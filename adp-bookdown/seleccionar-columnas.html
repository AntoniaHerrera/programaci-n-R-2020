<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>analizaR datos políticos</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook.">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="analizaR datos políticos" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="analizaR datos políticos" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Francisco Urdinez y Andrés Cruz">


<meta name="date" content="2017-11-16">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="manejo.html">
<link rel="next" href="ejercicios-1.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prefacio</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#agradecimientos"><i class="fa fa-check"></i><b>1.1</b> Agradecimientos</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduccion.html"><a href="introduccion.html"><i class="fa fa-check"></i><b>2</b> Introducción</a><ul>
<li class="chapter" data-level="2.1" data-path="introduccion.html"><a href="introduccion.html#organizacion-del-libro"><i class="fa fa-check"></i><b>2.1</b> Organización del libro</a></li>
<li class="chapter" data-level="2.2" data-path="introduccion.html"><a href="introduccion.html#prerrequisitos"><i class="fa fa-check"></i><b>2.2</b> Prerrequisitos</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="r-basico.html"><a href="r-basico.html"><i class="fa fa-check"></i><b>3</b> R básico</a><ul>
<li class="chapter" data-level="3.1" data-path="r-basico.html"><a href="r-basico.html#instalacion"><i class="fa fa-check"></i><b>3.1</b> Instalación</a><ul>
<li class="chapter" data-level="3.1.1" data-path="r-basico.html"><a href="r-basico.html#r"><i class="fa fa-check"></i><b>3.1.1</b> R</a></li>
<li class="chapter" data-level="3.1.2" data-path="r-basico.html"><a href="r-basico.html#rstudio"><i class="fa fa-check"></i><b>3.1.2</b> RStudio</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="r-basico.html"><a href="r-basico.html#partes-de-rstudio"><i class="fa fa-check"></i><b>3.2</b> Partes de RStudio</a><ul>
<li class="chapter" data-level="3.2.1" data-path="r-basico.html"><a href="r-basico.html#consola"><i class="fa fa-check"></i><b>3.2.1</b> Consola</a></li>
<li class="chapter" data-level="3.2.2" data-path="r-basico.html"><a href="r-basico.html#script"><i class="fa fa-check"></i><b>3.2.2</b> Script</a></li>
<li class="chapter" data-level="3.2.3" data-path="r-basico.html"><a href="r-basico.html#objetos"><i class="fa fa-check"></i><b>3.2.3</b> Objetos</a></li>
<li class="chapter" data-level="3.2.4" data-path="r-basico.html"><a href="r-basico.html#archivos-graficos-paquetes-ayuda"><i class="fa fa-check"></i><b>3.2.4</b> Archivos / gráficos / paquetes / ayuda</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="r-basico.html"><a href="r-basico.html#ejercicios"><i class="fa fa-check"></i><b>3.3</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="manejo.html"><a href="manejo.html"><i class="fa fa-check"></i><b>4</b> Manejo</a><ul>
<li class="chapter" data-level="4.1" data-path="manejo.html"><a href="manejo.html#nuestra-base-de-datos"><i class="fa fa-check"></i><b>4.1</b> Nuestra base de datos</a></li>
<li class="chapter" data-level="4.2" data-path="manejo.html"><a href="manejo.html#describir-base"><i class="fa fa-check"></i><b>4.2</b> Describir base</a></li>
<li class="chapter" data-level="4.3" data-path="manejo.html"><a href="manejo.html#ordenar-la-base"><i class="fa fa-check"></i><b>4.3</b> Ordenar la base</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="seleccionar-columnas.html"><a href="seleccionar-columnas.html"><i class="fa fa-check"></i><b>5</b> Seleccionar columnas</a><ul>
<li class="chapter" data-level="5.1" data-path="seleccionar-columnas.html"><a href="seleccionar-columnas.html#renombrar-columnas"><i class="fa fa-check"></i><b>5.1</b> Renombrar columnas</a></li>
<li class="chapter" data-level="5.2" data-path="seleccionar-columnas.html"><a href="seleccionar-columnas.html#filtrar-observaciones"><i class="fa fa-check"></i><b>5.2</b> Filtrar observaciones</a></li>
<li class="chapter" data-level="5.3" data-path="seleccionar-columnas.html"><a href="seleccionar-columnas.html#crear-nuevas-variables"><i class="fa fa-check"></i><b>5.3</b> Crear nuevas variables</a></li>
<li class="chapter" data-level="5.4" data-path="seleccionar-columnas.html"><a href="seleccionar-columnas.html#concatenar-comandos-las-pipes"><i class="fa fa-check"></i><b>5.4</b> Concatenar comandos: las pipes</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="ejercicios-1.html"><a href="ejercicios-1.html"><i class="fa fa-check"></i><b>6</b> Ejercicios</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">analizaR datos políticos</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="seleccionar-columnas" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Seleccionar columnas</h1>
<p>A veces queremos trabajar solo con algunas variables de una base de datos. Para esto existe la función <code>select()</code>. Pensemos que queremos solo el nombre de cada país (cname) y su porcentaje de población musulmana para 1980:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">select</span>(qog_mod, cname, lp_muslim80)</code></pre></div>
<pre><code>## # A tibble: 139 x 2
##          cname lp_muslim80
##          &lt;chr&gt;       &lt;dbl&gt;
##  1 Afghanistan        99.3
##  2     Albania        20.5
##  3     Algeria        99.1
##  4      Angola         0.0
##  5   Australia         0.2
##  6     Austria         0.6
##  7     Bahamas         0.0
##  8     Bahrain        95.0
##  9  Bangladesh        85.9
## 10    Barbados         0.2
## # ... with 129 more rows</code></pre>
<p>Al igual que para <code>arrange()</code>, aquí el primer argumento designa la base a modificar y los demás cómo se debería hacer eso -en este caso, qué variables deben ser seleccionadas.</p>
<p>Añadir un signo menos (-) aquí indica qué variables <em>no</em> seleccionar. Por ejemplo, quitemos el porcentaje de población musulmana para 1980 de la base:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">select</span>(qog_mod, <span class="op">-</span>lp_muslim80)</code></pre></div>
<pre><code>## # A tibble: 139 x 6
##          cname wdi_gdppppcon2011   wdi_pop ti_cpi fh_ipolity2
##          &lt;chr&gt;             &lt;dbl&gt;     &lt;int&gt;  &lt;dbl&gt;       &lt;dbl&gt;
##  1 Afghanistan       57566228480  30682500      8   2.0188808
##  2     Albania       28715335680   2897366     31   8.0833330
##  3     Algeria      507901640704  38186136     36   4.2500000
##  4      Angola      152477499392  23448202     23   3.2500000
##  5   Australia      990474338304  23125868     81  10.0000000
##  6     Austria      373413642240   8479375     69  10.0000000
##  7     Bahamas        8497731584    377841     71  10.0000000
##  8     Bahrain       56583507968   1349427     48   0.8333333
##  9  Bangladesh      446835425280 157157392     27   6.4166670
## 10    Barbados        4333428224    282503     75  10.0000000
## # ... with 129 more rows, and 1 more variables: region &lt;chr&gt;</code></pre>
<p>Aparte de seleccionar variables específicas, <code>select()</code> es capaz de entender referencias a intervalos de variables. Por ejemplo, podemos querer las cuatro primeras variables:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">select</span>(qog_mod, cname<span class="op">:</span>ti_cpi)</code></pre></div>
<pre><code>## # A tibble: 139 x 4
##          cname wdi_gdppppcon2011   wdi_pop ti_cpi
##          &lt;chr&gt;             &lt;dbl&gt;     &lt;int&gt;  &lt;dbl&gt;
##  1 Afghanistan       57566228480  30682500      8
##  2     Albania       28715335680   2897366     31
##  3     Algeria      507901640704  38186136     36
##  4      Angola      152477499392  23448202     23
##  5   Australia      990474338304  23125868     81
##  6     Austria      373413642240   8479375     69
##  7     Bahamas        8497731584    377841     71
##  8     Bahrain       56583507968   1349427     48
##  9  Bangladesh      446835425280 157157392     27
## 10    Barbados        4333428224    282503     75
## # ... with 129 more rows</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">select</span>(qog_mod, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) <span class="co"># lo mismo, aunque no recomendado</span></code></pre></div>
<pre><code>## # A tibble: 139 x 4
##          cname wdi_gdppppcon2011   wdi_pop ti_cpi
##          &lt;chr&gt;             &lt;dbl&gt;     &lt;int&gt;  &lt;dbl&gt;
##  1 Afghanistan       57566228480  30682500      8
##  2     Albania       28715335680   2897366     31
##  3     Algeria      507901640704  38186136     36
##  4      Angola      152477499392  23448202     23
##  5   Australia      990474338304  23125868     81
##  6     Austria      373413642240   8479375     69
##  7     Bahamas        8497731584    377841     71
##  8     Bahrain       56583507968   1349427     48
##  9  Bangladesh      446835425280 157157392     27
## 10    Barbados        4333428224    282503     75
## # ... with 129 more rows</code></pre>
<p>Otra herramienta para complejizar nuestra selección se encuentra en las funciones de ayuda. Entre ellas, <code>starts_with</code> es de particular utilidad, permitiendo seleccionar variables que empiecen con cierto patrón. Por ejemplo, podríamos querer, a partir del nombre del país, todas las variables que provengan de los World Development Indicators (WDI) del Banco Mundial:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">select</span>(qog_mod, cname, <span class="kw">starts_with</span>(<span class="st">&quot;wdi_&quot;</span>))</code></pre></div>
<pre><code>## # A tibble: 139 x 3
##          cname wdi_gdppppcon2011   wdi_pop
##          &lt;chr&gt;             &lt;dbl&gt;     &lt;int&gt;
##  1 Afghanistan       57566228480  30682500
##  2     Albania       28715335680   2897366
##  3     Algeria      507901640704  38186136
##  4      Angola      152477499392  23448202
##  5   Australia      990474338304  23125868
##  6     Austria      373413642240   8479375
##  7     Bahamas        8497731584    377841
##  8     Bahrain       56583507968   1349427
##  9  Bangladesh      446835425280 157157392
## 10    Barbados        4333428224    282503
## # ... with 129 more rows</code></pre>
<p>Otra función de ayuda útil es <code>everything()</code>, que se lee como “todas las demás variables”. Es especialmente útil para cambiar el orden de las variables en una bases de datos. Por ejemplo, pasemos región al segundo lugar entre las variables:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">select</span>(qog_mod, cname, region, <span class="kw">everything</span>())</code></pre></div>
<pre><code>## # A tibble: 139 x 7
##          cname                    region wdi_gdppppcon2011   wdi_pop
##          &lt;chr&gt;                     &lt;chr&gt;             &lt;dbl&gt;     &lt;int&gt;
##  1 Afghanistan             Southern Asia       57566228480  30682500
##  2     Albania           Southern Europe       28715335680   2897366
##  3     Algeria           Northern Africa      507901640704  38186136
##  4      Angola             Middle Africa      152477499392  23448202
##  5   Australia Australia and New Zealand      990474338304  23125868
##  6     Austria            Western Europe      373413642240   8479375
##  7     Bahamas                 Caribbean        8497731584    377841
##  8     Bahrain              Western Asia       56583507968   1349427
##  9  Bangladesh             Southern Asia      446835425280 157157392
## 10    Barbados                 Caribbean        4333428224    282503
## # ... with 129 more rows, and 3 more variables: ti_cpi &lt;dbl&gt;,
## #   lp_muslim80 &lt;dbl&gt;, fh_ipolity2 &lt;dbl&gt;</code></pre>
<div id="renombrar-columnas" class="section level2">
<h2><span class="header-section-number">5.1</span> Renombrar columnas</h2>
<p>La notación para el GDP es un poco confusa. ¿Y si queremos cambiar el nombre de la variable? Aprovechemos también de cambiar el nombre de la variable de identificación por país.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rename</span>(qog_mod, <span class="dt">wdi_gdp =</span> wdi_gdppppcon2011, <span class="dt">country_name =</span> cname)</code></pre></div>
<pre><code>## # A tibble: 139 x 7
##    country_name      wdi_gdp   wdi_pop ti_cpi lp_muslim80 fh_ipolity2
##           &lt;chr&gt;        &lt;dbl&gt;     &lt;int&gt;  &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;
##  1  Afghanistan  57566228480  30682500      8        99.3   2.0188808
##  2      Albania  28715335680   2897366     31        20.5   8.0833330
##  3      Algeria 507901640704  38186136     36        99.1   4.2500000
##  4       Angola 152477499392  23448202     23         0.0   3.2500000
##  5    Australia 990474338304  23125868     81         0.2  10.0000000
##  6      Austria 373413642240   8479375     69         0.6  10.0000000
##  7      Bahamas   8497731584    377841     71         0.0  10.0000000
##  8      Bahrain  56583507968   1349427     48        95.0   0.8333333
##  9   Bangladesh 446835425280 157157392     27        85.9   6.4166670
## 10     Barbados   4333428224    282503     75         0.2  10.0000000
## # ... with 129 more rows, and 1 more variables: region &lt;chr&gt;</code></pre>
</div>
<div id="filtrar-observaciones" class="section level2">
<h2><span class="header-section-number">5.2</span> Filtrar observaciones</h2>
<p>Es muy común el querer filtrar nuestras observaciones de acuerdo a algún tipo de criterio lógico. Para esto R cuenta con operadores lógicos. Los más comunes son los siguientes:</p>
<table>
<thead>
<tr class="header">
<th align="center">operador</th>
<th>descripción</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">==</td>
<td>es igual a</td>
</tr>
<tr class="even">
<td align="center">!=</td>
<td>es distinto a</td>
</tr>
<tr class="odd">
<td align="center">&gt;</td>
<td>es mayor a</td>
</tr>
<tr class="even">
<td align="center">&lt;</td>
<td>es menor a</td>
</tr>
<tr class="odd">
<td align="center">&gt;=</td>
<td>es mayor o igual a</td>
</tr>
<tr class="even">
<td align="center">&lt;=</td>
<td>es menor o igual a</td>
</tr>
<tr class="odd">
<td align="center">&amp;</td>
<td>y (intersección)</td>
</tr>
<tr class="even">
<td align="center"></td>
<td></td>
</tr>
</tbody>
</table>
<p>Por ejemplo, podríamos querer solo los países (observaciones) sudamericanos. Hacer esto con <code>filter()</code> es simple, con la ayuda de operadores lógicos:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">filter</span>(qog_mod, region <span class="op">==</span><span class="st"> &quot;South America&quot;</span>)</code></pre></div>
<pre><code>## # A tibble: 11 x 7
##        cname wdi_gdppppcon2011   wdi_pop ti_cpi lp_muslim80 fh_ipolity2
##        &lt;chr&gt;             &lt;dbl&gt;     &lt;int&gt;  &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;
##  1   Bolivia      6.334484e+10  10399931     34         0.0    7.583333
##  2    Brazil      3.109302e+12 204259376     42         0.1    8.666666
##  3     Chile      3.831625e+11  17575832     71         0.0   10.000000
##  4  Colombia      5.824887e+11  47342364     36         0.2    7.166667
##  5   Ecuador      1.664122e+11  15661312     35         0.0    7.083333
##  6    Guyana      5.066298e+09    761033     27         9.0    7.750000
##  7  Paraguay      5.319503e+10   6465669     24         0.0    8.083333
##  8      Peru      3.461269e+11  30565460     38         0.0    8.500000
##  9  Suriname      8.388805e+09    533450     36        13.0    7.916666
## 10   Uruguay      6.582768e+10   3407969     73         0.0   10.000000
## 11 Venezuela      5.355721e+11  30276044     20         0.0    5.166666
## # ... with 1 more variables: region &lt;chr&gt;</code></pre>
<p>¿Qué pasa si queremos solo las filas de países sudamericanos con más de 10 millones de habitantes (nos quedamos con 8 de 12)?</p>
<p>¿Cuáles son los filtros que aplican los siguientes comandos?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">filter</span>(qog_mod, fh_ipolity2 <span class="op">&gt;</span><span class="st"> </span><span class="dv">9</span>)</code></pre></div>
<pre><code>## # A tibble: 39 x 7
##             cname wdi_gdppppcon2011  wdi_pop ti_cpi lp_muslim80
##             &lt;chr&gt;             &lt;dbl&gt;    &lt;int&gt;  &lt;dbl&gt;       &lt;dbl&gt;
##  1      Australia      9.904743e+11 23125868     81         0.2
##  2        Austria      3.734136e+11  8479375     69         0.6
##  3        Bahamas      8.497732e+09   377841     71         0.0
##  4       Barbados      4.333428e+09   282503     75         0.2
##  5        Belgium      4.521544e+11 11182817     75         1.1
##  6         Canada      1.484142e+12 35158304     81         0.6
##  7     Cape Verde      3.109325e+09   507258     58         0.0
##  8          Chile      3.831625e+11 17575832     71         0.0
##  9     Costa Rica      6.541985e+10  4706433     53         0.0
## 10 Cyprus (1975-)      2.592799e+10  1141652     63        18.5
## # ... with 29 more rows, and 2 more variables: fh_ipolity2 &lt;dbl&gt;,
## #   region &lt;chr&gt;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">filter</span>(qog_mod, wdi_pop <span class="op">&gt;</span><span class="st"> </span><span class="fl">10e7</span>)</code></pre></div>
<pre><code>## # A tibble: 10 x 7
##               cname wdi_gdppppcon2011    wdi_pop ti_cpi lp_muslim80
##               &lt;chr&gt;             &lt;dbl&gt;      &lt;int&gt;  &lt;dbl&gt;       &lt;dbl&gt;
##  1       Bangladesh      4.468354e+11  157157392     27        85.9
##  2           Brazil      3.109302e+12  204259376     42         0.1
##  3            China      1.602399e+13 1357379968     40         2.4
##  4            India      6.566166e+12 1279498880     36        11.6
##  5        Indonesia      2.430922e+12  251268272     32        43.4
##  6            Japan      4.535077e+12  127338624     74         0.0
##  7           Mexico      1.997247e+12  123740112     34         0.0
##  8          Nigeria      9.414628e+11  172816512     25        45.0
##  9 Pakistan (1971-)      8.109545e+11  181192640     28        96.8
## 10    United States      1.623049e+13  316497536     73         0.8
## # ... with 2 more variables: fh_ipolity2 &lt;dbl&gt;, region &lt;chr&gt;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">filter</span>(qog_mod, cname <span class="op">!=</span><span class="st"> &quot;Albania&quot;</span>)</code></pre></div>
<pre><code>## # A tibble: 138 x 7
##          cname wdi_gdppppcon2011   wdi_pop ti_cpi lp_muslim80 fh_ipolity2
##          &lt;chr&gt;             &lt;dbl&gt;     &lt;int&gt;  &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;
##  1 Afghanistan       57566228480  30682500      8        99.3   2.0188808
##  2     Algeria      507901640704  38186136     36        99.1   4.2500000
##  3      Angola      152477499392  23448202     23         0.0   3.2500000
##  4   Australia      990474338304  23125868     81         0.2  10.0000000
##  5     Austria      373413642240   8479375     69         0.6  10.0000000
##  6     Bahamas        8497731584    377841     71         0.0  10.0000000
##  7     Bahrain       56583507968   1349427     48        95.0   0.8333333
##  8  Bangladesh      446835425280 157157392     27        85.9   6.4166670
##  9    Barbados        4333428224    282503     75         0.2  10.0000000
## 10     Belgium      452154359808  11182817     75         1.1   9.5000000
## # ... with 128 more rows, and 1 more variables: region &lt;chr&gt;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">filter</span>(qog_mod, lp_muslim80 <span class="op">&gt;=</span><span class="st"> </span><span class="dv">95</span>)</code></pre></div>
<pre><code>## # A tibble: 15 x 7
##               cname wdi_gdppppcon2011   wdi_pop   ti_cpi lp_muslim80
##               &lt;chr&gt;             &lt;dbl&gt;     &lt;int&gt;    &lt;dbl&gt;       &lt;dbl&gt;
##  1      Afghanistan      5.756623e+10  30682500  8.00000        99.3
##  2          Algeria      5.079016e+11  38186136 36.00000        99.1
##  3          Bahrain      5.658351e+10   1349427 48.00000        95.0
##  4             Iran      1.236225e+12  77152448 25.00000        97.9
##  5             Iraq      5.108955e+11  33781384 16.00000        95.8
##  6           Kuwait      2.665846e+11   3593689 43.00000        95.1
##  7            Libya      1.225442e+11   6265987 15.00000        98.1
##  8         Maldives      4.501654e+09    393000 24.70782        99.9
##  9       Mauritania      1.392070e+10   3872684 30.00000        99.4
## 10          Morocco      2.406042e+11  33452686 37.00000        99.4
## 11             Oman      1.517266e+11   3906912 47.00000        98.9
## 12 Pakistan (1971-)      8.109545e+11 181192640 28.00000        96.8
## 13     Saudi Arabia      1.478748e+12  30201052 46.00000        98.8
## 14          Tunisia      1.168218e+11  10886500 41.00000        99.4
## 15           Turkey      1.392197e+12  75010200 50.00000        99.2
## # ... with 2 more variables: fh_ipolity2 &lt;dbl&gt;, region &lt;chr&gt;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">filter</span>(qog_mod, region <span class="op">==</span><span class="st"> &quot;South America&quot;</span> <span class="op">&amp;</span><span class="st"> </span>wdi_pop <span class="op">&gt;</span><span class="st"> </span><span class="fl">10e6</span>)</code></pre></div>
<pre><code>## # A tibble: 7 x 7
##       cname wdi_gdppppcon2011   wdi_pop ti_cpi lp_muslim80 fh_ipolity2
##       &lt;chr&gt;             &lt;dbl&gt;     &lt;int&gt;  &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;
## 1   Bolivia      6.334484e+10  10399931     34         0.0    7.583333
## 2    Brazil      3.109302e+12 204259376     42         0.1    8.666666
## 3     Chile      3.831625e+11  17575832     71         0.0   10.000000
## 4  Colombia      5.824887e+11  47342364     36         0.2    7.166667
## 5   Ecuador      1.664122e+11  15661312     35         0.0    7.083333
## 6      Peru      3.461269e+11  30565460     38         0.0    8.500000
## 7 Venezuela      5.355721e+11  30276044     20         0.0    5.166666
## # ... with 1 more variables: region &lt;chr&gt;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">filter</span>(qog_mod, region <span class="op">==</span><span class="st"> &quot;South America&quot;</span> <span class="op">|</span><span class="st"> </span>region <span class="op">==</span><span class="st"> &quot;South-Eastern Asia&quot;</span>)</code></pre></div>
<pre><code>## # A tibble: 19 x 7
##               cname wdi_gdppppcon2011   wdi_pop ti_cpi lp_muslim80
##               &lt;chr&gt;             &lt;dbl&gt;     &lt;int&gt;  &lt;dbl&gt;       &lt;dbl&gt;
##  1          Bolivia      6.334484e+10  10399931     34         0.0
##  2           Brazil      3.109302e+12 204259376     42         0.1
##  3         Cambodia      4.455977e+10  15078564     20         2.4
##  4            Chile      3.831625e+11  17575832     71         0.0
##  5         Colombia      5.824887e+11  47342364     36         0.2
##  6          Ecuador      1.664122e+11  15661312     35         0.0
##  7           Guyana      5.066298e+09    761033     27         9.0
##  8        Indonesia      2.430922e+12 251268272     32        43.4
##  9             Laos      3.158284e+10   6579985     26         1.0
## 10 Malaysia (1966-)      6.900446e+11  29465372     50        49.4
## 11         Paraguay      5.319503e+10   6465669     24         0.0
## 12             Peru      3.461269e+11  30565460     38         0.0
## 13      Philippines      6.210440e+11  97571680     36         4.3
## 14        Singapore      4.196306e+11   5399200     86        17.4
## 15          Vietnam      4.597249e+11  89708896     31         1.0
## 16         Suriname      8.388805e+09    533450     36        13.0
## 17         Thailand      1.007950e+12  67451424     35         3.9
## 18          Uruguay      6.582768e+10   3407969     73         0.0
## 19        Venezuela      5.355721e+11  30276044     20         0.0
## # ... with 2 more variables: fh_ipolity2 &lt;dbl&gt;, region &lt;chr&gt;</code></pre>
</div>
<div id="crear-nuevas-variables" class="section level2">
<h2><span class="header-section-number">5.3</span> Crear nuevas variables</h2>
<p>Muchas veces queremos crear nuevas variables, a partir de las que ya tenemos. Por ejemplo, podríamos querer el GDP per capita, en vez del absoluto. Tenemos los ingredientes para calcularlo: el GDP absoluto y la población. Creemos una nueva variable, entonces:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mutate</span>(qog_mod, <span class="dt">gdp_ppp_per_capita =</span> wdi_gdppppcon2011<span class="op">/</span>wdi_pop)</code></pre></div>
<pre><code>## # A tibble: 139 x 8
##          cname wdi_gdppppcon2011   wdi_pop ti_cpi lp_muslim80 fh_ipolity2
##          &lt;chr&gt;             &lt;dbl&gt;     &lt;int&gt;  &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;
##  1 Afghanistan       57566228480  30682500      8        99.3   2.0188808
##  2     Albania       28715335680   2897366     31        20.5   8.0833330
##  3     Algeria      507901640704  38186136     36        99.1   4.2500000
##  4      Angola      152477499392  23448202     23         0.0   3.2500000
##  5   Australia      990474338304  23125868     81         0.2  10.0000000
##  6     Austria      373413642240   8479375     69         0.6  10.0000000
##  7     Bahamas        8497731584    377841     71         0.0  10.0000000
##  8     Bahrain       56583507968   1349427     48        95.0   0.8333333
##  9  Bangladesh      446835425280 157157392     27        85.9   6.4166670
## 10    Barbados        4333428224    282503     75         0.2  10.0000000
## # ... with 129 more rows, and 2 more variables: region &lt;chr&gt;,
## #   gdp_ppp_per_capita &lt;dbl&gt;</code></pre>
<p>Otra nueva variable que podría interesarnos es el número de musulmanes por país. Con la proporción de musulmanes y la población total del país podemos hacer una buena estimación:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mutate</span>(qog_mod, <span class="dt">n_muslim =</span> wdi_pop <span class="op">*</span><span class="st"> </span>lp_muslim80)</code></pre></div>
<pre><code>## # A tibble: 139 x 8
##          cname wdi_gdppppcon2011   wdi_pop ti_cpi lp_muslim80 fh_ipolity2
##          &lt;chr&gt;             &lt;dbl&gt;     &lt;int&gt;  &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;
##  1 Afghanistan       57566228480  30682500      8        99.3   2.0188808
##  2     Albania       28715335680   2897366     31        20.5   8.0833330
##  3     Algeria      507901640704  38186136     36        99.1   4.2500000
##  4      Angola      152477499392  23448202     23         0.0   3.2500000
##  5   Australia      990474338304  23125868     81         0.2  10.0000000
##  6     Austria      373413642240   8479375     69         0.6  10.0000000
##  7     Bahamas        8497731584    377841     71         0.0  10.0000000
##  8     Bahrain       56583507968   1349427     48        95.0   0.8333333
##  9  Bangladesh      446835425280 157157392     27        85.9   6.4166670
## 10    Barbados        4333428224    282503     75         0.2  10.0000000
## # ... with 129 more rows, and 2 more variables: region &lt;chr&gt;,
## #   n_muslim &lt;dbl&gt;</code></pre>
<p>¡Es posible crear más de una variable con el mismo comando! Creemos las dos de antes, a la vez:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mutate</span>(qog_mod, 
       <span class="dt">gdp_ppp_per_capita =</span> wdi_gdppppcon2011<span class="op">/</span>wdi_pop,
       <span class="dt">n_muslim           =</span> wdi_pop <span class="op">*</span><span class="st"> </span>lp_muslim80)</code></pre></div>
<pre><code>## # A tibble: 139 x 9
##          cname wdi_gdppppcon2011   wdi_pop ti_cpi lp_muslim80 fh_ipolity2
##          &lt;chr&gt;             &lt;dbl&gt;     &lt;int&gt;  &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;
##  1 Afghanistan       57566228480  30682500      8        99.3   2.0188808
##  2     Albania       28715335680   2897366     31        20.5   8.0833330
##  3     Algeria      507901640704  38186136     36        99.1   4.2500000
##  4      Angola      152477499392  23448202     23         0.0   3.2500000
##  5   Australia      990474338304  23125868     81         0.2  10.0000000
##  6     Austria      373413642240   8479375     69         0.6  10.0000000
##  7     Bahamas        8497731584    377841     71         0.0  10.0000000
##  8     Bahrain       56583507968   1349427     48        95.0   0.8333333
##  9  Bangladesh      446835425280 157157392     27        85.9   6.4166670
## 10    Barbados        4333428224    282503     75         0.2  10.0000000
## # ... with 129 more rows, and 3 more variables: region &lt;chr&gt;,
## #   gdp_ppp_per_capita &lt;dbl&gt;, n_muslim &lt;dbl&gt;</code></pre>
</div>
<div id="concatenar-comandos-las-pipes" class="section level2">
<h2><span class="header-section-number">5.4</span> Concatenar comandos: las pipes</h2>
<p>A menudo no queremos hacer una sola de las operaciones con bases de datos reseñadas antes, sino que una seguidilla de estas. Si quisiéramos crear una nueva base a través de, por ejemplo, (1) seleccionar las variables de país, población y GDP, (2) crear la variable de GDP per capita, y (3) ordenar los países de mayor a menor según GDP per capita, nuestro procedimiento en R sería algo como esto:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">qog_mod_seguidilla_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">select</span>(qog_mod, cname, wdi_pop, wdi_gdppppcon2011)
qog_mod_seguidilla_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">mutate</span>(qog_mod_seguidilla_<span class="dv">1</span>, 
                               <span class="dt">gdp_ppp_per_capita =</span> wdi_gdppppcon2011<span class="op">/</span>wdi_pop)
qog_mod_seguidilla_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">arrange</span>(qog_mod_seguidilla_<span class="dv">2</span>, <span class="op">-</span>gdp_ppp_per_capita)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">qog_mod_seguidilla_<span class="dv">3</span></code></pre></div>
<pre><code>## # A tibble: 139 x 4
##                   cname   wdi_pop wdi_gdppppcon2011 gdp_ppp_per_capita
##                   &lt;chr&gt;     &lt;int&gt;             &lt;dbl&gt;              &lt;dbl&gt;
##  1                Qatar   2101288      2.803021e+11          133395.36
##  2           Luxembourg    543360      4.884228e+10           89889.36
##  3            Singapore   5399200      4.196306e+11           77720.89
##  4               Kuwait   3593689      2.665846e+11           74181.33
##  5               Norway   5079623      3.216514e+11           63321.91
##  6 United Arab Emirates   9039978      5.609863e+11           62056.15
##  7          Switzerland   8089346      4.442016e+11           54911.93
##  8        United States 316497536      1.623049e+13           51281.58
##  9         Saudi Arabia  30201052      1.478748e+12           48963.45
## 10              Ireland   4598294      2.123570e+11           46181.70
## # ... with 129 more rows</code></pre>
<p>El lector notará que esto es bastante complicado y nos deja con dos <strong>objetos intermedios</strong> que no nos interesan, “qog_mod_seguidilla_1” y “qog_mod_seguidilla_2”.</p>
<p>La solución del paquete tidyverse que estamos utilizando son <strong>las pipes</strong>. El lector notará que en las tres funciones de nuestra seguidilla anterior (select, mutate y arrange) el primer argumento es la base de datos a tratar. En vez de crear objetos intermedios podemos “chutear” la base de datos a través de nuestros comandos con pipes, omitiendo los primeros argumentos:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">qog_mod_seguidilla &lt;-<span class="st"> </span>qog_mod <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(cname, wdi_pop, wdi_gdppppcon2011) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">gdp_ppp_per_capita =</span> wdi_gdppppcon2011<span class="op">/</span>wdi_pop) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="op">-</span>gdp_ppp_per_capita)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">qog_mod_seguidilla</code></pre></div>
<pre><code>## # A tibble: 139 x 4
##                   cname   wdi_pop wdi_gdppppcon2011 gdp_ppp_per_capita
##                   &lt;chr&gt;     &lt;int&gt;             &lt;dbl&gt;              &lt;dbl&gt;
##  1                Qatar   2101288      2.803021e+11          133395.36
##  2           Luxembourg    543360      4.884228e+10           89889.36
##  3            Singapore   5399200      4.196306e+11           77720.89
##  4               Kuwait   3593689      2.665846e+11           74181.33
##  5               Norway   5079623      3.216514e+11           63321.91
##  6 United Arab Emirates   9039978      5.609863e+11           62056.15
##  7          Switzerland   8089346      4.442016e+11           54911.93
##  8        United States 316497536      1.623049e+13           51281.58
##  9         Saudi Arabia  30201052      1.478748e+12           48963.45
## 10              Ireland   4598294      2.123570e+11           46181.70
## # ... with 129 more rows</code></pre>
<p>Las pipes pueden leerse como “pero luego”. Nuestra seguidilla anterior, entonces, se leería de la siguiente forma:</p>
<blockquote>
<p>qog_mod_seguilla es igual a qog_mod; pero luego seleccionamos las variables cname, wdi_pop, wdi_gdppppcon2011; pero luego creamos la variable gdp_ppp_per_capita; pero luego ordenamos la base en forma decreciente según gdp_ppp_per_capita.</p>
</blockquote>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="manejo.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ejercicios-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/04-manejo.Rmd",
"text": "Edit"
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
