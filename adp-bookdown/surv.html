<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>AnalizaR datos políticos</title>
  <meta name="description" content="Proyecto de libro">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="AnalizaR datos políticos" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Proyecto de libro" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="AnalizaR datos políticos" />
  
  <meta name="twitter:description" content="Proyecto de libro" />
  

<meta name="author" content="Francisco Urdinez y Andrés Cruz Labrín (editores)">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
<link rel="prev" href="logit.html">
<link rel="next" href="manejo-av.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<script src="libs/htmlwidgets-1.2/htmlwidgets.js"></script>
<link href="libs/wordcloud2-0.0.1/wordcloud.css" rel="stylesheet" />
<script src="libs/wordcloud2-0.0.1/wordcloud2-all.js"></script>
<script src="libs/wordcloud2-0.0.1/hover.js"></script>
<script src="libs/wordcloud2-binding-0.2.1/wordcloud2.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><b><a href="./index.html">analizaR datos políticos</a></b></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Tabla de contenidos</a></li>
<li class="chapter" data-level="1" data-path="prefacio.html"><a href="prefacio.html"><i class="fa fa-check"></i><b>1</b> Prefacio</a><ul>
<li class="chapter" data-level="1.1" data-path="prefacio.html"><a href="prefacio.html#agradecimientos"><i class="fa fa-check"></i><b>1.1</b> Agradecimientos</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduccion.html"><a href="introduccion.html"><i class="fa fa-check"></i><b>2</b> Introducción</a><ul>
<li class="chapter" data-level="2.1" data-path="introduccion.html"><a href="introduccion.html#organizacion-del-libro"><i class="fa fa-check"></i><b>2.1</b> Organización del libro</a></li>
<li class="chapter" data-level="2.2" data-path="introduccion.html"><a href="introduccion.html#prerrequisitos"><i class="fa fa-check"></i><b>2.2</b> Prerrequisitos</a></li>
</ul></li>
<li class="part"><span><b>I Introducción a R</b></span></li>
<li class="chapter" data-level="3" data-path="rbas.html"><a href="rbas.html"><i class="fa fa-check"></i><b>3</b> R básico</a><ul>
<li class="chapter" data-level="3.1" data-path="rbas.html"><a href="rbas.html#instalacion"><i class="fa fa-check"></i><b>3.1</b> Instalación</a><ul>
<li class="chapter" data-level="3.1.1" data-path="rbas.html"><a href="rbas.html#r"><i class="fa fa-check"></i><b>3.1.1</b> R</a></li>
<li class="chapter" data-level="3.1.2" data-path="rbas.html"><a href="rbas.html#rstudio"><i class="fa fa-check"></i><b>3.1.2</b> RStudio</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="rbas.html"><a href="rbas.html#partes-de-rstudio"><i class="fa fa-check"></i><b>3.2</b> Partes de RStudio</a><ul>
<li class="chapter" data-level="3.2.1" data-path="rbas.html"><a href="rbas.html#consola"><i class="fa fa-check"></i><b>3.2.1</b> Consola</a></li>
<li class="chapter" data-level="3.2.2" data-path="rbas.html"><a href="rbas.html#script"><i class="fa fa-check"></i><b>3.2.2</b> Script</a></li>
<li class="chapter" data-level="3.2.3" data-path="rbas.html"><a href="rbas.html#objetos"><i class="fa fa-check"></i><b>3.2.3</b> Objetos</a></li>
<li class="chapter" data-level="3.2.4" data-path="rbas.html"><a href="rbas.html#archivos-graficos-paquetes-ayuda"><i class="fa fa-check"></i><b>3.2.4</b> Archivos / gráficos / paquetes / ayuda</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="rbas.html"><a href="rbas.html#ejercicios"><i class="fa fa-check"></i><b>3.3</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="manejo-de-datos.html"><a href="manejo-de-datos.html"><i class="fa fa-check"></i><b>4</b> Manejo de datos</a><ul>
<li class="chapter" data-level="4.1" data-path="manejo-de-datos.html"><a href="manejo-de-datos.html#nuestra-base-de-datos"><i class="fa fa-check"></i><b>4.1</b> Nuestra base de datos</a></li>
<li class="chapter" data-level="4.2" data-path="manejo-de-datos.html"><a href="manejo-de-datos.html#describir-la-base"><i class="fa fa-check"></i><b>4.2</b> Describir la base</a></li>
<li class="chapter" data-level="4.3" data-path="manejo-de-datos.html"><a href="manejo-de-datos.html#ordenar-la-base-con-arrange"><i class="fa fa-check"></i><b>4.3</b> Ordenar la base con <code>arrange()</code></a></li>
<li class="chapter" data-level="4.4" data-path="manejo-de-datos.html"><a href="manejo-de-datos.html#seleccionar-columnas-de-la-base-con-select"><i class="fa fa-check"></i><b>4.4</b> Seleccionar columnas de la base con <code>select()</code></a></li>
<li class="chapter" data-level="4.5" data-path="manejo-de-datos.html"><a href="manejo-de-datos.html#renombrar-columnas-de-la-base-con-rename"><i class="fa fa-check"></i><b>4.5</b> Renombrar columnas de la base con <code>rename()</code></a></li>
<li class="chapter" data-level="4.6" data-path="manejo-de-datos.html"><a href="manejo-de-datos.html#filtrar-observaciones-de-la-base-con-filter"><i class="fa fa-check"></i><b>4.6</b> Filtrar observaciones de la base con <code>filter()</code></a></li>
<li class="chapter" data-level="4.7" data-path="manejo-de-datos.html"><a href="manejo-de-datos.html#crear-nuevas-variables-en-la-base-con-mutate"><i class="fa fa-check"></i><b>4.7</b> Crear nuevas variables en la base con <code>mutate()</code></a></li>
<li class="chapter" data-level="4.8" data-path="manejo-de-datos.html"><a href="manejo-de-datos.html#concatenar-comandos-las-pipes"><i class="fa fa-check"></i><b>4.8</b> Concatenar comandos: las pipes (<code>%&gt;%</code>)</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="dataviz.html"><a href="dataviz.html"><i class="fa fa-check"></i><b>5</b> Visualización de datos</a><ul>
<li class="chapter" data-level="5.1" data-path="dataviz.html"><a href="dataviz.html#por-que-quiero-visualizar-mis-datos"><i class="fa fa-check"></i><b>5.1</b> ¿Por qué quiero visualizar mis datos?</a></li>
<li class="chapter" data-level="5.2" data-path="dataviz.html"><a href="dataviz.html#primeros-pasos"><i class="fa fa-check"></i><b>5.2</b> Primeros pasos</a><ul>
<li class="chapter" data-level="5.2.1" data-path="dataviz.html"><a href="dataviz.html#las-capas-del-multiverso-ggplotidiano"><i class="fa fa-check"></i><b>5.2.1</b> Las capas del multiverso ggplotidiano</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="dataviz.html"><a href="dataviz.html#elecciones-locales-y-visualizacion-de-datos"><i class="fa fa-check"></i><b>5.3</b> Elecciones locales y visualización de datos</a><ul>
<li class="chapter" data-level="5.3.1" data-path="dataviz.html"><a href="dataviz.html#grafico-de-barras"><i class="fa fa-check"></i><b>5.3.1</b> Gráfico de barras</a></li>
<li class="chapter" data-level="5.3.2" data-path="dataviz.html"><a href="dataviz.html#boxplot"><i class="fa fa-check"></i><b>5.3.2</b> Boxplot</a></li>
<li class="chapter" data-level="5.3.3" data-path="dataviz.html"><a href="dataviz.html#relacion-entre-variables"><i class="fa fa-check"></i><b>5.3.3</b> Relación entre variables</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="dataviz.html"><a href="dataviz.html#para-seguir-aprendiendo"><i class="fa fa-check"></i><b>5.4</b> Para seguir aprendiendo</a><ul>
<li class="chapter" data-level="5.4.1" data-path="dataviz.html"><a href="dataviz.html#otros-paquetes"><i class="fa fa-check"></i><b>5.4.1</b> Otros paquetes:</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="carga-flujo.html"><a href="carga-flujo.html"><i class="fa fa-check"></i><b>6</b> Carga de bases y flujo de trabajo</a></li>
<li class="part"><span><b>II Modelos</b></span></li>
<li class="chapter" data-level="7" data-path="stats.html"><a href="stats.html"><i class="fa fa-check"></i><b>7</b> Estadística inferencial básica</a></li>
<li class="chapter" data-level="8" data-path="lineal.html"><a href="lineal.html"><i class="fa fa-check"></i><b>8</b> Modelos lineales</a><ul>
<li class="chapter" data-level="8.1" data-path="lineal.html"><a href="lineal.html#introduccion-1"><i class="fa fa-check"></i><b>8.1</b> Introducción</a></li>
<li class="chapter" data-level="8.2" data-path="lineal.html"><a href="lineal.html#aplicacion-en-r"><i class="fa fa-check"></i><b>8.2</b> Aplicación en R</a><ul>
<li class="chapter" data-level="8.2.1" data-path="lineal.html"><a href="lineal.html#estadisticos-descriptivos"><i class="fa fa-check"></i><b>8.2.1</b> Estadísticos Descriptivos</a></li>
<li class="chapter" data-level="8.2.2" data-path="lineal.html"><a href="lineal.html#estadisticos-descriptivos-y-distribucion-de-las-variables-del-modelo"><i class="fa fa-check"></i><b>8.2.2</b> Estadísticos descriptivos y distribución de las variables del modelo</a></li>
<li class="chapter" data-level="8.2.3" data-path="lineal.html"><a href="lineal.html#matriz-de-correlacion-de-variables-independientes"><i class="fa fa-check"></i><b>8.2.3</b> Matriz de correlación de variables independientes</a></li>
<li class="chapter" data-level="8.2.4" data-path="lineal.html"><a href="lineal.html#distribucion-de-las-variables-de-interes"><i class="fa fa-check"></i><b>8.2.4</b> Distribución de las variables de interés</a></li>
<li class="chapter" data-level="8.2.5" data-path="lineal.html"><a href="lineal.html#relacion-entre-la-variable-dependiente-e-independiente"><i class="fa fa-check"></i><b>8.2.5</b> Relación entre la variable dependiente e independiente</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="lineal.html"><a href="lineal.html#modelo-bivariado-regresion-lineal-simple"><i class="fa fa-check"></i><b>8.3</b> Modelo bivariado: regresión lineal simple</a><ul>
<li class="chapter" data-level="8.3.1" data-path="lineal.html"><a href="lineal.html#estimando-un-modelo-lineal-en-r"><i class="fa fa-check"></i><b>8.3.1</b> Estimando un modelo lineal en R</a></li>
<li class="chapter" data-level="8.3.2" data-path="lineal.html"><a href="lineal.html#representacion-grafica."><i class="fa fa-check"></i><b>8.3.2</b> Representación gráfica.</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="lineal.html"><a href="lineal.html#modelo-multivariado-regresion-multiple"><i class="fa fa-check"></i><b>8.4</b> Modelo multivariado: regresión múltiple</a><ul>
<li class="chapter" data-level="8.4.1" data-path="lineal.html"><a href="lineal.html#ajuste-del-modelo"><i class="fa fa-check"></i><b>8.4.1</b> Ajuste del modelo</a></li>
<li class="chapter" data-level="8.4.2" data-path="lineal.html"><a href="lineal.html#inferencia-en-modelos-lineales-multiples"><i class="fa fa-check"></i><b>8.4.2</b> Inferencia en modelos lineales múltiples</a></li>
<li class="chapter" data-level="8.4.3" data-path="lineal.html"><a href="lineal.html#supuestos-de-ols"><i class="fa fa-check"></i><b>8.4.3</b> Supuestos de OLS</a></li>
<li class="chapter" data-level="8.4.4" data-path="lineal.html"><a href="lineal.html#errores-estandares-robustos"><i class="fa fa-check"></i><b>8.4.4</b> Errores estándares robustos</a></li>
<li class="chapter" data-level="8.4.5" data-path="lineal.html"><a href="lineal.html#un-caso-especial-de-heterocedasticidad-la-varianza-del-error-asociada-a-clusters"><i class="fa fa-check"></i><b>8.4.5</b> Un caso especial de Heterocedasticidad: la varianza del error asociada a clusters</a></li>
<li class="chapter" data-level="8.4.6" data-path="lineal.html"><a href="lineal.html#un-supuesto-adicional-para-poder-realizar-inferencia"><i class="fa fa-check"></i><b>8.4.6</b> Un supuesto adicional para poder realizar <strong>inferencia</strong></a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="lineal.html"><a href="lineal.html#seleccion-de-casos"><i class="fa fa-check"></i><b>8.5</b> Selección de casos</a><ul>
<li class="chapter" data-level="8.5.1" data-path="lineal.html"><a href="lineal.html#que-casos-seleccionar"><i class="fa fa-check"></i><b>8.5.1</b> ¿Qué casos seleccionar?</a></li>
<li class="chapter" data-level="8.5.2" data-path="lineal.html"><a href="lineal.html#casos-tipicos"><i class="fa fa-check"></i><b>8.5.2</b> Casos Típicos</a></li>
<li class="chapter" data-level="8.5.3" data-path="lineal.html"><a href="lineal.html#casos-desviados"><i class="fa fa-check"></i><b>8.5.3</b> Casos desviados</a></li>
<li class="chapter" data-level="8.5.4" data-path="lineal.html"><a href="lineal.html#casos-influyentes"><i class="fa fa-check"></i><b>8.5.4</b> Casos Influyentes</a></li>
<li class="chapter" data-level="8.5.5" data-path="lineal.html"><a href="lineal.html#casos-extremos"><i class="fa fa-check"></i><b>8.5.5</b> Casos extremos</a></li>
<li class="chapter" data-level="8.5.6" data-path="lineal.html"><a href="lineal.html#casos-mas-similares"><i class="fa fa-check"></i><b>8.5.6</b> Casos más similares</a></li>
<li class="chapter" data-level="8.5.7" data-path="lineal.html"><a href="lineal.html#casos-mas-diferentes"><i class="fa fa-check"></i><b>8.5.7</b> Casos más diferentes</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="lineal.html"><a href="lineal.html#la-relevancia-de-combinar-metodos"><i class="fa fa-check"></i><b>8.6</b> La relevancia de combinar métodos</a></li>
<li class="chapter" data-level="8.7" data-path="lineal.html"><a href="lineal.html#referencias"><i class="fa fa-check"></i><b>8.7</b> Referencias</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="logit.html"><a href="logit.html"><i class="fa fa-check"></i><b>9</b> Modelos binarios</a><ul>
<li class="chapter" data-level="9.1" data-path="logit.html"><a href="logit.html#nociones-basicas"><i class="fa fa-check"></i><b>9.1</b> Nociones básicas</a></li>
<li class="chapter" data-level="9.2" data-path="logit.html"><a href="logit.html#aplicacion-en-r-1"><i class="fa fa-check"></i><b>9.2</b> Aplicación en R</a><ul>
<li class="chapter" data-level="9.2.1" data-path="logit.html"><a href="logit.html#estimar-los-modelos"><i class="fa fa-check"></i><b>9.2.1</b> Estimar los modelos</a></li>
<li class="chapter" data-level="9.2.2" data-path="logit.html"><a href="logit.html#crear-tablas"><i class="fa fa-check"></i><b>9.2.2</b> Crear tablas</a></li>
<li class="chapter" data-level="9.2.3" data-path="logit.html"><a href="logit.html#visualizacion-de-resultados"><i class="fa fa-check"></i><b>9.2.3</b> Visualización de resultados</a></li>
<li class="chapter" data-level="9.2.4" data-path="logit.html"><a href="logit.html#ajuste-de-los-modelos"><i class="fa fa-check"></i><b>9.2.4</b> Ajuste de los modelos</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="logit.html"><a href="logit.html#proximos-pasos"><i class="fa fa-check"></i><b>9.3</b> Próximos pasos</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="surv.html"><a href="surv.html"><i class="fa fa-check"></i><b>10</b> Modelos de supervivencia</a><ul>
<li class="chapter" data-level="10.1" data-path="surv.html"><a href="surv.html#nociones-basicas-1"><i class="fa fa-check"></i><b>10.1</b> Nociones básicas</a></li>
<li class="chapter" data-level="10.2" data-path="surv.html"><a href="surv.html#el-modelo-cox-de-riesgos-proporcionales"><i class="fa fa-check"></i><b>10.2</b> El modelo Cox de riesgos proporcionales</a></li>
<li class="chapter" data-level="10.3" data-path="surv.html"><a href="surv.html#aplicacion-en-r-2"><i class="fa fa-check"></i><b>10.3</b> Aplicación en R</a><ul>
<li class="chapter" data-level="10.3.1" data-path="surv.html"><a href="surv.html#replicar-la-tabla-1.2-de-altman-e-interpretar-sus-coeficientes-como-hazard-ratios."><i class="fa fa-check"></i><b>10.3.1</b> Replicar la tabla 1.2 de Altman e interpretar sus coeficientes como Hazard Ratios.</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Aplicaciones</b></span></li>
<li class="chapter" data-level="11" data-path="manejo-av.html"><a href="manejo-av.html"><i class="fa fa-check"></i><b>11</b> Manejo avanzado de datos políticos</a><ul>
<li class="chapter" data-level="11.1" data-path="manejo-av.html"><a href="manejo-av.html#introduccion-2"><i class="fa fa-check"></i><b>11.1</b> Introducción</a></li>
<li class="chapter" data-level="11.2" data-path="manejo-av.html"><a href="manejo-av.html#como-aprovechar-countrycode"><i class="fa fa-check"></i><b>11.2</b> ¿Cómo aprovechar ´countrycode´?</a></li>
<li class="chapter" data-level="11.3" data-path="manejo-av.html"><a href="manejo-av.html#como-imputar-datos"><i class="fa fa-check"></i><b>11.3</b> ¿Cómo imputar datos?</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="pca.html"><a href="pca.html"><i class="fa fa-check"></i><b>12</b> Creación de índices con Análisis de Componentes Principales (PCA)</a><ul>
<li class="chapter" data-level="12.1" data-path="pca.html"><a href="pca.html#conceptos-importantes"><i class="fa fa-check"></i><b>12.1</b> Conceptos importantes</a></li>
<li class="chapter" data-level="12.2" data-path="pca.html"><a href="pca.html#aplicacion-en-r-3"><i class="fa fa-check"></i><b>12.2</b> Aplicación en R</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="web-mining.html"><a href="web-mining.html"><i class="fa fa-check"></i><b>13</b> Mínería de datos</a></li>
<li class="chapter" data-level="14" data-path="redes.html"><a href="redes.html"><i class="fa fa-check"></i><b>14</b> Análisis de redes</a><ul>
<li class="chapter" data-level="14.1" data-path="redes.html"><a href="redes.html#introduccion-3"><i class="fa fa-check"></i><b>14.1</b> Introducción</a></li>
<li class="chapter" data-level="14.2" data-path="redes.html"><a href="redes.html#conceptos-basicos-de-redes"><i class="fa fa-check"></i><b>14.2</b> Conceptos básicos de redes</a><ul>
<li class="chapter" data-level="14.2.1" data-path="redes.html"><a href="redes.html#nodos-y-enlaces"><i class="fa fa-check"></i><b>14.2.1</b> Nodos y enlaces</a></li>
<li class="chapter" data-level="14.2.2" data-path="redes.html"><a href="redes.html#matriz-de-adyacencia"><i class="fa fa-check"></i><b>14.2.2</b> Matriz de adyacencia</a></li>
<li class="chapter" data-level="14.2.3" data-path="redes.html"><a href="redes.html#pesos-y-direccion"><i class="fa fa-check"></i><b>14.2.3</b> Pesos y dirección</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="redes.html"><a href="redes.html#generar-una-base-de-datos-de-redes"><i class="fa fa-check"></i><b>14.3</b> Generar una base de datos de redes</a></li>
<li class="chapter" data-level="14.4" data-path="redes.html"><a href="redes.html#disposicion-de-los-puntos-en-el-espacio"><i class="fa fa-check"></i><b>14.4</b> Disposición de los puntos en el espacio</a></li>
<li class="chapter" data-level="14.5" data-path="redes.html"><a href="redes.html#calcular-medidas-de-centralidad-basicas"><i class="fa fa-check"></i><b>14.5</b> Calcular medidas de centralidad básicas</a></li>
<li class="chapter" data-level="14.6" data-path="redes.html"><a href="redes.html#detectar-comunidades-en-las-redes"><i class="fa fa-check"></i><b>14.6</b> Detectar comunidades en las redes</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="qta.html"><a href="qta.html"><i class="fa fa-check"></i><b>15</b> Análisis cuantitativo de textos</a><ul>
<li class="chapter" data-level="15.1" data-path="qta.html"><a href="qta.html#introduccion-4"><i class="fa fa-check"></i><b>15.1</b> Introducción</a></li>
<li class="chapter" data-level="15.2" data-path="qta.html"><a href="qta.html#bases-de-datos"><i class="fa fa-check"></i><b>15.2</b> Bases de datos</a></li>
<li class="chapter" data-level="15.3" data-path="qta.html"><a href="qta.html#calculo-de-frecuencias"><i class="fa fa-check"></i><b>15.3</b> Cálculo de frecuencias</a><ul>
<li class="chapter" data-level="15.3.1" data-path="qta.html"><a href="qta.html#hashtags-mas-usados-de-las-cuentas-de-los-diputados"><i class="fa fa-check"></i><b>15.3.1</b> 10 hashtags mas usados de las cuentas de los diputados</a></li>
<li class="chapter" data-level="15.3.2" data-path="qta.html"><a href="qta.html#frecuencias-por-genero-cantidad-de-hashtags-usados-por-los-diputados-en-total"><i class="fa fa-check"></i><b>15.3.2</b> Frecuencias por género: cantidad de hashtags usados por los diputados en total</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="qta.html"><a href="qta.html#wordcloud-de-hashtags"><i class="fa fa-check"></i><b>15.4</b> Wordcloud de hashtags</a></li>
<li class="chapter" data-level="15.5" data-path="qta.html"><a href="qta.html#hashtags-mas-usados-por-genero"><i class="fa fa-check"></i><b>15.5</b> Hashtags más usados por género</a><ul>
<li class="chapter" data-level="15.5.1" data-path="qta.html"><a href="qta.html#entre-las-diputadas"><i class="fa fa-check"></i><b>15.5.1</b> Entre las diputadas</a></li>
<li class="chapter" data-level="15.5.2" data-path="qta.html"><a href="qta.html#entre-las-diputadas-1"><i class="fa fa-check"></i><b>15.5.2</b> Entre las diputadas</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="qta.html"><a href="qta.html#hashtags-de-genero-por-caracteristicas-del-diputado"><i class="fa fa-check"></i><b>15.6</b> Hashtags de género por características del diputado</a><ul>
<li class="chapter" data-level="15.6.1" data-path="qta.html"><a href="qta.html#por-el-genero-del-diputado"><i class="fa fa-check"></i><b>15.6.1</b> Por el género del diputado</a></li>
<li class="chapter" data-level="15.6.2" data-path="qta.html"><a href="qta.html#por-la-coalicion-de-los-diputados"><i class="fa fa-check"></i><b>15.6.2</b> Por la coalición de los diputados</a></li>
</ul></li>
<li class="chapter" data-level="15.7" data-path="qta.html"><a href="qta.html#variacion-temporal-del-uso-de-estos-hashtags"><i class="fa fa-check"></i><b>15.7</b> Variación temporal del uso de estos hashtags</a><ul>
<li class="chapter" data-level="15.7.1" data-path="qta.html"><a href="qta.html#frecuencia-semanal-de-olafeminista"><i class="fa fa-check"></i><b>15.7.1</b> Frecuencia semanal de #olafeminista</a></li>
<li class="chapter" data-level="15.7.2" data-path="qta.html"><a href="qta.html#frecuencia-semanal-de-tres-hashtags-de-genero"><i class="fa fa-check"></i><b>15.7.2</b> Frecuencia semanal de tres hashtags de género</a></li>
<li class="chapter" data-level="15.7.3" data-path="qta.html"><a href="qta.html#grafiquemos-los-hashtags-de-genero-por-semana"><i class="fa fa-check"></i><b>15.7.3</b> Grafiquemos los hashtags de género por semana</a></li>
<li class="chapter" data-level="15.7.4" data-path="qta.html"><a href="qta.html#ponderamos-en-relacion-al-total-de-hashtags-por-semana"><i class="fa fa-check"></i><b>15.7.4</b> Ponderamos en relación al total de hashtags por semana</a></li>
<li class="chapter" data-level="15.7.5" data-path="qta.html"><a href="qta.html#grafiquemos-los-hashtags-interesantes-ponderados-por-el-total-semanal"><i class="fa fa-check"></i><b>15.7.5</b> Grafiquemos los hashtags interesantes ponderados por el total semanal</a></li>
<li class="chapter" data-level="15.7.6" data-path="qta.html"><a href="qta.html#diputadas"><i class="fa fa-check"></i><b>15.7.6</b> Diputadas</a></li>
</ul></li>
<li class="chapter" data-level="15.8" data-path="qta.html"><a href="qta.html#hashtags-de-genero-por-semana-a-nivel-de-diputados-ponderados-por-semana"><i class="fa fa-check"></i><b>15.8</b> Hashtags de género por semana a nivel de diputados (ponderados por semana)</a></li>
<li class="chapter" data-level="15.9" data-path="qta.html"><a href="qta.html#comentarios-finales"><i class="fa fa-check"></i><b>15.9</b> Comentarios finales</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="mapas.html"><a href="mapas.html"><i class="fa fa-check"></i><b>16</b> Generación de mapas</a><ul>
<li class="chapter" data-level="16.1" data-path="mapas.html"><a href="mapas.html#datos-espaciales"><i class="fa fa-check"></i><b>16.1</b> Datos Espaciales</a><ul>
<li class="chapter" data-level="16.1.1" data-path="mapas.html"><a href="mapas.html#que-son"><i class="fa fa-check"></i><b>16.1.1</b> ¿Qué son?</a></li>
<li class="chapter" data-level="16.1.2" data-path="mapas.html"><a href="mapas.html#estructura-de-los-datos-espaciales"><i class="fa fa-check"></i><b>16.1.2</b> Estructura de los Datos Espaciales</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="mapas.html"><a href="mapas.html#datos-espaciales-en-r"><i class="fa fa-check"></i><b>16.2</b> Datos Espaciales en R</a></li>
<li class="chapter" data-level="16.3" data-path="mapas.html"><a href="mapas.html#special-features-en-r"><i class="fa fa-check"></i><b>16.3</b> Special Features en R</a><ul>
<li class="chapter" data-level="16.3.1" data-path="mapas.html"><a href="mapas.html#estructura"><i class="fa fa-check"></i><b>16.3.1</b> Estructura</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="mapas.html"><a href="mapas.html#manejo-de-datos-espaciales"><i class="fa fa-check"></i><b>16.4</b> Manejo de Datos Espaciales</a><ul>
<li class="chapter" data-level="16.4.1" data-path="mapas.html"><a href="mapas.html#modificaciones"><i class="fa fa-check"></i><b>16.4.1</b> Modificaciones</a></li>
<li class="chapter" data-level="16.4.2" data-path="mapas.html"><a href="mapas.html#crear-nuevos-shapefiles-con-st_write"><i class="fa fa-check"></i><b>16.4.2</b> .4 Crear nuevos shapefiles con <code>st_write</code></a></li>
<li class="chapter" data-level="16.4.3" data-path="mapas.html"><a href="mapas.html#incorporar-datos-de-otras-bases-con-merge"><i class="fa fa-check"></i><b>16.4.3</b> Incorporar datos de otras bases con <code>merge</code></a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="mapas.html"><a href="mapas.html#mapear-en-r"><i class="fa fa-check"></i><b>16.5</b> Mapear en R</a></li>
<li class="chapter" data-level="16.6" data-path="mapas.html"><a href="mapas.html#mapeando-variables"><i class="fa fa-check"></i><b>16.6</b> Mapeando variables</a><ul>
<li class="chapter" data-level="16.6.1" data-path="mapas.html"><a href="mapas.html#mapas-animados-con-gganimate"><i class="fa fa-check"></i><b>16.6.1</b> Mapas animados con gganimate</a></li>
</ul></li>
<li class="chapter" data-level="16.7" data-path="mapas.html"><a href="mapas.html#inferencia-a-partir-de-datos-espaciales"><i class="fa fa-check"></i><b>16.7</b> Inferencia a partir de Datos Espaciales</a><ul>
<li class="chapter" data-level="16.7.1" data-path="mapas.html"><a href="mapas.html#indicadores-locales-de-asociacion-espacial-lisa"><i class="fa fa-check"></i><b>16.7.1</b> Indicadores locales de asociación espacial (LISA)</a></li>
<li class="chapter" data-level="16.7.2" data-path="mapas.html"><a href="mapas.html#matriz-de-pesos-espaciales"><i class="fa fa-check"></i><b>16.7.2</b> Matriz de Pesos Espaciales</a></li>
<li class="chapter" data-level="16.7.3" data-path="mapas.html"><a href="mapas.html#morans-i"><i class="fa fa-check"></i><b>16.7.3</b> Moran’s I</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">AnalizaR datos políticos</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="surv" class="section level1">
<h1><span class="header-section-number">Capítulo 10</span> Modelos de supervivencia</h1>
<hr />
<p><strong>Lecturas de referencia</strong></p>
<ul>
<li><p>Box-Steffensmeier, J. M. &amp; Jones, B. S. (2004). <em>Event history modeling: A guide for social scientists</em>. Cambridge: Cambridge University Press.</p></li>
<li><p>Box-Steffensmeier, J. M., &amp; Jones, B. S. (1997). Time is of the essence: Event history models in political science. <em>American Journal of Political Science</em>, 41(4), 1414-1461.</p></li>
<li><p>Allison, P. D. (2014). <em>Event history and survival analysis: Regression for longitudinal event data</em> (2nd edition). Thousand Oaks, CA: SAGE publications.</p></li>
<li><p>Box-Steffensmeier, J. M., Brady, H. E., &amp; Collier, D. (Eds.). (2008). <em>The Oxford handbook of political methodology</em> (Vol. 10). Oxford: Oxford University Press.</p></li>
</ul>
<hr />
<p>Hay una serie de preguntas recurrentes al análisis de datos políticos que aún no hemos cubierto. Muchas veces nos interesa saber por qué ciertos eventos duran lo que duran, o porqué tardan más que otros en ocurrir ¿Por qué la paz es tan duradera entre algunos países mientras que otros guerrean con frecuencia? ¿Cuál era la probabilidad de que Turquía ingresara a la Unión Europea en 2018? ¿Por qué algunos legisladores permanecen en sus cargos por varios periodos consecutivos mientras que otros no logran reelegirse tan solo una vez? ¿Cuánto demora un sindicato en entrar en huelga durante una crisis económica?</p>
<div id="nociones-basicas-1" class="section level2">
<h2><span class="header-section-number">10.1</span> Nociones básicas</h2>
<p>Todas estas preguntas son sobre la duración de un evento. El momento de ocurrencia de un evento es parte de la respuesta que buscamos, necesitamos de un modelo que nos permita llegar a esta respuesta. Janet Box-Steffensmeier, una de las principales referencias en Ciencia Política de este método, se refiere a ellos como “modelos de eventos históricos” aunque buena parte de la literatura los llama modelos de supervivencia o modelos de duración. Si bien en la Ciencia Política no son modelos tan utilizados como uno creería (en el fondo, casi todas las preguntas que nos hacemos pueden ser reformuladas en una pregunta sobre la duración del evento), las ciencias médicas han explorado estos métodos en profundidad, y muchas las referencias que uno encuentra en R sobre paquetes accesorios a estos modelos son de departamentos bioestadísticos y médicos. De allí que “modelos de supervivencia” sea el nombre más frecuentemente utilizado para estos modelos, ya que en medicina comenzó a utilizárselos para modelar qué variables afectaban la sobrevida de sus pacientes enfermos.</p>
<p>Podemos tener dos tipos de bases de datos para estos problemas. Por un lado podemos tener una base en formato de panel en el que para un momento dado nuestra variable dependiente codifica si el evento ha ocurrido (<span class="math inline">\(=1\)</span>) o no (<span class="math inline">\(=0\)</span>). Así, por ejemplo, podemos tener una muestra de veinte países para cincuenta años (1965-2015) en los que nuestra variable de interés es si el país ha implementado una reforma constitucional. La variable independiente asumirá el valor 1 para el año 1994 en Argentina, pero será 0 para el resto de los años en este país. Por otro lado, podemos tener una base de datos transversal en la que cada observación aparece codificada apenas una vez. En este caso necesitamos, además de la variable que nos dirá si en el periodo de interés el evento ocurrió o no para cada observación (por ejemplo, Argentina debería ser codificada como “1”), una variable extra que codifique el tiempo de “supervivencia” de cada observación, es decir, cuánto tiempo pasó hasta que finalmente el evento sucedió. Para el caso de Argentina, esta variable codificará 29 (años), que es lo que demoró en implementarse una reforma constitucional desde 1965. La elección del año de partida, como podrá sospechar, es decisión del investigador, pero tiene un efecto enorme sobre nuestros resultados. Además, muchas veces la fecha de inicio acaba determinada por la disponibilidad de datos y se alejan del ideal que quisieramos modelar.</p>
<p>Supongamos que nos hacemos la pregunta que se hizo <a href="https://www.cambridge.org/core/books/citizenship-and-contemporary-direct-democracy/5F2081B8D1FD8AE7C7B9D784D272ED33">David Altman</a>: “¿Por qué algunos países demoran menos que otros en implementar instancias de democracia directa?”. Para ello tenemos una base de datos en formato de panel que parte del año 1900 y que llega a 2016 para 202 países (algunas observaciones, como la Unión Soviética se transforman en otras observaciones a partir de un determinado año en que dejan de existir). Al observar sus datos uno nota algo que probablemente también te suceda en tu base de datos. Para el año 2016 apenas un pequeño porcentaje de países había implementado este tipo de mecanismos (27% para ser más precisos) pero la base está censurada ya que a partir de ese año no sabemos que ha ocurrido con los países que aún no han implementado mecanismos de democracia directa. No todas las observaciones han “muerto” aún, ¿cómo saber cuándo lo harán? Ésta es una pregunta válida, que podremos responder con este tipo de modelos, ya que podemos calcular el tiempo que demorará cada uno de los países censurados en nuestra muestra (con la información que le damos al modelo, que siempre es incompleta).</p>
<p>En nuestra base de datos tendremos, al menos, cuatro tipos de observaciones (ver figura 1): (a) aquellas que, para el momento en que tenemos datos ya estaban en la muestra, aunque no siempre sabremos hace cuanto que “existen”. Son, en la figura, las observaciones B y C. En la base de datos de Altman, por ejemplo, México ya existía como entidad política en 1900, cuando su base de datos parte (sabemos que la Primera República Federal existió como entidad política desde octubre de 1824, por lo que México sería codificado como existente a partir de esa fecha). También sabemos que en 2012, por primera vez, México implementó una iniciativa de democracia directa, lo que define como positiva la ocurrencia del evento que nos interesa medir. Así, México sería como la observación B de la figura; (b) Algunas observaciones estarán desde el comienzo de la muestra, y existirán hasta el último momento sin haber registrado el evento de interés. Tal es el caso, de la observación C en la figura. En la muestra de Altman un ejemplo sería Argentina, que desde 1900 está registrado en la base (ya había “nacido”), y hasta el último año de la muestra no había registrado instancias de democracia directa (no “murió”), lo que la transforma en una observación censurada. A los fines prácticos no cambia saber qué ocurrió a partir del año en que nuestra base termina. Por ejemplo, en la figura, nuestra base cubre hast <span class="math inline">\(t_7\)</span>, y sabemos que en <span class="math inline">\(t_8\)</span> la observación C aún no había muerto, y la observación D lo había hecho en <span class="math inline">\(t_8\)</span>. En nuestra base, C y D serán ambas observaciones censuradas en <span class="math inline">\(t_7\)</span>; (c) Algunas observaciones pueden entrar “tarde” en la muestra, como es el caso de las observaciones A y D. Por ejemplo, Eslovenia entra a la muestra de Altman en 1991, que es cuando se independiza de Yugoslavia y “nace” como país; (d) Algunas observaciones, independientemente de cuando entren a la muestra, “moriran” durante el periodo analizado. Por ejemplo, A y B mueren dentro del periodo que hemos medido entrte <span class="math inline">\(t_1\)</span> y <span class="math inline">\(t_7\)</span>. Ya para la observación D, no registramos su muerte. Hay un caso no considerado en el ejemplo, de observaciones que nacen y mueren sucesivamente a lo largo del periodo de estudio. Para ellas, deberemos decidir si las tratamos como observaciones independientes, o si modelamos la posibilidad de morir más de una vez. Si es así, la probabilidad de morir por segunda vez deberá estar condicionada por la probabilidad de haber muerto (y cuando!) por primera vez. Este es un tipo de caso algo más complejo que no cubriremos en este caoítulo.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-3"></span>
<img src="00-images/surv_fig_10_1.PNG" alt="Ejemplos de observaciones presentes en una base de datos de supervivencia."  />
<p class="caption">
Figura 10.1: Ejemplos de observaciones presentes en una base de datos de supervivencia.
</p>
</div>
<p>Los modelos de supervivencia se interpretan a partir de la probabilidad de que en un momento dado el evento de interés ocurra siendo que que no ha ocurrido aun. Esta probabilidad recibe el nombre de tasa de riesgo. Partimos sabiendo que tenemos una variable, que llamaremos <span class="math inline">\(T\)</span>, y que representa un valor aleatorio positivo y que tiene una distribución de probabilidades (correspondiente a la probabilidad del evento ocurrir en cada uno de los momentos posibles) que llamaremos <span class="math inline">\(f(t)\)</span>. Esta probabilidad se puede expresar de manera acumulada, como una densidad acumulada <span class="math inline">\(F(t)\)</span>. Com, en la que vemos que <span class="math inline">\(F(t)\)</span> viene dada por la probabilidad de que el tiempo de supervivencia <span class="math inline">\(T\)</span> sea menor o igual a un tiempo específico <span class="math inline">\(t\)</span> :</p>
<p><span class="math display">\[F(t)=\int\limits_0^t f(u)d(u)=Pr(T)\leq t)\]</span></p>
<p>La función de supervivencia <span class="math inline">\(\hat S(t)\)</span>, que es un concepto clave en estos modelos, está relacionada a <span class="math inline">\(F(t)\)</span>, ya que</p>
<p><span class="math display">\[\hat S(t)= 1-F(t)=Pr(T\geq t)\]</span></p>
<p>Es decir, la función de supervivencia es la probabilidad inversa de <span class="math inline">\(F(t)\)</span>, pues dice respecto a la probabilidad de que el tiempo de supervivencia <span class="math inline">\(T\)</span> sea mayor o igual un tiempo <span class="math inline">\(t\)</span> de interés. Para el ejemplo concreto de Altman, uno podría preguntarse cuál es la probabilidad de que un país no implemente un mecanismo de democracia directa (lo que sería equivalente a “sobrevivir” a dicha implementación) siendo que ya ha sobrevivido a los mismos por 30 años. A medida que más y más países en la muestra van implementando iniciativas de democracia directa, la probabilidad de supervivencia va disminuyendo.</p>
<p>Los coeficientes de los modelos de supervivencia se suelen interpretar como tasas de riesgo (o “hazard rates” en inglés), que es el cociente de la probabilidad de que el evento suceda y la función de supervivencia</p>
<p><span class="math display">\[h(t)=\frac{f(t)}{S(t)}\]</span></p>
<p>Así, la tasa de riesgo indica la tasa a la que las observaciones “mueren” en nuestra muestra en el momento <span class="math inline">\(t\)</span>, considerando que la observación ha sobrevivido hasta el momento <span class="math inline">\(t\)</span>. Veremos más adelante como en el ejemplo de Altman podemos interpretar los coeficientes de nuestras regresiones como tasas de riesgo. En definitiva, la tasa de riesgo <span class="math inline">\(h(t)\)</span> es el riesgo de que el evento ocurra en un intervalo de tiempo determinado, que viene dado por</p>
<p><span class="math display">\[f(t)=\lim_{\bigtriangleup x \to 0} \frac {P(t+\bigtriangleup t &gt; T \geq t)}{\bigtriangleup t}\]</span></p>
</div>
<div id="el-modelo-cox-de-riesgos-proporcionales" class="section level2">
<h2><span class="header-section-number">10.2</span> El modelo Cox de riesgos proporcionales</h2>
<p>Hay dos tipos de modelos de supervivencia, los llamados modelos paramétricos y los llamados semi-parametricos. Los primeros son aquellos que hacen supuestos sobre las características de la población a la que la muestra pertenece. En este caso, los supuestos son sobre el “baseline hazard”, es decir, sobre el riesgo de que el evento ocurra cuando todas nuestras variables independientes son iguales a cero. El tipo de modelo de surpervivencia más común para esta categoría es el modelo de Weibull. Por otro lado, los modelos semi-parametricos no hacen ningún tipo de supuestos sobre la función de base, ya que ésta es estimada a partir de los datos. El ejemplo más famoso de ésta especificación es la del modelo de Cox.</p>
<p>El <em>Oxford Handbook</em> sobre metodología política dedica un capítulo entero a discutir modelos de supervivencia, y en el se toma una posición fuerte en favor de los modelos semi-parametricos. Aquí seguiremos dicha recomendación ya que las ventajas son varias. Por un lado, como no se hacen presupustos sobre la función del riesgo de base, su estimación es mucho más precisa. En una estimación paramétrica, elegir un “baseline hazard” equivocado siginificará que todo nuestro trabajo analítico estará sesgado. La decisión de la forma que adopta la curva de base en un modelo de Weibull debería estar orientado por razones teóricas de cuál es el efecto de nuestra variable independiente sobre la probabilidad de supervivencia de la observación (ver figura 2). Sin embargo, no siempre hay tales presupuestos. Elegir una especificación por Cox nos ahorra de tomar una decisión tan costosa.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-4"></span>
<img src="00-images/surv_fig_10_2.png" alt="Diferentes riesgos de base en el modelo de Weibull" width="423" />
<p class="caption">
Figura 10.2: Diferentes riesgos de base en el modelo de Weibull
</p>
</div>
<p>Una segunda ventaja de los modelos semi-parametricos sobre los paramétricos tiene que ver con el presupuesto de riesgos proporcionales. Ambos, modelos paramétricos y semi-parametricos, asumen que los riesgos entre dos individuos cualquiera de la muestra se mantienen constantes a lo largo de todo su periodo de supervivencia. Es decir, se asume que la curva de riesgo de cada individuo sigue la misma curva en el tiempo. Este es un presupuesto fuerte para trabajos en ciencia política, ya que las observaciones cambian en el tiempo y se diferencian unas de otras. Piénsense en el trabajo de Altman, por ejemplo. Uno puede teorizar que la probabilidad de una iniciativa de democracia directa en un determinado año en un determinado país estará afectada por el nivel de solidez de las instituciones democráticas, que podemos medir con algún tipo de variable estándar como los 21 puntos de Polity IV o la más reciente medición de V-Dem. Podemos, entonces, teorizar que a mayor solidez institucional mayor probabilidad de implementar mecanismos de democracia directa.</p>
<p>Sin embargo, los valores de estas variables no solo difieren ente países, sino que a lo largo del tiempo estas variables cambian mucho para un mismo país. Piénsese en Colombia, por ejemplo, en que la variable de V-Dem “v2x_polyarchy” sufrió avances y retrocesos entre 1900 y 2016 (ver figura 3). Cada vez que el valor de esta variable cambia, necesariamente cambia la tasa de riesgo de democracia directa para Colombia, rompiendo el presupuesto de proporcionalidad de los riesgos.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-5"></span>
<img src="00-images/surv_fig_10_3.png" alt="Valores de poliarquía para Colombia según V-Dem" width="600" />
<p class="caption">
Figura 10.3: Valores de poliarquía para Colombia según V-Dem
</p>
</div>
<p>La ventaja del modelo de Cox sobre sus contrapartes paramétricas es que existen tests para saber si alguna variable de nuestro modelo rompe el presupuesto de proporcionalidad de los riesgos, y de esa forma podremos corregirlo generando interacciones entre estas variables y variables temporales. De esta forma, permitimos que en nuestro modelo haya dos tipos de coeficientes: coeficientes constantes en el tiempo, y coeficientes cambiantes en el tiempo. Por ejemplo, podemos imaginar que ante un aumento brusco en la calidad de las instituciones democráticas de un país la tasa de riesgo de implementar democracia directa se dispare, pero que dicho efecto de desvanezca en el lapso de cuatro o cinco años. Cuando definas tu modelo, es importante que reflexiones sobre qué variables puede asumirse que permanezcan constantes en los riesgos y cuales no.</p>
<p>La recomendación dada por el <em>Oxford Handbook</em> para una buena implementación de modelos de supervivencia es la siguiente: (a) Primero, dada las ventajas de los modelos semi-paramétricos sobre los paramétricos, se recomienda el uso de Cox por sobre Weibull u otro modelo paramétrico. (b) Una vez que hemos definido nuestra variable dependiente (el evento), el tiempo de “nacimiento” y de “muerte” de cada observación, podemos especificar nuestro modelo. (c) Los coeficientes deben ser interpretados en tasas de riesgo (hazard rates), lo que exige exponenciar los coeficientes brutos que obtenemos en <code>R</code>. (d) Una vez que tenemos el modelo que creemos correcto, en función de nuestras intuiciones teóricas, es necesario testear que ninguno de los coeficientes viole el presupuesto de proporcionalidad de los riesgos. Para ello ejecutamos un test de Grambsch y Therneau, o mediante el análisis de los residuos de Schoenfeld. (e) Una vez identificados los coeficientes problemáticos, permitimos que estos interactúen con el logaritmo natural de la variable que mide la duración del evento. De esta forma, permitimos que haya coeficientes cuyo efecto se desvanece o se potencia con el tiempo. Una vez corregidos los coeficientes problemáticos, podemos si, proceder a interpretar nuestro modelo y la función de supervivencia del modelo.</p>
</div>
<div id="aplicacion-en-r-2" class="section level2">
<h2><span class="header-section-number">10.3</span> Aplicación en R</h2>
<p>Volvamos, entonces, a pregunta que se hizo David Altman en el capítulo 3 de <a href="https://www.cambridge.org/core/books/citizenship-and-contemporary-direct-democracy/5F2081B8D1FD8AE7C7B9D784D272ED33">Citizenship and Contemporary Direct Democracy (2019)</a>, “Catching on: waves of adoption of citizen-initiated mechanisms of direct democracy since World War I”: “¿Por qué algunos países demoran menos que otros en implementar instancias de democracia directa?”. Para poder responder a esta pregunta, uno debe correr modelos de supervivencia. Para cargar la base de datos vamos a usar la función <code>read_rds</code> de <code>tidyverse</code>:</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb183-1" data-line-number="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb183-2" data-line-number="2">datos_altman &lt;-<span class="st"> </span><span class="kw">read_rds</span>(<span class="st">&quot;00-datos/data_altman.rds&quot;</span>)</a></code></pre></div>
<p>A lo largo del ejemplo usaremos los paquetes <code>skimr</code>, <code>countrycode</code>, <code>survival</code>, <code>rms</code>, <code>survminer</code>, <code>ggalt</code>, <code>tidyverse</code>y <code>texreg</code>, pero los iremos cargando uno a uno para que veas para que sirven.
Si utilizamos <code>skim</code>, como ya hicimos en otros capítulos, podemos ver que es una base en formato de panel balanceado. Es decir, tenemos una variable “país” (<code>country_name</code>), que se repite a lo largo de una variable “año” (<code>year</code>).</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb184-1" data-line-number="1"><span class="kw">skim</span>(datos_altman)</a>
<a class="sourceLine" id="cb184-2" data-line-number="2"><span class="co">## Skim summary statistics</span></a>
<a class="sourceLine" id="cb184-3" data-line-number="3"><span class="co">##  n obs: 13885 </span></a>
<a class="sourceLine" id="cb184-4" data-line-number="4"><span class="co">##  n variables: 23 </span></a>
<a class="sourceLine" id="cb184-5" data-line-number="5"><span class="co">## </span></a>
<a class="sourceLine" id="cb184-6" data-line-number="6"><span class="co">## ── Variable type:character ────────────────────────────────────────────────────────────────────────</span></a>
<a class="sourceLine" id="cb184-7" data-line-number="7"><span class="co">##      variable missing complete     n min max empty n_unique</span></a>
<a class="sourceLine" id="cb184-8" data-line-number="8"><span class="co">##  country_name       0    13885 13885   4  32     0      202</span></a>
<a class="sourceLine" id="cb184-9" data-line-number="9"><span class="co">## </span></a>
<a class="sourceLine" id="cb184-10" data-line-number="10"><span class="co">## ── Variable type:numeric ──────────────────────────────────────────────────────────────────────────</span></a>
<a class="sourceLine" id="cb184-11" data-line-number="11"><span class="co">##              variable missing complete     n      mean    sd        p0</span></a>
<a class="sourceLine" id="cb184-12" data-line-number="12"><span class="co">##        p25     p50      p75    p100     hist</span></a>
<a class="sourceLine" id="cb184-13" data-line-number="13"><span class="co">##  [ reached getOption(&quot;max.print&quot;) -- omitted 22 rows ]</span></a></code></pre></div>
<p>Los países entran a la base cuando comienzan a existir como países independientes. Veamos el caso de Albania, por ejemplo, que nace como país en 1912 luego de las <a href="https://es.wikipedia.org/wiki/Guerras_de_los_Balcanes">Guerras los Balcanes</a>:</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb185-1" data-line-number="1">datos_altman <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb185-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(country_name <span class="op">==</span><span class="st"> &quot;Albania&quot;</span>)</a>
<a class="sourceLine" id="cb185-3" data-line-number="3"><span class="co">## # A tibble: 105 x 23</span></a>
<a class="sourceLine" id="cb185-4" data-line-number="4"><span class="co">##    country_name  year cic_dummy dem_positive dem_negative memory</span></a>
<a class="sourceLine" id="cb185-5" data-line-number="5"><span class="co">##    &lt;chr&gt;        &lt;dbl&gt;     &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;  &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb185-6" data-line-number="6"><span class="co">##  1 Albania       1912         0            0            0      0</span></a>
<a class="sourceLine" id="cb185-7" data-line-number="7"><span class="co">##  2 Albania       1913         0            0            0      0</span></a>
<a class="sourceLine" id="cb185-8" data-line-number="8"><span class="co">##  3 Albania       1914         0            0            0      0</span></a>
<a class="sourceLine" id="cb185-9" data-line-number="9"><span class="co">##  4 Albania       1915         0            0            0      0</span></a>
<a class="sourceLine" id="cb185-10" data-line-number="10"><span class="co">##  5 Albania       1916         0            0            0      0</span></a>
<a class="sourceLine" id="cb185-11" data-line-number="11"><span class="co">##  6 Albania       1917         0            0            0      0</span></a>
<a class="sourceLine" id="cb185-12" data-line-number="12"><span class="co">##  7 Albania       1918         0            0            0      0</span></a>
<a class="sourceLine" id="cb185-13" data-line-number="13"><span class="co">##  8 Albania       1919         0            0            0      0</span></a>
<a class="sourceLine" id="cb185-14" data-line-number="14"><span class="co">##  9 Albania       1920         0            0            0      0</span></a>
<a class="sourceLine" id="cb185-15" data-line-number="15"><span class="co">## 10 Albania       1921         0            0            0      0</span></a>
<a class="sourceLine" id="cb185-16" data-line-number="16"><span class="co">## # ... with 95 more rows, and 17 more variables: v2x_polyarchy &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb185-17" data-line-number="17"><span class="co">## #   capabilities_geo_ide &lt;dbl&gt;, occur_geo_ide &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb185-18" data-line-number="18"><span class="co">## #   c_pos_capabilities &lt;dbl&gt;, c_pos_occurrences &lt;dbl&gt;, c_pos_memory &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb185-19" data-line-number="19"><span class="co">## #   log_pop &lt;dbl&gt;, c_gbr &lt;dbl&gt;, c_fra &lt;dbl&gt;, c_ussr &lt;dbl&gt;, c_spa &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb185-20" data-line-number="20"><span class="co">## #   c_usa &lt;dbl&gt;, c_ned &lt;dbl&gt;, c_prt &lt;dbl&gt;, c_bel &lt;dbl&gt;, c_ahe &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb185-21" data-line-number="21"><span class="co">## #   c_ote &lt;dbl&gt;</span></a></code></pre></div>
<p>Para que los modelos funcionen correctamente en <code>R</code>, los países deberían salir del análisis (¡y de la base!) cuando “mueren”, en este caso cuando adoptan mecanismos de democracia directa. Albania, siguiendo el ejemplo, debería salir en 1998, y no perdurar en la base hasta 2016 como sucede ahora. Entonces crearemos una segunda versión de nuestra base de datos donde esto ya ha sido corregido. Si tu base de datos está en este formato desde el comienzo, entonces podrás saltarte este paso:</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb186-1" data-line-number="1">datos_altman_b &lt;-<span class="st"> </span>datos_altman <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb186-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(country_name) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb186-3" data-line-number="3"><span class="st">  </span><span class="co"># que la suma acumulada de la dummy sea como máximo 1</span></a>
<a class="sourceLine" id="cb186-4" data-line-number="4"><span class="st">  </span><span class="kw">filter</span>(<span class="kw">cumsum</span>(cic_dummy) <span class="op">&lt;=</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb186-5" data-line-number="5"><span class="st">  </span><span class="kw">ungroup</span>()</a></code></pre></div>
<p>Lo que estamos haciendo es filtrar de tal forma que al registrar el primer evento de interés (en este caso es la variable <code>cic_dummy</code>) el resto es dejado a un lado. Si comparamos el caso de Albania para la base original y para la base actual veremos la diferencia:</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb187-1" data-line-number="1">datos_altman <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb187-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(country_name <span class="op">==</span><span class="st"> &quot;Albania&quot;</span> <span class="op">&amp;</span><span class="st"> </span>cic_dummy <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb187-3" data-line-number="3"><span class="co">## # A tibble: 19 x 23</span></a>
<a class="sourceLine" id="cb187-4" data-line-number="4"><span class="co">##    country_name  year cic_dummy dem_positive dem_negative memory</span></a>
<a class="sourceLine" id="cb187-5" data-line-number="5"><span class="co">##    &lt;chr&gt;        &lt;dbl&gt;     &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;  &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb187-6" data-line-number="6"><span class="co">##  1 Albania       1998         1            0            0  1    </span></a>
<a class="sourceLine" id="cb187-7" data-line-number="7"><span class="co">##  2 Albania       1999         1            0            0  1    </span></a>
<a class="sourceLine" id="cb187-8" data-line-number="8"><span class="co">##  3 Albania       2000         1            0            0  1    </span></a>
<a class="sourceLine" id="cb187-9" data-line-number="9"><span class="co">##  4 Albania       2001         1            0            0  1    </span></a>
<a class="sourceLine" id="cb187-10" data-line-number="10"><span class="co">##  5 Albania       2002         1            0            0  0.94 </span></a>
<a class="sourceLine" id="cb187-11" data-line-number="11"><span class="co">##  6 Albania       2003         1            0            0  0.88 </span></a>
<a class="sourceLine" id="cb187-12" data-line-number="12"><span class="co">##  7 Albania       2004         1            0            0  0.82 </span></a>
<a class="sourceLine" id="cb187-13" data-line-number="13"><span class="co">##  8 Albania       2005         1            0            0  0.76 </span></a>
<a class="sourceLine" id="cb187-14" data-line-number="14"><span class="co">##  9 Albania       2006         1            0            0  0.7  </span></a>
<a class="sourceLine" id="cb187-15" data-line-number="15"><span class="co">## 10 Albania       2007         1            0            0  0.64 </span></a>
<a class="sourceLine" id="cb187-16" data-line-number="16"><span class="co">## 11 Albania       2008         1            0            0  0.580</span></a>
<a class="sourceLine" id="cb187-17" data-line-number="17"><span class="co">## 12 Albania       2009         1            0            0  0.52 </span></a>
<a class="sourceLine" id="cb187-18" data-line-number="18"><span class="co">## 13 Albania       2010         1            0            0  0.46 </span></a>
<a class="sourceLine" id="cb187-19" data-line-number="19"><span class="co">## 14 Albania       2011         1            0            0  0.4  </span></a>
<a class="sourceLine" id="cb187-20" data-line-number="20"><span class="co">## 15 Albania       2012         1            0            0  0.34 </span></a>
<a class="sourceLine" id="cb187-21" data-line-number="21"><span class="co">## 16 Albania       2013         1            0            0  0.28 </span></a>
<a class="sourceLine" id="cb187-22" data-line-number="22"><span class="co">## 17 Albania       2014         1            0            0  0.22 </span></a>
<a class="sourceLine" id="cb187-23" data-line-number="23"><span class="co">## 18 Albania       2015         1            0            0  0.16 </span></a>
<a class="sourceLine" id="cb187-24" data-line-number="24"><span class="co">## 19 Albania       2016         1            0            0  0.1  </span></a>
<a class="sourceLine" id="cb187-25" data-line-number="25"><span class="co">## # ... with 17 more variables: v2x_polyarchy &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb187-26" data-line-number="26"><span class="co">## #   capabilities_geo_ide &lt;dbl&gt;, occur_geo_ide &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb187-27" data-line-number="27"><span class="co">## #   c_pos_capabilities &lt;dbl&gt;, c_pos_occurrences &lt;dbl&gt;, c_pos_memory &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb187-28" data-line-number="28"><span class="co">## #   log_pop &lt;dbl&gt;, c_gbr &lt;dbl&gt;, c_fra &lt;dbl&gt;, c_ussr &lt;dbl&gt;, c_spa &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb187-29" data-line-number="29"><span class="co">## #   c_usa &lt;dbl&gt;, c_ned &lt;dbl&gt;, c_prt &lt;dbl&gt;, c_bel &lt;dbl&gt;, c_ahe &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb187-30" data-line-number="30"><span class="co">## #   c_ote &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb187-31" data-line-number="31"></a>
<a class="sourceLine" id="cb187-32" data-line-number="32">datos_altman_b <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb187-33" data-line-number="33"><span class="st">  </span><span class="kw">filter</span>(country_name <span class="op">==</span><span class="st"> &quot;Albania&quot;</span> <span class="op">&amp;</span><span class="st"> </span>cic_dummy <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb187-34" data-line-number="34"><span class="co">## # A tibble: 1 x 23</span></a>
<a class="sourceLine" id="cb187-35" data-line-number="35"><span class="co">##   country_name  year cic_dummy dem_positive dem_negative memory</span></a>
<a class="sourceLine" id="cb187-36" data-line-number="36"><span class="co">##   &lt;chr&gt;        &lt;dbl&gt;     &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;  &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb187-37" data-line-number="37"><span class="co">## 1 Albania       1998         1            0            0      1</span></a>
<a class="sourceLine" id="cb187-38" data-line-number="38"><span class="co">## # ... with 17 more variables: v2x_polyarchy &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb187-39" data-line-number="39"><span class="co">## #   capabilities_geo_ide &lt;dbl&gt;, occur_geo_ide &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb187-40" data-line-number="40"><span class="co">## #   c_pos_capabilities &lt;dbl&gt;, c_pos_occurrences &lt;dbl&gt;, c_pos_memory &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb187-41" data-line-number="41"><span class="co">## #   log_pop &lt;dbl&gt;, c_gbr &lt;dbl&gt;, c_fra &lt;dbl&gt;, c_ussr &lt;dbl&gt;, c_spa &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb187-42" data-line-number="42"><span class="co">## #   c_usa &lt;dbl&gt;, c_ned &lt;dbl&gt;, c_prt &lt;dbl&gt;, c_bel &lt;dbl&gt;, c_ahe &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb187-43" data-line-number="43"><span class="co">## #   c_ote &lt;dbl&gt;</span></a></code></pre></div>
<p>En resumen, ahora tenemos un panel desbalanceado, en el que los países entran a la base cuando comienzan a existir como tales y salen, o bien cuando adoptan mecanismos de democracia directa, o bien cuando la base termina en su extensión temporal (en 2016). De esta forma nuestra base se acerca mucho a la figura 1 con la que ejemplificamos los distintos tipos de observaciones. ¿Qué tal si probamos hacer algo similar a la figura 1 pero con los datos de David Altman? Este tipo de figuras se llaman gráficos de Gantt, y pueden recrearse con <code>ggplot2</code> aunque es justo decir que hay que seguir unos cuantos pasos, y puede ser algo dificil. Ojalá que con este ejemplo puedas recrearlo con tus propios datos porque una figura así es de mucha utlidad para el lector.</p>
<p>Primero debemos crear una base de datos que, para cada país, registre el año de entrada y el año de salida. También nos interesa por qué sale el país: ¿adopta democracia directa o la base termina? Vamos a crear un subonjunto que llamaremos <code>gantt_plot_df</code> donde nos quedamos solamente con tres variables de la base, que son el nombre del país <code>country_name</code>, el año <code>year</code>, y la variable dependiente <code>cic_dummy</code>. También quitaremos de la base aquellas observaciones que para el primer año de la base ya han “muerto”. Por ejemplo, Suiza había implementado mecanismos de democracia directa mucho antes que 1900, así que desde el primer año de la base hasta el último la variable dependiente será “1”:</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb188-1" data-line-number="1">gantt_plot_df &lt;-<span class="st"> </span>datos_altman_b <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb188-2" data-line-number="2"><span class="st">  </span><span class="co"># las variables que nos interesan</span></a>
<a class="sourceLine" id="cb188-3" data-line-number="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(country_name, year, cic_dummy) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb188-4" data-line-number="4"><span class="st">  </span><span class="kw">group_by</span>(country_name) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb188-5" data-line-number="5"><span class="st">  </span><span class="kw">filter</span>(year <span class="op">==</span><span class="st"> </span><span class="kw">min</span>(year) <span class="op">|</span><span class="st"> </span>year <span class="op">==</span><span class="st"> </span><span class="kw">max</span>(year)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb188-6" data-line-number="6"><span class="st">  </span><span class="co"># debemos sacar las observaciones para países que &quot;nacen&quot; (para nuestra base) con democracia directa:</span></a>
<a class="sourceLine" id="cb188-7" data-line-number="7"><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span>(year <span class="op">==</span><span class="st"> </span><span class="kw">min</span>(year) <span class="op">&amp;</span><span class="st"> </span>cic_dummy <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb188-8" data-line-number="8"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">year_enters =</span> <span class="kw">min</span>(year),</a>
<a class="sourceLine" id="cb188-9" data-line-number="9">            <span class="dt">year_exits  =</span> <span class="kw">max</span>(year),</a>
<a class="sourceLine" id="cb188-10" data-line-number="10">            <span class="dt">exits_bc_dd =</span> <span class="kw">max</span>(cic_dummy)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb188-11" data-line-number="11"><span class="st">  </span><span class="kw">ungroup</span>()</a>
<a class="sourceLine" id="cb188-12" data-line-number="12">gantt_plot_df</a>
<a class="sourceLine" id="cb188-13" data-line-number="13"><span class="co">## # A tibble: 194 x 4</span></a>
<a class="sourceLine" id="cb188-14" data-line-number="14"><span class="co">##    country_name        year_enters year_exits exits_bc_dd</span></a>
<a class="sourceLine" id="cb188-15" data-line-number="15"><span class="co">##    &lt;chr&gt;                     &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb188-16" data-line-number="16"><span class="co">##  1 Afghanistan                1919       2016           0</span></a>
<a class="sourceLine" id="cb188-17" data-line-number="17"><span class="co">##  2 Albania                    1912       1998           1</span></a>
<a class="sourceLine" id="cb188-18" data-line-number="18"><span class="co">##  3 Algeria                    1962       2016           0</span></a>
<a class="sourceLine" id="cb188-19" data-line-number="19"><span class="co">##  4 Andorra                    1900       2016           0</span></a>
<a class="sourceLine" id="cb188-20" data-line-number="20"><span class="co">##  5 Angola                     1975       2016           0</span></a>
<a class="sourceLine" id="cb188-21" data-line-number="21"><span class="co">##  6 Antigua and Barbuda        1981       2016           0</span></a>
<a class="sourceLine" id="cb188-22" data-line-number="22"><span class="co">##  7 Argentina                  1900       2016           0</span></a>
<a class="sourceLine" id="cb188-23" data-line-number="23"><span class="co">##  8 Armenia                    1991       2016           0</span></a>
<a class="sourceLine" id="cb188-24" data-line-number="24"><span class="co">##  9 Australia                  1901       2016           0</span></a>
<a class="sourceLine" id="cb188-25" data-line-number="25"><span class="co">## 10 Austria                    1918       2016           0</span></a>
<a class="sourceLine" id="cb188-26" data-line-number="26"><span class="co">## # ... with 184 more rows</span></a></code></pre></div>
<p>Los países que salen por democracia directa (“mueren”) son:</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb189-1" data-line-number="1">gantt_plot_df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(exits_bc_dd <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb189-2" data-line-number="2"><span class="co">## # A tibble: 49 x 4</span></a>
<a class="sourceLine" id="cb189-3" data-line-number="3"><span class="co">##    country_name year_enters year_exits exits_bc_dd</span></a>
<a class="sourceLine" id="cb189-4" data-line-number="4"><span class="co">##    &lt;chr&gt;              &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb189-5" data-line-number="5"><span class="co">##  1 Albania             1912       1998           1</span></a>
<a class="sourceLine" id="cb189-6" data-line-number="6"><span class="co">##  2 Belarus             1991       1995           1</span></a>
<a class="sourceLine" id="cb189-7" data-line-number="7"><span class="co">##  3 Belize              1981       2008           1</span></a>
<a class="sourceLine" id="cb189-8" data-line-number="8"><span class="co">##  4 Bolivia             1900       2004           1</span></a>
<a class="sourceLine" id="cb189-9" data-line-number="9"><span class="co">##  5 Bulgaria            1908       2009           1</span></a>
<a class="sourceLine" id="cb189-10" data-line-number="10"><span class="co">##  6 Cape Verde          1975       1992           1</span></a>
<a class="sourceLine" id="cb189-11" data-line-number="11"><span class="co">##  7 Colombia            1900       1991           1</span></a>
<a class="sourceLine" id="cb189-12" data-line-number="12"><span class="co">##  8 Costa Rica          1900       2002           1</span></a>
<a class="sourceLine" id="cb189-13" data-line-number="13"><span class="co">##  9 Croatia             1992       2001           1</span></a>
<a class="sourceLine" id="cb189-14" data-line-number="14"><span class="co">## 10 Ecuador             1900       1998           1</span></a>
<a class="sourceLine" id="cb189-15" data-line-number="15"><span class="co">## # ... with 39 more rows</span></a></code></pre></div>
<p>Podemos identificar en una nueva variable la región geopolítica de cada país, gracias a la función <code>countrycode::countrycode()</code> (VER CAP X). Este paquete es de gran utilidad para quienes hacen política comparada o relaciones internacionales porque facilita mucho darle códigos a los países. Lo que nos permite el paquete es asignar a cada país su región de pertenencia de manera casi automática:</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb190-1" data-line-number="1"><span class="kw">library</span>(countrycode)</a>
<a class="sourceLine" id="cb190-2" data-line-number="2">gantt_plot_df_region &lt;-<span class="st"> </span>gantt_plot_df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb190-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">region =</span> <span class="kw">countrycode</span>(country_name, <span class="dt">origin =</span> <span class="st">&quot;country.name&quot;</span>, <span class="dt">dest =</span> <span class="st">&quot;region&quot;</span>))</a>
<a class="sourceLine" id="cb190-4" data-line-number="4"><span class="co">## Warning in countrycode(country_name, origin = &quot;country.name&quot;, dest = &quot;region&quot;): Some values were not matched unambiguously: Kosovo, South Yemen, Vietnam, Democratic Republic of, Vietnam, Republic of</span></a>
<a class="sourceLine" id="cb190-5" data-line-number="5"></a>
<a class="sourceLine" id="cb190-6" data-line-number="6">gantt_plot_df_region</a>
<a class="sourceLine" id="cb190-7" data-line-number="7"><span class="co">## # A tibble: 194 x 5</span></a>
<a class="sourceLine" id="cb190-8" data-line-number="8"><span class="co">##    country_name      year_enters year_exits exits_bc_dd region             </span></a>
<a class="sourceLine" id="cb190-9" data-line-number="9"><span class="co">##    &lt;chr&gt;                   &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;              </span></a>
<a class="sourceLine" id="cb190-10" data-line-number="10"><span class="co">##  1 Afghanistan              1919       2016           0 Southern Asia      </span></a>
<a class="sourceLine" id="cb190-11" data-line-number="11"><span class="co">##  2 Albania                  1912       1998           1 Southern Europe    </span></a>
<a class="sourceLine" id="cb190-12" data-line-number="12"><span class="co">##  3 Algeria                  1962       2016           0 Northern Africa    </span></a>
<a class="sourceLine" id="cb190-13" data-line-number="13"><span class="co">##  4 Andorra                  1900       2016           0 Southern Europe    </span></a>
<a class="sourceLine" id="cb190-14" data-line-number="14"><span class="co">##  5 Angola                   1975       2016           0 Middle Africa      </span></a>
<a class="sourceLine" id="cb190-15" data-line-number="15"><span class="co">##  6 Antigua and Barb…        1981       2016           0 Caribbean          </span></a>
<a class="sourceLine" id="cb190-16" data-line-number="16"><span class="co">##  7 Argentina                1900       2016           0 South America      </span></a>
<a class="sourceLine" id="cb190-17" data-line-number="17"><span class="co">##  8 Armenia                  1991       2016           0 Western Asia       </span></a>
<a class="sourceLine" id="cb190-18" data-line-number="18"><span class="co">##  9 Australia                1901       2016           0 Australia and New …</span></a>
<a class="sourceLine" id="cb190-19" data-line-number="19"><span class="co">## 10 Austria                  1918       2016           0 Western Europe     </span></a>
<a class="sourceLine" id="cb190-20" data-line-number="20"><span class="co">## # ... with 184 more rows</span></a></code></pre></div>
<p>Como dice el warning, algunos países no fueron encontrados. Estos son los países que <code>countrycode</code> no pudo encontrar, seguramente porque los países están escritos de otra manera:</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb191-1" data-line-number="1">gantt_plot_df_region <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb191-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(<span class="kw">is.na</span>(region))</a>
<a class="sourceLine" id="cb191-3" data-line-number="3"><span class="co">## # A tibble: 4 x 5</span></a>
<a class="sourceLine" id="cb191-4" data-line-number="4"><span class="co">##   country_name                    year_enters year_exits exits_bc_dd region</span></a>
<a class="sourceLine" id="cb191-5" data-line-number="5"><span class="co">##   &lt;chr&gt;                                 &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt; </span></a>
<a class="sourceLine" id="cb191-6" data-line-number="6"><span class="co">## 1 Kosovo                                 2008       2016           0 &lt;NA&gt;  </span></a>
<a class="sourceLine" id="cb191-7" data-line-number="7"><span class="co">## 2 South Yemen                            1967       2016           0 &lt;NA&gt;  </span></a>
<a class="sourceLine" id="cb191-8" data-line-number="8"><span class="co">## 3 Vietnam, Democratic Republic of        1945       2016           0 &lt;NA&gt;  </span></a>
<a class="sourceLine" id="cb191-9" data-line-number="9"><span class="co">## 4 Vietnam, Republic of                   1949       1975           0 &lt;NA&gt;</span></a></code></pre></div>
<p>Podemos corregir esto a mano ex-post o correr <code>countrycode::countrycode()</code> de nuevo, pero con el argumento <code>custom_match</code>:</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb192-1" data-line-number="1">gantt_plot_df_region &lt;-<span class="st"> </span>gantt_plot_df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb192-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">region =</span> <span class="kw">countrycode</span>(country_name, </a>
<a class="sourceLine" id="cb192-3" data-line-number="3">                              <span class="dt">origin       =</span> <span class="st">&quot;country.name&quot;</span>, </a>
<a class="sourceLine" id="cb192-4" data-line-number="4">                              <span class="dt">dest         =</span> <span class="st">&quot;region&quot;</span>,</a>
<a class="sourceLine" id="cb192-5" data-line-number="5">                              <span class="dt">custom_match =</span> <span class="kw">c</span>(<span class="st">&quot;Korea, North&quot;</span> =<span class="st"> &quot;Eastern Asia&quot;</span>,</a>
<a class="sourceLine" id="cb192-6" data-line-number="6">                                               <span class="st">&quot;Kosovo&quot;</span> =<span class="st"> &quot;Eastern Europe&quot;</span>,</a>
<a class="sourceLine" id="cb192-7" data-line-number="7">                                               <span class="st">&quot;South Yemen&quot;</span> =<span class="st"> &quot;Western Asia&quot;</span>,</a>
<a class="sourceLine" id="cb192-8" data-line-number="8">                                               <span class="st">&quot;Vietnam, Democratic Republic of&quot;</span> =<span class="st"> &quot;South-Eastern Asia&quot;</span>,</a>
<a class="sourceLine" id="cb192-9" data-line-number="9">                                               <span class="st">&quot;Vietnam, Republic of&quot;</span> =<span class="st"> &quot;South-Eastern Asia&quot;</span>)))</a>
<a class="sourceLine" id="cb192-10" data-line-number="10">gantt_plot_df_region</a>
<a class="sourceLine" id="cb192-11" data-line-number="11"><span class="co">## # A tibble: 194 x 5</span></a>
<a class="sourceLine" id="cb192-12" data-line-number="12"><span class="co">##    country_name      year_enters year_exits exits_bc_dd region             </span></a>
<a class="sourceLine" id="cb192-13" data-line-number="13"><span class="co">##    &lt;chr&gt;                   &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;              </span></a>
<a class="sourceLine" id="cb192-14" data-line-number="14"><span class="co">##  1 Afghanistan              1919       2016           0 Southern Asia      </span></a>
<a class="sourceLine" id="cb192-15" data-line-number="15"><span class="co">##  2 Albania                  1912       1998           1 Southern Europe    </span></a>
<a class="sourceLine" id="cb192-16" data-line-number="16"><span class="co">##  3 Algeria                  1962       2016           0 Northern Africa    </span></a>
<a class="sourceLine" id="cb192-17" data-line-number="17"><span class="co">##  4 Andorra                  1900       2016           0 Southern Europe    </span></a>
<a class="sourceLine" id="cb192-18" data-line-number="18"><span class="co">##  5 Angola                   1975       2016           0 Middle Africa      </span></a>
<a class="sourceLine" id="cb192-19" data-line-number="19"><span class="co">##  6 Antigua and Barb…        1981       2016           0 Caribbean          </span></a>
<a class="sourceLine" id="cb192-20" data-line-number="20"><span class="co">##  7 Argentina                1900       2016           0 South America      </span></a>
<a class="sourceLine" id="cb192-21" data-line-number="21"><span class="co">##  8 Armenia                  1991       2016           0 Western Asia       </span></a>
<a class="sourceLine" id="cb192-22" data-line-number="22"><span class="co">##  9 Australia                1901       2016           0 Australia and New …</span></a>
<a class="sourceLine" id="cb192-23" data-line-number="23"><span class="co">## 10 Austria                  1918       2016           0 Western Europe     </span></a>
<a class="sourceLine" id="cb192-24" data-line-number="24"><span class="co">## # ... with 184 more rows</span></a></code></pre></div>
<p>Ahora no tenemos NA! Hemos logrado asignar una región a cada país de la muestra.</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb193-1" data-line-number="1">gantt_plot_df_region <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb193-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(<span class="kw">is.na</span>(region))</a>
<a class="sourceLine" id="cb193-3" data-line-number="3"><span class="co">## # A tibble: 0 x 5</span></a>
<a class="sourceLine" id="cb193-4" data-line-number="4"><span class="co">## # ... with 5 variables: country_name &lt;chr&gt;, year_enters &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb193-5" data-line-number="5"><span class="co">## #   year_exits &lt;dbl&gt;, exits_bc_dd &lt;dbl&gt;, region &lt;chr&gt;</span></a></code></pre></div>
<p>Con nuestra base ya armada, podemos hacer el plot con facilidad, gracias a <code>ggalt::geom_dumbbell()</code>:</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb194-1" data-line-number="1"><span class="kw">library</span>(ggalt)</a>
<a class="sourceLine" id="cb194-2" data-line-number="2">gantt_plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data    =</span> gantt_plot_df_region, </a>
<a class="sourceLine" id="cb194-3" data-line-number="3">                     <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x     =</span> year_enters, </a>
<a class="sourceLine" id="cb194-4" data-line-number="4">                                   <span class="dt">xend  =</span> year_exits, </a>
<a class="sourceLine" id="cb194-5" data-line-number="5">                                   <span class="dt">y     =</span> <span class="kw">fct_rev</span>(country_name), </a>
<a class="sourceLine" id="cb194-6" data-line-number="6">                                   <span class="dt">color =</span> <span class="kw">factor</span>(exits_bc_dd))) <span class="op">+</span></a>
<a class="sourceLine" id="cb194-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_dumbbell</span>(<span class="dt">size_x =</span> <span class="dv">2</span>, <span class="dt">size_xend =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb194-8" data-line-number="8"></a>
<a class="sourceLine" id="cb194-9" data-line-number="9">gantt_plot</a></code></pre></div>
<p><img src="surv_files/figure-html/unnamed-chunk-18-1.png" width="672" style="display: block; margin: auto;" />
En el eje vertical tenemos los países ordenados alfabeticamente, y en el eje x hay dos variables que informan al gráfico, por un lado el comienzo de la línea (<code>year_enters</code>) y por otro su fin (<code>year_exits</code>). Además, hay una tercer variable informativa que es el color de la línea, que denota si el país implementó o no una instancia de democracia directa (<code>exits_bc_dd</code>). Los pa[ises en azul son los que implementaron dicha instancia entre 1900 y 2016.</p>
<p>Si bien la figura es de una enorme utilidad visual, hay que reconocer que son demasiados países para incluirla en el cuerpo de un artículo. Un enfoque posible es concentrarnos en ciertas regiones. Veamos Sudamérica, por ejemplo:</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb195-1" data-line-number="1">gantt_plot_sa &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data    =</span> gantt_plot_df_region <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(region <span class="op">==</span><span class="st"> &quot;South America&quot;</span>), </a>
<a class="sourceLine" id="cb195-2" data-line-number="2">                     <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x     =</span> year_enters, </a>
<a class="sourceLine" id="cb195-3" data-line-number="3">                                   <span class="dt">xend  =</span> year_exits, </a>
<a class="sourceLine" id="cb195-4" data-line-number="4">                                   <span class="dt">y     =</span> <span class="kw">fct_rev</span>(country_name), </a>
<a class="sourceLine" id="cb195-5" data-line-number="5">                                   <span class="dt">color =</span> <span class="kw">fct_recode</span>(<span class="kw">factor</span>(exits_bc_dd)))) <span class="op">+</span></a>
<a class="sourceLine" id="cb195-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_dumbbell</span>(<span class="dt">size_x =</span> <span class="dv">2</span>, <span class="dt">size_xend =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb195-7" data-line-number="7"></a>
<a class="sourceLine" id="cb195-8" data-line-number="8">gantt_plot_sa</a></code></pre></div>
<p><img src="surv_files/figure-html/unnamed-chunk-19-1.png" width="480" style="display: block; margin: auto;" />
Podemos agregarle los años como texto para mejorar aún más la lectura de la figura:</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb196-1" data-line-number="1">gantt_plot_sa &lt;-<span class="st"> </span>gantt_plot_sa <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb196-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> year_enters), <span class="dt">vjust =</span> <span class="fl">-.4</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb196-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">x =</span> year_exits, <span class="dt">label =</span> year_exits), <span class="dt">vjust =</span> <span class="fl">-.4</span>)</a>
<a class="sourceLine" id="cb196-4" data-line-number="4"></a>
<a class="sourceLine" id="cb196-5" data-line-number="5">gantt_plot_sa</a></code></pre></div>
<p><img src="surv_files/figure-html/unnamed-chunk-20-1.png" width="480" style="display: block; margin: auto;" />
Finalmente, algunos retoques estéticos, con todo lo que hemos aprendido en el CAP X:</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb197-1" data-line-number="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb197-2" data-line-number="2">gantt_plot_sa &lt;-<span class="st"> </span>gantt_plot_sa <span class="op">+</span></a>
<a class="sourceLine" id="cb197-3" data-line-number="3"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x     =</span> <span class="st">&quot;año&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb197-4" data-line-number="4">       <span class="dt">title =</span> <span class="st">&quot;Años de entrada y salida, Sudamérica&quot;</span>,</a>
<a class="sourceLine" id="cb197-5" data-line-number="5">       <span class="dt">color =</span> <span class="st">&quot;¿Adopta democracia directa?&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb197-6" data-line-number="6"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_blank</span>())</a>
<a class="sourceLine" id="cb197-7" data-line-number="7"></a>
<a class="sourceLine" id="cb197-8" data-line-number="8">gantt_plot_sa</a></code></pre></div>
<p><img src="surv_files/figure-html/unnamed-chunk-21-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>Además de gráficos de Gantt, es muy común que quien trabaja con modelos de supervivencia muestre gráficos con las curvas de supervivencia comparando dos grupos de interés. Por ejemplo, David Altman se pregunta si hubo una diferencia en el siglo XX entre países que se democratizaron rápidamente y aquellos que demoraron décadas en hacerlo sobre la rapidez con que implementaron mecanismos de democracia directa. Este tipo de figuras no tiene valor inferencial, pero si gran valor decriptivo. Tenemos que estimar una curva de supervivencia no paramétrica, usando el método de Kaplan-Meier.</p>
<p>A partir de este punto debemos hacer una modificación más a nuestra base. Seguramente tu también debas hacerlo con tus propios datos, así que presta atención. Los modelos de supervivencia no trabajan con datos de panel tradicionales, como el de nuestra base. Tenemos que convertirlos a “tiempo en riesgo”. ¿Qué quiere decir esto?</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb198-1" data-line-number="1">datos_altman_c &lt;-<span class="st"> </span>datos_altman_b <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb198-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(country_name) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb198-3" data-line-number="3"><span class="st">  </span><span class="co"># vamos a eliminar el primer año para cada país. no está en riesgo, por definición!</span></a>
<a class="sourceLine" id="cb198-4" data-line-number="4"><span class="st">  </span><span class="kw">filter</span>(year <span class="op">!=</span><span class="st"> </span><span class="kw">min</span>(year)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb198-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">risk_time_at_end   =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">n</span>()),</a>
<a class="sourceLine" id="cb198-6" data-line-number="6">         <span class="dt">risk_time_at_start =</span> <span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span>(<span class="kw">n</span>() <span class="op">-</span><span class="st"> </span><span class="dv">1</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb198-7" data-line-number="7"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb198-8" data-line-number="8"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(country_name, year, risk_time_at_start, risk_time_at_end, <span class="kw">everything</span>())</a></code></pre></div>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb199-1" data-line-number="1">datos_altman_c</a>
<a class="sourceLine" id="cb199-2" data-line-number="2"><span class="co">## # A tibble: 12,014 x 25</span></a>
<a class="sourceLine" id="cb199-3" data-line-number="3"><span class="co">##    country_name  year risk_time_at_st… risk_time_at_end cic_dummy</span></a>
<a class="sourceLine" id="cb199-4" data-line-number="4"><span class="co">##    &lt;chr&gt;        &lt;dbl&gt;            &lt;int&gt;            &lt;int&gt;     &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb199-5" data-line-number="5"><span class="co">##  1 Afghanistan   1920                0                1         0</span></a>
<a class="sourceLine" id="cb199-6" data-line-number="6"><span class="co">##  2 Afghanistan   1921                1                2         0</span></a>
<a class="sourceLine" id="cb199-7" data-line-number="7"><span class="co">##  3 Afghanistan   1922                2                3         0</span></a>
<a class="sourceLine" id="cb199-8" data-line-number="8"><span class="co">##  4 Afghanistan   1923                3                4         0</span></a>
<a class="sourceLine" id="cb199-9" data-line-number="9"><span class="co">##  5 Afghanistan   1924                4                5         0</span></a>
<a class="sourceLine" id="cb199-10" data-line-number="10"><span class="co">##  6 Afghanistan   1925                5                6         0</span></a>
<a class="sourceLine" id="cb199-11" data-line-number="11"><span class="co">##  7 Afghanistan   1926                6                7         0</span></a>
<a class="sourceLine" id="cb199-12" data-line-number="12"><span class="co">##  8 Afghanistan   1927                7                8         0</span></a>
<a class="sourceLine" id="cb199-13" data-line-number="13"><span class="co">##  9 Afghanistan   1928                8                9         0</span></a>
<a class="sourceLine" id="cb199-14" data-line-number="14"><span class="co">## 10 Afghanistan   1929                9               10         0</span></a>
<a class="sourceLine" id="cb199-15" data-line-number="15"><span class="co">## # ... with 12,004 more rows, and 20 more variables: dem_positive &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb199-16" data-line-number="16"><span class="co">## #   dem_negative &lt;dbl&gt;, memory &lt;dbl&gt;, v2x_polyarchy &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb199-17" data-line-number="17"><span class="co">## #   capabilities_geo_ide &lt;dbl&gt;, occur_geo_ide &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb199-18" data-line-number="18"><span class="co">## #   c_pos_capabilities &lt;dbl&gt;, c_pos_occurrences &lt;dbl&gt;, c_pos_memory &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb199-19" data-line-number="19"><span class="co">## #   log_pop &lt;dbl&gt;, c_gbr &lt;dbl&gt;, c_fra &lt;dbl&gt;, c_ussr &lt;dbl&gt;, c_spa &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb199-20" data-line-number="20"><span class="co">## #   c_usa &lt;dbl&gt;, c_ned &lt;dbl&gt;, c_prt &lt;dbl&gt;, c_bel &lt;dbl&gt;, c_ahe &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb199-21" data-line-number="21"><span class="co">## #   c_ote &lt;dbl&gt;</span></a></code></pre></div>
<p>Corramos la curva de supervivencia no paramétrica, usando el método de Kaplan-Meier:</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb200-1" data-line-number="1"><span class="kw">library</span>(survival)</a>
<a class="sourceLine" id="cb200-2" data-line-number="2"></a>
<a class="sourceLine" id="cb200-3" data-line-number="3">km &lt;-<span class="st"> </span><span class="kw">survfit</span>(<span class="kw">Surv</span>(<span class="dt">time =</span> risk_time_at_start, <span class="dt">time2 =</span> risk_time_at_end,</a>
<a class="sourceLine" id="cb200-4" data-line-number="4">                   <span class="dt">event =</span> cic_dummy) <span class="op">~</span><span class="st"> </span>dem_positive,</a>
<a class="sourceLine" id="cb200-5" data-line-number="5">              <span class="dt">type      =</span> <span class="st">&quot;kaplan-meier&quot;</span>, </a>
<a class="sourceLine" id="cb200-6" data-line-number="6">              <span class="dt">conf.type =</span> <span class="st">&quot;log&quot;</span>, </a>
<a class="sourceLine" id="cb200-7" data-line-number="7">              <span class="dt">data      =</span> datos_altman_c)</a></code></pre></div>
<p>Ahora podemos armar nuestro plot con <code>survminer::ggsurvplot()</code></p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb201-1" data-line-number="1"><span class="kw">library</span>(survminer)</a>
<a class="sourceLine" id="cb201-2" data-line-number="2"><span class="co">## Loading required package: ggpubr</span></a>
<a class="sourceLine" id="cb201-3" data-line-number="3"><span class="co">## Loading required package: magrittr</span></a>
<a class="sourceLine" id="cb201-4" data-line-number="4"><span class="co">## </span></a>
<a class="sourceLine" id="cb201-5" data-line-number="5"><span class="co">## Attaching package: &#39;magrittr&#39;</span></a>
<a class="sourceLine" id="cb201-6" data-line-number="6"><span class="co">## The following object is masked from &#39;package:purrr&#39;:</span></a>
<a class="sourceLine" id="cb201-7" data-line-number="7"><span class="co">## </span></a>
<a class="sourceLine" id="cb201-8" data-line-number="8"><span class="co">##     set_names</span></a>
<a class="sourceLine" id="cb201-9" data-line-number="9"><span class="co">## The following object is masked from &#39;package:tidyr&#39;:</span></a>
<a class="sourceLine" id="cb201-10" data-line-number="10"><span class="co">## </span></a>
<a class="sourceLine" id="cb201-11" data-line-number="11"><span class="co">##     extract</span></a>
<a class="sourceLine" id="cb201-12" data-line-number="12"><span class="kw">ggsurvplot</span>(km, <span class="dt">conf.int =</span> T, <span class="dt">legend.title =</span> <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb201-13" data-line-number="13">           <span class="dt">break.x.by =</span> <span class="dv">20</span>,</a>
<a class="sourceLine" id="cb201-14" data-line-number="14">           <span class="dt">legend.labs =</span> <span class="kw">c</span>(<span class="st">&quot;Fast democratization = 0&quot;</span>, <span class="st">&quot;Fast democratization = 1&quot;</span>), </a>
<a class="sourceLine" id="cb201-15" data-line-number="15">           <span class="dt">data =</span> datos_altman_c) <span class="op">+</span></a>
<a class="sourceLine" id="cb201-16" data-line-number="16"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title    =</span> <span class="st">&quot;Kaplan-Meir Survival estimates&quot;</span>)</a></code></pre></div>
<p><img src="surv_files/figure-html/unnamed-chunk-25-1.png" width="1056" style="display: block; margin: auto;" /></p>
<p>Altman tiene la hipótesis de que países que sufrieron “shocks” democratizadores fueron mucho más rápidos en implementar mecanismos directos. La figura confirma su intuición, pues vemos que la probabilidad de supervivencia de un país (léase como la probabilidad de que persista sin implementar mecanismos de democracia directa) se reduce a la mitad en los primeros cuatro años que siguien al shock democratizador. Por el contrario, países que se democratizan de a poco, no sufren este efecto.</p>
<div id="replicar-la-tabla-1.2-de-altman-e-interpretar-sus-coeficientes-como-hazard-ratios." class="section level3">
<h3><span class="header-section-number">10.3.1</span> Replicar la tabla 1.2 de Altman e interpretar sus coeficientes como Hazard Ratios.</h3>
<p>Vamos a correr los modelos y correr los tests de Grambsch and Therneau.</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb202-1" data-line-number="1">cox_m1 &lt;-<span class="st"> </span><span class="kw">coxph</span>(<span class="kw">Surv</span>(risk_time_at_start, risk_time_at_end, cic_dummy) <span class="op">~</span><span class="st"> </span></a>
<a class="sourceLine" id="cb202-2" data-line-number="2"><span class="st">                  </span>dem_positive <span class="op">+</span><span class="st"> </span>dem_negative <span class="op">+</span><span class="st"> </span>memory <span class="op">+</span><span class="st"> </span>v2x_polyarchy <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb202-3" data-line-number="3"><span class="st">                  </span>capabilities_geo_ide <span class="op">+</span><span class="st"> </span>occur_geo_ide, </a>
<a class="sourceLine" id="cb202-4" data-line-number="4">                <span class="dt">data   =</span> datos_altman_c, </a>
<a class="sourceLine" id="cb202-5" data-line-number="5">                <span class="dt">robust =</span> T, </a>
<a class="sourceLine" id="cb202-6" data-line-number="6">                <span class="dt">method =</span><span class="st">&quot;breslow&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb203-1" data-line-number="1"><span class="kw">cox.zph</span>(cox_m1)</a>
<a class="sourceLine" id="cb203-2" data-line-number="2"><span class="co">##                          rho  chisq      p</span></a>
<a class="sourceLine" id="cb203-3" data-line-number="3"><span class="co">## dem_positive         -0.1234 0.7250 0.3945</span></a>
<a class="sourceLine" id="cb203-4" data-line-number="4"><span class="co">## dem_negative          0.0147 0.0106 0.9178</span></a>
<a class="sourceLine" id="cb203-5" data-line-number="5"><span class="co">##  [ reached getOption(&quot;max.print&quot;) -- omitted 5 rows ]</span></a></code></pre></div>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb204-1" data-line-number="1">cox_m2 &lt;-<span class="st"> </span><span class="kw">coxph</span>(<span class="kw">Surv</span>(risk_time_at_start, risk_time_at_end, cic_dummy) <span class="op">~</span><span class="st"> </span></a>
<a class="sourceLine" id="cb204-2" data-line-number="2"><span class="st">                  </span>dem_positive <span class="op">+</span><span class="st"> </span>dem_negative <span class="op">+</span><span class="st"> </span>memory <span class="op">+</span><span class="st"> </span>v2x_polyarchy <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb204-3" data-line-number="3"><span class="st">                  </span>capabilities_geo_ide <span class="op">+</span><span class="st"> </span>occur_geo_ide <span class="op">+</span><span class="st"> </span>c_pos_capabilities <span class="op">+</span></a>
<a class="sourceLine" id="cb204-4" data-line-number="4"><span class="st">                  </span>c_pos_occurrences, </a>
<a class="sourceLine" id="cb204-5" data-line-number="5">                <span class="dt">data   =</span> datos_altman_c, </a>
<a class="sourceLine" id="cb204-6" data-line-number="6">                <span class="dt">robust =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb204-7" data-line-number="7">                <span class="dt">method =</span><span class="st">&quot;breslow&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb205-1" data-line-number="1"><span class="kw">cox.zph</span>(cox_m2)</a>
<a class="sourceLine" id="cb205-2" data-line-number="2"><span class="co">##                           rho   chisq      p</span></a>
<a class="sourceLine" id="cb205-3" data-line-number="3"><span class="co">## dem_positive         -0.08383 0.30625 0.5800</span></a>
<a class="sourceLine" id="cb205-4" data-line-number="4"><span class="co">## dem_negative          0.00630 0.00200 0.9643</span></a>
<a class="sourceLine" id="cb205-5" data-line-number="5"><span class="co">##  [ reached getOption(&quot;max.print&quot;) -- omitted 7 rows ]</span></a></code></pre></div>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb206-1" data-line-number="1">cox_m3 &lt;-<span class="st"> </span><span class="kw">coxph</span>(<span class="kw">Surv</span>(risk_time_at_start, risk_time_at_end, cic_dummy) <span class="op">~</span><span class="st"> </span></a>
<a class="sourceLine" id="cb206-2" data-line-number="2"><span class="st">                  </span>dem_positive <span class="op">+</span><span class="st"> </span>dem_negative <span class="op">+</span><span class="st"> </span>memory <span class="op">+</span><span class="st"> </span>v2x_polyarchy <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb206-3" data-line-number="3"><span class="st">                  </span>capabilities_geo_ide <span class="op">+</span><span class="st"> </span>occur_geo_ide <span class="op">+</span><span class="st"> </span>c_pos_capabilities <span class="op">+</span></a>
<a class="sourceLine" id="cb206-4" data-line-number="4"><span class="st">                  </span>c_pos_occurrences <span class="op">+</span><span class="st"> </span>c_pos_memory, </a>
<a class="sourceLine" id="cb206-5" data-line-number="5">                <span class="dt">data   =</span> datos_altman_c, </a>
<a class="sourceLine" id="cb206-6" data-line-number="6">                <span class="dt">robust =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb206-7" data-line-number="7">                <span class="dt">method =</span><span class="st">&quot;breslow&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb207-1" data-line-number="1"><span class="kw">cox.zph</span>(cox_m3)</a>
<a class="sourceLine" id="cb207-2" data-line-number="2"><span class="co">##                          rho   chisq      p</span></a>
<a class="sourceLine" id="cb207-3" data-line-number="3"><span class="co">## dem_positive         -0.2785  2.8244 0.0928</span></a>
<a class="sourceLine" id="cb207-4" data-line-number="4"><span class="co">## dem_negative         -0.0242  0.0298 0.8630</span></a>
<a class="sourceLine" id="cb207-5" data-line-number="5"><span class="co">##  [ reached getOption(&quot;max.print&quot;) -- omitted 8 rows ]</span></a></code></pre></div>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb208-1" data-line-number="1">cox_m4 &lt;-<span class="st"> </span><span class="kw">coxph</span>(<span class="kw">Surv</span>(risk_time_at_start, risk_time_at_end, cic_dummy) <span class="op">~</span><span class="st"> </span></a>
<a class="sourceLine" id="cb208-2" data-line-number="2"><span class="st">                  </span>dem_positive <span class="op">+</span><span class="st"> </span>dem_negative <span class="op">+</span><span class="st"> </span>memory <span class="op">+</span><span class="st"> </span>v2x_polyarchy <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb208-3" data-line-number="3"><span class="st">                  </span>capabilities_geo_ide <span class="op">+</span><span class="st"> </span>occur_geo_ide <span class="op">+</span><span class="st"> </span>c_pos_capabilities <span class="op">+</span></a>
<a class="sourceLine" id="cb208-4" data-line-number="4"><span class="st">                  </span>c_pos_occurrences <span class="op">+</span><span class="st"> </span>c_pos_memory <span class="op">+</span><span class="st"> </span>log_pop, </a>
<a class="sourceLine" id="cb208-5" data-line-number="5">                <span class="dt">data   =</span> datos_altman_c, </a>
<a class="sourceLine" id="cb208-6" data-line-number="6">                <span class="dt">robust =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb208-7" data-line-number="7">                <span class="dt">method =</span> <span class="st">&quot;breslow&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb209-1" data-line-number="1"><span class="kw">cox.zph</span>(cox_m4)</a>
<a class="sourceLine" id="cb209-2" data-line-number="2"><span class="co">##                          rho   chisq      p</span></a>
<a class="sourceLine" id="cb209-3" data-line-number="3"><span class="co">## dem_positive         -0.2834  2.9290 0.0870</span></a>
<a class="sourceLine" id="cb209-4" data-line-number="4"><span class="co">## dem_negative          0.0278  0.0413 0.8389</span></a>
<a class="sourceLine" id="cb209-5" data-line-number="5"><span class="co">##  [ reached getOption(&quot;max.print&quot;) -- omitted 9 rows ]</span></a></code></pre></div>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb210-1" data-line-number="1">cox_m5 &lt;-<span class="st"> </span><span class="kw">coxph</span>(<span class="kw">Surv</span>(risk_time_at_start, risk_time_at_end, cic_dummy) <span class="op">~</span><span class="st"> </span></a>
<a class="sourceLine" id="cb210-2" data-line-number="2"><span class="st">                  </span>dem_positive <span class="op">+</span><span class="st"> </span>dem_negative <span class="op">+</span><span class="st"> </span>memory <span class="op">+</span><span class="st"> </span>v2x_polyarchy <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb210-3" data-line-number="3"><span class="st">                  </span>capabilities_geo_ide <span class="op">+</span><span class="st"> </span>occur_geo_ide <span class="op">+</span><span class="st"> </span>c_pos_capabilities <span class="op">+</span></a>
<a class="sourceLine" id="cb210-4" data-line-number="4"><span class="st">                  </span>c_pos_occurrences <span class="op">+</span><span class="st"> </span>c_pos_memory <span class="op">+</span><span class="st"> </span>log_pop <span class="op">+</span><span class="st"> </span>c_gbr, </a>
<a class="sourceLine" id="cb210-5" data-line-number="5">                <span class="dt">data   =</span> datos_altman_c, </a>
<a class="sourceLine" id="cb210-6" data-line-number="6">                <span class="dt">robust =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb210-7" data-line-number="7">                <span class="dt">method =</span><span class="st">&quot;breslow&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb211-1" data-line-number="1"><span class="kw">cox.zph</span>(cox_m5)</a>
<a class="sourceLine" id="cb211-2" data-line-number="2"><span class="co">##                          rho   chisq      p</span></a>
<a class="sourceLine" id="cb211-3" data-line-number="3"><span class="co">## dem_positive         -0.2640  2.5838 0.1080</span></a>
<a class="sourceLine" id="cb211-4" data-line-number="4"><span class="co">## dem_negative          0.0462  0.1158 0.7336</span></a>
<a class="sourceLine" id="cb211-5" data-line-number="5"><span class="co">##  [ reached getOption(&quot;max.print&quot;) -- omitted 10 rows ]</span></a></code></pre></div>
<p>¿Cómo arreglar este problema?</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb212-1" data-line-number="1">cox_m5_int &lt;-<span class="st"> </span><span class="kw">coxph</span>(<span class="kw">Surv</span>(risk_time_at_start, risk_time_at_end, cic_dummy) <span class="op">~</span><span class="st"> </span></a>
<a class="sourceLine" id="cb212-2" data-line-number="2"><span class="st">                  </span>dem_positive <span class="op">+</span><span class="st"> </span>dem_negative <span class="op">+</span><span class="st"> </span>memory <span class="op">+</span><span class="st"> </span>v2x_polyarchy <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb212-3" data-line-number="3"><span class="st">                  </span>capabilities_geo_ide <span class="op">+</span><span class="st"> </span>occur_geo_ide <span class="op">+</span><span class="st"> </span>c_pos_capabilities <span class="op">+</span></a>
<a class="sourceLine" id="cb212-4" data-line-number="4"><span class="st">                  </span>c_pos_occurrences <span class="op">+</span><span class="st"> </span>c_pos_memory <span class="op">+</span><span class="st"> </span>log_pop <span class="op">+</span><span class="st"> </span>c_gbr <span class="op">+</span></a>
<a class="sourceLine" id="cb212-5" data-line-number="5"><span class="st">                  </span>v2x_polyarchy<span class="op">:</span><span class="kw">log</span>(risk_time_at_end) <span class="op">+</span></a>
<a class="sourceLine" id="cb212-6" data-line-number="6"><span class="st">                  </span>log_pop<span class="op">:</span><span class="kw">log</span>(risk_time_at_end), </a>
<a class="sourceLine" id="cb212-7" data-line-number="7">                <span class="dt">data   =</span> datos_altman_c, </a>
<a class="sourceLine" id="cb212-8" data-line-number="8">                <span class="dt">robust =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb212-9" data-line-number="9">                <span class="dt">method =</span><span class="st">&quot;breslow&quot;</span>)</a></code></pre></div>
<p>Veamos todos los modelos juntos con <code>texreg</code>:</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb213-1" data-line-number="1"><span class="kw">library</span>(texreg)</a></code></pre></div>
<p><strong>PENDIENTE</strong>: Explicar el cálculo de errores estándares ajustados para modelos lineales generalizados.</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb214-1" data-line-number="1">f_get_adj_se &lt;-<span class="st"> </span><span class="cf">function</span>(model){</a>
<a class="sourceLine" id="cb214-2" data-line-number="2">  <span class="co"># adaptado de https://www.andrewheiss.com/blog/2016/04/25/convert-logistic-regression-standard-errors-to-odds-ratios-with-r/</span></a>
<a class="sourceLine" id="cb214-3" data-line-number="3">  </a>
<a class="sourceLine" id="cb214-4" data-line-number="4">  model_df &lt;-<span class="st"> </span>broom<span class="op">::</span><span class="kw">tidy</span>(model)</a>
<a class="sourceLine" id="cb214-5" data-line-number="5">  </a>
<a class="sourceLine" id="cb214-6" data-line-number="6">  model_df_extra &lt;-<span class="st"> </span>model_df <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb214-7" data-line-number="7"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">hr       =</span> <span class="kw">exp</span>(estimate),      <span class="co"># Hazard ratios</span></a>
<a class="sourceLine" id="cb214-8" data-line-number="8">           <span class="dt">var_diag =</span> <span class="kw">diag</span>(<span class="kw">vcov</span>(model)),  <span class="co"># Varianza de cada coeficiente</span></a>
<a class="sourceLine" id="cb214-9" data-line-number="9">           <span class="dt">hr_se    =</span> <span class="kw">sqrt</span>(hr<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>var_diag))</a>
<a class="sourceLine" id="cb214-10" data-line-number="10">  </a>
<a class="sourceLine" id="cb214-11" data-line-number="11">  <span class="kw">return</span>(model_df_extra<span class="op">$</span>hr_se)</a>
<a class="sourceLine" id="cb214-12" data-line-number="12">}</a></code></pre></div>
<p><strong>PENDIENTE:</strong> Explicar que aquí se están utilizando iteraciones para reemplazar los coeficientes y errores estándar (y dejar el código legible)</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb215-1" data-line-number="1">lista_modelos &lt;-<span class="st"> </span><span class="kw">list</span>(cox_m1, cox_m2, cox_m3, cox_m4, cox_m5, cox_m5_int)</a>
<a class="sourceLine" id="cb215-2" data-line-number="2"></a>
<a class="sourceLine" id="cb215-3" data-line-number="3"><span class="kw">screenreg</span>(<span class="dt">l =</span> lista_modelos,</a>
<a class="sourceLine" id="cb215-4" data-line-number="4">          <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;Modelo 1&quot;</span>, <span class="st">&quot;Modelo 2&quot;</span>, <span class="st">&quot;Modelo 3&quot;</span>, <span class="st">&quot;Modelo 4&quot;</span>, <span class="st">&quot;Modelo 5&quot;</span>, <span class="st">&quot;Modelo 5 c/int&quot;</span>),</a>
<a class="sourceLine" id="cb215-5" data-line-number="5">          <span class="dt">override.coef =</span> <span class="kw">map</span>(lista_modelos, <span class="op">~</span><span class="st"> </span><span class="kw">exp</span>(<span class="kw">coef</span>(.x))),</a>
<a class="sourceLine" id="cb215-6" data-line-number="6">          <span class="dt">override.se   =</span> <span class="kw">map</span>(lista_modelos, <span class="op">~</span><span class="st"> </span><span class="kw">f_get_adj_se</span>(.x)))</a>
<a class="sourceLine" id="cb215-7" data-line-number="7"><span class="co">## </span></a>
<a class="sourceLine" id="cb215-8" data-line-number="8"><span class="co">## =========================================================================================================================</span></a>
<a class="sourceLine" id="cb215-9" data-line-number="9"><span class="co">##                                      Modelo 1      Modelo 2      Modelo 3      Modelo 4      Modelo 5      Modelo 5 c/int</span></a>
<a class="sourceLine" id="cb215-10" data-line-number="10"><span class="co">## -------------------------------------------------------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb215-11" data-line-number="11"><span class="co">## dem_positive                             7.00 ***      6.37 ***     13.18 ***     12.75 ***     12.44 ***      9.25 ***  </span></a>
<a class="sourceLine" id="cb215-12" data-line-number="12"><span class="co">##                                         (2.53)        (2.91)        (7.71)        (7.34)        (7.20)        (6.23)     </span></a>
<a class="sourceLine" id="cb215-13" data-line-number="13"><span class="co">## dem_negative                             2.42          2.42          2.40          2.39          2.21          2.32      </span></a>
<a class="sourceLine" id="cb215-14" data-line-number="14"><span class="co">##                                         (1.77)        (1.77)        (1.75)        (1.76)        (1.63)        (1.72)     </span></a>
<a class="sourceLine" id="cb215-15" data-line-number="15"><span class="co">## memory                                   5.11 ***      5.07 ***      6.60 ***      6.53 ***      6.06 ***      6.30 ***  </span></a>
<a class="sourceLine" id="cb215-16" data-line-number="16"><span class="co">##                                         (1.85)        (1.89)        (2.75)        (2.72)        (2.58)        (2.66)     </span></a>
<a class="sourceLine" id="cb215-17" data-line-number="17"><span class="co">## v2x_polyarchy                            3.91 *        3.96 *        3.99 *        4.26 *        5.97 **     498.25 ***  </span></a>
<a class="sourceLine" id="cb215-18" data-line-number="18"><span class="co">##                                         (2.17)        (2.21)        (2.26)        (2.54)        (3.62)      (765.22)     </span></a>
<a class="sourceLine" id="cb215-19" data-line-number="19"><span class="co">## capabilities_geo_ide                     2.98 ***      3.15 **       3.23 **       3.22 **       3.01 **       2.89 **   </span></a>
<a class="sourceLine" id="cb215-20" data-line-number="20"><span class="co">##                                         (0.99)        (1.14)        (1.21)        (1.21)        (1.10)        (1.14)     </span></a>
<a class="sourceLine" id="cb215-21" data-line-number="21"><span class="co">## occur_geo_ide                            0.03          0.02          0.01          0.01          0.01          0.02      </span></a>
<a class="sourceLine" id="cb215-22" data-line-number="22"><span class="co">##                                         (0.05)        (0.04)        (0.03)        (0.03)        (0.03)        (0.05)     </span></a>
<a class="sourceLine" id="cb215-23" data-line-number="23"><span class="co">## c_pos_capabilities                                     0.71          0.85          0.89          0.95          1.32      </span></a>
<a class="sourceLine" id="cb215-24" data-line-number="24"><span class="co">##                                                       (1.32)        (1.61)        (1.68)        (1.68)        (2.22)     </span></a>
<a class="sourceLine" id="cb215-25" data-line-number="25"><span class="co">## c_pos_occurrences                                     12.97         20.24         18.22         17.52         11.77      </span></a>
<a class="sourceLine" id="cb215-26" data-line-number="26"><span class="co">##                                                      (65.70)      (107.88)       (97.37)       (88.32)       (52.45)     </span></a>
<a class="sourceLine" id="cb215-27" data-line-number="27"><span class="co">## c_pos_memory                                                         0.29          0.30          0.26          0.23      </span></a>
<a class="sourceLine" id="cb215-28" data-line-number="28"><span class="co">##                                                                     (0.25)        (0.25)        (0.21)        (0.19)     </span></a>
<a class="sourceLine" id="cb215-29" data-line-number="29"><span class="co">## log_pop                                                                            1.03          1.03          1.61 *    </span></a>
<a class="sourceLine" id="cb215-30" data-line-number="30"><span class="co">##                                                                                   (0.09)        (0.09)        (0.33)     </span></a>
<a class="sourceLine" id="cb215-31" data-line-number="31"><span class="co">## c_gbr                                                                                            0.41 *        0.44      </span></a>
<a class="sourceLine" id="cb215-32" data-line-number="32"><span class="co">##                                                                                                 (0.18)        (0.20)     </span></a>
<a class="sourceLine" id="cb215-33" data-line-number="33"><span class="co">## v2x_polyarchy:log(risk_time_at_end)                                                                            0.25 **   </span></a>
<a class="sourceLine" id="cb215-34" data-line-number="34"><span class="co">##                                                                                                               (0.11)     </span></a>
<a class="sourceLine" id="cb215-35" data-line-number="35"><span class="co">## log_pop:log(risk_time_at_end)                                                                                  0.88 *    </span></a>
<a class="sourceLine" id="cb215-36" data-line-number="36"><span class="co">##                                                                                                               (0.05)     </span></a>
<a class="sourceLine" id="cb215-37" data-line-number="37"><span class="co">## -------------------------------------------------------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb215-38" data-line-number="38"><span class="co">## AIC                                    379.23        382.86        382.79        384.58        382.46        375.85      </span></a>
<a class="sourceLine" id="cb215-39" data-line-number="39"><span class="co">## R^2                                      0.01          0.01          0.01          0.01          0.01          0.01      </span></a>
<a class="sourceLine" id="cb215-40" data-line-number="40"><span class="co">## Max. R^2                                 0.04          0.04          0.04          0.04          0.04          0.04      </span></a>
<a class="sourceLine" id="cb215-41" data-line-number="41"><span class="co">## Num. events                             48            48            48            48            48            48         </span></a>
<a class="sourceLine" id="cb215-42" data-line-number="42"><span class="co">## Num. obs.                            11276         11276         11276         11245         11245         11245         </span></a>
<a class="sourceLine" id="cb215-43" data-line-number="43"><span class="co">## Missings                               738           738           738           769           769           769         </span></a>
<a class="sourceLine" id="cb215-44" data-line-number="44"><span class="co">## PH test                                  0.25          0.45          0.20          0.06          0.12          0.58      </span></a>
<a class="sourceLine" id="cb215-45" data-line-number="45"><span class="co">## =========================================================================================================================</span></a>
<a class="sourceLine" id="cb215-46" data-line-number="46"><span class="co">## *** p &lt; 0.001, ** p &lt; 0.01, * p &lt; 0.05</span></a></code></pre></div>

</div>
</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="logit.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="manejo-av.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "serif",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["adp-bookdown.pdf"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
