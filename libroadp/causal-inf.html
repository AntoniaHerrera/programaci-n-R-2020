<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 10 Inferencia causal | AnalizaR Datos Políticos</title>
  <meta name="description" content="Capítulo 10 Inferencia causal | AnalizaR Datos Políticos" />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 10 Inferencia causal | AnalizaR Datos Políticos" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 10 Inferencia causal | AnalizaR Datos Políticos" />
  
  
  

<meta name="author" content="Francisco Urdinez y Andrés Cruz Labrín (editores)" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link rel="prev" href="surv.html"/>
<link rel="next" href="adv-data.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<script>
% https://stackoverflow.com/a/4425214/8242291
var links = document.links;

for (var i = 0, linksLength = links.length; i < linksLength; i++) {

    if (links[i].hostname != window.location.hostname) {
        links[i].target = '_blank';
    }

}
</script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #2a211c;
    color: #bdae9d;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #bdae9d;  padding-left: 4px; }
div.sourceCode
  { color: #bdae9d; background-color: #2a211c; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ffff00; } /* Alert */
code span.an { color: #0066ff; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #44aa43; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #43a8ed; font-weight: bold; } /* ControlFlow */
code span.ch { color: #049b0a; } /* Char */
code span.cn { } /* Constant */
code span.co { color: #0066ff; font-weight: bold; font-style: italic; } /* Comment */
code span.do { color: #0066ff; font-style: italic; } /* Documentation */
code span.dt { text-decoration: underline; } /* DataType */
code span.dv { color: #44aa43; } /* DecVal */
code span.er { color: #ffff00; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #44aa43; } /* Float */
code span.fu { color: #ff9358; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #0066ff; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #43a8ed; font-weight: bold; } /* Keyword */
code span.op { } /* Operator */
code span.pp { font-weight: bold; } /* Preprocessor */
code span.sc { color: #049b0a; } /* SpecialChar */
code span.ss { color: #049b0a; } /* SpecialString */
code span.st { color: #049b0a; } /* String */
code span.va { } /* Variable */
code span.vs { color: #049b0a; } /* VerbatimString */
code span.wa { color: #ffff00; font-weight: bold; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><b><a href="./index.html"><img style="float: left; margin-right: 5px;" src="favicon.ico"></img>AnalizaR datos políticos</a></b></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introducción</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#inicio"><i class="fa fa-check"></i>Inicio</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#cómo-contribuir"><i class="fa fa-check"></i>¿Cómo contribuir?</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#sobre-los-autores-y-autoras"><i class="fa fa-check"></i>Sobre los autores y autoras</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#prefacio"><i class="fa fa-check"></i>Prefacio</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#agradecimientos"><i class="fa fa-check"></i>Agradecimientos</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#qué-esperar-del-libro"><i class="fa fa-check"></i>Qué esperar del libro</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#estructura-del-libro"><i class="fa fa-check"></i>Estructura del libro</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#cómo-utilizar-el-libro-en-un-curso-de-métodos"><i class="fa fa-check"></i>¿Cómo utilizar el libro en un curso de métodos?</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#primera-opción-curso-semestral-de-análisis-de-datos-políticos"><i class="fa fa-check"></i>Primera opción: Curso semestral de análisis de datos políticos</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#segunda-opción-curso-semestral-de-introducción-a-métodos-cuantitativos"><i class="fa fa-check"></i>Segunda opción: Curso semestral de introducción a métodos cuantitativos</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#prerrequisitos"><i class="fa fa-check"></i>Prerrequisitos</a></li>
</ul></li>
<li class="part"><span><b>I Introducción a R</b></span></li>
<li class="chapter" data-level="1" data-path="basic-r.html"><a href="basic-r.html"><i class="fa fa-check"></i><b>1</b> R Básico</a><ul>
<li class="chapter" data-level="1.1" data-path="basic-r.html"><a href="basic-r.html#instalación"><i class="fa fa-check"></i><b>1.1</b> Instalación</a><ul>
<li class="chapter" data-level="" data-path="basic-r.html"><a href="basic-r.html#r"><i class="fa fa-check"></i>R</a></li>
<li class="chapter" data-level="" data-path="basic-r.html"><a href="basic-r.html#rstudio"><i class="fa fa-check"></i>RStudio</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="basic-r.html"><a href="basic-r.html#consola"><i class="fa fa-check"></i><b>1.2</b> Consola</a></li>
<li class="chapter" data-level="1.3" data-path="basic-r.html"><a href="basic-r.html#script"><i class="fa fa-check"></i><b>1.3</b> Script</a></li>
<li class="chapter" data-level="1.4" data-path="basic-r.html"><a href="basic-r.html#objetos-y-funciones"><i class="fa fa-check"></i><b>1.4</b> Objetos (y funciones)</a><ul>
<li class="chapter" data-level="1.4.1" data-path="basic-r.html"><a href="basic-r.html#vectores"><i class="fa fa-check"></i><b>1.4.1</b> Vectores</a></li>
<li class="chapter" data-level="1.4.2" data-path="basic-r.html"><a href="basic-r.html#basic-r-functions"><i class="fa fa-check"></i><b>1.4.2</b> Functions</a></li>
<li class="chapter" data-level="1.4.3" data-path="basic-r.html"><a href="basic-r.html#archivos-gráficos-paquetes-ayuda"><i class="fa fa-check"></i><b>1.4.3</b> Archivos / gráficos / paquetes / ayuda</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>2</b> Manejo de datos</a><ul>
<li class="chapter" data-level="" data-path="data.html"><a href="data.html#los-paquetes-que-necesitas-instalar"><i class="fa fa-check"></i>Los paquetes que necesitas instalar</a></li>
<li class="chapter" data-level="2.1" data-path="data.html"><a href="data.html#introducción-al-manejo-de-datos"><i class="fa fa-check"></i><b>2.1</b> Introducción al manejo de datos</a><ul>
<li class="chapter" data-level="2.1.1" data-path="data.html"><a href="data.html#nuestra-base-de-datos"><i class="fa fa-check"></i><b>2.1.1</b> Nuestra base de datos</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="data.html"><a href="data.html#describiendo-una-base-de-datos"><i class="fa fa-check"></i><b>2.2</b> Describiendo una base de datos</a></li>
<li class="chapter" data-level="2.3" data-path="data.html"><a href="data.html#operaciones-básicas"><i class="fa fa-check"></i><b>2.3</b> Operaciones básicas</a><ul>
<li class="chapter" data-level="2.3.1" data-path="data.html"><a href="data.html#seleccionar-columnas"><i class="fa fa-check"></i><b>2.3.1</b> Seleccionar columnas</a></li>
<li class="chapter" data-level="2.3.2" data-path="data.html"><a href="data.html#renombra-las-columnas"><i class="fa fa-check"></i><b>2.3.2</b> Renombra las columnas</a></li>
<li class="chapter" data-level="2.3.3" data-path="data.html"><a href="data.html#filtrar-las-observaciones"><i class="fa fa-check"></i><b>2.3.3</b> Filtrar las observaciones</a></li>
<li class="chapter" data-level="2.3.4" data-path="data.html"><a href="data.html#cambiar-el-orden-de-una-base-de-datos"><i class="fa fa-check"></i><b>2.3.4</b> Cambiar el orden de una base de datos</a></li>
<li class="chapter" data-level="2.3.5" data-path="data.html"><a href="data.html#transformar-y-crear-variables"><i class="fa fa-check"></i><b>2.3.5</b> Transformar y crear variables</a></li>
<li class="chapter" data-level="2.3.6" data-path="data.html"><a href="data.html#resúmenes"><i class="fa fa-check"></i><b>2.3.6</b> Resúmenes</a></li>
<li class="chapter" data-level="2.3.7" data-path="data.html"><a href="data.html#resúmenes-por-grupo"><i class="fa fa-check"></i><b>2.3.7</b> Resúmenes por grupo</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="data.html"><a href="data.html#comandos-en-cadena"><i class="fa fa-check"></i><b>2.4</b> Comandos en cadena</a></li>
<li class="chapter" data-level="2.5" data-path="data.html"><a href="data.html#data-recodificar"><i class="fa fa-check"></i><b>2.5</b> Recodificar valores</a><ul>
<li class="chapter" data-level="2.5.1" data-path="data.html"><a href="data.html#pivoteo-de-datos-data-pivot"><i class="fa fa-check"></i><b>2.5.1</b> Pivoteo de datos {data-pivot}</a></li>
<li class="chapter" data-level="2.5.2" data-path="data.html"><a href="data.html#bases-de-datos-anchas-con-más-de-una-variable-de-interés"><i class="fa fa-check"></i><b>2.5.2</b> Bases de datos anchas con más de una variable de interés</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="dataviz.html"><a href="dataviz.html"><i class="fa fa-check"></i><b>3</b> Visualización de datos</a><ul>
<li class="chapter" data-level="" data-path="dataviz.html"><a href="dataviz.html#lecturas-sugeridas"><i class="fa fa-check"></i>Lecturas sugeridas</a></li>
<li class="chapter" data-level="" data-path="dataviz.html"><a href="dataviz.html#los-paquetes-que-necesitas-instalar-1"><i class="fa fa-check"></i>Los paquetes que necesitas instalar</a></li>
<li class="chapter" data-level="3.1" data-path="dataviz.html"><a href="dataviz.html#por-qué-visualizar-mis-datos"><i class="fa fa-check"></i><b>3.1</b> ¿Por qué visualizar mis datos?</a></li>
<li class="chapter" data-level="3.2" data-path="dataviz.html"><a href="dataviz.html#primeros-pasos"><i class="fa fa-check"></i><b>3.2</b> Primeros pasos</a><ul>
<li class="chapter" data-level="3.2.1" data-path="dataviz.html"><a href="dataviz.html#las-capas-del-universo-ggplotiano"><i class="fa fa-check"></i><b>3.2.1</b> Las capas del “universo ggplotiano”</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="dataviz.html"><a href="dataviz.html#ejemplo-aplicado-elecciones-locales-y-visualización-de-datos"><i class="fa fa-check"></i><b>3.3</b> Ejemplo aplicado: Elecciones locales y visualización de datos</a><ul>
<li class="chapter" data-level="3.3.1" data-path="dataviz.html"><a href="dataviz.html#gráfico-de-barras"><i class="fa fa-check"></i><b>3.3.1</b> Gráfico de barras</a></li>
<li class="chapter" data-level="3.3.2" data-path="dataviz.html"><a href="dataviz.html#gráfico-de-caja"><i class="fa fa-check"></i><b>3.3.2</b> Gráfico de caja</a></li>
<li class="chapter" data-level="3.3.3" data-path="dataviz.html"><a href="dataviz.html#histograma"><i class="fa fa-check"></i><b>3.3.3</b> Histograma</a></li>
<li class="chapter" data-level="3.3.4" data-path="dataviz.html"><a href="dataviz.html#relación-entre-las-variables"><i class="fa fa-check"></i><b>3.3.4</b> Relación entre las variables</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="dataviz.html"><a href="dataviz.html#para-continuar-aprendiendo"><i class="fa fa-check"></i><b>3.4</b> Para continuar aprendiendo</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="load.html"><a href="load.html"><i class="fa fa-check"></i><b>4</b> Carga de datos</a><ul>
<li class="chapter" data-level="" data-path="load.html"><a href="load.html#los-paquetes-que-necesitas-instalar-2"><i class="fa fa-check"></i>Los paquetes que necesitas instalar</a></li>
<li class="chapter" data-level="4.1" data-path="load.html"><a href="load.html#load-intro"><i class="fa fa-check"></i><b>4.1</b> Introducción</a></li>
<li class="chapter" data-level="4.2" data-path="load.html"><a href="load.html#carga-formatos"><i class="fa fa-check"></i><b>4.2</b> Diferentes formatos de bases de datos</a></li>
<li class="chapter" data-level="4.3" data-path="load.html"><a href="load.html#los-archivos-separados-por-delimitadores-.csv-y-.tsv"><i class="fa fa-check"></i><b>4.3</b> Los archivos separados por delimitadores (.csv y .tsv)</a><ul>
<li class="chapter" data-level="4.3.1" data-path="load.html"><a href="load.html#r-básico-utils"><i class="fa fa-check"></i><b>4.3.1</b> R básico: <code>utils</code></a></li>
<li class="chapter" data-level="4.3.2" data-path="load.html"><a href="load.html#load-r"><i class="fa fa-check"></i><b>4.3.2</b> Archivos creados con R (.Rdata y .rds)</a></li>
<li class="chapter" data-level="4.3.3" data-path="load.html"><a href="load.html#load-labels"><i class="fa fa-check"></i><b>4.3.3</b> Bases de datos con etiquetas (de Stata or SPSS)</a></li>
<li class="chapter" data-level="4.3.4" data-path="load.html"><a href="load.html#load-excel"><i class="fa fa-check"></i><b>4.3.4</b> Archivos de Excel</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="load.html"><a href="load.html#load-large"><i class="fa fa-check"></i><b>4.4</b> Grandes bases de datos tabulares</a></li>
</ul></li>
<li class="part"><span><b>II Modelos</b></span></li>
<li class="chapter" data-level="5" data-path="linear.html"><a href="linear.html"><i class="fa fa-check"></i><b>5</b> Modelos lineales</a><ul>
<li class="chapter" data-level="" data-path="linear.html"><a href="linear.html#lecturas-sugeridas-1"><i class="fa fa-check"></i>Lecturas sugeridas</a></li>
<li class="chapter" data-level="" data-path="linear.html"><a href="linear.html#los-paquetes-que-necesitas-instalar-3"><i class="fa fa-check"></i>Los paquetes que necesitas instalar</a></li>
<li class="chapter" data-level="" data-path="linear.html"><a href="linear.html#introducción-1"><i class="fa fa-check"></i>Introducción</a></li>
<li class="chapter" data-level="5.1" data-path="linear.html"><a href="linear.html#mínimos-cuadrados-ordinarios-en-r"><i class="fa fa-check"></i><b>5.1</b> Mínimos cuadrados ordinarios en R</a><ul>
<li class="chapter" data-level="5.1.1" data-path="linear.html"><a href="linear.html#cómo-obtener-estadísticas-descriptivas"><i class="fa fa-check"></i><b>5.1.1</b> Cómo obtener estadísticas descriptivas</a></li>
<li class="chapter" data-level="5.1.2" data-path="linear.html"><a href="linear.html#estadísticas-descriptivas-y-distribución-de-las-variables-en-el-modelo"><i class="fa fa-check"></i><b>5.1.2</b> Estadísticas descriptivas y distribución de las variables en el modelo</a></li>
<li class="chapter" data-level="5.1.3" data-path="linear.html"><a href="linear.html#matriz-de-correlación-de-variables-independientes"><i class="fa fa-check"></i><b>5.1.3</b> Matriz de correlación de variables independientes</a></li>
<li class="chapter" data-level="5.1.4" data-path="linear.html"><a href="linear.html#distribución-de-las-variables-de-interés"><i class="fa fa-check"></i><b>5.1.4</b> Distribución de las variables de interés</a></li>
<li class="chapter" data-level="5.1.5" data-path="linear.html"><a href="linear.html#relación-entre-la-variable-dependiente-e-independiente"><i class="fa fa-check"></i><b>5.1.5</b> Relación entre la variable dependiente e independiente</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="linear.html"><a href="linear.html#modelo-bivariado-regresión-lineal-simple"><i class="fa fa-check"></i><b>5.2</b> Modelo bivariado: regresión lineal simple</a><ul>
<li class="chapter" data-level="5.2.1" data-path="linear.html"><a href="linear.html#la-función-lm"><i class="fa fa-check"></i><b>5.2.1</b> La función <code>lm</code></a></li>
<li class="chapter" data-level="5.2.2" data-path="linear.html"><a href="linear.html#representación-gráfica"><i class="fa fa-check"></i><b>5.2.2</b> Representación gráfica</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="linear.html"><a href="linear.html#modelo-multivariado-regresión-múltiple"><i class="fa fa-check"></i><b>5.3</b> Modelo multivariado: regresión múltiple</a></li>
<li class="chapter" data-level="5.4" data-path="linear.html"><a href="linear.html#ajuste-del-modelo"><i class="fa fa-check"></i><b>5.4</b> Ajuste del modelo</a></li>
<li class="chapter" data-level="5.5" data-path="linear.html"><a href="linear.html#inferencia-en-los-modelos-lineales-múltiples"><i class="fa fa-check"></i><b>5.5</b> Inferencia en los modelos lineales múltiples</a></li>
<li class="chapter" data-level="5.6" data-path="linear.html"><a href="linear.html#testeando-los-supuestos-de-mco"><i class="fa fa-check"></i><b>5.6</b> Testeando los supuestos de MCO</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="case-sel.html"><a href="case-sel.html"><i class="fa fa-check"></i><b>6</b> Selección de casos basada en regresiones</a><ul>
<li class="chapter" data-level="" data-path="case-sel.html"><a href="case-sel.html#lecturas-sugeridas-2"><i class="fa fa-check"></i>Lecturas sugeridas</a></li>
<li class="chapter" data-level="" data-path="case-sel.html"><a href="case-sel.html#los-paquetes-que-necesitas-instalar-4"><i class="fa fa-check"></i>Los paquetes que necesitas instalar</a></li>
<li class="chapter" data-level="6.1" data-path="case-sel.html"><a href="case-sel.html#selección-de-estudios-de-casos"><i class="fa fa-check"></i><b>6.1</b> Selección de estudios de casos</a></li>
<li class="chapter" data-level="6.2" data-path="case-sel.html"><a href="case-sel.html#qué-estudio-de-caso-debería-seleccionar-para-la-investigación-cualitativa"><i class="fa fa-check"></i><b>6.2</b> ¿Qué estudio de caso debería seleccionar para la investigación cualitativa?</a><ul>
<li class="chapter" data-level="6.2.1" data-path="case-sel.html"><a href="case-sel.html#casos-típicos"><i class="fa fa-check"></i><b>6.2.1</b> Casos típicos</a></li>
<li class="chapter" data-level="6.2.2" data-path="case-sel.html"><a href="case-sel.html#los-valores-atípicos"><i class="fa fa-check"></i><b>6.2.2</b> Los valores atípicos</a></li>
<li class="chapter" data-level="6.2.3" data-path="case-sel.html"><a href="case-sel.html#casos-influyentes"><i class="fa fa-check"></i><b>6.2.3</b> Casos influyentes</a></li>
<li class="chapter" data-level="6.2.4" data-path="case-sel.html"><a href="case-sel.html#casos-extremos"><i class="fa fa-check"></i><b>6.2.4</b> Casos extremos</a></li>
<li class="chapter" data-level="6.2.5" data-path="case-sel.html"><a href="case-sel.html#casos-más-similares"><i class="fa fa-check"></i><b>6.2.5</b> Casos más similares</a></li>
<li class="chapter" data-level="6.2.6" data-path="case-sel.html"><a href="case-sel.html#casos-mas-diferentes"><i class="fa fa-check"></i><b>6.2.6</b> Casos mas diferentes</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="case-sel.html"><a href="case-sel.html#la-importancia-de-la-combinación-de-métodos"><i class="fa fa-check"></i><b>6.3</b> La importancia de la combinación de métodos</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="panel.html"><a href="panel.html"><i class="fa fa-check"></i><b>7</b> Datos de panel</a><ul>
<li class="chapter" data-level="" data-path="panel.html"><a href="panel.html#lecturas-sugeridas-3"><i class="fa fa-check"></i>Lecturas sugeridas</a></li>
<li class="chapter" data-level="" data-path="panel.html"><a href="panel.html#los-paquetes-que-necesitas-instalar-5"><i class="fa fa-check"></i>Los paquetes que necesitas instalar</a></li>
<li class="chapter" data-level="7.1" data-path="panel.html"><a href="panel.html#introducción-2"><i class="fa fa-check"></i><b>7.1</b> Introducción</a></li>
<li class="chapter" data-level="7.2" data-path="panel.html"><a href="panel.html#describiendo-la-base-de-datos-en-panel"><i class="fa fa-check"></i><b>7.2</b> Describiendo la base de datos en panel</a><ul>
<li class="chapter" data-level="7.2.1" data-path="panel.html"><a href="panel.html#opción-a.-gráfico-de-líneas"><i class="fa fa-check"></i><b>7.2.1</b> Opción A. Gráfico de líneas</a></li>
<li class="chapter" data-level="7.2.2" data-path="panel.html"><a href="panel.html#option-b.-gráfico-de-cajas"><i class="fa fa-check"></i><b>7.2.2</b> Option B. Gráfico de cajas</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="panel.html"><a href="panel.html#modelización-de-la-variación-a-nivel-de-grupo"><i class="fa fa-check"></i><b>7.3</b> Modelización de la variación a nivel de grupo</a></li>
<li class="chapter" data-level="7.4" data-path="panel.html"><a href="panel.html#efectos-fijos-vs.-efectos-aleatorios"><i class="fa fa-check"></i><b>7.4</b> Efectos fijos vs. efectos aleatorios</a><ul>
<li class="chapter" data-level="7.4.1" data-path="panel.html"><a href="panel.html#test-de-hausman"><i class="fa fa-check"></i><b>7.4.1</b> Test de Hausman</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="panel.html"><a href="panel.html#testeando-raíces-unitarias"><i class="fa fa-check"></i><b>7.5</b> Testeando raíces unitarias</a><ul>
<li class="chapter" data-level="7.5.1" data-path="panel.html"><a href="panel.html#creación-de-variables-rezagadas-lags-y-variables-prospectivas-leads"><i class="fa fa-check"></i><b>7.5.1</b> Creación de variables rezagadas (<em>lags</em>) y variables prospectivas (<em>leads</em>)</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="panel.html"><a href="panel.html#errores-estándar-robustos-corregidos-para-panel"><i class="fa fa-check"></i><b>7.6</b> Errores estándar robustos corregidos para panel</a><ul>
<li class="chapter" data-level="7.6.1" data-path="panel.html"><a href="panel.html#errores-estándar-robustos-1"><i class="fa fa-check"></i><b>7.6.1</b> Errores estándar robustos</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="logit.html"><a href="logit.html"><i class="fa fa-check"></i><b>8</b> Modelos logísticos</a><ul>
<li class="chapter" data-level="" data-path="logit.html"><a href="logit.html#lecturas-sugeridas-4"><i class="fa fa-check"></i>Lecturas sugeridas</a></li>
<li class="chapter" data-level="" data-path="logit.html"><a href="logit.html#los-paquetes-que-necesitas-instalar-6"><i class="fa fa-check"></i>Los paquetes que necesitas instalar</a></li>
<li class="chapter" data-level="8.1" data-path="logit.html"><a href="logit.html#introducción-3"><i class="fa fa-check"></i><b>8.1</b> Introducción</a></li>
<li class="chapter" data-level="8.2" data-path="logit.html"><a href="logit.html#uso-de-los-modelos-logísticos"><i class="fa fa-check"></i><b>8.2</b> Uso de los modelos logísticos</a></li>
<li class="chapter" data-level="8.3" data-path="logit.html"><a href="logit.html#cómo-se-estiman-las-probabilidades"><i class="fa fa-check"></i><b>8.3</b> ¿Cómo se estiman las probabilidades?</a></li>
<li class="chapter" data-level="8.4" data-path="logit.html"><a href="logit.html#estimación-de-los-modelos"><i class="fa fa-check"></i><b>8.4</b> Estimación de los modelos</a></li>
<li class="chapter" data-level="8.5" data-path="logit.html"><a href="logit.html#creando-tablas"><i class="fa fa-check"></i><b>8.5</b> Creando tablas</a></li>
<li class="chapter" data-level="8.6" data-path="logit.html"><a href="logit.html#representación-visual-de-los-resultados"><i class="fa fa-check"></i><b>8.6</b> Representación visual de los resultados</a><ul>
<li class="chapter" data-level="8.6.1" data-path="logit.html"><a href="logit.html#visualización-de-las-interacciones-entre-las-variables"><i class="fa fa-check"></i><b>8.6.1</b> Visualización de las interacciones entre las variables</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="logit.html"><a href="logit.html#medidas-para-evaluar-el-ajuste-de-los-modelos"><i class="fa fa-check"></i><b>8.7</b> Medidas para evaluar el ajuste de los modelos</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="surv.html"><a href="surv.html"><i class="fa fa-check"></i><b>9</b> Modelos de supervivencia</a><ul>
<li class="chapter" data-level="" data-path="surv.html"><a href="surv.html#lecturas-sugeridas-5"><i class="fa fa-check"></i>Lecturas sugeridas</a></li>
<li class="chapter" data-level="" data-path="surv.html"><a href="surv.html#los-paquetes-que-necesitas-instalar-7"><i class="fa fa-check"></i>Los paquetes que necesitas instalar</a></li>
<li class="chapter" data-level="9.1" data-path="surv.html"><a href="surv.html#introducción-4"><i class="fa fa-check"></i><b>9.1</b> Introducción</a></li>
<li class="chapter" data-level="9.2" data-path="surv.html"><a href="surv.html#cómo-interpretamos-las-tasas-de-riesgo"><i class="fa fa-check"></i><b>9.2</b> ¿Cómo interpretamos las tasas de riesgo?</a></li>
<li class="chapter" data-level="9.3" data-path="surv.html"><a href="surv.html#el-modelo-cox-de-riesgos-proporcionales"><i class="fa fa-check"></i><b>9.3</b> El modelo Cox de riesgos proporcionales</a></li>
<li class="chapter" data-level="9.4" data-path="surv.html"><a href="surv.html#estimación-de-los-modelos-de-cox-en-r"><i class="fa fa-check"></i><b>9.4</b> Estimación de los modelos de Cox en R</a></li>
<li class="chapter" data-level="9.5" data-path="surv.html"><a href="surv.html#modelos-de-supervivencia-e-interpretación-sus-coeficientes-como-hazard-ratios."><i class="fa fa-check"></i><b>9.5</b> Modelos de supervivencia e interpretación sus coeficientes como Hazard Ratios.</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="causal-inf.html"><a href="causal-inf.html"><i class="fa fa-check"></i><b>10</b> Inferencia causal</a><ul>
<li class="chapter" data-level="" data-path="causal-inf.html"><a href="causal-inf.html#lecturas-sugeridas-6"><i class="fa fa-check"></i>Lecturas sugeridas</a></li>
<li class="chapter" data-level="" data-path="causal-inf.html"><a href="causal-inf.html#los-paquetes-que-necesitas-instalar-8"><i class="fa fa-check"></i>Los paquetes que necesitas instalar</a></li>
<li class="chapter" data-level="10.1" data-path="causal-inf.html"><a href="causal-inf.html#introducción-5"><i class="fa fa-check"></i><b>10.1</b> Introducción</a></li>
<li class="chapter" data-level="10.2" data-path="causal-inf.html"><a href="causal-inf.html#causalidad-y-gráficos-causales"><i class="fa fa-check"></i><b>10.2</b> Causalidad y gráficos causales</a></li>
<li class="chapter" data-level="10.3" data-path="causal-inf.html"><a href="causal-inf.html#midiendo-efectos-causales"><i class="fa fa-check"></i><b>10.3</b> Midiendo efectos causales</a></li>
<li class="chapter" data-level="10.4" data-path="causal-inf.html"><a href="causal-inf.html#dags-y-asociaciones-estadísticas"><i class="fa fa-check"></i><b>10.4</b> DAGs y asociaciones estadísticas</a></li>
<li class="chapter" data-level="10.5" data-path="causal-inf.html"><a href="causal-inf.html#puertas-traseras-y-cálculos-hacer"><i class="fa fa-check"></i><b>10.5</b> Puertas traseras y cálculos “<em>hacer</em>”</a></li>
<li class="chapter" data-level="10.6" data-path="causal-inf.html"><a href="causal-inf.html#dibujar-y-analizar-dags"><i class="fa fa-check"></i><b>10.6</b> Dibujar y analizar DAGs</a><ul>
<li class="chapter" data-level="10.6.1" data-path="causal-inf.html"><a href="causal-inf.html#dibujar-un-dag-con-dagitty"><i class="fa fa-check"></i><b>10.6.1</b> Dibujar un DAG con DAGitty</a></li>
<li class="chapter" data-level="10.6.2" data-path="causal-inf.html"><a href="causal-inf.html#encontrar-sets-de-ajuste-con-dagitty"><i class="fa fa-check"></i><b>10.6.2</b> Encontrar sets de ajuste con DAGitty</a></li>
<li class="chapter" data-level="10.6.3" data-path="causal-inf.html"><a href="causal-inf.html#diseñar-dags-en-r"><i class="fa fa-check"></i><b>10.6.3</b> Diseñar DAGs en R</a></li>
<li class="chapter" data-level="10.6.4" data-path="causal-inf.html"><a href="causal-inf.html#encontrar-caminos-y-sets-de-ajustes-con-r"><i class="fa fa-check"></i><b>10.6.4</b> Encontrar caminos y sets de ajustes con R</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="causal-inf.html"><a href="causal-inf.html#haciendo-ajustes-causales"><i class="fa fa-check"></i><b>10.7</b> Haciendo ajustes causales</a><ul>
<li class="chapter" data-level="10.7.1" data-path="causal-inf.html"><a href="causal-inf.html#datos-de-redes-para-mosquitos"><i class="fa fa-check"></i><b>10.7.1</b> Datos de redes para mosquitos</a></li>
<li class="chapter" data-level="10.7.2" data-path="causal-inf.html"><a href="causal-inf.html#verificar-las-independencias-condicionales"><i class="fa fa-check"></i><b>10.7.2</b> Verificar las independencias condicionales</a></li>
<li class="chapter" data-level="10.7.3" data-path="causal-inf.html"><a href="causal-inf.html#encuentra-el-set-de-ajuste"><i class="fa fa-check"></i><b>10.7.3</b> Encuentra el set de ajuste</a></li>
<li class="chapter" data-level="10.7.4" data-path="causal-inf.html"><a href="causal-inf.html#estimación-ingenua-no-ajustada"><i class="fa fa-check"></i><b>10.7.4</b> Estimación ingenua no ajustada</a></li>
<li class="chapter" data-level="10.7.5" data-path="causal-inf.html"><a href="causal-inf.html#regresiones"><i class="fa fa-check"></i><b>10.7.5</b> Regresiones</a></li>
<li class="chapter" data-level="10.7.6" data-path="causal-inf.html"><a href="causal-inf.html#matching"><i class="fa fa-check"></i><b>10.7.6</b> Matching</a></li>
<li class="chapter" data-level="10.7.7" data-path="causal-inf.html"><a href="causal-inf.html#ponderación-de-probabilidad-inversa"><i class="fa fa-check"></i><b>10.7.7</b> Ponderación de probabilidad inversa</a></li>
<li class="chapter" data-level="10.7.8" data-path="causal-inf.html"><a href="causal-inf.html#comparando-todos-los-métodos"><i class="fa fa-check"></i><b>10.7.8</b> Comparando todos los métodos</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="causal-inf.html"><a href="causal-inf.html#cconsejos-finales"><i class="fa fa-check"></i><b>10.8</b> CConsejos finales</a></li>
</ul></li>
<li class="part"><span><b>III Aplicaciones</b></span></li>
<li class="chapter" data-level="11" data-path="adv-data.html"><a href="adv-data.html"><i class="fa fa-check"></i><b>11</b> Manejo avanzado de datos políticos</a><ul>
<li class="chapter" data-level="" data-path="adv-data.html"><a href="adv-data.html#lecturas-sugeridas-7"><i class="fa fa-check"></i>Lecturas sugeridas</a></li>
<li class="chapter" data-level="" data-path="adv-data.html"><a href="adv-data.html#los-paquetes-que-necesitas-instalar-9"><i class="fa fa-check"></i>Los paquetes que necesitas instalar</a></li>
<li class="chapter" data-level="11.1" data-path="adv-data.html"><a href="adv-data.html#introducción-6"><i class="fa fa-check"></i><b>11.1</b> Introducción</a></li>
<li class="chapter" data-level="11.2" data-path="adv-data.html"><a href="adv-data.html#uniendo-bases-de-datos"><i class="fa fa-check"></i><b>11.2</b> Uniendo bases de datos</a></li>
<li class="chapter" data-level="11.3" data-path="adv-data.html"><a href="adv-data.html#estandarizando-los-códigos-de-país"><i class="fa fa-check"></i><b>11.3</b> Estandarizando los códigos de país</a></li>
<li class="chapter" data-level="11.4" data-path="adv-data.html"><a href="adv-data.html#la-unión-borrosa-o-inexacta-de-los-datos"><i class="fa fa-check"></i><b>11.4</b> La unión borrosa o inexacta de los datos</a></li>
<li class="chapter" data-level="11.5" data-path="adv-data.html"><a href="adv-data.html#gestión-de-valores-perdidos"><i class="fa fa-check"></i><b>11.5</b> Gestión de valores perdidos</a><ul>
<li class="chapter" data-level="11.5.1" data-path="adv-data.html"><a href="adv-data.html#tipos-de-valores-perdidos"><i class="fa fa-check"></i><b>11.5.1</b> Tipos de valores perdidos</a></li>
<li class="chapter" data-level="11.5.2" data-path="adv-data.html"><a href="adv-data.html#descripción-de-los-valores-que-faltan-en-la-base-de-datos"><i class="fa fa-check"></i><b>11.5.2</b> Descripción de los valores que faltan en la base de datos</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="adv-data.html"><a href="adv-data.html#imputación-de-valores-perdidos"><i class="fa fa-check"></i><b>11.6</b> Imputación de valores perdidos</a><ul>
<li class="chapter" data-level="11.6.1" data-path="adv-data.html"><a href="adv-data.html#regresiones-luego-de-imputar-datos"><i class="fa fa-check"></i><b>11.6.1</b> Regresiones luego de imputar datos</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="web-mining.html"><a href="web-mining.html"><i class="fa fa-check"></i><b>12</b> Web Scraping</a><ul>
<li class="chapter" data-level="" data-path="web-mining.html"><a href="web-mining.html#lecturas-sugeridas-8"><i class="fa fa-check"></i>Lecturas sugeridas</a></li>
<li class="chapter" data-level="" data-path="web-mining.html"><a href="web-mining.html#los-paquetes-que-necesitas-instalar-10"><i class="fa fa-check"></i>Los paquetes que necesitas instalar</a></li>
<li class="chapter" data-level="12.1" data-path="web-mining.html"><a href="web-mining.html#introducción-7"><i class="fa fa-check"></i><b>12.1</b> Introducción</a></li>
<li class="chapter" data-level="12.2" data-path="web-mining.html"><a href="web-mining.html#formas-de-hacer-web-scraping"><i class="fa fa-check"></i><b>12.2</b> Formas de hacer web scraping</a><ul>
<li class="chapter" data-level="12.2.1" data-path="web-mining.html"><a href="web-mining.html#estándar-de-exclusión-de-robot"><i class="fa fa-check"></i><b>12.2.1</b> Estándar de exclusión de robot</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="web-mining.html"><a href="web-mining.html#web-scraping-en-r"><i class="fa fa-check"></i><b>12.3</b> Web scraping en R</a><ul>
<li class="chapter" data-level="12.3.1" data-path="web-mining.html"><a href="web-mining.html#ejemplo-aplicado-los-comunicados-de-prensa-de-la-organización-de-estados-americanos-oea"><i class="fa fa-check"></i><b>12.3.1</b> Ejemplo aplicado: los comunicados de prensa de la Organización de Estados Americanos (OEA)</a></li>
<li class="chapter" data-level="12.3.2" data-path="web-mining.html"><a href="web-mining.html#caraga-el-html-para-trabajar-con-r"><i class="fa fa-check"></i><b>12.3.2</b> Caraga el html para trabajar con R</a></li>
<li class="chapter" data-level="12.3.3" data-path="web-mining.html"><a href="web-mining.html#extraer-la-información-con-html_nodes-html_text"><i class="fa fa-check"></i><b>12.3.3</b> Extraer la información con <code>html_nodes()</code> + <code>html_text()</code></a></li>
<li class="chapter" data-level="12.3.4" data-path="web-mining.html"><a href="web-mining.html#iteraciones"><i class="fa fa-check"></i><b>12.3.4</b> Iteraciones</a></li>
<li class="chapter" data-level="12.3.5" data-path="web-mining.html"><a href="web-mining.html#funciones-personalizadas-recetas"><i class="fa fa-check"></i><b>12.3.5</b> Funciones personalizadas (recetas)</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="web-mining.html"><a href="web-mining.html#usando-apis-y-extrayendo-datos-de-twitter"><i class="fa fa-check"></i><b>12.4</b> Usando APIs y extrayendo datos de Twitter</a><ul>
<li class="chapter" data-level="12.4.1" data-path="web-mining.html"><a href="web-mining.html#buscar-una-palabra-clave"><i class="fa fa-check"></i><b>12.4.1</b> Buscar una palabra clave</a></li>
<li class="chapter" data-level="12.4.2" data-path="web-mining.html"><a href="web-mining.html#buscar-una-frase"><i class="fa fa-check"></i><b>12.4.2</b> Buscar una frase</a></li>
<li class="chapter" data-level="12.4.3" data-path="web-mining.html"><a href="web-mining.html#descargando-características-relacionadas-con-los-usuarios-de-twitter"><i class="fa fa-check"></i><b>12.4.3</b> Descargando características relacionadas con los usuarios de Twitter</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="qta.html"><a href="qta.html"><i class="fa fa-check"></i><b>13</b> Análisis cuantitativo de textos políticos</a><ul>
<li class="chapter" data-level="" data-path="qta.html"><a href="qta.html#lecturas-recomendadas"><i class="fa fa-check"></i>Lecturas recomendadas</a></li>
<li class="chapter" data-level="" data-path="qta.html"><a href="qta.html#paquetes-que-necesitas-instalar"><i class="fa fa-check"></i>Paquetes que necesitas instalar</a></li>
<li class="chapter" data-level="13.1" data-path="qta.html"><a href="qta.html#sqta1"><i class="fa fa-check"></i><b>13.1</b> Análisis de hashtags políticos</a><ul>
<li class="chapter" data-level="13.1.1" data-path="qta.html"><a href="qta.html#exploración-de-datos-de-twitter"><i class="fa fa-check"></i><b>13.1.1</b> Exploración de datos de Twitter</a></li>
<li class="chapter" data-level="13.1.2" data-path="qta.html"><a href="qta.html#diagnóstico-visual"><i class="fa fa-check"></i><b>13.1.2</b> Diagnóstico visual</a></li>
<li class="chapter" data-level="13.1.3" data-path="qta.html"><a href="qta.html#hashtags-más-utilizados"><i class="fa fa-check"></i><b>13.1.3</b> Hashtags más utilizados</a></li>
<li class="chapter" data-level="13.1.4" data-path="qta.html"><a href="qta.html#wordclouds-nubes-de-palabras"><i class="fa fa-check"></i><b>13.1.4</b> Wordclouds (Nubes de palabras)</a></li>
<li class="chapter" data-level="13.1.5" data-path="qta.html"><a href="qta.html#nubes-de-palabras-por-grupos"><i class="fa fa-check"></i><b>13.1.5</b> Nubes de palabras por grupos</a></li>
<li class="chapter" data-level="13.1.6" data-path="qta.html"><a href="qta.html#gráficos-de-barras"><i class="fa fa-check"></i><b>13.1.6</b> Gráficos de barras</a></li>
<li class="chapter" data-level="13.1.7" data-path="qta.html"><a href="qta.html#variación-temporal-en-el-uso-de-hashtags"><i class="fa fa-check"></i><b>13.1.7</b> Variación temporal en el uso de hashtags</a></li>
<li class="chapter" data-level="13.1.8" data-path="qta.html"><a href="qta.html#para-resumir"><i class="fa fa-check"></i><b>13.1.8</b> Para resumir</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="qta.html"><a href="qta.html#wordfish"><i class="fa fa-check"></i><b>13.2</b> Wordfish</a><ul>
<li class="chapter" data-level="13.2.1" data-path="qta.html"><a href="qta.html#inspección-y-limpieza-de-datos"><i class="fa fa-check"></i><b>13.2.1</b> Inspección y limpieza de datos</a></li>
<li class="chapter" data-level="13.2.2" data-path="qta.html"><a href="qta.html#pre-procesamiento"><i class="fa fa-check"></i><b>13.2.2</b> Pre-procesamiento</a></li>
<li class="chapter" data-level="13.2.3" data-path="qta.html"><a href="qta.html#sqta2"><i class="fa fa-check"></i><b>13.2.3</b> Wordfish</a></li>
<li class="chapter" data-level="13.2.4" data-path="qta.html"><a href="qta.html#qué-aprendimos-de-wordfish"><i class="fa fa-check"></i><b>13.2.4</b> ¿Qué aprendimos de Wordfish?</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="qta.html"><a href="qta.html#sqta3"><i class="fa fa-check"></i><b>13.3</b> Structural Topic Modeling (STM)</a><ul>
<li class="chapter" data-level="13.3.1" data-path="qta.html"><a href="qta.html#pre-procesamiento-1"><i class="fa fa-check"></i><b>13.3.1</b> Pre-procesamiento</a></li>
<li class="chapter" data-level="13.3.2" data-path="qta.html"><a href="qta.html#diagnósticos"><i class="fa fa-check"></i><b>13.3.2</b> Diagnósticos</a></li>
<li class="chapter" data-level="13.3.3" data-path="qta.html"><a href="qta.html#análisis"><i class="fa fa-check"></i><b>13.3.3</b> Análisis</a></li>
<li class="chapter" data-level="13.3.4" data-path="qta.html"><a href="qta.html#observaciones-finales"><i class="fa fa-check"></i><b>13.3.4</b> Observaciones finales</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="networks.html"><a href="networks.html"><i class="fa fa-check"></i><b>14</b> Análisis de redes</a><ul>
<li class="chapter" data-level="" data-path="networks.html"><a href="networks.html#lecturas-sugeridas-9"><i class="fa fa-check"></i>Lecturas sugeridas</a></li>
<li class="chapter" data-level="" data-path="networks.html"><a href="networks.html#los-paquetes-que-necesitas-instalar-11"><i class="fa fa-check"></i>Los paquetes que necesitas instalar</a></li>
<li class="chapter" data-level="14.1" data-path="networks.html"><a href="networks.html#introducción-8"><i class="fa fa-check"></i><b>14.1</b> Introducción</a></li>
<li class="chapter" data-level="14.2" data-path="networks.html"><a href="networks.html#conceptos-básicos-en-una-red"><i class="fa fa-check"></i><b>14.2</b> Conceptos básicos en una red</a><ul>
<li class="chapter" data-level="14.2.1" data-path="networks.html"><a href="networks.html#nodos-y-enlaces"><i class="fa fa-check"></i><b>14.2.1</b> Nodos y enlaces</a></li>
<li class="chapter" data-level="14.2.2" data-path="networks.html"><a href="networks.html#matriz-de-adyacencia"><i class="fa fa-check"></i><b>14.2.2</b> Matriz de adyacencia</a></li>
<li class="chapter" data-level="14.2.3" data-path="networks.html"><a href="networks.html#pesos-y-direcciones"><i class="fa fa-check"></i><b>14.2.3</b> Pesos y direcciones</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="networks.html"><a href="networks.html#bases-de-datos-de-la-red"><i class="fa fa-check"></i><b>14.3</b> Bases de datos de la red</a></li>
<li class="chapter" data-level="14.4" data-path="networks.html"><a href="networks.html#presentación-gráfica-de-una-red"><i class="fa fa-check"></i><b>14.4</b> Presentación gráfica de una red</a></li>
<li class="chapter" data-level="14.5" data-path="networks.html"><a href="networks.html#medidas-de-centralidad"><i class="fa fa-check"></i><b>14.5</b> Medidas de centralidad</a><ul>
<li class="chapter" data-level="14.5.1" data-path="networks.html"><a href="networks.html#grado"><i class="fa fa-check"></i><b>14.5.1</b> Grado</a></li>
<li class="chapter" data-level="14.5.2" data-path="networks.html"><a href="networks.html#centralidad-del-eigenvector"><i class="fa fa-check"></i><b>14.5.2</b> Centralidad del eigenvector</a></li>
<li class="chapter" data-level="14.5.3" data-path="networks.html"><a href="networks.html#centralidad-de-intermediación-betweenness"><i class="fa fa-check"></i><b>14.5.3</b> Centralidad de intermediación (<em>betweenness</em>)</a></li>
<li class="chapter" data-level="14.5.4" data-path="networks.html"><a href="networks.html#cercanía"><i class="fa fa-check"></i><b>14.5.4</b> Cercanía</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="networks.html"><a href="networks.html#aplicación-en-r"><i class="fa fa-check"></i><b>14.6</b> Aplicación en R</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="indexes.html"><a href="indexes.html"><i class="fa fa-check"></i><b>15</b> Análisis de componentes principales</a><ul>
<li class="chapter" data-level="" data-path="indexes.html"><a href="indexes.html#lecturas-sugeridas-10"><i class="fa fa-check"></i>Lecturas sugeridas</a></li>
<li class="chapter" data-level="" data-path="indexes.html"><a href="indexes.html#los-paquetes-que-necesitas-instalar-12"><i class="fa fa-check"></i>Los paquetes que necesitas instalar</a></li>
<li class="chapter" data-level="15.1" data-path="indexes.html"><a href="indexes.html#introducción-9"><i class="fa fa-check"></i><b>15.1</b> Introducción</a><ul>
<li class="chapter" data-level="15.1.1" data-path="indexes.html"><a href="indexes.html#conceptos-medidas-y-validez"><i class="fa fa-check"></i><b>15.1.1</b> Conceptos, medidas y validez</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="indexes.html"><a href="indexes.html#cómo-funciona-el-análisis-de-componentes-principales"><i class="fa fa-check"></i><b>15.2</b> Cómo funciona el Análisis de Componentes Principales</a></li>
<li class="chapter" data-level="15.3" data-path="indexes.html"><a href="indexes.html#nociones-básicas-en-r"><i class="fa fa-check"></i><b>15.3</b> Nociones básicas en R</a></li>
<li class="chapter" data-level="15.4" data-path="indexes.html"><a href="indexes.html#dimensionalidad-del-concepto"><i class="fa fa-check"></i><b>15.4</b> Dimensionalidad del concepto</a></li>
<li class="chapter" data-level="15.5" data-path="indexes.html"><a href="indexes.html#variación-del-concepto"><i class="fa fa-check"></i><b>15.5</b> Variación del concepto</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="maps.html"><a href="maps.html"><i class="fa fa-check"></i><b>16</b> Mapas y datos espaciales</a><ul>
<li class="chapter" data-level="" data-path="maps.html"><a href="maps.html#lecturas-sugeridas-11"><i class="fa fa-check"></i>Lecturas sugeridas</a></li>
<li class="chapter" data-level="" data-path="maps.html"><a href="maps.html#los-paquetes-que-necesitas-instalar-13"><i class="fa fa-check"></i>Los paquetes que necesitas instalar</a></li>
<li class="chapter" data-level="16.1" data-path="maps.html"><a href="maps.html#introducción-10"><i class="fa fa-check"></i><b>16.1</b> Introducción</a><ul>
<li class="chapter" data-level="16.1.1" data-path="maps.html"><a href="maps.html#datos-espaciales-qué-son"><i class="fa fa-check"></i><b>16.1.1</b> Datos espaciales: ¿qué son?</a></li>
<li class="chapter" data-level="16.1.2" data-path="maps.html"><a href="maps.html#estructura-de-datos-espaciales"><i class="fa fa-check"></i><b>16.1.2</b> Estructura de datos espaciales</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="maps.html"><a href="maps.html#datos-espaciales-en-r"><i class="fa fa-check"></i><b>16.2</b> Datos espaciales en R</a><ul>
<li class="chapter" data-level="16.2.1" data-path="maps.html"><a href="maps.html#características-simples-en-r"><i class="fa fa-check"></i><b>16.2.1</b> Características simples en R</a></li>
<li class="chapter" data-level="16.2.2" data-path="maps.html"><a href="maps.html#estructura"><i class="fa fa-check"></i><b>16.2.2</b> Estructura</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="maps.html"><a href="maps.html#gestión-de-datos-espaciales"><i class="fa fa-check"></i><b>16.3</b> Gestión de Datos Espaciales</a><ul>
<li class="chapter" data-level="16.3.1" data-path="maps.html"><a href="maps.html#modificaciones"><i class="fa fa-check"></i><b>16.3.1</b> Modificaciones</a></li>
<li class="chapter" data-level="16.3.2" data-path="maps.html"><a href="maps.html#añade-datos-de-otras-bases-de-datos-con-left_join"><i class="fa fa-check"></i><b>16.3.2</b> Añade datos de otras bases de datos con <code>left_join()</code></a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="maps.html"><a href="maps.html#mapeo"><i class="fa fa-check"></i><b>16.4</b> Mapeo</a><ul>
<li class="chapter" data-level="16.4.1" data-path="maps.html"><a href="maps.html#generando-centroides"><i class="fa fa-check"></i><b>16.4.1</b> Generando centroides</a></li>
<li class="chapter" data-level="16.4.2" data-path="maps.html"><a href="maps.html#mapeando-variables"><i class="fa fa-check"></i><b>16.4.2</b> Mapeando variables</a></li>
<li class="chapter" data-level="16.4.3" data-path="maps.html"><a href="maps.html#mapeando-puntos"><i class="fa fa-check"></i><b>16.4.3</b> Mapeando puntos</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="maps.html"><a href="maps.html#inferencia-a-partir-de-datos-espaciales"><i class="fa fa-check"></i><b>16.5</b> Inferencia a partir de datos espaciales</a><ul>
<li class="chapter" data-level="16.5.1" data-path="maps.html"><a href="maps.html#indicador-local-de-asociación-espacial-lisa-por-sus-siglas-en-inglés"><i class="fa fa-check"></i><b>16.5.1</b> Indicador local de asociación espacial (LISA, por sus siglas en inglés)</a></li>
<li class="chapter" data-level="16.5.2" data-path="maps.html"><a href="maps.html#matriz-de-pesos-espaciales"><i class="fa fa-check"></i><b>16.5.2</b> Matriz de pesos espaciales</a></li>
<li class="chapter" data-level="16.5.3" data-path="maps.html"><a href="maps.html#i-de-moran"><i class="fa fa-check"></i><b>16.5.3</b> I de Moran</a></li>
<li class="chapter" data-level="" data-path="maps.html"><a href="maps.html#comentarios-finales-referencias-para-un-mejor-análisis-de-datos-espaciales"><i class="fa fa-check"></i>Comentarios finales: Referencias para un mejor análisis de datos espaciales</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Referencias</b></span></li>
<li class="chapter" data-level="17" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i><b>17</b> Referencias</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">AnalizaR Datos Políticos</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="causal-inf" class="section level1">
<h1><span class="header-section-number">Capítulo 10</span> Inferencia causal</h1>
<p>Andrew Heiss<a href="#fn43" class="footnote-ref" id="fnref43"><sup>43</sup></a></p>
<div id="lecturas-sugeridas-6" class="section level3 unnumbered">
<h3>Lecturas sugeridas</h3>
<ul>
<li><p>Elwert, F. (2013). Graphical Causal Models. In S. L. Morgan (Ed.), <em>Handbook of Causal Analysis for Social Research</em> (pp. 245–273). Springer.</p></li>
<li><p>Hernán, M. A., &amp; Robbins, J. M. (2020). <em>Causal Inference: What If</em>. CRC Press.</p></li>
<li><p>Morgan, S. L., &amp; Winship, C. (2007). <em>Counterfactuals and Causal Inference: Methods and Principles for Social Research</em>. Cambridge University Press.</p></li>
<li><p>Pearl, J., Glymour, M., &amp; Jewell, N. P. (2016). <em>Causal Inference in Statistics: A Primer</em>. Wiley.</p></li>
<li><p>Pearl, J., &amp; Mackenzie, D. (2018). <em>The Book of Why: The New Science of Cause and Effect</em>. Basic Books.</p></li>
<li><p>Rohrer, J. M. (2018). Thinking Clearly About Correlations and Causation: Graphical Causal Models for Observational Data. <em>Advances in Methods and Practices in Psychological Science</em>, <em>1</em>(1), 27–42.</p></li>
</ul>
</div>
<div id="los-paquetes-que-necesitas-instalar-8" class="section level3 unnumbered">
<h3>Los paquetes que necesitas instalar</h3>
<ul>
<li><code>tidyverse</code>, <code>ggdag</code>, <code>dagitty</code>, <code>MatchIt</code>, <code>broom</code>, <code>texreg</code></li>
</ul>
</div>
<div id="introducción-5" class="section level2">
<h2><span class="header-section-number">10.1</span> Introducción</h2>
<p>Una de las frases más repetidas en cualquier clase de estadística introductoria es la advertencia de que “la correlación no es causalidad”. En las investigaciones de Ciencia Política, sin embargo, a menudo nos preocupamos por las causas de los fenómenos sociales y políticos. ¿El gasto del gobierno en educación disminuye la desigualdad social? ¿El aumento del poder ejecutivo causa el colapso de un régimen? ¿El aumento de la fragmentación étnica causa genocidio? ¿Los proyectos de desarrollo internacional reducen la pobreza o aumentan la salud? Estas son preguntas importantes, pero usando los métodos estadísticos que se tratan en este libro, sólo podemos hablar de estas relaciones usando un lenguaje asociativo. En el capítulo 6 encontramos que los gastos en educación están asociados con el aumento de la desigualdad, y en el capítulo 9 encontramos que el aumento de la concentración del poder ejecutivo está asociado con una menor probabilidad de que el régimen se derrumbe. Aunque tuvimos mucho cuidado de no utilizar un lenguaje causal al interpretar estos coeficientes de regresión, en última instancia nos preocupa la causalidad, especialmente si tenemos la capacidad de influir en la política. Si una intervención de desarrollo <em>causa</em> mejoras en la salud, sería valioso desplegarla a gran escala.</p>
<p>Es bastante fácil hacer una regresión que incluya dos variables aparentemente no relacionadas y encontrar que en realidad están significativamente correlacionadas. Por ejemplo, en los Estados Unidos, el consumo per cápita de queso de mozzarella se correlaciona fuertemente (<span class="math inline">\(r = 0,959\)</span>) con el número de doctorados de ingeniería civil (ver Figura <a href="causal-inf.html#fig:dr-cheese">10.1</a>). Matemáticamente no hay diferencia entre la fuerte relación entre el consumo de queso y los doctorados en ingeniería civil y la fuerte relación entre el gasto en educación y la desigualdad social. Ambas relaciones están definidas por un único número: un coeficiente de regresión. Sin embargo, la relación entre el queso y los títulos no significa que el aumento del consumo de queso creará nuevos doctores, ni que el aumento de las filas de ingenieros civiles provoque un aumento de la cantidad de queso que comen los estadounidenses. Podemos fácilmente descartar esta relación como espuria.</p>
<div class="figure" style="text-align: center"><span id="fig:dr-cheese"></span>
<img src="00-images/causal-inf/dr-cheese.png" alt="La alta correlación entre el queso y la ingeniería civil" width="1084" />
<p class="caption">
Figura 10.1: La alta correlación entre el queso y la ingeniería civil
</p>
</div>
<p>Es menos probable que califiquemos de espuria la relación entre el gasto en educación y la desigualdad. No nos reímos inmediatamente de la correlación que encontramos en el capítulo 6, y hay muchos trabajos académicos publicados que investigan la relación genuina entre ellos. ¿Por qué? La diferencia entre la posibilidad de las dos relaciones va más allá de las estadísticas. No hay ninguna explicación creíble que vincule el consumo de queso con los títulos de doctorado, a pesar de la alta correlación entre ambos. Hay una historia causal creíble entre la desigualdad y la educación, ya que el aumento de la calidad de la educación mejora las oportunidades de empleo disponibles para los estudiantes después de la graduación.</p>
<p>En este capítulo, presentamos un nuevo lenguaje no estadístico para crear, medir y evaluar situaciones y relaciones causales utilizando datos observacionales (es decir, no experimentales). Introducimos el concepto de gráficos acíclicos dirigidos por la causalidad (<em>Directed Acyclical Graphs</em> o DAGs en inglés) que nos permiten codificar formalmente nuestra comprensión de las historias causales. Con los DAGs bien elaborados, podemos utilizar un conjunto de reglas llamadas cálculos <em>do</em> (hacer) para lograr ajustes específicos a los modelos estadísticos y aislar o identificar relaciones causales entre las variables de interés.</p>
</div>
<div id="causalidad-y-gráficos-causales" class="section level2">
<h2><span class="header-section-number">10.2</span> Causalidad y gráficos causales</h2>
<p>A diferencia de la correlación, que en su núcleo es simplemente una fórmula matemática, no existe una función de “causalidad” en R, algo como <code>causation()</code>. La causalidad es una cuestión de filosofía y teoría, no de matemáticas. Los debates sobre la definición de la causalidad se han llevado a cabo durante miles de años - Platón y Aristóteles escribieron sobre la metafísica y los componentes de las relaciones causales. En aras de la simplicidad, en este capítulo utilizaremos una definición bastante universal: se puede decir que <span class="math inline">\(X\)</span> causa <span class="math inline">\(Y\)</span> si:</p>
<ul>
<li><strong>Asociación</strong>: <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> están <em>relacionadas</em> entre sí</li>
<li><strong>Orden temporal</strong>: <span class="math inline">\(X\)</span> <em>precede a</em> <span class="math inline">\(Y\)</span></li>
<li>La relación entre <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> <em>no es espúrea</em></li>
</ul>
<p>Más simplemente, podemos colapsar las tres condiciones en una sola definición:</p>
<blockquote>
<p>Una variable <span class="math inline">\(X\)</span> es una causa de una variable <span class="math inline">\(Y\)</span> si <span class="math inline">\(Y\)</span> de alguna manera depende de <span class="math inline">\(X\)</span> para su valor… <span class="math inline">\(X\)</span> es una causa de <span class="math inline">\(Y\)</span> si <span class="math inline">\(Y\)</span> escucha a <span class="math inline">\(X\)</span> y decide su valor en respuesta a lo que escucha <span class="citation">(Pearl, Glymour, and Jewell <a href="referencias.html#ref-PearlGlymourJewell:2016" role="doc-biblioref">2016</a>, 5–6)</span></p>
</blockquote>
<p>El concepto de variables que se “escuchan” simultáneamente incorpora la relación, el ordenamiento en el tiempo y la relación no espuria. Considere la relación entre encender un interruptor de luz y que la luz se encienda. El acto de accionar un interruptor de luz se asocia con una bombilla que emite luz, lo que indica una asociación entre ambos. Una bombilla no puede emitir luz antes de ser encendida, por lo que se debe asegurar el orden correcto del tiempo: el encendido del interruptor debe preceder a la luz. Por último, la asociación no es espuria ya que existe un vínculo plausible entre ambos: los impulsos eléctricos viajan a través de los cables hasta el equipo que transforma la energía en electricidad que, en última instancia, puede alimentar la bombilla. También podemos decir más simplemente que la bombilla “escucha” al interruptor de luz. Los cambios en el estado de encendido y apagado del interruptor influyen en el estado de la bombilla más abajo en la cadena causal. Una bombilla escucha muchos otros factores - la electricidad debe fluir en el edificio, los transformadores deben funcionar correctamente, y múltiples interruptores podrían controlar la misma luz - pero un solo interruptor es definitivamente una de las causas de la emisión de luz.</p>
<div class="figure" style="text-align: center"><span id="fig:general-examples"></span>
<img src="00-images/causal-inf/general-examples.png" alt="Varios DAGs" width="675" />
<p class="caption">
Figura 10.2: Varios DAGs
</p>
</div>
<p>Podemos codificar la filosofía o la teoría de una cadena causal de eventos en un gráfico acíclico dirigido, o DAG. Los DAGs son modelos gráficos del proceso que genera los datos y describen cómo <span class="math inline">\(X\)</span> causa <span class="math inline">\(Y\)</span> (ver panel A de la Figura @ref(fig: general-examples)) Estos gráficos consisten en tres elementos centrales: nodos, bordes (o flechas) y dirección. Los nodos representan fenómenos que tienen relaciones causales con otros elementos del sistema. Estos pueden ser cosas que se pueden medir y que podrían incluir una base de datos, como el PIB, la población, el partido político, el tiempo de permanencia en el cargo, los ingresos, la ubicación geográfica o la situación socioeconómica. Los nodos no tienen por qué ser necesariamente medibles; las limitaciones en la recopilación de datos o la abstracción de variables pueden hacer imposible la recopilación de mediciones fiables sobre diferentes fenómenos. Si éste es el caso, el nodo debe seguir estando incluido en el gráfico, pero debe ser considerado <em>no observado</em> o <em>latente</em>. Los nodos también representan las variables de tratamiento y de resultado (véase el panel B de la figura @ref(fig: general-examples)). Por ejemplo, si nos interesa el efecto causal de los gastos en educación sobre la desigualdad (como en el capítulo 6), los gastos en educación serían el <em>tratamiento</em> o la <em>exposición</em>, y la desigualdad social basada en Gini sería el <em>resultado</em>.</p>
<p>Las flechas transmiten asociaciones entre nodos. Por ejemplo, si un gráfico muestra que <span class="math inline">\(X \rightarrow Y\)</span>, <span class="math inline">\(X\)</span> tiene una asociación causal con <span class="math inline">\(Y\)</span>, o <span class="math inline">\(Y\)</span> “escucha” o responde a <span class="math inline">\(X\)</span>. Crucialmente, la ausencia de una flecha entre los nodos implica que no hay relación causal entre los nodos. Las asociaciones causales entre los nodos sólo pueden fluir en una <strong>dirección</strong>- las flechas nunca pueden ir en ambas direcciones (por ejemplo, <span class="math inline">\(X \leftrightarrow Y\)</span>), y debería ser imposible volver a cualquier nodo dado mientras se camina por el gráfico (por ejemplo, <span class="math inline">\(X \rightarrow Z \rightarrow Y \rightarrow Z \rightarrow X\)</span>). A menudo hay una razón válida para incluir flechas de loop o de retroalimentación. Por ejemplo, los gastos en educación pueden conducir a la desigualdad, lo que a su vez conduce a cambios en los gastos en educación. En estas situaciones, en lugar de incluir flechas bidireccionales, es mejor distinguir entre los dos períodos de gastos en educación, a menudo utilizando el subíndice <span class="math inline">\(t\)</span> para el tiempo: <span class="math inline">\(X_{t-1} \rightarrow Y_{t-i} \rightarrow X_t \rightarrow Y_t\)</span> (ver panel C en la figura -(fig:general-examples)).</p>
<p>La presencia y ausencia de nodos, flechas y dirección en un DAG comunica nuestra teoría y nuestra filosofía de la causalidad. El uso de los DAGs deja claro a su audiencia cuáles son tus supuestos. Vincular los nodos entre sí implica que hay una relación estadística entre dos fenómenos, mientras que omitir un nodo o una flecha implica que el nodo no juega ningún papel en la historia causal. Si los lectores quieren discutir con su teoría de la causalidad, pueden hacerlo fácilmente refiriéndose al DAG y señalando qué nodos y flechas deben ser incluidos o excluidos.</p>
</div>
<div id="midiendo-efectos-causales" class="section level2">
<h2><span class="header-section-number">10.3</span> Midiendo efectos causales</h2>
<p>Como la causalidad significa que <span class="math inline">\(Y\)</span> escucha a <span class="math inline">\(X\)</span>, medir el efecto de <span class="math inline">\(X\)</span> en <span class="math inline">\(Y\)</span> requiere que se pueda manipular <span class="math inline">\(X\)</span> directamente para ver qué pasa con <span class="math inline">\(Y\)</span>. Podemos usar una pieza especial de notación matemática para representar intervenciones directas: el operador <em>hacer</em>, o <span class="math inline">\(hacer(\cdot)\)</span>. Si <span class="math inline">\(Y\)</span> escucha a <span class="math inline">\(X\)</span>, podemos decir que hay algún valor esperado de <span class="math inline">\(Y\)</span> cuando “hacemos” <span class="math inline">\(X\)</span>, o <span class="math inline">\(E(Y | hacer(X))\)</span> (léase esto como “el valor esperado de Y dado que tienes X”).<a href="#fn44" class="footnote-ref" id="fnref44"><sup>44</sup></a> Podemos hacer que esta notación sea un poco más fácil de entender con algunos ejemplos de preguntas causales que interesan a los cientistas sociales:</p>
<ul>
<li><span class="math inline">\(E(\text{Votos obtenidos}\ | \ hacer(\text{Recaudación de fondos de la campaña}))\)</span>: El efecto de <em>hacer</em> (es decir, participar en) la recaudación de fondos de la campaña en el número de votos ganados en una elección</li>
<li><span class="math inline">\(E(\text{Desigualdad}\ | \ hacer(\text{Gastos en educación}))\)</span>: El efecto de “hacer” gastos de educación (es decir, gastar dinero) en el nivel de desigualdad social de un país</li>
<li><span class="math inline">\(E(\text{Calidad del aire}\ | \ hacer(\text{Impuesto sobre el carbono}))\)</span>: Tel efecto de “hacer” (es decir, aplicar) un impuesto sobre el carbono en la calidad del aire de un país</li>
<li><span class="math inline">\(E(\text{Tasa de infección de malaria}\ | \ hacer(\text{redes para mosquitos}))\)</span>: El efecto de “hacer” (es decir, usar) un mosquitero en la tasa de infección de malaria de una aldea</li>
</ul>
<p>Para medir el efecto causal de una intervención, necesitamos comparar el valor esperado del resultado (<span class="math inline">\(E(Y)\)</span>) cuando intervenimos y cuando no intervenimos con <span class="math inline">\(X\)</span>. Por ejemplo, podemos comparar lo que sucede con una bombilla cuando accionamos un interruptor con lo que sucede con una bombilla cuando no accionamos el interruptor. Restringiendo la diferencia entre estos dos estados del mundo se obtiene un efecto causal:</p>
<p><span class="math display">\[
\text{Efecto causal del encendido de la luz} = E(\text{Luz}\ | \ hacer(\text{Interruptor = Encendido})) - E(\text{Luz}\ | \ hacer(\text{Interruptor = Apagado}))
\]</span></p>
<p>Podemos escribir esta definición de manera más general usando unos pocos símbolos matemáticos más. Aquí <span class="math inline">\(\delta\)</span> representa el efecto causal y el subíndice <span class="math inline">\(i\)</span> representa un individuo específico (es decir, comparando los efectos en la misma bombilla):</p>
<p><span class="math display">\[
\delta_i = E(Y\ | \ hacer(X = 1))_i - E(Y\ | \ hacer(X = 0))_i
\]</span></p>
<p>El cálculo del efecto causal <span class="math inline">\(\delta_i\)</span> en el mundo físico es bastante sencillo. Encuentra dos bombillas codigoénticas, enciende una ( <span class="math inline">\(hacer(\text{Interruptor = Encendido})\)</span>), deja una apagada ( <span class="math inline">\(hacer(\text{Interruptor= Apagado})\)</span>), y compara la luz que se emite. O, como una sola bombilla no cambia con el tiempo, medir el cambio de luz en la misma bombilla en dos momentos diferentes.</p>
<p>Sin embargo, en las ciencias sociales es mucho más difícil medir el efecto causal de las intervenciones en personas, provincias o países concretos. No podemos medir <span class="math inline">\(E(Y | hacer( X = 1))_i\)</span> en un individuo y luego retroceder en el tiempo para medir <span class="math inline">\(E(Y | hacer(X = 0))_i\)</span> en ese mismo individuo. Esto plantea el <em>problema fundamental de la inferencia causal</em>: los efectos causales a nivel individual son imposibles de observar porque no podemos ver contrafactuales a nivel individual.</p>
<p>En lugar de medir los efectos a nivel individual, es más fácil (y realmente factible) medir los resultados medios de cada unidad de un grupo. Podemos encontrar el <em>efecto promedio del tratamiento</em> (ATE) calculando la diferencia entre el valor esperado del resultado promedio (<span class="math inline">\(\bar{Y}\)</span>) para los que <span class="math inline">\(hacen(X)\)</span> y los que no:</p>
<p><span class="math display">\[
\delta_\text{ATE} = E(\bar{Y}\ | \ hacer(X = 1)) - E(\bar{Y}\ | \ hacer(X = 0))
\]</span></p>
<p>En condiciones experimentales, como en los ensayos controlados aleatorios en los que los participantes se asignan al azar para recibir tratamiento o no, los grupos que <span class="math inline">\(hacen(X = 1)\)</span> y <span class="math inline">\(hacen(X = 0)\)</span> serán generalmente comparables porque ningún individuo se seleccionó voluntariamente dentro o fuera del tratamiento. Mientras la aleatorización se haga bien, el ATE que calculamos debe ser imparcial (sin sesgo) y preciso.</p>
<p>Sin embargo, la mayoría de los datos de la ciencia política son de naturaleza observacional. El PIB nacional, los resultados de las elecciones, el gasto del gobierno, la matrícula en las escuelas primarias y el número de golpes de Estado se generan a partir de procesos no experimentales. Si estamos interesados en el efecto de ser una democracia (es decir, “hacer” democracia) en el PIB, podríamos tratar de definir el efecto causal como:</p>
<p><span class="math display">\[
\delta_\text{ATE} = E(\text{PBI promedio}\ | \ hacer(\text{Democracia} = 1)) - E(\text{PBI promedio}\ | \ hacer(\text{Democracia} = 0))
\]</span></p>
<p>Sin embargo, el simple hecho de restar el PIB medio de las no democracias del PIB medio de las democracias dará lugar a una estimación sesgada e incorrecta. Los países no se asignan al azar para ser democracias. Hay innumerables factores económicos, históricos, sociológicos y políticos que influyen en la capacidad de un país para <span class="math inline">\(hacer(\text{democracia})\)</span>, lo que garantiza que habrá un sesgo sistemático en la selección del sistema político de un país. Cualquier correlación que pudiéramos encontrar no implicaría causalidad.</p>
<p>Existen muchas técnicas econométricas para identificar y estimar los efectos causales a partir de datos de observación, incluidos los experimentos naturales, el análisis de diferencias en las diferencias, el análisis de regresión discontinua y las variables instrumentales (véase <span class="citation">Cunningham (<a href="referencias.html#ref-mixtape" role="doc-biblioref">2018</a>)</span>, <span class="citation">Angrist and Pischke (<a href="referencias.html#ref-angristMostlyHarmlessEconometrics2008" role="doc-biblioref">2008</a>)</span>, <span class="citation">Angrist and Pischke (<a href="referencias.html#ref-masteringmetrics" role="doc-biblioref">2015</a>)</span> para una visión general completa de todos estos métodos). En general, estos métodos tratan de aproximarse a los grupos de tratamiento y control, organizando a las personas o los países en grupos comparables y eliminando el sesgo de selección. Además de estos enfoques, podemos utilizar la lógica de los modelos causales para identificar las relaciones causales, eliminar la confusión estadística y utilizar datos de observación para estimar efectos causales válidos.</p>
</div>
<div id="dags-y-asociaciones-estadísticas" class="section level2">
<h2><span class="header-section-number">10.4</span> DAGs y asociaciones estadísticas</h2>
<p>Dibujar nodos y flechas es útil para comprender los diversos elementos de un fenómeno social, pero por sí solos, los nodos y bordes no identifican relaciones causales. Se considera que un efecto causal está <em>identificado</em> si la asociación entre el nodo de tratamiento y el nodo de resultado se aísla y se despoja de las asociaciones estadísticas que provienen de otros nodos del gráfico.</p>
<div class="figure" style="text-align: center"><span id="fig:association-examples"></span>
<img src="00-images/causal-inf/association-examples.png" alt="Los tipos básicos de relaciones en DAGs" width="675" />
<p class="caption">
Figura 10.3: Los tipos básicos de relaciones en DAGs
</p>
</div>
<p>La <strong>dirección</strong> de las flechas a lo largo de las trayectorias entre nodos en un gráfico determina cómo se transmiten las asociaciones estadísticas entre los nodos. Para ilustrar cómo ciertas relaciones direccionales pueden pasar asociaciones estadísticas entre nodos en un gráfico, supongamos que dos variables <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> no están relacionadas entre sí. Podemos decir esto con notación matemática usando el símbolo <span class="math inline">\(\perp\)</span>: <span class="math inline">\(X \perp Y\)</span> significa que <span class="math inline">\(X\)</span> es independiente de <span class="math inline">\(Y\)</span> (y <span class="math inline">\(X \not\perp Y\)</span> significa que las dos variables no son independientes). En el lenguaje de los gráficos causales, podemos decir que si <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> son independientes la una de la otra, están <em>d-separadas</em> (el <em>d-</em> significa “dirección”). Si <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> no son independientes una de la otra, están <em>d-conectadas</em>: las características de las relaciones direccionales en el gráfico causal conectan las dos variables entre sí y permiten que la información pase entre ellas. La figura <a href="causal-inf.html#fig:association-examples">10.3</a> muestra cómo la inclusión de un tercer nodo <span class="math inline">\(Z\)</span> en la vía entre <span class="math inline">\(X\)</span> y <span class="math inline">\(Y\)</span> cambia la relación estadística entre los dos e influye en si están <em>d</em>-separadas o <em>d</em>- conectadas.</p>
<ol style="list-style-type: decimal">
<li><p><strong>Mediadores</strong>: En el panel A, <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> están correlacionadas entre sí por la variable mediadora <span class="math inline">\(Z\)</span>. Cualquier cambio en <span class="math inline">\(X\)</span> causará cambios en <span class="math inline">\(Y\)</span> a través de <span class="math inline">\(Z\)</span>. El camino entre <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> es por lo tanto <em>abierto</em> y <span class="math inline">\(X \not\perp Y\)</span>. <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> están <em>d</em>conectadas.</p></li>
<li><p><strong>variable confusora</strong>: En el panel B, aunque <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> no se causan mutuamente, <span class="math inline">\(Z\)</span> es una causa común de ambos y confunde la relación. Cualquier cambio en <span class="math inline">\(Z\)</span> causará cambios tanto en <span class="math inline">\(X\)</span> como en <span class="math inline">\(Y\)</span>, eliminando así cualquier independencia estadística entre los dos. El camino entre <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> está así <em>abierto</em> y de nuevo, <span class="math inline">\(X \not\perp Y\)</span>. <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> están <em>d</em>conectadas.</p></li>
</ol>
<p>En realidad, <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> deberían ser independientes entre sí, pero en el caso de los mediadores y los las variables de confusión, <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> están <em>d</em>conectadas porque <span class="math inline">\(Z\)</span> abre un camino entre los dos y pasa información entre ellos.</p>
<p>Un elemento poderoso de la lógica de los diagramas causales es que podemos controlar el flujo de información estadística bloqueando y abriendo vías entre los nodos. Tanto para mediar como para confundir, si podemos detener la asociación entre ambos <span class="math inline">\(X\)</span> y <span class="math inline">\(Z\)</span> y <span class="math inline">\(Z\)</span> e <span class="math inline">\(Y\)</span>, entonces <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> serán una vez más independientes entre sí y estarán <em>d</em>-separadas. Para ello, podemos <em>ajustar para</em> o <em>condicionar sobre</em> <span class="math inline">\(Z\)</span> quitando las partes de <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> que se explican por <span class="math inline">\(Z\)</span>. Hay muchas maneras de ajustar las variables, y se incluyen ejemplos más adelante en este capítulo. Una forma básica de pensar en el ajuste de variables es con la regresión: si ejecutáramos una regresión e incluyéramos <span class="math inline">\(Z\)</span> como variable de control (por ejemplo, <code>lm(Y ~ X + Z)</code>), el coeficiente para <span class="math inline">\(Z\)</span> explicaría (y eliminaría) la variación conjunta de <span class="math inline">\(Z\)</span> a través de <span class="math inline">\(X\)</span> y <span class="math inline">\(Y\)</span>. Una vez que ajustamos para <span class="math inline">\(Z\)</span>, el camino entre <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> se bloquea y los dos se <em>d</em>separan. Matemáticamente, podemos escribir esto como <span class="math inline">\(X \perp Y | Z\)</span>, o decir que <span class="math inline">\(X\)</span> es independiente de <span class="math inline">\(Y\)</span> condicionado a <span class="math inline">\(Z\)</span>.</p>
<p>El concepto de bloqueo o condicionamiento nos ayuda a entender el tipo de relación final entre los nodos:</p>
<ol start="3" style="list-style-type: decimal">
<li><strong>Colisionadores</strong>: En el panel C de la figura @ref(fig: association-examples), <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> son causas comunes de <span class="math inline">\(Z\)</span>, pero cada una es independiente de la otra. El camino entre <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> está cerrado porque está bloqueado por <span class="math inline">\(Z\)</span>. <span class="math inline">\(X \perp Y\)</span> y <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> están <em>d</em>separados. Si controlamos por <span class="math inline">\(Z\)</span> en un modelo de regresión, abrimos inadvertidamente el camino entre <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> y creamos una relación estadística espuria entre los dos.</li>
</ol>
<div class="figure" style="text-align: center"><span id="fig:money-votes-simple"></span>
<img src="00-images/causal-inf/money-votes-simple.png" alt="DAG simplificado que muestra la relación entre los gastos de campaña y los votos ganados en una elección" width="60%" />
<p class="caption">
Figura 10.4: DAG simplificado que muestra la relación entre los gastos de campaña y los votos ganados en una elección
</p>
</div>
<p>Hasta ahora, hemos hablado de DAGs y <em>d</em>-separación en abstracto con <span class="math inline">\(X\)</span>, <span class="math inline">\(Y\)</span>, y <span class="math inline">\(Z\)</span>. La figura <a href="causal-inf.html#fig:money-votes-simple">10.4</a> proporciona un gráfico causal más concreto que ilustra las tres relaciones simultáneamente. Supongamos que estamos interesados en el efecto causal de la recaudación de fondos de la campaña (<span class="math inline">\(X\)</span>) sobre el total de votos (<span class="math inline">\(Y\)</span>). En este caso, ya no suponemos que <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> son independientes la una de la otra (es decir, <span class="math inline">\(X \perp Y\)</span>), sino que queremos medir la relación entre ambas. Sin embargo, para aislar esa relación, debemos asegurarnos de que la vía entre el dinero de la campaña y el total de votos sea la única vía conectada en el gráfico. Cada uno de los otros nodos del gráfico - “director de campaña contratado”, “calidad del candidato” y “elección ganada” - pasa por diferentes tipos de asociaciones estadísticas entre el dinero y el éxito electoral. Podemos examinarlos a su vez:</p>
<ol style="list-style-type: decimal">
<li>La relación entre el dinero y el total de votos es <strong>mediada</strong> por la contratación de un director de campaña. Cualquier cambio en la recaudación de fondos tiene un efecto en el número de votos ganados, pero la recaudación de fondos también influye en las posibilidades de contratar a un director de campaña, lo que a su vez tiene un efecto en el total de votos. El camino entre el dinero y los votos está así abierto debido a la variable de director de campaña mediador.</li>
<li>La relación entre el dinero y el éxito electoral se <strong>confunde</strong> con la calidad del candidato. Los candidatos de alta calidad son más propensos a recaudar más dinero <em>y</em> ganar elecciones, lo que significa que la relación entre el dinero y el éxito electoral ya no está aislada. Si ajustamos la calidad del candidato y comparamos los candidatos de la misma calidad (o controlar por la calidad en una regresión, manteniendo la calidad constante), podemos cerrar el camino entre el dinero y el éxito electoral.</li>
<li>Ganar una elección es un <strong>colicionador</strong> en el camino entre el dinero y el éxito electoral. Si ajustamos por ganar las elecciones (es decir, sólo miramos a los candidatos ganadores), la relación real entre el dinero y el éxito electoral se distorsionará. El sesgo colisionador es un tipo de sesgo de selección: si sólo miramos las campañas exitosas, no vemos la relación entre el dinero y el éxito de los candidatos que no ganaron, y nuestras estimaciones serán erróneas. No deberíamos controlar por el hecho de ganar una elección.</li>
</ol>
<p>Conocer la dirección de las flechas entre los nodos de un DAG, por lo tanto, proporciona una guía útil sobre qué controlar o ajustar. Si queremos aislar la relación entre la recaudación de fondos de campaña y el éxito electoral, debemos controlar por la calidad del candidato (ya que es un confusor) y no debemos controlar por el hecho de ganar la elección (ya que es un colisionador). La decisión de ajustar por tener un director de campaña dependerá de nuestra pregunta de investigación. Si lo ajustamos, eliminaremos el efecto de director de campaña del efecto total de la recaudación de fondos sobre los votos, y el efecto restante de <span class="math inline">\(X\)</span> sobre <span class="math inline">\(Y\)</span> será realmente de <span class="math inline">\(X\)</span> sin el efecto de director de campaña. Si estamos interesados en el efecto total de la recaudación de fondos, incluyendo cualquier efecto que provenga de tener un director de campaña, <em>no deberíamos controlar</em> el tener un director de campaña.</p>
</div>
<div id="puertas-traseras-y-cálculos-hacer" class="section level2">
<h2><span class="header-section-number">10.5</span> Puertas traseras y cálculos “<em>hacer</em>”</h2>
<p>Following the fundamental problem of causal inference (i.e. due the the fact that we do not have a time machine), answering causal questions without an experiment appears impossible. However, if we apply a special set of logical rules called <em>do</em>-calculus to our causal graph, we can strip away any confounding relationships between our tratamiento and outcome nodes and isolate the causal effect between them using only observational data.</p>
<div class="figure" style="text-align: center"><span id="fig:rct-arrow-deletion"></span>
<img src="00-images/causal-inf/rct-dag.png" alt="Las flechas en un DAG se borran cuando usamos el operador $hacer(\cdot)$" width="60%" />
<p class="caption">
Figura 10.5: Las flechas en un DAG se borran cuando usamos el operador <span class="math inline">\(hacer(\cdot)\)</span>
</p>
</div>
<p>El operador <em>hacer</em> representa una intervención directa en un DAG y nos permite “congelar” un nodo en un valor específico. Por ejemplo, en un ensayo controlado aleatorio, nosotros como investigadores tenemos control sobre quién es asignado al tratamiento y a los grupos de control en la intervención. El efecto causal (o <span class="math inline">\(delta\)</span>) que encontramos en el ensayo es el efecto de <span class="math inline">\(X\)</span> en nuestro resultado <span class="math inline">\(Y\)</span> cuando <span class="math inline">\(hacer(X = \ text{tratamiento})\)</span>. En los entornos experimentales, una intervención <span class="math inline">\(hacer(\cdot)\)</span> implica que todas las flechas que entran en el nodo de tratamiento se eliminan (ver Figura <a href="causal-inf.html#fig:rct-arrow-deletion">10.5</a>). Esto asegura que <span class="math inline">\(X\)</span> esté <em>d</em>-separada de <span class="math inline">\(Y\)</span> y que la flecha entre <span class="math inline">\(X\)</span> y <span class="math inline">\(Y\)</span> esté completamente aislada e identificada. Sin embargo, con datos de observacionales, no es posible estimar <span class="math inline">\(E(Y | hacer(X))\)</span> porque como investigadores, no tenemos control sobre <span class="math inline">\(X\)</span>. No podemos asignar a algunos países a que aumenten y otros a que disminuyan el gasto en educación como parte de un experimento para ver cómo cambia la desigualdad social, ni asignar a algunas campañas a que hagan un esfuerzo extra en la recaudación de fondos para ver el efecto del dinero en los votos. En lugar de <span class="math inline">\(E(Y | hacer(X))\)</span>, que es nuestro valor de interés, sólo podemos estimar <span class="math inline">\(E(Y | X)\)</span>, o el valor esperado de <span class="math inline">\(Y\)</span> dados los niveles existentes de <span class="math inline">\(X\)</span> (es decir, la correlación entre ambos). Desafortunadamente, la frase con la que se abrió este capítulo, “la correlación no es causalidad”, se mantiene aquí: <span class="math inline">\(E(Y | X) \neq E(Y | hacer(X))\)</span>. Para estimar un efecto causal a partir de datos observacionales, necesitamos transformar <span class="math inline">\(E(Y | hacer(X))\)</span> en algo que esté liberado del término <em>hacer</em>, ya que no podemos realmente intervenir sobre cuándo <em>hacer</em> ocurre y cuando no.</p>
<p>Un conjunto de tres reglas lógicas especiales denominadas “cálculos <em>hacer</em>” nos permite hacer precisamente eso: mediante la aplicación de diferentes reglas, podemos eliminar los operadores <span class="math inline">\(hacer(\cdot)\)</span> de los DAG e identificar los efectos causales con sólo datos observacionales. Cubrir el conjunto completo de reglas de cálculo <em>hacer</em> va más allá del alcance de este capítulo; puedes consultar <span class="citation">Pearl, Glymour, and Jewell (<a href="referencias.html#ref-PearlGlymourJewell:2016" role="doc-biblioref">2016</a>)</span>, <span class="citation">Pearl and Mackenzie (<a href="referencias.html#ref-PearlMackenzie:2018" role="doc-biblioref">2018</a>)</span>, <span class="citation">Shpitser and Pearl (<a href="referencias.html#ref-ShpitserPearl:2008" role="doc-biblioref">2008</a>)</span> para más detalles y ejemplos.</p>
<p>Una derivación particular de las reglas de cálculos <em>hacer</em> define un especial <em>criterio de puerta trasera</em> que nos permite eliminar los operadores <span class="math inline">\(hacer(\cdot)\)</span> ajustando las variables de confusión a lo largo del camino entre <span class="math inline">\(X\)</span> y <span class="math inline">\(Y\)</span>. El criterio de puerta trasera establece que el efecto causal de <span class="math inline">\(X\)</span> sobre <span class="math inline">\(Y\)</span> es identificable (es decir, puede ser aislado) después de ajustar el conjunto de variables de confusión <span class="math inline">\(Z\)</span>, usando la fórmula:</p>
<p><span class="math display">\[
P(Y | hacer(X)) = \sum_Z P(Y | X, Z) \times P(Z)
\]</span></p>
<p>En este capítulo, la derivación e interpretación exacta de esta fórmula es menos importante que la intuición. De acuerdo con este criterio de puerta trasera, el operador <em>hacer</em> del lado izquierdo de la ecuación puede transformarse en una expresión libre de <em>hacer</em> del lado derecho, estimada con <span class="math inline">\(P(Y | X, Z)\)</span> (la distribución de <span class="math inline">\(Y\)</span> condicionada tanto a <span class="math inline">\(X\)</span> como a <span class="math inline">\(Z\)</span>) y <span class="math inline">\(P(Z)\)</span> (la distribución de <span class="math inline">\(Z\)</span>), que son ambas estimables utilizando sólo datos de observación.</p>
<p>En la práctica, el ajuste de la puerta trasera suele ser mucho más intuitivo que tratar de derivar fórmulas largas. En su lugar, es posible encontrar y ajustar caminos de puertas traseras confusores usando un DAG siguiendo este proceso:</p>
<ol style="list-style-type: decimal">
<li>Enumera todos los caminos entre <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span>, sin importar la dirección de las flechas.</li>
<li>Identifica cualquier camino que tenga flechas que apunten hacia atrás, hacia <span class="math inline">\(X\)</span>.</li>
<li>Los nodos que apuntan hacia atrás a <span class="math inline">\(X\)</span> son confusores y por lo tanto abren caminos de vuelta. Estos deben ser ajustados.</li>
</ol>
<p>Podemos aplicar este proceso al DAG en la figura <a href="causal-inf.html#fig:money-votes-simple">10.4</a>. Estamos interesados en el efecto de la recaudación de fondos de campaña en la cantidad de votos obtenidos en una elección, o <span class="math inline">\(E(\text{Votos obtenidos}\ | \ hacer(\text{campaña de recaudación de fondos}))\)</span>. Como no asignamos experimentalmente algunas campañas para recaudar dinero y otras no, sólo podemos trabajar con datos observacionales, dejándonos sólo con la correlación entre la recaudación de fondos de la campaña y los votos, o <span class="math inline">\(E(\text{Votos obtenidos}\ |\ \text{campaña de recaudación de fondos})\)</span>. Si miramos el gráfico causal hay cuatro caminos entre “Dinero recaudado” y “Total de votos”:</p>
<ul>
<li><span class="math inline">\(\text{Recaudación} \rightarrow \text{Cantidad de votos}\)</span></li>
<li><span class="math inline">\(\text{Recaudación} \leftarrow \text{Calidad del candidato} \rightarrow \text{Cantidad de votos}\)</span></li>
<li><span class="math inline">\(\text{Recaudación} \rightarrow \text{Contratar gerente de campaña} \rightarrow \text{Cantidad de votos}\)</span></li>
<li><span class="math inline">\(\text{Recaudación} \rightarrow \text{Ganar la elección} \leftarrow \text{Cantidad de votos}\)</span></li>
</ul>
<p>En el segundo camino, la calidad del candidato apunta hacia atrás hacia “dinero recaudado” y es un confusor que abre un camino secundario entre la recaudación de fondos y los votos. El primero, tercero y cuarto caminos sólo tienen flechas hacia la derecha y no producen ninguna confusión. Si ajustamos por la calidad del candidato y la mantenemos constante, nos aseguramos de que la relación entre la recaudación de fondos y los votos estará <em>d</em>-separada de todos los demás nodos y por lo tanto esté aislada e identificada.</p>
<div class="figure" style="text-align: center"><span id="fig:money-votes-complex"></span>
<img src="00-images/causal-inf/money-votes-complex.png" alt="Un DAG más complicado que muestra la relación entre los gastos de campaña y los votos ganados en una elección" width="60%" />
<p class="caption">
Figura 10.6: Un DAG más complicado que muestra la relación entre los gastos de campaña y los votos ganados en una elección
</p>
</div>
<p>La misma lógica se aplica también a DAGs más complejos. Consideremos la figura <a href="causal-inf.html#fig:money-votes-complex">10.6</a>, que es una versión amplificada de la figura <a href="causal-inf.html#fig:money-votes-simple">10.4</a> con tres nuevos nodos: el partido político del candidato, el distrito en el que se presenta el candidato y la historia no observada tanto del distrito como del partido, que influyen en la toma de decisiones del partido y en la dinámica demográfica del distrito. Estamos interesados en identificar o aislar el camino entre la recaudación de fondos y el total de votos, pero hay caminos de confusión que <em>d</em>-separan el camino causal que nos interesa. Podemos cerrar estas puertas traseras para aislar el efecto causal. Primero, enumeramos todos los caminos entre “Dinero recaudado” y “Total de votos”:</p>
<ul>
<li><span class="math inline">\(\text{Recaudación} \rightarrow \text{Cantidad de votos}\)</span></li>
<li><span class="math inline">\(\text{Recaudación} \rightarrow \text{Contratar gerente de campaña} \rightarrow \text{Cantidad de votos}\)</span></li>
<li><span class="math inline">\(\text{Recaudación} \rightarrow \text{Ganar elección} \leftarrow \text{Cantidad de votos}\)</span></li>
<li><span class="math inline">\(\text{Recaudación} \leftarrow \text{Calidad del candidato} \rightarrow \text{Cantidad de votos}\)</span></li>
<li><span class="math inline">\(\text{Recaudación} \leftarrow \text{Distrito} \rightarrow \text{Cantidad de votos}\)</span></li>
<li><span class="math inline">\(\text{Recaudación} \leftarrow \text{Partido} \rightarrow \text{Cantidad de votos}\)</span></li>
<li><span class="math inline">\(\text{Recaudación} \leftarrow \text{Distrito} \leftarrow \text{Historia} \rightarrow \text{Partido} \rightarrow \text{Cantidad de votos}\)</span></li>
<li><span class="math inline">\(\text{Recaudación} \leftarrow \text{Partido} \leftarrow \text{Historia} \rightarrow \text{Distrito} \rightarrow \text{Cantidad de votos}\)</span></li>
</ul>
<p>De estos ocho caminos posibles, los últimos cinco tienen flechas que apuntan hacia la izquierda en “Dinero recaudado” desde tres nodos únicos: calidad del candidato, partido y distrito. Por lo tanto, debemos ajustar por la calidad del candidato, el partido y el distrito para cerrar estos caminos de puerta trasera y asegurarnos de que se identifique la conexión entre dinero y votos. Es importante destacar que la historia, que no es medible, también es un factor de confusión. Sin embargo, debido a que cerramos el partido y el distrito mediante ajustes, la historia no confunde estadísticamente la relación entre el dinero y los votos. Aunque es latente e inconmensurable, los nodos posteriores que <em>son</em> medibles nos permiten cerrar sus efectos de puerta trasera. También ten en cuenta que medir por “haber ganado la elección” es un colisionador, no un factor de confusión, y no debe ajustarse para evitar crear conexiones espurias entre la recaudación y los votos, y tener un gerente de campaña es un mediador y no debe ajustarse si estamos interesados en el efecto total del dinero en los votos.</p>
<p>El criterio de puerta trasera no es el único método para encontrar qué nodos deben ajustarse. Otro método común es el criterio de la puerta delantera, que se basa en variables mediadoras <em>d</em>-separadas para identificar la relación entre $ X $ e $ Y $ (consulta <span class="citation">Rohrer (<a href="referencias.html#ref-Rohrer:2018" role="doc-biblioref">2018</a>)</span>, <span class="citation">Pearl, Glymour, and Jewell (<a href="referencias.html#ref-PearlGlymourJewell:2016" role="doc-biblioref">2016</a>)</span>, <span class="citation">Pearl and Mackenzie (<a href="referencias.html#ref-PearlMackenzie:2018" role="doc-biblioref">2018</a>)</span>, <span class="citation">Elwert (<a href="referencias.html#ref-Elwert:2013" role="doc-biblioref">2013</a>)</span> y <span class="citation">Hernán and Robbins (<a href="referencias.html#ref-HernanRobbins:2020" role="doc-biblioref">2020</a>)</span> para detalles y ejemplos). Los DAGs complejos que no se ajustan fácilmente a los criterios de puerta trasera o puerta delantera pueden usar la aplicación de las reglas de cálculo <em>hacer</em> para encontrar ajustes apropiados y factibles. Se han desarrollado algoritmos especiales para trabajar a través de las reglas de cálculo <em>hacer</em> para determinar si un efecto es identificable: el paquete <code>causaleffect</code> en R incluye funciones para ejecutar estos algoritmos.</p>
<p>Es importante destacar que no siempre es posible identificar los efectos causales en un DAG. Si no hay forma de traducir $ P (Y | hacer (X)) $ a una expresión libre usando cálculos <em>hacer</em>, entonces es imposible aislar e identificar la relación causal usando datos observacionales.</p>
</div>
<div id="dibujar-y-analizar-dags" class="section level2">
<h2><span class="header-section-number">10.6</span> Dibujar y analizar DAGs</h2>
<p>Como los DAGs son un conjunto de nodos y flechas, son fáciles de dibujar. Recomiendo esbozarlos a mano en papel o en una pizarra cuando estés mapeando por primera vez tu teoría causal, y luego transfiere el borrador escrito a mano a una computadora. Si bien es posible usar muchos programas diferentes para dibujar DAGs, incluidos Microsoft PowerPoint o Adobe Illustrator, es mejor usar un software de gráficos como DAGitty o el paquete <code>ggdag</code>en R.</p>
<div id="dibujar-un-dag-con-dagitty" class="section level3">
<h3><span class="header-section-number">10.6.1</span> Dibujar un DAG con DAGitty</h3>
<p>DAGitty (<a href="https://www.dagitty.red">https://www.dagitty.red</a>) is an in-browser graphical editor for creating and analyzing causal diagrams. By pointing and clicking, you can create nodes and link them together with edges. You can also assign specific nodes to be tratamiento, outcome, and latent/unobserved variables, which each have their own coloring scheme. You can export DAGs as PNG, JPG, and SVG files for inclusion in other documents. Figure <a href="causal-inf.html#fig:example-dagitty">10.7</a> shows an example of a causal graph made in DAGitty. Consult <a href="http://dagitty.red%20/manual-3.x.png">the online manual</a> for more details about DAGitty’s features, or spend a few minutes playing around to get used to adding and connecting nodes.</p>
<p>DAGitty ([<a href="https://www.dagitty.red" class="uri">https://www.dagitty.red</a> ] (<a href="https://www.dagitty.red" class="uri">https://www.dagitty.red</a> )) es un editor gráfico online para crear y analizar diagramas causales. Con el mouse, y sin código, puede crear nodos y vincularlos con flechas. También puede asignar nodos específicos para que sean tratamiento, resultado o variables latentes / no observadas, y a cada una darle su propia escala de colores. Puedes exportar los DAGs como archivos PNG, JPG y SVG para incluirlos en otros documentos. La figura <a href="causal-inf.html#fig:example-dagitty">10.7</a> muestra un ejemplo de un gráfico causal realizado en DAGitty por mí.</p>
<blockquote>
<p><strong>Ejercicio 10A.</strong> Consulta [el manual en línea] (<a href="http://dagitty.red" class="uri">http://dagitty.red</a> /manual-3.x.png) para obtener más detalles sobre las características de DAGitty, o pasa unos minutos jugando para acostumbrarte a agregar y conectar nodos.</p>
</blockquote>
<div class="figure" style="text-align: center"><span id="fig:example-dagitty"></span>
<img src="00-images/causal-inf/dagitty-mosquito-nets.png" alt="Ejemplo de un DAG dibujado en DAGitty" width="50%" />
<p class="caption">
Figura 10.7: Ejemplo de un DAG dibujado en DAGitty
</p>
</div>
</div>
<div id="encontrar-sets-de-ajuste-con-dagitty" class="section level3">
<h3><span class="header-section-number">10.6.2</span> Encontrar sets de ajuste con DAGitty</h3>
<p>DAGitty colorea automáticamente los nodos y las flechas según estén abiertos o no. Por ejemplo, en la Figura <a href="causal-inf.html#fig:example-dagitty">10.7</a>, los nodos de la temperatura nocturna, ingresos y condiciones de salud son rojos, lo que indica que confunden la relación entre el tratamiento (red) y el resultado (malaria). Puedes especificar que estos nodos se ajustarán y así despejar ej camino causal.</p>
<p>En la barra lateral derecha, DAGitty incluye una lista de nodos que deben ajustarse para identificar el efecto causal. Si el efecto es identificable, enumerará todos los nodos mínimamente suficientes; y si la causalidad no es identificable, DAGitty se lo informará. Para el DAG en la Figura <a href="causal-inf.html#fig:example-dagitty">10.7</a>), el conjunto de ajustes mínimamente suficientes incluye las temperaturas nocturnas, los ingresos y las condiciones de salud subyacentes (see Figure <a href="causal-inf.html#fig:dagitty-adjust-implications">10.8</a>).</p>
<div class="figure" style="text-align: center"><span id="fig:dagitty-adjust-implications"></span>
<img src="00-images/causal-inf/dagitty-mosquito-nets-details.png" alt="Sets con ajustes mínimos suficientes e implicaciones comprobables para un modelo en DAGitty" width="45%" />
<p class="caption">
Figura 10.8: Sets con ajustes mínimos suficientes e implicaciones comprobables para un modelo en DAGitty
</p>
</div>
<p>La barra lateral derecha también incluye una lista de todas las implicaciones comprobables del DAG. Recuerde que después del ajuste, ciertos nodos se <em>d</em>separan y, por lo tanto, no pasan asociaciones estadísticas entre sí. Según este DAG, después de ajustar las temperaturas nocturnas, los ingresos y las condiciones de salud subyacentes, algunas de las siguientes afirmaciones deberían ser ciertas:</p>
<ul>
<li><span class="math inline">\(\text{Ingresos} \perp \text{Resistencia al insecticida}\)</span>: Los ingresos deben ser independientes de la resistencia a los insecticidas.</li>
<li><span class="math inline">\(\text{Ingresos} \perp \text{Temperaturas nocturas}\)</span>:Los ingresos deben ser independientes de las temperaturas nocturnas.</li>
<li><span class="math inline">\(\text{Gente en el hogar} \perp \text{Condiciones de salud subyacente}\ |\ \text{Ingresos}\)</span>: El número de personas en un hogar debe ser independiente de las condiciones de salud subyacentes en niveles similares de ingresos.</li>
</ul>
<p>Cada una de estas afirmaciones es comprobable con datos observacionales. Si tiene columnas en una base de datos para estos nodos diferentes, puede usar R para verificar las correlaciones entre ellos (es decir, <code>cor(data$ingresos, data$temperatura)</code> o <code>lm(gente_hogar ~ salud + ingresos)</code>) y ver si en realidad son independientes entre sí.</p>
</div>
<div id="diseñar-dags-en-r" class="section level3">
<h3><span class="header-section-number">10.6.3</span> Diseñar DAGs en R</h3>
<p>El paquete <code>ggdag</code> te permite usar <code>ggplot2</code> para crear y analizar DAGs en R. La documentación del paquete está llena de ejemplos útiles del rango completo de funciones del paquete. A continuación se presentan algunos ejemplos de las cosas más comunes que puede hacer con él</p>
<p>En general, diseñas un DAG con <code>dagify ()</code> y lo graficas con <code>ggdag ()</code> o <code>ggplot ()</code>. La sintaxis para diseñar un DAG en <code>dagify ()</code> es similar a la que usas cuando creas modelos con <code>lm ()</code> o <code>glm ()</code>: crearás sistemas de fórmulas que indican relaciones entre los nodos. Por ejemplo, en el DAG a continuación, <code>y</code> es causado por <code>x</code>, <code>a</code> y <code>b</code> (<code>y ~ x + a + b</code>), y <code>x</code> es causado por <code>a</code> y<code>b</code> (<code>x ~ a + b</code>), que hace que <code>a</code> y <code>b</code> sean variables de confusión.</p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="causal-inf.html#cb331-1"></a><span class="kw">library</span>(ggdag)</span>
<span id="cb331-2"><a href="causal-inf.html#cb331-2"></a></span>
<span id="cb331-3"><a href="causal-inf.html#cb331-3"></a>simple_dag &lt;-<span class="st"> </span><span class="kw">dagify</span>(</span>
<span id="cb331-4"><a href="causal-inf.html#cb331-4"></a>  y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>a <span class="op">+</span><span class="st"> </span>b,</span>
<span id="cb331-5"><a href="causal-inf.html#cb331-5"></a>  x <span class="op">~</span><span class="st"> </span>a <span class="op">+</span><span class="st"> </span>b,</span>
<span id="cb331-6"><a href="causal-inf.html#cb331-6"></a>  <span class="dt">exposure =</span> <span class="st">&quot;x&quot;</span>,</span>
<span id="cb331-7"><a href="causal-inf.html#cb331-7"></a>  <span class="dt">outcome =</span> <span class="st">&quot;y&quot;</span></span>
<span id="cb331-8"><a href="causal-inf.html#cb331-8"></a>)</span>
<span id="cb331-9"><a href="causal-inf.html#cb331-9"></a></span>
<span id="cb331-10"><a href="causal-inf.html#cb331-10"></a><span class="co"># theme_dag() coloca la trama en un fondo blanco sin etiquetas en los ejes</span></span>
<span id="cb331-11"><a href="causal-inf.html#cb331-11"></a><span class="kw">ggdag</span>(simple_dag) <span class="op">+</span><span class="st"> </span></span>
<span id="cb331-12"><a href="causal-inf.html#cb331-12"></a><span class="st">  </span><span class="kw">theme_dag</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:build-simple-dag"></span>
<img src="10-causal-inf_es_files/figure-html/build-simple-dag-1.png" alt="DAG básico diseñado con \texttt{ggdag()}" width="55%" />
<p class="caption">
Figura 10.9: DAG básico diseñado con 
</p>
</div>
<p>Establecer <code>x</code> e <code>y</code> como tus variables independiente y dependiente es opcional si lo que deseas es un gráfico simple, pero si lo configuras así, puedes colorear los puntos por tipo de nodo:</p>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="causal-inf.html#cb332-1"></a><span class="kw">ggdag_status</span>(simple_dag) <span class="op">+</span></span>
<span id="cb332-2"><a href="causal-inf.html#cb332-2"></a><span class="st">  </span><span class="kw">theme_dag</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:status-dag"></span>
<img src="10-causal-inf_es_files/figure-html/status-dag-1.png" alt="DAG con nodos coloreados por estatus" width="55%" />
<p class="caption">
Figura 10.10: DAG con nodos coloreados por estatus
</p>
</div>
<p>Observe cómo el diseño es diferente en ambos gráficos. Por defecto, <code>ggdag ()</code> coloca los nodos aleatoriamente cada vez que usa un algoritmo de red. Puedes cambiar el algoritmo utilizando el argumento <code>layout</code>:<code>ggdag (simple_dag, layout = "nicely")</code>. Puedes ver una lista completa de los posibles algoritmos ejecutando <code>?layout_tbl_graph_igraph</code> en la consola.</p>
<p>Alternativamente, puedes especificar tus propias coordenadas para que los nodos se coloquen en el mismo lugar cada vez. Logras esto con el argumento <code>coords</code> en<code>dagify ()</code>:</p>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="causal-inf.html#cb333-1"></a>simple_dag_with_coords &lt;-<span class="st"> </span><span class="kw">dagify</span>(</span>
<span id="cb333-2"><a href="causal-inf.html#cb333-2"></a>  y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>a <span class="op">+</span><span class="st"> </span>b,</span>
<span id="cb333-3"><a href="causal-inf.html#cb333-3"></a>  x <span class="op">~</span><span class="st"> </span>a <span class="op">+</span><span class="st"> </span>b,</span>
<span id="cb333-4"><a href="causal-inf.html#cb333-4"></a>  <span class="dt">exposure =</span> <span class="st">&quot;x&quot;</span>,</span>
<span id="cb333-5"><a href="causal-inf.html#cb333-5"></a>  <span class="dt">outcome =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb333-6"><a href="causal-inf.html#cb333-6"></a>  <span class="dt">coords =</span> <span class="kw">list</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dt">x =</span> <span class="dv">1</span>, <span class="dt">a =</span> <span class="dv">2</span>, <span class="dt">b =</span> <span class="dv">2</span>, <span class="dt">y =</span> <span class="dv">3</span>),</span>
<span id="cb333-7"><a href="causal-inf.html#cb333-7"></a>                <span class="dt">y =</span> <span class="kw">c</span>(<span class="dt">x =</span> <span class="dv">2</span>, <span class="dt">a =</span> <span class="dv">1</span>, <span class="dt">b =</span> <span class="dv">3</span>, <span class="dt">y =</span> <span class="dv">2</span>))</span>
<span id="cb333-8"><a href="causal-inf.html#cb333-8"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="causal-inf.html#cb334-1"></a><span class="kw">ggdag_status</span>(simple_dag_with_coords) <span class="op">+</span><span class="st"> </span></span>
<span id="cb334-2"><a href="causal-inf.html#cb334-2"></a><span class="st">  </span><span class="kw">theme_dag</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:coords-dag"></span>
<img src="10-causal-inf_es_files/figure-html/coords-dag-1.png" alt="DAG con coordenadas manuales" width="55%" />
<p class="caption">
Figura 10.11: DAG con coordenadas manuales
</p>
</div>
<p>Esto ya lo sabrás de los capítulos previos, pero es bueno aclarar que los nombres de variables que uses no tienen que limitarse a solo <code>x</code>, <code>y</code> y otras letras minúsculas. Puedes usar cualquier nombre que desees, siempre que no haya espacios.</p>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="causal-inf.html#cb335-1"></a>dag_with_var_names &lt;-<span class="st"> </span><span class="kw">dagify</span>(</span>
<span id="cb335-2"><a href="causal-inf.html#cb335-2"></a>  resultado <span class="op">~</span><span class="st"> </span>tratamiento <span class="op">+</span><span class="st"> </span>confundidor1 <span class="op">+</span><span class="st"> </span>confundidor2,</span>
<span id="cb335-3"><a href="causal-inf.html#cb335-3"></a>  tratamiento <span class="op">~</span><span class="st"> </span>confundidor1 <span class="op">+</span><span class="st"> </span>confundidor2,</span>
<span id="cb335-4"><a href="causal-inf.html#cb335-4"></a>  <span class="dt">exposure =</span> <span class="st">&quot;tratamiento&quot;</span>,</span>
<span id="cb335-5"><a href="causal-inf.html#cb335-5"></a>  <span class="dt">outcome =</span> <span class="st">&quot;resultado&quot;</span></span>
<span id="cb335-6"><a href="causal-inf.html#cb335-6"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="causal-inf.html#cb336-1"></a><span class="kw">ggdag_status</span>(dag_with_var_names) <span class="op">+</span><span class="st"> </span></span>
<span id="cb336-2"><a href="causal-inf.html#cb336-2"></a><span class="st">  </span><span class="kw">theme_dag</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:plot-name-dag"></span>
<img src="10-causal-inf_es_files/figure-html/plot-name-dag-1.png" alt="DAG con nombres en los nodos" width="55%" />
<p class="caption">
Figura 10.12: DAG con nombres en los nodos
</p>
</div>
<p>Sin embargo, a menos que uses nombres muy cortos, es probable que el texto no se ajuste dentro de los nodos. Para evitar esto, puede agregar etiquetas a los nodos utilizando el argumento <code>labels</code> en <code>dagify ()</code>. Trace las etiquetas configurando <code>use_labels =" label "</code> en <code>ggdag ()</code>. Puedes desactivar el texto en los nodos con <code>text = FALSE</code> en<code>ggdag ()</code>.</p>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="causal-inf.html#cb337-1"></a>simple_dag_with_coords_and_labels &lt;-<span class="st"> </span><span class="kw">dagify</span>(</span>
<span id="cb337-2"><a href="causal-inf.html#cb337-2"></a>  y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>a <span class="op">+</span><span class="st"> </span>b,</span>
<span id="cb337-3"><a href="causal-inf.html#cb337-3"></a>  x <span class="op">~</span><span class="st"> </span>a <span class="op">+</span><span class="st"> </span>b,</span>
<span id="cb337-4"><a href="causal-inf.html#cb337-4"></a>  <span class="dt">exposure =</span> <span class="st">&quot;x&quot;</span>,</span>
<span id="cb337-5"><a href="causal-inf.html#cb337-5"></a>  <span class="dt">outcome =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb337-6"><a href="causal-inf.html#cb337-6"></a>  <span class="dt">labels =</span> <span class="kw">c</span>(<span class="dt">y =</span> <span class="st">&quot;Resultado&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;Tratamiento&quot;</span>, </span>
<span id="cb337-7"><a href="causal-inf.html#cb337-7"></a>             <span class="dt">a =</span> <span class="st">&quot;Confundidor 1&quot;</span>, <span class="dt">b =</span> <span class="st">&quot;Confundidor 2&quot;</span>),</span>
<span id="cb337-8"><a href="causal-inf.html#cb337-8"></a>  <span class="dt">coords =</span> <span class="kw">list</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dt">x =</span> <span class="dv">1</span>, <span class="dt">a =</span> <span class="dv">2</span>, <span class="dt">b =</span> <span class="dv">2</span>, <span class="dt">y =</span> <span class="dv">3</span>),</span>
<span id="cb337-9"><a href="causal-inf.html#cb337-9"></a>                <span class="dt">y =</span> <span class="kw">c</span>(<span class="dt">x =</span> <span class="dv">2</span>, <span class="dt">a =</span> <span class="dv">1</span>, <span class="dt">b =</span> <span class="dv">3</span>, <span class="dt">y =</span> <span class="dv">2</span>))</span>
<span id="cb337-10"><a href="causal-inf.html#cb337-10"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="causal-inf.html#cb338-1"></a><span class="kw">ggdag_status</span>(simple_dag_with_coords_and_labels, </span>
<span id="cb338-2"><a href="causal-inf.html#cb338-2"></a>             <span class="dt">use_labels =</span> <span class="st">&quot;label&quot;</span>, <span class="dt">text =</span> <span class="ot">FALSE</span>) <span class="op">+</span></span>
<span id="cb338-3"><a href="causal-inf.html#cb338-3"></a><span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="ot">FALSE</span>, <span class="dt">color =</span> <span class="ot">FALSE</span>) <span class="op">+</span><span class="st">  </span><span class="co"># Quitar la leyenda</span></span>
<span id="cb338-4"><a href="causal-inf.html#cb338-4"></a><span class="st">  </span><span class="kw">theme_dag</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:plot-label-dag"></span>
<img src="10-causal-inf_es_files/figure-html/plot-label-dag-1.png" alt="DAG con etiquetas en los nodos" width="55%" />
<p class="caption">
Figura 10.13: DAG con etiquetas en los nodos
</p>
</div>
</div>
<div id="encontrar-caminos-y-sets-de-ajustes-con-r" class="section level3">
<h3><span class="header-section-number">10.6.4</span> Encontrar caminos y sets de ajustes con R</h3>
<p>R también puede realizar análisis en objetos DAG. Por ejemplo, podemos encontrar todas las implicaciones comprobables del DAG utilizando la función <code>impliedConditionalIndependencies ()</code> del paquete <code>dagitty</code>. Para este DAG simple, solo hay uno: <code>a</code> debe ser independiente de<code>b</code>. Si tuviéramos una base de datos con columnas para cada una de estas variables, podríamos verificar si esto es cierto ejecutando <code>cor (a, b)</code> para ver si las dos están relacionadas.</p>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="causal-inf.html#cb339-1"></a><span class="kw">library</span>(dagitty)</span>
<span id="cb339-2"><a href="causal-inf.html#cb339-2"></a></span>
<span id="cb339-3"><a href="causal-inf.html#cb339-3"></a><span class="kw">impliedConditionalIndependencies</span>(simple_dag)</span>
<span id="cb339-4"><a href="causal-inf.html#cb339-4"></a><span class="co">## a _||_ b</span></span></code></pre></div>
<p>También podemos encontrar todas las rutas entre <code>x</code> e<code>y</code> usando la función <code>paths ()</code> del paquete <code>dagitty</code>. Podemos ver que hay tres caminos abiertos entre <code>x</code> e<code>y</code>:</p>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="causal-inf.html#cb340-1"></a><span class="kw">paths</span>(simple_dag)</span>
<span id="cb340-2"><a href="causal-inf.html#cb340-2"></a><span class="co">## $paths</span></span>
<span id="cb340-3"><a href="causal-inf.html#cb340-3"></a><span class="co">## [1] &quot;x -&gt; y&quot;      &quot;x &lt;- a -&gt; y&quot; &quot;x &lt;- b -&gt; y&quot;</span></span>
<span id="cb340-4"><a href="causal-inf.html#cb340-4"></a><span class="co">## </span></span>
<span id="cb340-5"><a href="causal-inf.html#cb340-5"></a><span class="co">## $open</span></span>
<span id="cb340-6"><a href="causal-inf.html#cb340-6"></a><span class="co">## [1] TRUE TRUE TRUE</span></span></code></pre></div>
<p>El primer camino abierto está bien: queremos una única relación <em>d</em>conectada entre el tratamiento y el control, pero las otras dos indican que hay confusión entre <code>a</code> y<code>b</code>. Podemos ver cuáles son cada una de estas rutas con la función <code>ggdag_paths ()</code> del paquete <code>ggdag</code>:</p>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="causal-inf.html#cb341-1"></a><span class="kw">ggdag_paths</span>(simple_dag_with_coords) <span class="op">+</span></span>
<span id="cb341-2"><a href="causal-inf.html#cb341-2"></a><span class="st">  </span><span class="kw">theme_dag</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:plot-dag-paths"></span>
<img src="10-causal-inf_es_files/figure-html/plot-dag-paths-1.png" alt="Todos los caminos posibles entre \texttt{x} e \texttt{y}" width="70%" />
<p class="caption">
Figura 10.14: Todos los caminos posibles entre  e 
</p>
</div>
<p>En vez de enumerar todos los caminos posibles e identificar puertas traseras a mano, puede usar la función <code>settingsSets ()</code> en el paquete <code>dagitty</code> para buscar todos los nodos que necesitan ser ajustados. Aquí vemos que tanto <code>a</code> como<code>b</code> deben controlarse para aislar la relación <code>x -&gt; y</code>.</p>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb342-1"><a href="causal-inf.html#cb342-1"></a><span class="kw">adjustmentSets</span>(simple_dag)</span>
<span id="cb342-2"><a href="causal-inf.html#cb342-2"></a><span class="co">##  { a, b }</span></span></code></pre></div>
<p>También puedes visualizar los sets de ajustes con <code>ggdag_adjustment_set ()</code> en el paquete <code>ggdag</code>. Asegúrate de establecer <code>shadow = TRUE</code> para dibujar las flechas que salen de los nodos ajustados ya que de manera predeterminada, no están incluidos.</p>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="causal-inf.html#cb343-1"></a><span class="kw">ggdag_adjustment_set</span>(simple_dag_with_coords, <span class="dt">shadow =</span> <span class="ot">TRUE</span>) <span class="op">+</span></span>
<span id="cb343-2"><a href="causal-inf.html#cb343-2"></a><span class="st">  </span><span class="kw">theme_dag</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:plot-adjustment-sets"></span>
<img src="10-causal-inf_es_files/figure-html/plot-adjustment-sets-1.png" alt="Sets de ajuste en un DAG" width="55%" />
<p class="caption">
Figura 10.15: Sets de ajuste en un DAG
</p>
</div>
<p>R encontrará conjuntos de ajustes mínimamente suficientes, que incluyen el menor número de ajustes necesarios para cerrar todas las puertas traseras entre <code>x</code> e<code>y</code>. En este ejemplo, el DAG solo tiene un set de variables (<code>a</code> y<code>b</code>), pero en otras situaciones podría haber muchos sets posibles, o ninguno si el efecto causal no es identificable.</p>
<blockquote>
<p><strong>Ejercicio 10B.</strong> En el Capítulo 6, hiciste una regresión múltiple para estimar los determinantes de la desigualdad en América Latina y el Caribe (<span class="citation">Huber et al. (<a href="referencias.html#ref-huberPoliticsInequalityLatin2006" role="doc-biblioref">2006</a>)</span>). Para este ejercicio, dibujarás un DAG que modele el efecto causal de la <em>diversidad étnica</em> sobre la <em>desigualdad social</em>. Haz lo siguiente:</p>
<ol style="list-style-type: decimal">
<li><p>Enumera todas las variables que utilizaste en ese capítulo (PIB, inversión extranjera directa, gasto en salud, etc.) y cualquier otra variable que parezca relevante para explicar la desigualdad social.</p></li>
<li><p>Dibuja un DAG inicial a mano en papel o en una pizarra y considera cuidadosamente las relaciones causales entre los diferentes nodos.</p></li>
<li><p>Dibuja el DAG con DAGitty. Asigne la desigualdad como el resultado y la diversidad étnica como la variable independiente. Si alguno de tus nodos no es observado, asígnelos como latentes. Determine para qué nodos deben ajustarse.</p></li>
<li><p>Dibuja el DAG en R con <code>ggdag()</code>.</p></li>
</ol>
</blockquote>
</div>
</div>
<div id="haciendo-ajustes-causales" class="section level2">
<h2><span class="header-section-number">10.7</span> Haciendo ajustes causales</h2>
<p>A lo largo de este capítulo, hemos hablado sobre el ajuste de los confusores para cerrar los caminos de las puertas traseras, pero hasta ahora no hemos explorado cómo hacer realmente estos ajustes. No hay un método único y correcto para ajustar los nodos. Matemáticamente, el ajuste significa eliminar la variación que proviene de los confusores fuera de los nodos de tratamiento y control. Por ejemplo, en el DAG de la figura @ref(fig: money-votes-simple), eliminamos el efecto de la calidad del candidato sobre el dinero recaudado, eliminamos el efecto de la calidad del candidato sobre el total de votos, y luego comparamos el efecto sin confusión del dinero recaudado sobre el total de votos. Podemos explicar el efecto de la calidad del candidato estratificando nuestra muestra en candidatos de alta y baja calidad, realizando una regresión que incluya la calidad del candidato como covariable, encontrando pares coincidentes en los datos que tengan valores de calidad similares, o ponderando las observaciones por calidad. En esta sección, recorreremos tres formas comunes de hacer ajustes: regresión múltiple, emparejamiento y ponderación de probabilidad inversa.</p>
<div id="datos-de-redes-para-mosquitos" class="section level3">
<h3><span class="header-section-number">10.7.1</span> Datos de redes para mosquitos</h3>
<p>En lugar de utilizar una base de datos real de ciencia política, exploraremos diferentes métodos para hacer ajustes utilizando datos simulados que generé sobre un programa de desarrollo internacional diseñado para reducir el riesgo de malaria utilizando mosquiteros. Los mismos métodos y principios se aplican al análisis utilizando datos reales, pero es imposible conocer el verdadero efecto causal preexistente en los datos reales de observación, por lo que no hay forma de comparar las estimaciones con la “verdad”. Sin embargo, debido a que nuestros datos son simulados, sabemos que la (hipotética) verdad de que el uso de mosquiteros <em>causa</em> que el riesgo de malaria disminuya, en promedio, en 10 puntos.</p>
<p>A los investigadores les interesa saber si el uso de mosquiteros disminuye el riesgo de que una persona contraiga malaria. Para ello han recopilado datos de 1.752 hogares en un país sin nombre y tienen variables relacionadas con los factores ambientales, salud individual y las características de los hogares. Además, este país tiene un programa especial que proporciona mosquiteros gratuitos a los hogares que cumplen con requisitos específicos: para calificar para el programa, debe haber más de 4 miembros del hogar, y el ingreso mensual del hogar debe ser inferior a 700 dólares al mes. Los hogares no se inscriben automáticamente en el programa, y muchos no lo usan. Los datos no son experimentales - los investigadores no tienen control sobre quién usa los mosquiteros, y los hogares individuales toman sus propias decisiones sobre si solicitan mosquiteros gratuitos o compran sus propios mosquiteros, así como si usan los mosquiteros si los tienen.</p>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="causal-inf.html#cb344-1"></a>mosquito_dag &lt;-<span class="st"> </span><span class="kw">dagify</span>(</span>
<span id="cb344-2"><a href="causal-inf.html#cb344-2"></a>  riesgo_malaria <span class="op">~</span><span class="st"> </span>red <span class="op">+</span><span class="st"> </span>ingreso <span class="op">+</span><span class="st"> </span>salud <span class="op">+</span><span class="st"> </span>temperatura <span class="op">+</span><span class="st"> </span>resistencia,</span>
<span id="cb344-3"><a href="causal-inf.html#cb344-3"></a>  red  <span class="op">~</span><span class="st"> </span>ingreso <span class="op">+</span><span class="st"> </span>salud <span class="op">+</span><span class="st"> </span>temperatura <span class="op">+</span><span class="st"> </span>elegible <span class="op">+</span><span class="st"> </span>hogar,</span>
<span id="cb344-4"><a href="causal-inf.html#cb344-4"></a>  elegible <span class="op">~</span><span class="st"> </span>ingreso <span class="op">+</span><span class="st"> </span>hogar,</span>
<span id="cb344-5"><a href="causal-inf.html#cb344-5"></a>  salud <span class="op">~</span><span class="st"> </span>ingreso,</span>
<span id="cb344-6"><a href="causal-inf.html#cb344-6"></a>  <span class="dt">exposure =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb344-7"><a href="causal-inf.html#cb344-7"></a>  <span class="dt">outcome =</span> <span class="st">&quot;riesgo_malaria&quot;</span>,</span>
<span id="cb344-8"><a href="causal-inf.html#cb344-8"></a>  <span class="dt">coords =</span> <span class="kw">list</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dt">riesgo_malaria =</span> <span class="dv">7</span>, <span class="dt">red  =</span> <span class="dv">3</span>, <span class="dt">ingreso =</span> <span class="dv">4</span>, <span class="dt">salud =</span> <span class="dv">5</span>,</span>
<span id="cb344-9"><a href="causal-inf.html#cb344-9"></a>                      <span class="dt">temperatura =</span> <span class="dv">6</span>, <span class="dt">resistencia =</span> <span class="fl">8.5</span>, <span class="dt">elegible =</span> <span class="dv">2</span>, <span class="dt">hogar =</span> <span class="dv">1</span>),</span>
<span id="cb344-10"><a href="causal-inf.html#cb344-10"></a>                <span class="dt">y =</span> <span class="kw">c</span>(<span class="dt">riesgo_malaria =</span> <span class="dv">2</span>, <span class="dt">red  =</span> <span class="dv">2</span>, <span class="dt">ingreso =</span> <span class="dv">3</span>, <span class="dt">salud =</span> <span class="dv">1</span>,</span>
<span id="cb344-11"><a href="causal-inf.html#cb344-11"></a>                      <span class="dt">temperatura =</span> <span class="dv">3</span>, <span class="dt">resistencia =</span> <span class="dv">2</span>, <span class="dt">elegible =</span> <span class="dv">3</span>, <span class="dt">hogar =</span> <span class="dv">2</span>)),</span>
<span id="cb344-12"><a href="causal-inf.html#cb344-12"></a>  <span class="dt">labels =</span> <span class="kw">c</span>(<span class="dt">riesgo_malaria =</span> <span class="st">&quot;Riesgo de malaria&quot;</span>, <span class="dt">red  =</span> <span class="st">&quot;Mosquitero&quot;</span>, <span class="dt">ingreso =</span> <span class="st">&quot;Ingreso&quot;</span>,</span>
<span id="cb344-13"><a href="causal-inf.html#cb344-13"></a>             <span class="dt">salud =</span> <span class="st">&quot;Salud&quot;</span>, <span class="dt">temperatura =</span> <span class="st">&quot;temperaturas nocturnas&quot;</span>, </span>
<span id="cb344-14"><a href="causal-inf.html#cb344-14"></a>             <span class="dt">resistencia =</span> <span class="st">&quot;Resistencia a insecticidas&quot;</span>,</span>
<span id="cb344-15"><a href="causal-inf.html#cb344-15"></a>             <span class="dt">elegible =</span> <span class="st">&quot;Eligible para el programa&quot;</span>, <span class="dt">hogar =</span> <span class="st">&quot;Miembros en el hogar&quot;</span>)</span>
<span id="cb344-16"><a href="causal-inf.html#cb344-16"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="causal-inf.html#cb345-1"></a><span class="kw">ggdag_status</span>(mosquito_dag, <span class="dt">use_labels =</span> <span class="st">&quot;label&quot;</span>, <span class="dt">text =</span> <span class="ot">FALSE</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb345-2"><a href="causal-inf.html#cb345-2"></a><span class="st">  </span><span class="kw">theme_dag</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:mosquito-dag-plain"></span>
<img src="00-images/causal-inf/mosquito-dag-plain.png" alt="DAG del efecto de un hipotético programa de mosquiteros sobre el riesgo de malaria" width="60%" />
<p class="caption">
Figura 10.16: DAG del efecto de un hipotético programa de mosquiteros sobre el riesgo de malaria
</p>
</div>
<p>El gráfico causal de la figura <a href="causal-inf.html#fig:mosquito-dag-plain">10.16</a> esboza la relación completa entre el uso de mosquiteros y el riesgo de malaria. Cada nodo en el DAG es una columna en la base de datos recogida por los investigadores, e incluye lo siguiente:</p>
<ul>
<li>Riesgo de malaria (<code>riesgo_malaria</code>): La probabilidad de que alguien en el hogar se infecte con malaria. Se mide en una escala de 0-100, con valores más altos que indican un mayor riesgo.</li>
<li>Mosquitero (<code>red</code> y <code>red_cant</code>): Una variable binaria que indica si el hogar utiliza mosquiteros.</li>
<li>Elegible para el programa (<code>elegible</code>): Una variable binaria que indica si el hogar es elegible para el programa de mosquiteros gratuitos.</li>
<li>Ingresos (<code>ingreso</code>): Los ingresos mensuales del hogar, en dólares americanos.</li>
<li>Temperaturas nocturnas (<code>temperatura</code>): La temperatura media nocturna, en grados centígrados.</li>
<li>Salud (<code>salud</code>): La salud de la familia se declarada por sus propios miembros. Medido en una escala de 0-100, con valores más altos que indican mejor salud.</li>
<li>Número en el hogar (<code>hogar</code>): Número de personas que viven en el hogar.</li>
<li>Resistencia a los insecticidas (<code>resistencia</code>): Algunas cepas de mosquitos son más resistentes a los insecticidas y, por lo tanto, suponen un mayor riesgo de infectar a las personas con malaria. Esto se mide en una escala de 0-100, con valores más altos que indican una mayor resistencia.</li>
</ul>
<p>Según el DAG, el riesgo de contraer malaria es causado por los ingresos, las temperaturas, la salud, la resistencia a los insecticidas y el uso de mosquiteros. Las personas que viven en regiones más cálidas, tienen ingresos más bajos, tienen peor salud, están rodeadas de mosquitos con alta resistencia a los insecticidas y los que no utilizan mosquiteros corren un riesgo mayor de contraer malaria que los que los utilizan. El uso de los mosquiteros se explica por los ingresos, las temperaturas nocturnas, la salud, el número de personas que viven en la vivienda y la elegibilidad para el programa de mosquiteros gratuitos. Las personas que viven en zonas más frescas por la noche, tienen ingresos más altos, mejor salud, tienen más personas en el hogar, y son elegibles para los mosquiteros gratuitos del gobierno, tienen más probabilidades de usar regularmente los mosquiteros. El DAG también muestra que la elegibilidad para el programa de mosquiteros gratuitos se explica por los ingresos y el tamaño de los núcleos familiares, ya que los hogares deben cumplir con umbrales específicos para calificar.</p>
<p>Podemos cargar los datos y usar <code>glimpse()</code> para ver las primeras observaciones de cada columna:</p>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="causal-inf.html#cb346-1"></a><span class="kw">library</span>(tidyverse)</span></code></pre></div>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="causal-inf.html#cb347-1"></a><span class="kw">library</span>(paqueteadp)</span>
<span id="cb347-2"><a href="causal-inf.html#cb347-2"></a><span class="kw">data</span>(red_mosquitos)</span></code></pre></div>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="causal-inf.html#cb348-1"></a><span class="kw">glimpse</span>(red_mosquitos)</span>
<span id="cb348-2"><a href="causal-inf.html#cb348-2"></a><span class="co">## Rows: 1,752</span></span>
<span id="cb348-3"><a href="causal-inf.html#cb348-3"></a><span class="co">## Columns: 10</span></span>
<span id="cb348-4"><a href="causal-inf.html#cb348-4"></a><span class="co">## $ codigo         &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, …</span></span>
<span id="cb348-5"><a href="causal-inf.html#cb348-5"></a><span class="co">## $ red            &lt;lgl&gt; TRUE, FALSE, FALSE, TRUE, FALSE, FALSE, TRUE, F…</span></span>
<span id="cb348-6"><a href="causal-inf.html#cb348-6"></a><span class="co">## $ red_cant       &lt;dbl&gt; 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 0, 1,…</span></span>
<span id="cb348-7"><a href="causal-inf.html#cb348-7"></a><span class="co">## $ riesgo_malaria &lt;dbl&gt; 33, 42, 80, 34, 44, 25, 19, 35, 32, 40, 30, 14,…</span></span>
<span id="cb348-8"><a href="causal-inf.html#cb348-8"></a><span class="co">## $ ingreso        &lt;dbl&gt; 781, 974, 502, 671, 728, 1050, 1146, 1093, 1037…</span></span>
<span id="cb348-9"><a href="causal-inf.html#cb348-9"></a><span class="co">## $ salud          &lt;dbl&gt; 56, 57, 15, 20, 17, 48, 65, 75, 60, 36, 75, 62,…</span></span>
<span id="cb348-10"><a href="causal-inf.html#cb348-10"></a><span class="co">## $ hogar          &lt;dbl&gt; 2, 4, 3, 5, 5, 1, 3, 5, 3, 3, 6, 3, 4, 3, 1, 5,…</span></span>
<span id="cb348-11"><a href="causal-inf.html#cb348-11"></a><span class="co">## $ elegible       &lt;lgl&gt; FALSE, FALSE, FALSE, TRUE, FALSE, FALSE, FALSE,…</span></span>
<span id="cb348-12"><a href="causal-inf.html#cb348-12"></a><span class="co">## $ temperatura    &lt;dbl&gt; 21, 26, 26, 21, 19, 25, 27, 30, 28, 21, 17, 19,…</span></span>
<span id="cb348-13"><a href="causal-inf.html#cb348-13"></a><span class="co">## $ resistencia    &lt;dbl&gt; 59, 73, 65, 46, 54, 34, 45, 65, 55, 54, 33, 39,…</span></span></code></pre></div>
</div>
<div id="verificar-las-independencias-condicionales" class="section level3">
<h3><span class="header-section-number">10.7.2</span> Verificar las independencias condicionales</h3>
<p>Antes de proceder a identificar la relación causal entre el uso de mosquiteros y el riesgo de malaria, debemos comprobar primero si las relaciones definidas por nuestro DAG reflejan la realidad de los datos. Recordemos que la <em>d</em>separación implica que los nodos son estadísticamente independientes entre sí y no transfieren información asociativa. Si dibujas el DAG en la Figura <a href="causal-inf.html#fig:mosquito-dag-plain">10.16</a> en DAGitty, o si ejecutas <code>impliedConditionalIndependencies()</code> en R, puedes ver una lista de todas las independencias condicionales implícitas.</p>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="causal-inf.html#cb349-1"></a><span class="kw">impliedConditionalIndependencies</span>(mosquito_dag)</span>
<span id="cb349-2"><a href="causal-inf.html#cb349-2"></a><span class="co">## elegible _||_ resistencia</span></span>
<span id="cb349-3"><a href="causal-inf.html#cb349-3"></a><span class="co">## elegible _||_ riesgo_malaria | ingreso, red, salud, temperatura</span></span>
<span id="cb349-4"><a href="causal-inf.html#cb349-4"></a><span class="co">## elegible _||_ salud | ingreso</span></span>
<span id="cb349-5"><a href="causal-inf.html#cb349-5"></a><span class="co">## elegible _||_ temperatura</span></span>
<span id="cb349-6"><a href="causal-inf.html#cb349-6"></a><span class="co">## hogar _||_ ingreso</span></span>
<span id="cb349-7"><a href="causal-inf.html#cb349-7"></a><span class="co">## hogar _||_ resistencia</span></span>
<span id="cb349-8"><a href="causal-inf.html#cb349-8"></a><span class="co">## hogar _||_ riesgo_malaria | ingreso, red, salud, temperatura</span></span>
<span id="cb349-9"><a href="causal-inf.html#cb349-9"></a><span class="co">## hogar _||_ salud</span></span>
<span id="cb349-10"><a href="causal-inf.html#cb349-10"></a><span class="co">## hogar _||_ temperatura</span></span>
<span id="cb349-11"><a href="causal-inf.html#cb349-11"></a><span class="co">## ingreso _||_ resistencia</span></span>
<span id="cb349-12"><a href="causal-inf.html#cb349-12"></a><span class="co">## ingreso _||_ temperatura</span></span>
<span id="cb349-13"><a href="causal-inf.html#cb349-13"></a><span class="co">## red _||_ resistencia</span></span>
<span id="cb349-14"><a href="causal-inf.html#cb349-14"></a><span class="co">## resistencia _||_ salud</span></span>
<span id="cb349-15"><a href="causal-inf.html#cb349-15"></a><span class="co">## resistencia _||_ temperatura</span></span>
<span id="cb349-16"><a href="causal-inf.html#cb349-16"></a><span class="co">## salud _||_ temperatura</span></span></code></pre></div>
<p>Por motivos de espacio aquí, no verificaremos todas estas independencias implícitas, pero podemos probar algunas de ellas:</p>
<ul>
<li><p><span class="math inline">\(\text{Salud} \perp \text{Miembros en el hogar}\)</span>: La salud debe ser independiente del número de personas en cada hogar. En los datos, las dos variables no deben estar correlacionadas. Este es el caso:</p>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="causal-inf.html#cb350-1"></a><span class="kw">cor</span>(red_mosquitos<span class="op">$</span>salud, red_mosquitos<span class="op">$</span>hogar)</span>
<span id="cb350-2"><a href="causal-inf.html#cb350-2"></a><span class="co">## [1] 9.8e-05</span></span></code></pre></div></li>
<li><p><span class="math inline">\(\text{Income} \perp \text{Insecticide resistencia}\)</span>: Income should be independent of insecticide resistencia. This is again true:</p>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="causal-inf.html#cb351-1"></a><span class="kw">cor</span>(red_mosquitos<span class="op">$</span>ingreso, red_mosquitos<span class="op">$</span>resistencia)</span>
<span id="cb351-2"><a href="causal-inf.html#cb351-2"></a><span class="co">## [1] 0.014</span></span></code></pre></div></li>
<li><p><span class="math inline">\(\text{Riesgo de malaria} \perp \text{Miembros en el hogar}\ |\ \text{Salud, Ingreso, Uso de la red, Temperatura}\)</span>: El riesgo de malaria debe ser independiente del número de miembros de la familia, dado que los niveles de salud, ingresos, uso de mosquiteros y temperaturas nocturnas son similares. No podemos utilizar <code>cor()</code> para probar esta implicación, ya que hay muchas variables en juego, pero podemos utilizar un modelo de regresión para comprobar si el número de miembros del hogar está significativamente relacionado con el riesgo de malaria. No es significativo (<span class="math inline">\(t = -0.17\)</span>, <span class="math inline">\(p = 0.863\)</span>), lo que significa que los dos son independientes, como se esperaba.</p>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb352-1"><a href="causal-inf.html#cb352-1"></a><span class="kw">lm</span>(riesgo_malaria <span class="op">~</span><span class="st"> </span>hogar <span class="op">+</span><span class="st"> </span>salud <span class="op">+</span><span class="st"> </span>ingreso <span class="op">+</span><span class="st"> </span>red  <span class="op">+</span><span class="st"> </span>temperatura, </span>
<span id="cb352-2"><a href="causal-inf.html#cb352-2"></a>   <span class="dt">data =</span> red_mosquitos) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb352-3"><a href="causal-inf.html#cb352-3"></a><span class="st">  </span>broom<span class="op">::</span><span class="kw">tidy</span>()</span>
<span id="cb352-4"><a href="causal-inf.html#cb352-4"></a><span class="co">## # A tibble: 6 x 5</span></span>
<span id="cb352-5"><a href="causal-inf.html#cb352-5"></a><span class="co">##   term        estimate std.error statistic  p.value</span></span>
<span id="cb352-6"><a href="causal-inf.html#cb352-6"></a><span class="co">##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span id="cb352-7"><a href="causal-inf.html#cb352-7"></a><span class="co">## 1 (Intercept)  76.2       0.966     78.9   0.      </span></span>
<span id="cb352-8"><a href="causal-inf.html#cb352-8"></a><span class="co">## 2 hogar        -0.0155    0.0893    -0.173 8.63e- 1</span></span>
<span id="cb352-9"><a href="causal-inf.html#cb352-9"></a><span class="co">## 3 salud         0.148     0.0107    13.9   9.75e-42</span></span>
<span id="cb352-10"><a href="causal-inf.html#cb352-10"></a><span class="co">## # … with 3 more rows</span></span></code></pre></div></li>
</ul>
<p>Después de comprobar todas las demás dependencias condicionales, podemos saber si nuestro DAG captura la realidad del sistema completo de factores que influyen en el uso de mosquiteros y el riesgo de malaria. Si hay correlaciones sustanciales y significativas entre los nodos que deberían ser independientes, es probable que haya un problema con la especificación del DAG. Si es así, vuelves a la teoría y refinas más tu DAG.</p>
</div>
<div id="encuentra-el-set-de-ajuste" class="section level3">
<h3><span class="header-section-number">10.7.3</span> Encuentra el set de ajuste</h3>
<p>Existe una vía directa entre el uso de mosquiteros y el riesgo de contraer malaria, pero el efecto no se identifica causalmente debido a otras varias vías abiertas. Podemos enumerar todos los caminos y encontrar cuáles tienen flechas que apuntan hacia atrás en el nodo del mosquitero (ejecuta <code>paths(mosquito_dag)</code> para ver estos resultados), o podemos dejar que R encuentre los sets de ajuste apropiados automáticamente:</p>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="causal-inf.html#cb353-1"></a><span class="kw">adjustmentSets</span>(mosquito_dag)</span>
<span id="cb353-2"><a href="causal-inf.html#cb353-2"></a><span class="co">##  { ingreso, salud, temperatura }</span></span></code></pre></div>
<p>Basándose en las relaciones entre todos los nodos del DAG, el ajuste por salud, ingresos y temperatura es suficiente para cerrar todas las puertas traseras e identificar la relación entre el uso de la red y el riesgo de malaria (ver Figura <a href="causal-inf.html#fig:mosquito-dag-adjusted">10.17</a>). Es importante destacar que no tenemos que preocuparnos por ninguno de los nodos relacionados con el programa gubernamental de redes gratuitas, ya que esos nodos no están <em>d</em> conectados con el riesgo de malaria. Sólo tenemos que preocuparnos por las relaciones de confusión.</p>
<p>Podemos confirmar esto gráficamente con <code>ggdag_adjustment_set()</code>:</p>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="causal-inf.html#cb354-1"></a><span class="kw">ggdag_adjustment_set</span>(mosquito_dag, <span class="dt">shadow =</span> <span class="ot">TRUE</span>,</span>
<span id="cb354-2"><a href="causal-inf.html#cb354-2"></a>                     <span class="dt">use_labels =</span> <span class="st">&quot;label&quot;</span>, <span class="dt">text =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:mosquito-dag-adjusted"></span>
<img src="00-images/causal-inf/mosquito-dag-adjusted.png" alt="Adjustment set to identify the relationship between mosquito red  use and malaria risk" width="60%" />
<p class="caption">
Figura 10.17: Adjustment set to identify the relationship between mosquito red use and malaria risk
</p>
</div>
</div>
<div id="estimación-ingenua-no-ajustada" class="section level3">
<h3><span class="header-section-number">10.7.4</span> Estimación ingenua no ajustada</h3>
<p>Como base de referencia para los otros enfoques de ajuste que intentaremos, podemos ver primero cuál es la relación entre el uso de mosquiteros y el riesgo de malaria en ausencia de cualquier ajuste. Si creamos un cuadro de la distribución del riesgo de malaria entre las personas que usan y no usan mosquiteros, vemos que el riesgo medio es sustancialmente menor entre los que usan mosquiteros (véase la figura <a href="causal-inf.html#fig:naive-boxplots">10.18</a>).</p>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="causal-inf.html#cb355-1"></a><span class="kw">ggplot</span>(red_mosquitos, <span class="kw">aes</span>(<span class="dt">x =</span> red , <span class="dt">y =</span> riesgo_malaria)) <span class="op">+</span></span>
<span id="cb355-2"><a href="causal-inf.html#cb355-2"></a><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></span>
<span id="cb355-3"><a href="causal-inf.html#cb355-3"></a><span class="st">  </span>cowplot<span class="op">::</span><span class="kw">theme_cowplot</span>(<span class="dt">font_size =</span> <span class="dv">11</span>, <span class="dt">font_family =</span> <span class="st">&quot;LM Roman 10&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:naive-boxplots"></span>
<img src="10-causal-inf_es_files/figure-html/naive-boxplots-1.png" alt="Distribución del riesgo de malaria entre quienes usaron y no usaron mosquiteros" width="384" />
<p class="caption">
Figura 10.18: Distribución del riesgo de malaria entre quienes usaron y no usaron mosquiteros
</p>
</div>
<p>Podemos ejecutar un simple modelo de regresión para medir la diferencia promedio exacta:</p>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="causal-inf.html#cb356-1"></a>model_naive &lt;-<span class="st"> </span><span class="kw">lm</span>(riesgo_malaria <span class="op">~</span><span class="st"> </span>red , <span class="dt">data =</span> red_mosquitos)</span>
<span id="cb356-2"><a href="causal-inf.html#cb356-2"></a></span>
<span id="cb356-3"><a href="causal-inf.html#cb356-3"></a>texreg<span class="op">::</span><span class="kw">screenreg</span>(model_naive)</span>
<span id="cb356-4"><a href="causal-inf.html#cb356-4"></a><span class="co">## </span></span>
<span id="cb356-5"><a href="causal-inf.html#cb356-5"></a><span class="co">## ========================</span></span>
<span id="cb356-6"><a href="causal-inf.html#cb356-6"></a><span class="co">##              Model 1    </span></span>
<span id="cb356-7"><a href="causal-inf.html#cb356-7"></a><span class="co">## ------------------------</span></span>
<span id="cb356-8"><a href="causal-inf.html#cb356-8"></a><span class="co">## (Intercept)    41.94 ***</span></span>
<span id="cb356-9"><a href="causal-inf.html#cb356-9"></a><span class="co">##                (0.40)   </span></span>
<span id="cb356-10"><a href="causal-inf.html#cb356-10"></a><span class="co">## redTRUE       -16.33 ***</span></span>
<span id="cb356-11"><a href="causal-inf.html#cb356-11"></a><span class="co">##                (0.65)   </span></span>
<span id="cb356-12"><a href="causal-inf.html#cb356-12"></a><span class="co">## ------------------------</span></span>
<span id="cb356-13"><a href="causal-inf.html#cb356-13"></a><span class="co">## R^2             0.27    </span></span>
<span id="cb356-14"><a href="causal-inf.html#cb356-14"></a><span class="co">## Adj. R^2        0.27    </span></span>
<span id="cb356-15"><a href="causal-inf.html#cb356-15"></a><span class="co">## Num. obs.    1752       </span></span>
<span id="cb356-16"><a href="causal-inf.html#cb356-16"></a><span class="co">## ========================</span></span>
<span id="cb356-17"><a href="causal-inf.html#cb356-17"></a><span class="co">## *** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</span></span></code></pre></div>
<p>Según este modelo, parece que el uso de un mosquitero está asociado con una disminución de 16 puntos en el riesgo de malaria. Sin embargo, este no es el efecto causal. Este es un caso en el que la correlación no es igual a la causalidad. Otros factores como los ingresos, la salud y las temperaturas confunden la relación entre el uso de los mosquiteros y el riesgo.</p>
</div>
<div id="regresiones" class="section level3">
<h3><span class="header-section-number">10.7.5</span> Regresiones</h3>
<p>Como ya está familiarizado con los modelos de regresión múltiple del capítulo 6, una forma rápida y fácil de tratar de ajustar las variables de confusión es incluirlas como covariables en una regresión lineal. A primera vista, esto tiene sentido intuitivo: el objetivo del ajuste es comparar los nodos de tratamiento y de resultado con los mismos valores de los diversos confusores, y el propósito de la regresión múltiple es explicar la variación del resultado manteniendo constantes las diferentes variables explicativas. Sin embargo, hacer ajustes de confusión con la regresión lineal dará como resultado relaciones causales correctamente identificadas sólo en circunstancias muy específicas. Para que el ajuste basado en la regresión funcione, las relaciones entre todos los nodos de tratamiento, resultado y confusión <em>deben ser lineales,</em> lo cual es difícil de probar y verificar con datos de observación reales. Casi siempre es mejor utilizar una de las otras técnicas de ajuste que se describen a continuación (matching o ponderación de probabilidad inversa), ya que esos métodos no se basan en el supuesto de la linealidad.</p>
<p>Con esta <em>importante advertencia</em>, podemos ajustar nuestras puertas traseras incluyéndolas en un modelo de regresión:</p>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="causal-inf.html#cb357-1"></a>model_regression &lt;-<span class="st"> </span><span class="kw">lm</span>(riesgo_malaria <span class="op">~</span><span class="st"> </span>red  <span class="op">+</span><span class="st"> </span>ingreso <span class="op">+</span><span class="st"> </span>temperatura <span class="op">+</span><span class="st"> </span>salud, </span>
<span id="cb357-2"><a href="causal-inf.html#cb357-2"></a>                       <span class="dt">data =</span> red_mosquitos)</span>
<span id="cb357-3"><a href="causal-inf.html#cb357-3"></a></span>
<span id="cb357-4"><a href="causal-inf.html#cb357-4"></a>texreg<span class="op">::</span><span class="kw">screenreg</span>(model_regression)</span>
<span id="cb357-5"><a href="causal-inf.html#cb357-5"></a><span class="co">## </span></span>
<span id="cb357-6"><a href="causal-inf.html#cb357-6"></a><span class="co">## ========================</span></span>
<span id="cb357-7"><a href="causal-inf.html#cb357-7"></a><span class="co">##              Model 1    </span></span>
<span id="cb357-8"><a href="causal-inf.html#cb357-8"></a><span class="co">## ------------------------</span></span>
<span id="cb357-9"><a href="causal-inf.html#cb357-9"></a><span class="co">## (Intercept)    76.16 ***</span></span>
<span id="cb357-10"><a href="causal-inf.html#cb357-10"></a><span class="co">##                (0.93)   </span></span>
<span id="cb357-11"><a href="causal-inf.html#cb357-11"></a><span class="co">## redTRUE       -10.44 ***</span></span>
<span id="cb357-12"><a href="causal-inf.html#cb357-12"></a><span class="co">##                (0.26)   </span></span>
<span id="cb357-13"><a href="causal-inf.html#cb357-13"></a><span class="co">## ingreso        -0.08 ***</span></span>
<span id="cb357-14"><a href="causal-inf.html#cb357-14"></a><span class="co">##                (0.00)   </span></span>
<span id="cb357-15"><a href="causal-inf.html#cb357-15"></a><span class="co">## temperatura     1.01 ***</span></span>
<span id="cb357-16"><a href="causal-inf.html#cb357-16"></a><span class="co">##                (0.03)   </span></span>
<span id="cb357-17"><a href="causal-inf.html#cb357-17"></a><span class="co">## salud           0.15 ***</span></span>
<span id="cb357-18"><a href="causal-inf.html#cb357-18"></a><span class="co">##                (0.01)   </span></span>
<span id="cb357-19"><a href="causal-inf.html#cb357-19"></a><span class="co">## ------------------------</span></span>
<span id="cb357-20"><a href="causal-inf.html#cb357-20"></a><span class="co">## R^2             0.89    </span></span>
<span id="cb357-21"><a href="causal-inf.html#cb357-21"></a><span class="co">## Adj. R^2        0.88    </span></span>
<span id="cb357-22"><a href="causal-inf.html#cb357-22"></a><span class="co">## Num. obs.    1752       </span></span>
<span id="cb357-23"><a href="causal-inf.html#cb357-23"></a><span class="co">## ========================</span></span>
<span id="cb357-24"><a href="causal-inf.html#cb357-24"></a><span class="co">## *** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</span></span></code></pre></div>
<p>Según estos resultados, el uso de un mosquitero <em>causa</em> una disminución de 10.44 puntos en el riesgo de paludismo, en promedio. Nótese que debido a que hemos ajustado los confusores, ahora podemos usar justificadamente el lenguaje causal en lugar de hablar simplemente de asociaciones.</p>
</div>
<div id="matching" class="section level3">
<h3><span class="header-section-number">10.7.6</span> Matching</h3>
<p>El principal problema de utilizar datos de observación en lugar de datos experimentales es que las personas que utilizaron un mosquitero lo hicieron sin ser asignadas a un grupo de tratamiento. Las características individuales llevaron a las personas a auto-seleccionarse para el tratamiento, lo que hace que las personas que usaron mosquiteros sean esencialmente diferentes de las que no lo hicieron. Gracias al DAG, conocemos muchos de los factores que causaron que la gente eligiera usar los mosquiteros: ingresos, salud y temperatura. Si pudiéramos agrupar las observaciones que son similares entre sí en cuanto a ingresos, salud y temperatura, pero que difieren en el uso de los mosquiteros, podríamos simular el tratamiento experimental y los grupos de control y, posiblemente, calcular un efecto causal más exacto, ya que estamos encontrando la estimación entre grupos comparables.</p>
<p>En el capítulo 7 se exploró la idea de matching para identificar estudios de casos relevantes en una investigación de métodos mixtos. Allí se crearon puntuaciones de propensión que estimaban la probabilidad de tratamiento, y luego se identificaron casos con puntuaciones de propensión similares (o muy diferentes). Si bien el emparejamiento con los puntajes de propensión es popular, puede causar problemas cuando se utiliza para la identificación causal (véase <span class="citation">King and Nielsen (<a href="referencias.html#ref-KingNielsen:2019" role="doc-biblioref">2019</a>)</span>). Sin embargo, existen alternativas. Una técnica común es encontrar coincidencias que minimicen la distancia entre los diferentes factores de confusión para cada observación.</p>
<p>Para ilustrar este concepto muy brevemente, considere un modelo causal en el que la edad y la educación son los únicos factores de confusión de la relación entre un tratamiento y un resultado. Algunas de las observaciones se autoseleccionaron en el tratamiento, mientras que el resto no. El panel A de la figura <a href="causal-inf.html#fig:matching-example">10.19</a> muestra la distribución del tratamiento auto-seleccionado a través de diferentes valores de edad y educación. Hay algunos patrones notables: sólo una observación tratada tiene más de 25 años de educación, y sólo una tiene menos de 15 años de edad. Si queremos crear grupos sintéticos de tratamiento y control a partir de estos datos, no tendría sentido comparar la única observación tratada de alto nivel educativo con observaciones no tratadas de bajo nivel educativo, ya que las dos observaciones tienen niveles muy diferentes de educación. Idealmente, queremos encontrar la observación altamente educada no tratada más cercana y usarla como comparación con la única observación altamente educada tratada.</p>
<p>Si podemos encontrar un conjunto de observaciones sin tratar que estén cerca en distancia de las observaciones tratadas, podemos crear un grupo equilibrado de observaciones tratadas y no tratadas. El panel B de la figura <a href="causal-inf.html#fig:matching-example">10.19</a> muestra cada uno de los pares más cercanos de observaciones tratadas y no tratadas. Podemos descartar cualquier observación sin tratar y sólo usar el grupo emparejado para hacer nuestra inferencia causal, ya que ahora aparentemente tenemos grupos de tratamiento y control comparables. Hay múltiples maneras de medir esta distancia - Mahalanobis y distancia euclidiana son comunes, pero no son los únicos métodos. También hay múltiples métodos para definir pares. En la figura <a href="causal-inf.html#fig:matching-example">10.19</a>, cada observación tratada se empareja con una única observación no tratada, pero también es posible permitir la duplicación y triplicación de los emparejamientos. El ejemplo de la figura <a href="causal-inf.html#fig:matching-example">10.19</a> minimiza la distancia entre dos dimensiones de las variables de confusión (edad y educación), pero se pueden utilizar tantas variables de confusión como sea necesario para crear pares de coincidencia.</p>
<div class="figure" style="text-align: center"><span id="fig:matching-example"></span>
<img src="00-images/causal-inf/matching-example.png" alt="Matching basado en la distancia Mahalanobis del vecino más cercano" width="600" />
<p class="caption">
Figura 10.19: Matching basado en la distancia Mahalanobis del vecino más cercano
</p>
</div>
<p>Podemos usar matching para ajustar los factores de confusión en nuestro DAG con la relación entre usar la red de mosquitos y el riesgo de malaria. La función <code>matchit()</code> en el paquete <code>Matchit</code> proporciona muchos métodos de emparejamiento diferentes, incluyendo la concordancia de Mahalanobis del vecino más cercano. No hay un método de concordancia que sea necesariamente el mejor, y deberás jugar con las diferentes opciones para los argumentos de <code>method</code> y <code>distance</code>. El argumento <code>replace = TRUE</code> permite que las observaciones tratadas se emparejen con más de una observación no tratada.</p>
<p>La función <code>matchit()</code> utiliza una sintaxis familiar basada en fórmulas para definir cómo hacer coincidir la asignación con los mosquiteros. Debido a que nuestro set de ajuste incluye ingresos, temperatura y salud, usamos las tres para crear las coincidencias.</p>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="causal-inf.html#cb358-1"></a><span class="kw">library</span>(MatchIt)</span>
<span id="cb358-2"><a href="causal-inf.html#cb358-2"></a></span>
<span id="cb358-3"><a href="causal-inf.html#cb358-3"></a>matched &lt;-<span class="st"> </span><span class="kw">matchit</span>(red <span class="op">~</span><span class="st"> </span>ingreso <span class="op">+</span><span class="st"> </span>temperatura <span class="op">+</span><span class="st"> </span>salud, </span>
<span id="cb358-4"><a href="causal-inf.html#cb358-4"></a>                   <span class="dt">data =</span> red_mosquitos,</span>
<span id="cb358-5"><a href="causal-inf.html#cb358-5"></a>                   <span class="dt">method =</span> <span class="st">&quot;nearest&quot;</span>, <span class="dt">distance =</span> <span class="st">&quot;mahalanobis&quot;</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="causal-inf.html#cb359-1"></a>matched</span></code></pre></div>
<pre><code>## 
## Call: 
## matchit(formula = red ~ ingreso + temperatura + salud,
##         data = red_mosquitos, 
##         method = &quot;nearest&quot;, distance = &quot;mahalanobis&quot;, replace = TRUE)
## 
## Sample sizes:
##           Control Treated
## All          1071     681
## Matched       439     681
## Unmatched     632       0
## Discarded       0       0</code></pre>
<p>Según el resultado de <code>matched</code>, las 681 observaciones tratadas (es decir, las que utilizaron mosquiteros) se emparejaron con 439 observaciones no tratadas (es decir, personas que son similares en cuanto a ingresos, temperatura nocturna y salud, pero que no utilizaron mosquiteros). 632 observaciones no tratadas no fueron emparejadas y serán descartadas. Si hubiéramos usado <code>replace = FALSE</code>, habría habido un número igual de observaciones tratadas y no tratadas; hay menos observaciones no tratadas aquí porque algunas se duplican o triplican.</p>
<p>Podemos crear una nueva base de datos basada en este matching con la función <code>match.data()</code>. Observa cómo ahora hay sólo 1120 filas en lugar de 1752, ya que hemos descartado las observaciones no emparejadas. También nota que hay una nueva columna llamada <code>weights</code>. La función <code>matchit()</code> asigna a los pares de observaciones emparejadas diferentes pesos dependiendo de lo cerca o lejos que estén los emparejamientos en un intento de controlar la variación de la distancia. Podemos utilizar estos pesos en nuestro modelo de regresión para mejorar nuestra estimación del efecto causal.</p>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="causal-inf.html#cb361-1"></a>red_mosquitos_matched &lt;-<span class="st"> </span><span class="kw">match.data</span>(matched)</span>
<span id="cb361-2"><a href="causal-inf.html#cb361-2"></a></span>
<span id="cb361-3"><a href="causal-inf.html#cb361-3"></a><span class="kw">glimpse</span>(red_mosquitos_matched)</span>
<span id="cb361-4"><a href="causal-inf.html#cb361-4"></a><span class="co">## Rows: 1,120</span></span>
<span id="cb361-5"><a href="causal-inf.html#cb361-5"></a><span class="co">## Columns: 12</span></span>
<span id="cb361-6"><a href="causal-inf.html#cb361-6"></a><span class="co">## $ codigo         &lt;dbl&gt; 1, 3, 4, 5, 6, 7, 8, 11, 12, 13, 14, 16, 17, 20…</span></span>
<span id="cb361-7"><a href="causal-inf.html#cb361-7"></a><span class="co">## $ red            &lt;lgl&gt; TRUE, FALSE, TRUE, FALSE, FALSE, TRUE, FALSE, F…</span></span>
<span id="cb361-8"><a href="causal-inf.html#cb361-8"></a><span class="co">## $ red_cant       &lt;dbl&gt; 1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 0, 1, 1, 1, 0, 0,…</span></span>
<span id="cb361-9"><a href="causal-inf.html#cb361-9"></a><span class="co">## $ riesgo_malaria &lt;dbl&gt; 33, 80, 34, 44, 25, 19, 35, 30, 14, 31, 34, 54,…</span></span>
<span id="cb361-10"><a href="causal-inf.html#cb361-10"></a><span class="co">## $ ingreso        &lt;dbl&gt; 781, 502, 671, 728, 1050, 1146, 1093, 889, 1133…</span></span>
<span id="cb361-11"><a href="causal-inf.html#cb361-11"></a><span class="co">## $ salud          &lt;dbl&gt; 56, 15, 20, 17, 48, 65, 75, 75, 62, 42, 53, 29,…</span></span>
<span id="cb361-12"><a href="causal-inf.html#cb361-12"></a><span class="co">## $ hogar          &lt;dbl&gt; 2, 3, 5, 5, 1, 3, 5, 6, 3, 4, 3, 5, 2, 6, 4, 3,…</span></span>
<span id="cb361-13"><a href="causal-inf.html#cb361-13"></a><span class="co">## $ elegible       &lt;lgl&gt; FALSE, FALSE, TRUE, FALSE, FALSE, FALSE, FALSE,…</span></span>
<span id="cb361-14"><a href="causal-inf.html#cb361-14"></a><span class="co">## $ temperatura    &lt;dbl&gt; 21, 26, 21, 19, 25, 27, 30, 17, 19, 28, 24, 26,…</span></span>
<span id="cb361-15"><a href="causal-inf.html#cb361-15"></a><span class="co">## $ resistencia    &lt;dbl&gt; 59, 65, 46, 54, 34, 45, 65, 33, 39, 37, 53, 55,…</span></span>
<span id="cb361-16"><a href="causal-inf.html#cb361-16"></a><span class="co">## $ distance       &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…</span></span>
<span id="cb361-17"><a href="causal-inf.html#cb361-17"></a><span class="co">## $ weights        &lt;dbl&gt; 1.00, 0.64, 1.00, 0.64, 1.29, 1.00, 1.93, 0.64,…</span></span></code></pre></div>
<p>Por último, podemos hacer una regresión usando los datos emparejados:</p>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb362-1"><a href="causal-inf.html#cb362-1"></a>model_matched &lt;-<span class="st"> </span><span class="kw">lm</span>(riesgo_malaria <span class="op">~</span><span class="st"> </span>red , <span class="dt">data =</span> red_mosquitos_matched, </span>
<span id="cb362-2"><a href="causal-inf.html#cb362-2"></a>                    <span class="dt">weights =</span> weights)</span>
<span id="cb362-3"><a href="causal-inf.html#cb362-3"></a></span>
<span id="cb362-4"><a href="causal-inf.html#cb362-4"></a>texreg<span class="op">::</span><span class="kw">screenreg</span>(model_matched)</span>
<span id="cb362-5"><a href="causal-inf.html#cb362-5"></a><span class="co">## </span></span>
<span id="cb362-6"><a href="causal-inf.html#cb362-6"></a><span class="co">## ========================</span></span>
<span id="cb362-7"><a href="causal-inf.html#cb362-7"></a><span class="co">##              Model 1    </span></span>
<span id="cb362-8"><a href="causal-inf.html#cb362-8"></a><span class="co">## ------------------------</span></span>
<span id="cb362-9"><a href="causal-inf.html#cb362-9"></a><span class="co">## (Intercept)    36.09 ***</span></span>
<span id="cb362-10"><a href="causal-inf.html#cb362-10"></a><span class="co">##                (0.60)   </span></span>
<span id="cb362-11"><a href="causal-inf.html#cb362-11"></a><span class="co">## redTRUE       -10.49 ***</span></span>
<span id="cb362-12"><a href="causal-inf.html#cb362-12"></a><span class="co">##                (0.76)   </span></span>
<span id="cb362-13"><a href="causal-inf.html#cb362-13"></a><span class="co">## ------------------------</span></span>
<span id="cb362-14"><a href="causal-inf.html#cb362-14"></a><span class="co">## R^2             0.14    </span></span>
<span id="cb362-15"><a href="causal-inf.html#cb362-15"></a><span class="co">## Adj. R^2        0.14    </span></span>
<span id="cb362-16"><a href="causal-inf.html#cb362-16"></a><span class="co">## Num. obs.    1120       </span></span>
<span id="cb362-17"><a href="causal-inf.html#cb362-17"></a><span class="co">## ========================</span></span>
<span id="cb362-18"><a href="causal-inf.html#cb362-18"></a><span class="co">## *** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</span></span></code></pre></div>
<p>Según estos resultados, el uso de un mosquitero <em>causa</em> una disminución de 10.49 puntos en el riesgo de malaria, en promedio. Una vez más, podemos utilizar el lenguaje causal ahora porque hemos ajustado los confusores al hacer la comparación, identificando así el camino causal entre el uso de mosquiteros y el riesgo de malaria.</p>
</div>
<div id="ponderación-de-probabilidad-inversa" class="section level3">
<h3><span class="header-section-number">10.7.7</span> Ponderación de probabilidad inversa</h3>
<p>Una desventaja del uso de matching es que desechamos mucha información: las observaciones no coincidentes se descartan, y el tamaño de nuestra muestra puede reducirse significativamente. El emparejamiento también tiende a ser muy riguroso, ya que cada observación tratada debe ser emparejada con una (o más) observaciones no tratadas. Miren el Panel B en la Figura <a href="causal-inf.html#fig:matching-example">10.19</a> y noten que algunas observaciones no tratadas están en realidad muy cerca de las observaciones tratadas, pero aún así se descartan porque fueron superadas por observaciones que tienen una distancia ligeramente menor.</p>
<p>En lugar de desechar datos potencialmente útiles, podemos utilizar otros métodos para crear coincidencias que sean menos rigurosas pero más informativas. Un método común en epidemiología y bioestadística es la ponderación de probabilidad inversa (IPW, en inglés). En la IPW, a cada observación se le asigna un peso basado en lo bien que su asignación real al tratamiento coincide con la probabilidad prevista del tratamiento, y esos pesos se utilizan luego en un modelo de regresión para estimar el efecto causal del tratamiento en el resultado.</p>
<p>Podemos ilustrar este proceso con el ejemplo de educación y edad de la figura <a href="causal-inf.html#fig:matching-example">10.19</a>. En lugar de emparejar por matching, utilizamos una regresión logística para crear puntuaciones de propensión al tratamiento:</p>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="causal-inf.html#cb363-1"></a><span class="kw">data</span>(<span class="st">&quot;edad_educ&quot;</span>) <span class="co"># desde el paquete &quot;paqueteadp&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb364-1"><a href="causal-inf.html#cb364-1"></a>edad_educ &lt;-<span class="st"> </span>edad_educ <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb364-2"><a href="causal-inf.html#cb364-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">tratamiento =</span> <span class="kw">factor</span>(tratamiento))</span>
<span id="cb364-3"><a href="causal-inf.html#cb364-3"></a></span>
<span id="cb364-4"><a href="causal-inf.html#cb364-4"></a>model_tratamiento &lt;-<span class="st"> </span><span class="kw">glm</span>(tratamiento <span class="op">~</span><span class="st"> </span>educacion <span class="op">+</span><span class="st"> </span>edad, <span class="dt">data =</span> edad_educ,</span>
<span id="cb364-5"><a href="causal-inf.html#cb364-5"></a>                       <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link =</span> <span class="st">&quot;logit&quot;</span>))</span>
<span id="cb364-6"><a href="causal-inf.html#cb364-6"></a></span>
<span id="cb364-7"><a href="causal-inf.html#cb364-7"></a>edad_educ_propensiones &lt;-<span class="st"> </span>broom<span class="op">::</span><span class="kw">augment_columns</span>(</span>
<span id="cb364-8"><a href="causal-inf.html#cb364-8"></a>  model_tratamiento, edad_educ, <span class="dt">type.predict =</span> <span class="st">&quot;response&quot;</span></span>
<span id="cb364-9"><a href="causal-inf.html#cb364-9"></a>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb364-10"><a href="causal-inf.html#cb364-10"></a><span class="st">  </span><span class="kw">rename</span>(<span class="dt">propension =</span> .fitted)</span></code></pre></div>
<p>Podemos mirar unas pocas filas en los datos para ver estos puntajes de propensión (o propension scores). La persona 59 tenía una probabilidad del 14% de auto-seleccionarse para el tratamiento dada su educación y edad, pero terminó no haciendo el tratamiento, como se predijo. La persona 27, por otro lado, también tenía una probabilidad del 14% de elegir el tratamiento y lo hizo, lo cual es un resultado bastante improbable. Esa elección es inesperada!</p>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="causal-inf.html#cb365-1"></a>edad_educ_propensiones <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb365-2"><a href="causal-inf.html#cb365-2"></a><span class="st">  </span><span class="kw">select</span>(codigo, tratamiento, educacion, edad, propension) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb365-3"><a href="causal-inf.html#cb365-3"></a><span class="st">  </span><span class="kw">slice</span>(<span class="dv">59</span>, <span class="dv">27</span>)</span>
<span id="cb365-4"><a href="causal-inf.html#cb365-4"></a><span class="co">## # A tibble: 2 x 5</span></span>
<span id="cb365-5"><a href="causal-inf.html#cb365-5"></a><span class="co">##   codigo tratamiento educacion  edad propension</span></span>
<span id="cb365-6"><a href="causal-inf.html#cb365-6"></a><span class="co">##    &lt;dbl&gt; &lt;fct&gt;           &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span id="cb365-7"><a href="causal-inf.html#cb365-7"></a><span class="co">## 1     59 Control          28.9  47.0      0.147</span></span>
<span id="cb365-8"><a href="causal-inf.html#cb365-8"></a><span class="co">## 2     27 Tratamiento      21.7  63.2      0.148</span></span></code></pre></div>
<p>Con matching, estábamos interesados en emparejar las observaciones inesperadas y esperadas, recordemos que necesitábamos encontrar una observación no tratada altamente educada para emparejarla con la única observación tratada altamente educada. Hacemos lo mismo aquí. Las observaciones que es improbable que reciban tratamiento y luego no lo reciben siguen nuestras expectativas y deberían tener menos peso. Por el contrario, las observaciones que con poca probabilidad recibirán tratamiento deberían tener más peso. La ponderación de la probabilidad inversa nos permite asignar un valor numérico a lo inesperado de las observaciones. Utilizamos la siguiente fórmula para calcular los pesos de probabilidad inversa para un efecto medio del tratamiento, donde <span class="math inline">\(\text{Tratamiento}\)</span> es una variable binaria 0/1:<a href="#fn45" class="footnote-ref" id="fnref45"><sup>45</sup></a></p>
<p><span class="math display">\[
\frac{\text{Tratamiento}}{\text{Propensión}} + \frac{1 - \text{Tratamiento}}{1 - \text{Propensión}}
\]</span></p>
<p>Podemos agregar pesos de probabilidad inversa a nuestros puntajes de propensión pronosticados con <code>mutate()</code>. Compara los valores de <code>ipw</code> de las personas 59 y 27. Recuerde que la persona 59 tenía una baja probabilidad de seleccionar en el tratamiento y no lo hizo, como se esperaba. Su peso de probabilidad inversa es sólo 1.17. La persona 27, por otro lado, tenía una baja probabilidad de estar en el tratamiento y sin embargo superó las probabilidades y se unió al tratamiento, en contra de lo esperado. En consecuencia, tienen un alto peso de probabilidad inversa de 6.78.</p>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="causal-inf.html#cb366-1"></a>edad_educ_peso_invertido &lt;-<span class="st"> </span>edad_educ_propensiones <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb366-2"><a href="causal-inf.html#cb366-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">peso_invertido =</span> (num_tratamiento <span class="op">/</span><span class="st"> </span>propension) <span class="op">+</span><span class="st"> </span></span>
<span id="cb366-3"><a href="causal-inf.html#cb366-3"></a><span class="st">           </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>num_tratamiento) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>propension))</span>
<span id="cb366-4"><a href="causal-inf.html#cb366-4"></a></span>
<span id="cb366-5"><a href="causal-inf.html#cb366-5"></a>edad_educ_peso_invertido <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb366-6"><a href="causal-inf.html#cb366-6"></a><span class="st">  </span><span class="kw">select</span>(codigo, tratamiento, educacion, edad, propension, peso_invertido) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb366-7"><a href="causal-inf.html#cb366-7"></a><span class="st">  </span><span class="kw">slice</span>(<span class="dv">59</span>, <span class="dv">27</span>)</span>
<span id="cb366-8"><a href="causal-inf.html#cb366-8"></a><span class="co">## # A tibble: 2 x 6</span></span>
<span id="cb366-9"><a href="causal-inf.html#cb366-9"></a><span class="co">##   codigo tratamiento educacion  edad propension peso_invertido</span></span>
<span id="cb366-10"><a href="causal-inf.html#cb366-10"></a><span class="co">##    &lt;dbl&gt; &lt;fct&gt;           &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;          &lt;dbl&gt;</span></span>
<span id="cb366-11"><a href="causal-inf.html#cb366-11"></a><span class="co">## 1     59 Control          28.9  47.0      0.147           1.17</span></span>
<span id="cb366-12"><a href="causal-inf.html#cb366-12"></a><span class="co">## 2     27 Tratamiento      21.7  63.2      0.148           6.78</span></span></code></pre></div>
<p>Dado que cada observación en la base de datos tiene una puntuación de probabilidad inversa, no necesitamos desechar ningún dato. En su lugar, podemos ponderar cada observación por su puntuación de probabilidad inversa. La figura <a href="causal-inf.html#fig:ipw-example">10.20</a> muestra los datos completos con los puntos dimensionados por su IPW. Las observaciones que cumplen las expectativas reciben menos peso que las que se comportan de forma contraria a las expectativas.</p>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="causal-inf.html#cb367-1"></a><span class="kw">ggplot</span>(edad_educ_peso_invertido, <span class="kw">aes</span>(<span class="dt">x =</span> educacion, <span class="dt">y =</span> edad, </span>
<span id="cb367-2"><a href="causal-inf.html#cb367-2"></a>                        <span class="dt">color =</span> tratamiento, <span class="dt">size =</span> peso_invertido)) <span class="op">+</span></span>
<span id="cb367-3"><a href="causal-inf.html#cb367-3"></a><span class="st">  </span><span class="kw">geom_point</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:ipw-example"></span>
<img src="00-images/causal-inf/ipw-example.png" alt="Observaciones dimensionadas por pesos de probabilidad inversa" width="300" height="100%" />
<p class="caption">
Figura 10.20: Observaciones dimensionadas por pesos de probabilidad inversa
</p>
</div>
<p>Podemos ajustar los factores de confusión de nuestro mosquitero y el ejemplo de riesgo de malaria usando una ponderación de probabilidad inversa. Primero, usamos una regresión logística para predecir la propensión a usar un mosquitero usando los ingresos, la temperatura y la salud. Luego usamos los puntajes de propensión para calcular los pesos de probabilidad inversa usando esta fórmula:</p>
<p><span class="math display">\[
\frac{\text{Mosquitero}}{\text{Propensión}} + \frac{1 - \text{Mosquitero}}{1 - \text{Propensión}}
\]</span></p>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="causal-inf.html#cb368-1"></a>model_red_mosquitos &lt;-<span class="st"> </span><span class="kw">glm</span>(red  <span class="op">~</span><span class="st"> </span>ingreso <span class="op">+</span><span class="st"> </span>temperatura <span class="op">+</span><span class="st"> </span>salud, </span>
<span id="cb368-2"><a href="causal-inf.html#cb368-2"></a>                          <span class="dt">data =</span> red_mosquitos,</span>
<span id="cb368-3"><a href="causal-inf.html#cb368-3"></a>                          <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link =</span> <span class="st">&quot;logit&quot;</span>))</span>
<span id="cb368-4"><a href="causal-inf.html#cb368-4"></a></span>
<span id="cb368-5"><a href="causal-inf.html#cb368-5"></a>red_mosquitos_ipw &lt;-<span class="st"> </span>broom<span class="op">::</span><span class="kw">augment_columns</span>(model_red_mosquitos,</span>
<span id="cb368-6"><a href="causal-inf.html#cb368-6"></a>                                            red_mosquitos,</span>
<span id="cb368-7"><a href="causal-inf.html#cb368-7"></a>                                            <span class="dt">type.predict =</span> <span class="st">&quot;response&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb368-8"><a href="causal-inf.html#cb368-8"></a><span class="st">  </span><span class="kw">rename</span>(<span class="dt">propension =</span> .fitted) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb368-9"><a href="causal-inf.html#cb368-9"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">peso_invertido =</span> (red_cant <span class="op">/</span><span class="st"> </span>propension) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>red_cant) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>propension))</span></code></pre></div>
<p>Ahora que tenemos pesos de probabilidad inversa, podemos usarlos en una regresión:</p>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="causal-inf.html#cb369-1"></a>model_peso_invertido &lt;-<span class="st"> </span><span class="kw">lm</span>(riesgo_malaria <span class="op">~</span><span class="st"> </span>red , <span class="dt">data =</span> red_mosquitos_ipw, </span>
<span id="cb369-2"><a href="causal-inf.html#cb369-2"></a>                <span class="dt">weights =</span> peso_invertido)</span>
<span id="cb369-3"><a href="causal-inf.html#cb369-3"></a></span>
<span id="cb369-4"><a href="causal-inf.html#cb369-4"></a>texreg<span class="op">::</span><span class="kw">screenreg</span>(model_peso_invertido)</span>
<span id="cb369-5"><a href="causal-inf.html#cb369-5"></a><span class="co">## </span></span>
<span id="cb369-6"><a href="causal-inf.html#cb369-6"></a><span class="co">## ========================</span></span>
<span id="cb369-7"><a href="causal-inf.html#cb369-7"></a><span class="co">##              Model 1    </span></span>
<span id="cb369-8"><a href="causal-inf.html#cb369-8"></a><span class="co">## ------------------------</span></span>
<span id="cb369-9"><a href="causal-inf.html#cb369-9"></a><span class="co">## (Intercept)    39.68 ***</span></span>
<span id="cb369-10"><a href="causal-inf.html#cb369-10"></a><span class="co">##                (0.47)   </span></span>
<span id="cb369-11"><a href="causal-inf.html#cb369-11"></a><span class="co">## redTRUE       -10.13 ***</span></span>
<span id="cb369-12"><a href="causal-inf.html#cb369-12"></a><span class="co">##                (0.66)   </span></span>
<span id="cb369-13"><a href="causal-inf.html#cb369-13"></a><span class="co">## ------------------------</span></span>
<span id="cb369-14"><a href="causal-inf.html#cb369-14"></a><span class="co">## R^2             0.12    </span></span>
<span id="cb369-15"><a href="causal-inf.html#cb369-15"></a><span class="co">## Adj. R^2        0.12    </span></span>
<span id="cb369-16"><a href="causal-inf.html#cb369-16"></a><span class="co">## Num. obs.    1752       </span></span>
<span id="cb369-17"><a href="causal-inf.html#cb369-17"></a><span class="co">## ========================</span></span>
<span id="cb369-18"><a href="causal-inf.html#cb369-18"></a><span class="co">## *** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</span></span></code></pre></div>
<p>Según este modelo de IPW, el uso de un mosquitero <em>causa</em> una disminución de 10.13 puntos en el riesgo de malaria, en promedio. Una vez más, podemos utilizar con seguridad el lenguaje causal porque hemos identificado el camino causal entre el uso de mosquiteros y el riesgo de malaria teniendo en cuenta los factores de confusión en los pesos de probabilidad inversos.</p>
</div>
<div id="comparando-todos-los-métodos" class="section level3">
<h3><span class="header-section-number">10.7.8</span> Comparando todos los métodos</h3>
<p>Ahora que hemos ejecutado varios modelos de regresión que se ajustan a los factores de confusión de diferentes maneras, podemos comparar los resultados todos juntos. La ingenua estimación de -16 parece ser definitivamente una sobreestimación: después de ajustar con la regresión, el matching y la ponderación de probabilidad inversa, el efecto causal del uso de un mosquitero en el riesgo de malaria es consistentemente de alrededor de -10. Asumiendo que nuestro DAG está correcto, encontramos con éxito un efecto causal a partir de datos no experimentales y observacionales.</p>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="causal-inf.html#cb370-1"></a>texreg<span class="op">::</span><span class="kw">screenreg</span>(<span class="kw">list</span>(model_naive, model_regression, model_matched, model_peso_invertido),</span>
<span id="cb370-2"><a href="causal-inf.html#cb370-2"></a>                  <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;Naive&quot;</span>, <span class="st">&quot;Regresión&quot;, &quot;</span>Matching<span class="st">&quot;, &quot;</span>IPW<span class="st">&quot;))</span></span>
<span id="cb370-3"><a href="causal-inf.html#cb370-3"></a><span class="st">## </span></span>
<span id="cb370-4"><a href="causal-inf.html#cb370-4"></a><span class="st">## ===============================================================</span></span>
<span id="cb370-5"><a href="causal-inf.html#cb370-5"></a><span class="st">##              Naive        Regresión    Matching     IPW        </span></span>
<span id="cb370-6"><a href="causal-inf.html#cb370-6"></a><span class="st">## ---------------------------------------------------------------</span></span>
<span id="cb370-7"><a href="causal-inf.html#cb370-7"></a><span class="st">## (Intercept)    41.94 ***    76.16 ***    36.09 ***    39.68 ***</span></span>
<span id="cb370-8"><a href="causal-inf.html#cb370-8"></a><span class="st">##                (0.40)       (0.93)       (0.60)       (0.47)   </span></span>
<span id="cb370-9"><a href="causal-inf.html#cb370-9"></a><span class="st">## redTRUE       -16.33 ***   -10.44 ***   -10.49 ***   -10.13 ***</span></span>
<span id="cb370-10"><a href="causal-inf.html#cb370-10"></a><span class="st">##                (0.65)       (0.26)       (0.76)       (0.66)   </span></span>
<span id="cb370-11"><a href="causal-inf.html#cb370-11"></a><span class="st">## ingreso                     -0.08 ***                          </span></span>
<span id="cb370-12"><a href="causal-inf.html#cb370-12"></a><span class="st">##                             (0.00)                             </span></span>
<span id="cb370-13"><a href="causal-inf.html#cb370-13"></a><span class="st">## temperatura                  1.01 ***                          </span></span>
<span id="cb370-14"><a href="causal-inf.html#cb370-14"></a><span class="st">##                             (0.03)                             </span></span>
<span id="cb370-15"><a href="causal-inf.html#cb370-15"></a><span class="st">## salud                        0.15 ***                          </span></span>
<span id="cb370-16"><a href="causal-inf.html#cb370-16"></a><span class="st">##                             (0.01)                             </span></span>
<span id="cb370-17"><a href="causal-inf.html#cb370-17"></a><span class="st">## ---------------------------------------------------------------</span></span>
<span id="cb370-18"><a href="causal-inf.html#cb370-18"></a><span class="st">## R^2             0.27         0.89         0.14         0.12    </span></span>
<span id="cb370-19"><a href="causal-inf.html#cb370-19"></a><span class="st">## Adj. R^2        0.27         0.88         0.14         0.12    </span></span>
<span id="cb370-20"><a href="causal-inf.html#cb370-20"></a><span class="st">## Num. obs.    1752         1752         1120         1752       </span></span>
<span id="cb370-21"><a href="causal-inf.html#cb370-21"></a><span class="st">## ===============================================================</span></span>
<span id="cb370-22"><a href="causal-inf.html#cb370-22"></a><span class="st">## *** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</span></span></code></pre></div>
<blockquote>
<p><strong>Ejercicio 10B</strong>: En el ejercicio 10A, dibujaste un DAG que modeló la relación causal entre la diversidad étnica y la desigualdad social. En este ejercicio utilizarás el set de ajustes de ese DAG para intentar estimar el efecto causal de esa relación. Haz lo siguiente:</p>
<ol style="list-style-type: decimal">
<li><p>Carga la base de datos de <code>bienestar</code> del paquete del libro:</p>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="causal-inf.html#cb371-1"></a><span class="kw">library</span>(paqueteadp)</span>
<span id="cb371-2"><a href="causal-inf.html#cb371-2"></a><span class="kw">data</span>(<span class="st">&quot;bienestar&quot;</span>)</span></code></pre></div>
<p>Tu variable dependiente es el índice de Gini (<code>gini</code>). Tu variable de tratamiento es la diversidad étnica (<code>diversidad_etnica</code>), una variable binaria que es 1 si entre el 20-80% de la población es étnicamente diversa (y 0 si no).</p></li>
<li><p>Use el DAG que hiciste anteriormente para determinar el ajuste mínimo suficiente. ¿Qué nodos deben ser ajustados para asegurar que se identifique el camino entre la diversidad étnica y la desigualdad?</p></li>
<li><p>Construye un modelo de correlación no causal (que llamamos de ingenuo o naive) para probar la relación entre la diversidad y la desigualdad (es decir, <code>lm(gini ~ diversidad_etnica, data = bienestar)</code>). ¿Cómo se asocia la diversidad con la desigualdad? ¿Por qué esta estimación no es causal?</p></li>
<li><p>Usar una regresión múltiple para cerrar las puertas traseras. Incluya las variables de tu set de ajuste como variables explicativas en un modelo de regresión.</p></li>
<li><p>Usa matching para cerrar las puertas traseras. Usa las variables de tu set de ajuste para hacer coincidir la asignación de las observaciones con el tratamiento, luego usa las observaciones emparejadas en un modelo de regresión.</p></li>
<li><p>Usa la ponderación de probabilidad inversa para cerrar las puertas traseras. Usa las variables de tu conjunto de ajustes para generar puntuaciones de propensión para la asignación al tratamiento, y luego crea ponderaciones de probabilidad inversas y usa esas ponderaciones en un modelo de regresión.</p></li>
<li><p>¿Cómo se comparan estos efectos ajustados con el modelo “ingenuo”? ¿Cuánta confianza tienes en que estos son efectos causales? ¿Por qué? ¿Qué podría hacer para mejorar su identificación causal?</p></li>
</ol>
</blockquote>
</div>
</div>
<div id="cconsejos-finales" class="section level2">
<h2><span class="header-section-number">10.8</span> CConsejos finales</h2>
<p>Los DAG son herramientas poderosas para incorporar la teoría y la filosofía de tu modelo causal en la estimación estadística de la relación entre tratamiento y control. Sin embargo, diseñar un DAG no te garantiza automáticamente la capacidad de hablar con lenguaje causal. Los gráficos causales no resuelven el problema fundamental de la inferencia causal, no crean una máquina del tiempo que permita ver los resultados en un mundo contrafactual.
El supuesto central cuando se utilizan los DAG es que es posible identificar y aislar completamente una relación causal utilizando sólo datos observables. Los críticos de este supuesto a menudo desprecian este enfoque de selección de datos observables. Si se omite un nodo importante porque no es observable, la estimación causal será incorrecta y sesgada, independientemente de si se utiliza matching, la ponderación de probabilidad inversa o cualquier otro método para aislar relaciones entre nodos.</p>
<p>Los nodos en los DAG pueden representar variables observables reales en una base de datos, pero no siempre es así. Recordemos que los gráficos causales codifican nuestra filosofía del proceso de generación de datos: cada nodo representa algún fenómeno que tiene alguna influencia en algún punto de la cadena de eventos que finalmente causa el tratamiento y el resultado. Los nodos no necesitan ser medibles. En la figura <a href="causal-inf.html#fig:money-votes-complex">10.6</a> incluimos un nodo para la historia del distrito electoral, que influye tanto en la dinámica de los partidos como en las características del distrito. Es imposible destilar toda la historia de un distrito en un solo número en un conjunto de datos. Podríamos intentar hacerlo dividiendo el nodo de “historia” en componentes más pequeños (y más mensurables), como el partido de los candidatos anteriores, las decisiones sobre los límites del distrito o la riqueza de los dirigentes y partidarios del partido, pero incluso así, debemos sentirnos cómodos declarando que estos nodos más pequeños representan toda la historia de un distrito. Es una suposición difícil.</p>
<p>Contrariamente a las críticas al enfoque de selección sobre observables inherente a los gráficos causales, la presencia de nodos inobservables en un DAG no impide que los utilicemos para aislar e identificar los efectos causales. Debido a la lógica de la <em>d</em>separación - y a la forma en que hemos dibujado las flechas en el DAG, podemos excluir la historia inobservable de un distrito en la Figura <a href="causal-inf.html#fig:money-votes-complex">10.6</a> porque su nodo está bloqueado por los nodos de distrito y partido. Si creemos que nuestro DAG es correcto y que estos dos nodos son de hecho suficientes para bloquear toda la variación no medida del nodo de la historia, podemos proceder con seguridad a estimar el efecto causal. Si la historia inobservable de un distrito pasa de las asociaciones estadísticas a la recaudación de fondos de campaña o el total de votos a través de otras vías no bloqueadas, no podremos identificar el efecto causal con datos observacionales.</p>
<p>Al final, tus estimaciones causales son tan buenas como sea tu DAG. Si accidentalmente omites nodos de varaibles de confusión, o si no puede medir los nodos de confusión, o si incluyes nodos que son colisionadores, los resultados serán erróneos. Además, las relaciones entre los nodos observados y no observados podrían ser demasiado complejas para ser resueltas usando el ajuste de cálculo <em>hacer</em>. A menos que estés completamente seguro de que tu DAG refleja el proceso real de generación de datos y la teoría subyacente del fenómeno que estás estudiando y que los ajustes que hagas son suficientes para identificar la relación causal, evita siempre confiar demasiado en los resultados y mantén una actitud de incertidumbre.</p>

</div>
</div>



<div class="footnotes">
<hr />
<ol start="43">
<li id="fn43"><p>E-mail: aheiss@gsu.edu<a href="causal-inf.html#fnref43" class="footnote-back">↩︎</a></p></li>
<li id="fn44"><p>Esto también puede escribirse como <span class="math inline">\(P(Y | hacer(X))\)</span>, de la distribución de probabilidad de <span class="math inline">\(Y\)</span> dado que “haces” <span class="math inline">\(X\)</span>.<a href="causal-inf.html#fnref44" class="footnote-back">↩︎</a></p></li>
<li id="fn45"><p>Hay muchas otras versiones de ponderaciones de probabilidad inversa que tienen por objeto estimar otras cantidades causales, como el promedio de tratamiento en el efecto tratado, el promedio de tratamiento entre el efecto igualado y el promedio de tratamiento entre el efecto de la población superpuesta. Vale la pena ver esta entrada en el blog de Lucy D’Agostino McGowan para más detalles: <a href="https://livefreeordichotomize.com/2019/01/17/understanding-propension-score-weighting/">https://livefreeordichotomize.com/2019/01/17/understanding-propension-score-weighting/</a><a href="causal-inf.html#fnref45" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="surv.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="adv-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "night",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/arcruz0/libroadp/edit/master/10-causal-inf_es.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
