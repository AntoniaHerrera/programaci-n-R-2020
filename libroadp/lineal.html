<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 6 Modelos lineales | AnalizaR Datos Políticos</title>
  <meta name="description" content="Manual aplicado para politólogos y relacionistas internacionales en R" />
  <meta name="generator" content="bookdown  and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 6 Modelos lineales | AnalizaR Datos Políticos" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Manual aplicado para politólogos y relacionistas internacionales en R" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 6 Modelos lineales | AnalizaR Datos Políticos" />
  
  <meta name="twitter:description" content="Manual aplicado para politólogos y relacionistas internacionales en R" />
  

<meta name="author" content="Francisco Urdinez y Andrés Cruz Labrín (editores)" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link rel="prev" href="carga.html">
<link rel="next" href="logit.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<script src="libs/htmlwidgets-1.2/htmlwidgets.js"></script>
<link href="libs/wordcloud2-0.0.1/wordcloud.css" rel="stylesheet" />
<script src="libs/wordcloud2-0.0.1/wordcloud2-all.js"></script>
<script src="libs/wordcloud2-0.0.1/hover.js"></script>
<script src="libs/wordcloud2-binding-0.2.1/wordcloud2.js"></script>
<script>
% https://stackoverflow.com/a/4425214/8242291
var links = document.links;

for (var i = 0, linksLength = links.length; i < linksLength; i++) {

    if (links[i].hostname != window.location.hostname) {
        links[i].target = '_blank';
    }

}
</script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #2a211c;
    color: #bdae9d;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #bdae9d;  padding-left: 4px; }
div.sourceCode
  { color: #bdae9d; background-color: #2a211c; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ffff00; } /* Alert */
code span.an { color: #0066ff; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #44aa43; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #43a8ed; font-weight: bold; } /* ControlFlow */
code span.ch { color: #049b0a; } /* Char */
code span.cn { } /* Constant */
code span.co { color: #0066ff; font-weight: bold; font-style: italic; } /* Comment */
code span.do { color: #0066ff; font-style: italic; } /* Documentation */
code span.dt { text-decoration: underline; } /* DataType */
code span.dv { color: #44aa43; } /* DecVal */
code span.er { color: #ffff00; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #44aa43; } /* Float */
code span.fu { color: #ff9358; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #0066ff; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #43a8ed; font-weight: bold; } /* Keyword */
code span.op { } /* Operator */
code span.pp { font-weight: bold; } /* Preprocessor */
code span.sc { color: #049b0a; } /* SpecialChar */
code span.ss { color: #049b0a; } /* SpecialString */
code span.st { color: #049b0a; } /* String */
code span.va { } /* Variable */
code span.vs { color: #049b0a; } /* VerbatimString */
code span.wa { color: #ffff00; font-weight: bold; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><b><a href="./index.html"><img style="float: left; margin-right: 5px;" src="favicon.ico"></img>AnalizaR datos políticos</a></b></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introducción</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#inicio"><i class="fa fa-check"></i><b>1.1</b> Inicio</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#como-contribuir"><i class="fa fa-check"></i><b>1.2</b> ¿Cómo contribuir?</a><ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#sobre-los-autores-y-autoras"><i class="fa fa-check"></i><b>1.2.1</b> Sobre los autores y autoras</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#prefacio"><i class="fa fa-check"></i><b>1.3</b> Prefacio</a><ul>
<li class="chapter" data-level="1.3.1" data-path="index.html"><a href="index.html#agradecimientos"><i class="fa fa-check"></i><b>1.3.1</b> Agradecimientos</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#que-esperar-del-libro"><i class="fa fa-check"></i><b>1.4</b> Qué esperar del libro</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#estructura-del-libro"><i class="fa fa-check"></i><b>1.5</b> Estructura del libro</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#prerrequisitos"><i class="fa fa-check"></i><b>1.6</b> Prerrequisitos</a></li>
</ul></li>
<li class="part"><span><b>I Introducción a R</b></span></li>
<li class="chapter" data-level="2" data-path="rbas.html"><a href="rbas.html"><i class="fa fa-check"></i><b>2</b> R básico</a><ul>
<li class="chapter" data-level="2.1" data-path="rbas.html"><a href="rbas.html#instalacion"><i class="fa fa-check"></i><b>2.1</b> Instalación</a><ul>
<li class="chapter" data-level="2.1.1" data-path="rbas.html"><a href="rbas.html#r"><i class="fa fa-check"></i><b>2.1.1</b> R</a></li>
<li class="chapter" data-level="2.1.2" data-path="rbas.html"><a href="rbas.html#rstudio"><i class="fa fa-check"></i><b>2.1.2</b> RStudio</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="rbas.html"><a href="rbas.html#partes-de-rstudio"><i class="fa fa-check"></i><b>2.2</b> Partes de RStudio</a><ul>
<li class="chapter" data-level="2.2.1" data-path="rbas.html"><a href="rbas.html#consola"><i class="fa fa-check"></i><b>2.2.1</b> Consola</a></li>
<li class="chapter" data-level="2.2.2" data-path="rbas.html"><a href="rbas.html#script"><i class="fa fa-check"></i><b>2.2.2</b> Script</a></li>
<li class="chapter" data-level="2.2.3" data-path="rbas.html"><a href="rbas.html#objetos"><i class="fa fa-check"></i><b>2.2.3</b> Objetos</a></li>
<li class="chapter" data-level="2.2.4" data-path="rbas.html"><a href="rbas.html#archivos-graficos-paquetes-ayuda"><i class="fa fa-check"></i><b>2.2.4</b> Archivos / gráficos / paquetes / ayuda</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="manejo-de-datos.html"><a href="manejo-de-datos.html"><i class="fa fa-check"></i><b>3</b> Manejo de datos</a><ul>
<li class="chapter" data-level="3.1" data-path="manejo-de-datos.html"><a href="manejo-de-datos.html#introduccion-1"><i class="fa fa-check"></i><b>3.1</b> Introducción</a><ul>
<li class="chapter" data-level="3.1.1" data-path="manejo-de-datos.html"><a href="manejo-de-datos.html#nuestra-base-de-datos"><i class="fa fa-check"></i><b>3.1.1</b> Nuestra base de datos</a></li>
<li class="chapter" data-level="3.1.2" data-path="manejo-de-datos.html"><a href="manejo-de-datos.html#describir-la-base"><i class="fa fa-check"></i><b>3.1.2</b> Describir la base</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="manejo-de-datos.html"><a href="manejo-de-datos.html#operaciones-en-bases"><i class="fa fa-check"></i><b>3.2</b> Operaciones en bases</a><ul>
<li class="chapter" data-level="3.2.1" data-path="manejo-de-datos.html"><a href="manejo-de-datos.html#ordenar-una-base"><i class="fa fa-check"></i><b>3.2.1</b> Ordenar una base</a></li>
<li class="chapter" data-level="3.2.2" data-path="manejo-de-datos.html"><a href="manejo-de-datos.html#seleccionar-columnas"><i class="fa fa-check"></i><b>3.2.2</b> Seleccionar columnas</a></li>
<li class="chapter" data-level="3.2.3" data-path="manejo-de-datos.html"><a href="manejo-de-datos.html#renombrar-columnas"><i class="fa fa-check"></i><b>3.2.3</b> Renombrar columnas</a></li>
<li class="chapter" data-level="3.2.4" data-path="manejo-de-datos.html"><a href="manejo-de-datos.html#filtrar-observaciones"><i class="fa fa-check"></i><b>3.2.4</b> Filtrar observaciones</a></li>
<li class="chapter" data-level="3.2.5" data-path="manejo-de-datos.html"><a href="manejo-de-datos.html#crear-nuevas-variables"><i class="fa fa-check"></i><b>3.2.5</b> Crear nuevas variables</a></li>
<li class="chapter" data-level="3.2.6" data-path="manejo-de-datos.html"><a href="manejo-de-datos.html#concatenar-comandos"><i class="fa fa-check"></i><b>3.2.6</b> Concatenar comandos</a></li>
<li class="chapter" data-level="3.2.7" data-path="manejo-de-datos.html"><a href="manejo-de-datos.html#operaciones-agrupadas"><i class="fa fa-check"></i><b>3.2.7</b> Operaciones agrupadas</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="manejo-de-datos.html"><a href="manejo-de-datos.html#reformatear-bases"><i class="fa fa-check"></i><b>3.3</b> Reformatear bases</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="dataviz.html"><a href="dataviz.html"><i class="fa fa-check"></i><b>4</b> Visualización de datos</a><ul>
<li class="chapter" data-level="4.1" data-path="dataviz.html"><a href="dataviz.html#por-que-quiero-visualizar-mis-datos"><i class="fa fa-check"></i><b>4.1</b> ¿Por qué quiero visualizar mis datos?</a></li>
<li class="chapter" data-level="4.2" data-path="dataviz.html"><a href="dataviz.html#primeros-pasos"><i class="fa fa-check"></i><b>4.2</b> Primeros pasos</a><ul>
<li class="chapter" data-level="4.2.1" data-path="dataviz.html"><a href="dataviz.html#las-capas-del-multiverso-ggplotidiano"><i class="fa fa-check"></i><b>4.2.1</b> Las capas del multiverso ggplotidiano</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="dataviz.html"><a href="dataviz.html#elecciones-locales-y-visualizacion-de-datos"><i class="fa fa-check"></i><b>4.3</b> Elecciones locales y visualización de datos</a><ul>
<li class="chapter" data-level="4.3.1" data-path="dataviz.html"><a href="dataviz.html#grafico-de-barras"><i class="fa fa-check"></i><b>4.3.1</b> Gráfico de barras</a></li>
<li class="chapter" data-level="4.3.2" data-path="dataviz.html"><a href="dataviz.html#grafico-de-linea"><i class="fa fa-check"></i><b>4.3.2</b> Gráfico de Línea</a></li>
<li class="chapter" data-level="4.3.3" data-path="dataviz.html"><a href="dataviz.html#boxplot"><i class="fa fa-check"></i><b>4.3.3</b> Boxplot</a></li>
<li class="chapter" data-level="4.3.4" data-path="dataviz.html"><a href="dataviz.html#histograma"><i class="fa fa-check"></i><b>4.3.4</b> Histograma</a></li>
<li class="chapter" data-level="4.3.5" data-path="dataviz.html"><a href="dataviz.html#relacion-entre-variables"><i class="fa fa-check"></i><b>4.3.5</b> Relación entre variables</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="dataviz.html"><a href="dataviz.html#para-seguir-aprendiendo"><i class="fa fa-check"></i><b>4.4</b> Para seguir aprendiendo</a><ul>
<li class="chapter" data-level="4.4.1" data-path="dataviz.html"><a href="dataviz.html#otros-paquetes"><i class="fa fa-check"></i><b>4.4.1</b> Otros paquetes:</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="carga.html"><a href="carga.html"><i class="fa fa-check"></i><b>5</b> Carga de bases</a><ul>
<li class="chapter" data-level="5.1" data-path="carga.html"><a href="carga.html#carga-intro"><i class="fa fa-check"></i><b>5.1</b> Introducción</a></li>
<li class="chapter" data-level="5.2" data-path="carga.html"><a href="carga.html#carga-formatos"><i class="fa fa-check"></i><b>5.2</b> Distintos formatos de bases</a><ul>
<li class="chapter" data-level="5.2.1" data-path="carga.html"><a href="carga.html#archivos-separados-por-delimitadores-.csv-y-.tsv"><i class="fa fa-check"></i><b>5.2.1</b> Archivos separados por delimitadores (.csv y .tsv)</a></li>
<li class="chapter" data-level="5.2.2" data-path="carga.html"><a href="carga.html#carga-r"><i class="fa fa-check"></i><b>5.2.2</b> Archivos creados con R (.Rdata y .rds)</a></li>
<li class="chapter" data-level="5.2.3" data-path="carga.html"><a href="carga.html#carga-etiquetas"><i class="fa fa-check"></i><b>5.2.3</b> Datos con etiquetas (Stata o SPSS)</a></li>
<li class="chapter" data-level="5.2.4" data-path="carga.html"><a href="carga.html#carga-excel"><i class="fa fa-check"></i><b>5.2.4</b> Archivos de Excel</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="carga.html"><a href="carga.html#multiples-bases-de-datos-a-la-vez"><i class="fa fa-check"></i><b>5.3</b> Múltiples bases de datos a la vez</a></li>
<li class="chapter" data-level="5.4" data-path="carga.html"><a href="carga.html#carga-grandes"><i class="fa fa-check"></i><b>5.4</b> Bases de datos tabulares grandes</a></li>
</ul></li>
<li class="part"><span><b>II Modelos</b></span></li>
<li class="chapter" data-level="6" data-path="lineal.html"><a href="lineal.html"><i class="fa fa-check"></i><b>6</b> Modelos lineales</a><ul>
<li class="chapter" data-level="6.1" data-path="lineal.html"><a href="lineal.html#introduccion-2"><i class="fa fa-check"></i><b>6.1</b> Introducción</a></li>
<li class="chapter" data-level="6.2" data-path="lineal.html"><a href="lineal.html#aplicacion-en-r"><i class="fa fa-check"></i><b>6.2</b> Aplicación en <code>R</code></a><ul>
<li class="chapter" data-level="6.2.1" data-path="lineal.html"><a href="lineal.html#estadisticos-descriptivos"><i class="fa fa-check"></i><b>6.2.1</b> Estadísticos Descriptivos</a></li>
<li class="chapter" data-level="6.2.2" data-path="lineal.html"><a href="lineal.html#estadisticos-descriptivos-y-distribucion-de-las-variables-del-modelo"><i class="fa fa-check"></i><b>6.2.2</b> Estadísticos descriptivos y distribución de las variables del modelo</a></li>
<li class="chapter" data-level="6.2.3" data-path="lineal.html"><a href="lineal.html#matriz-de-correlacion-de-variables-independientes"><i class="fa fa-check"></i><b>6.2.3</b> Matriz de correlación de variables independientes</a></li>
<li class="chapter" data-level="6.2.4" data-path="lineal.html"><a href="lineal.html#distribucion-de-las-variables-de-interes"><i class="fa fa-check"></i><b>6.2.4</b> Distribución de las variables de interés</a></li>
<li class="chapter" data-level="6.2.5" data-path="lineal.html"><a href="lineal.html#relacion-entre-la-variable-dependiente-e-independiente"><i class="fa fa-check"></i><b>6.2.5</b> Relación entre la variable dependiente e independiente</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="lineal.html"><a href="lineal.html#modelo-bivariado-regresion-lineal-simple"><i class="fa fa-check"></i><b>6.3</b> Modelo bivariado: regresión lineal simple</a><ul>
<li class="chapter" data-level="6.3.1" data-path="lineal.html"><a href="lineal.html#estimando-un-modelo-lineal-en-r"><i class="fa fa-check"></i><b>6.3.1</b> Estimando un modelo lineal en <code>R</code></a></li>
<li class="chapter" data-level="6.3.2" data-path="lineal.html"><a href="lineal.html#representacion-grafica"><i class="fa fa-check"></i><b>6.3.2</b> Representación gráfica</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="lineal.html"><a href="lineal.html#modelo-multivariado-regresion-multiple"><i class="fa fa-check"></i><b>6.4</b> Modelo multivariado: regresión múltiple</a><ul>
<li class="chapter" data-level="6.4.1" data-path="lineal.html"><a href="lineal.html#ajuste-del-modelo"><i class="fa fa-check"></i><b>6.4.1</b> Ajuste del modelo</a></li>
<li class="chapter" data-level="6.4.2" data-path="lineal.html"><a href="lineal.html#inferencia-en-modelos-lineales-multiples"><i class="fa fa-check"></i><b>6.4.2</b> Inferencia en modelos lineales múltiples</a></li>
<li class="chapter" data-level="6.4.3" data-path="lineal.html"><a href="lineal.html#supuestos-de-ols"><i class="fa fa-check"></i><b>6.4.3</b> Supuestos de OLS</a></li>
<li class="chapter" data-level="6.4.4" data-path="lineal.html"><a href="lineal.html#errores-estandares-robustos"><i class="fa fa-check"></i><b>6.4.4</b> Errores estándares robustos</a></li>
<li class="chapter" data-level="6.4.5" data-path="lineal.html"><a href="lineal.html#un-caso-especial-de-heterocedasticidad-la-varianza-del-error-asociada-a-clusters"><i class="fa fa-check"></i><b>6.4.5</b> Un caso especial de Heterocedasticidad: la varianza del error asociada a clusters</a></li>
<li class="chapter" data-level="6.4.6" data-path="lineal.html"><a href="lineal.html#un-supuesto-adicional-para-poder-realizar-inferencia"><i class="fa fa-check"></i><b>6.4.6</b> Un supuesto adicional para poder realizar <strong>inferencia</strong></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="logit.html"><a href="logit.html"><i class="fa fa-check"></i><b>7</b> Modelos logísticos</a><ul>
<li class="chapter" data-level="7.1" data-path="logit.html"><a href="logit.html#nociones-basicas"><i class="fa fa-check"></i><b>7.1</b> Nociones básicas</a></li>
<li class="chapter" data-level="7.2" data-path="logit.html"><a href="logit.html#aplicacion-en-r-1"><i class="fa fa-check"></i><b>7.2</b> Aplicación en <code>R</code></a><ul>
<li class="chapter" data-level="7.2.1" data-path="logit.html"><a href="logit.html#estimar-los-modelos"><i class="fa fa-check"></i><b>7.2.1</b> Estimar los modelos</a></li>
<li class="chapter" data-level="7.2.2" data-path="logit.html"><a href="logit.html#crear-tablas"><i class="fa fa-check"></i><b>7.2.2</b> Crear tablas</a></li>
<li class="chapter" data-level="7.2.3" data-path="logit.html"><a href="logit.html#visualizacion-de-resultados"><i class="fa fa-check"></i><b>7.2.3</b> Visualización de resultados</a></li>
<li class="chapter" data-level="7.2.4" data-path="logit.html"><a href="logit.html#ajuste-de-los-modelos"><i class="fa fa-check"></i><b>7.2.4</b> Ajuste de los modelos</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="surv.html"><a href="surv.html"><i class="fa fa-check"></i><b>8</b> Modelos de supervivencia</a><ul>
<li class="chapter" data-level="8.1" data-path="surv.html"><a href="surv.html#nociones-basicas-1"><i class="fa fa-check"></i><b>8.1</b> Nociones básicas</a></li>
<li class="chapter" data-level="8.2" data-path="surv.html"><a href="surv.html#el-modelo-cox-de-riesgos-proporcionales"><i class="fa fa-check"></i><b>8.2</b> El modelo Cox de riesgos proporcionales</a></li>
<li class="chapter" data-level="8.3" data-path="surv.html"><a href="surv.html#aplicacion-en-r-2"><i class="fa fa-check"></i><b>8.3</b> Aplicación en <code>R</code></a><ul>
<li class="chapter" data-level="8.3.1" data-path="surv.html"><a href="surv.html#modelos-de-supervivencia-e-interpretacion-sus-coeficientes-como-hazard-ratios."><i class="fa fa-check"></i><b>8.3.1</b> Modelos de supervivencia e interpretación sus coeficientes como Hazard Ratios.</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Aplicaciones</b></span></li>
<li class="chapter" data-level="9" data-path="manejo-av.html"><a href="manejo-av.html"><i class="fa fa-check"></i><b>9</b> Manejo avanzado de datos políticos</a><ul>
<li class="chapter" data-level="9.1" data-path="manejo-av.html"><a href="manejo-av.html#introduccion-3"><i class="fa fa-check"></i><b>9.1</b> Introducción</a></li>
<li class="chapter" data-level="9.2" data-path="manejo-av.html"><a href="manejo-av.html#como-aprovechar-countrycode"><i class="fa fa-check"></i><b>9.2</b> ¿Cómo aprovechar <code>countrycode</code>?</a></li>
<li class="chapter" data-level="9.3" data-path="manejo-av.html"><a href="manejo-av.html#como-imputar-datos-faltantes"><i class="fa fa-check"></i><b>9.3</b> ¿Cómo imputar datos faltantes?</a></li>
<li class="chapter" data-level="9.4" data-path="manejo-av.html"><a href="manejo-av.html#imputar-datos-usando-amelia"><i class="fa fa-check"></i><b>9.4</b> Imputar datos usando Amelia</a><ul>
<li class="chapter" data-level="9.4.1" data-path="manejo-av.html"><a href="manejo-av.html#diagnosticos"><i class="fa fa-check"></i><b>9.4.1</b> Diagnosticos</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="manejo-av.html"><a href="manejo-av.html#regresiones-luego-de-imputar-datos"><i class="fa fa-check"></i><b>9.5</b> Regresiones luego de imputar datos</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="pca.html"><a href="pca.html"><i class="fa fa-check"></i><b>10</b> Creación de índices con PCA</a><ul>
<li class="chapter" data-level="10.1" data-path="pca.html"><a href="pca.html#aplicacion-en-r-3"><i class="fa fa-check"></i><b>10.1</b> Aplicación en <code>R</code></a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="casos.html"><a href="casos.html"><i class="fa fa-check"></i><b>11</b> Selección de casos a partir de regresiones</a><ul>
<li class="chapter" data-level="11.1" data-path="casos.html"><a href="casos.html#que-casos-de-estudio-debo-seleccionar-para-testear-mi-hipotesis"><i class="fa fa-check"></i><b>11.1</b> ¿Qué casos de estudio debo seleccionar para testear mi hipótesis?</a><ul>
<li class="chapter" data-level="11.1.1" data-path="casos.html"><a href="casos.html#casos-tipicos"><i class="fa fa-check"></i><b>11.1.1</b> Casos Típicos</a></li>
<li class="chapter" data-level="11.1.2" data-path="casos.html"><a href="casos.html#casos-desviados"><i class="fa fa-check"></i><b>11.1.2</b> Casos desviados</a></li>
<li class="chapter" data-level="11.1.3" data-path="casos.html"><a href="casos.html#casos-influyentes"><i class="fa fa-check"></i><b>11.1.3</b> Casos Influyentes</a></li>
<li class="chapter" data-level="11.1.4" data-path="casos.html"><a href="casos.html#casos-extremos"><i class="fa fa-check"></i><b>11.1.4</b> Casos extremos</a></li>
<li class="chapter" data-level="11.1.5" data-path="casos.html"><a href="casos.html#casos-mas-similares"><i class="fa fa-check"></i><b>11.1.5</b> Casos más similares</a></li>
<li class="chapter" data-level="11.1.6" data-path="casos.html"><a href="casos.html#casos-mas-diferentes"><i class="fa fa-check"></i><b>11.1.6</b> Casos más diferentes</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="casos.html"><a href="casos.html#la-relevancia-de-combinar-metodos"><i class="fa fa-check"></i><b>11.2</b> La relevancia de combinar métodos</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="web-mining.html"><a href="web-mining.html"><i class="fa fa-check"></i><b>12</b> Mínería de datos</a></li>
<li class="chapter" data-level="13" data-path="redes.html"><a href="redes.html"><i class="fa fa-check"></i><b>13</b> Análisis de redes</a><ul>
<li class="chapter" data-level="13.1" data-path="redes.html"><a href="redes.html#introduccion-4"><i class="fa fa-check"></i><b>13.1</b> Introducción</a></li>
<li class="chapter" data-level="13.2" data-path="redes.html"><a href="redes.html#conceptos-iniciales"><i class="fa fa-check"></i><b>13.2</b> Conceptos iniciales</a><ul>
<li class="chapter" data-level="13.2.1" data-path="redes.html"><a href="redes.html#nodos-y-enlaces"><i class="fa fa-check"></i><b>13.2.1</b> Nodos y enlaces</a></li>
<li class="chapter" data-level="13.2.2" data-path="redes.html"><a href="redes.html#matriz-de-adyacencia"><i class="fa fa-check"></i><b>13.2.2</b> Matriz de adyacencia</a></li>
<li class="chapter" data-level="13.2.3" data-path="redes.html"><a href="redes.html#pesos-y-direccion"><i class="fa fa-check"></i><b>13.2.3</b> Pesos y dirección</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="redes.html"><a href="redes.html#bases-de-datos-de-redes"><i class="fa fa-check"></i><b>13.3</b> Bases de datos de redes</a></li>
<li class="chapter" data-level="13.4" data-path="redes.html"><a href="redes.html#disposicion-grafica"><i class="fa fa-check"></i><b>13.4</b> Disposición gráfica</a><ul>
<li class="chapter" data-level="13.4.1" data-path="redes.html"><a href="redes.html#color-y-forma-en-la-representacion-visual"><i class="fa fa-check"></i><b>13.4.1</b> Color y forma en la representación visual</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="redes.html"><a href="redes.html#analisis-basico-de-redes"><i class="fa fa-check"></i><b>13.5</b> Análisis básico de redes</a><ul>
<li class="chapter" data-level="13.5.1" data-path="redes.html"><a href="redes.html#medidas-de-centralidad"><i class="fa fa-check"></i><b>13.5.1</b> Medidas de centralidad</a></li>
<li class="chapter" data-level="13.5.2" data-path="redes.html"><a href="redes.html#comunidades-en-las-redes"><i class="fa fa-check"></i><b>13.5.2</b> Comunidades en las redes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="qta.html"><a href="qta.html"><i class="fa fa-check"></i><b>14</b> Análisis cuantitativo de texto</a><ul>
<li class="chapter" data-level="14.1" data-path="qta.html"><a href="qta.html#introduccion-5"><i class="fa fa-check"></i><b>14.1</b> Introducción</a></li>
<li class="chapter" data-level="14.2" data-path="qta.html"><a href="qta.html#exploracion-de-la-bases-de-datos"><i class="fa fa-check"></i><b>14.2</b> Exploración de la bases de datos</a></li>
<li class="chapter" data-level="14.3" data-path="qta.html"><a href="qta.html#calculo-de-frecuencias"><i class="fa fa-check"></i><b>14.3</b> Cálculo de frecuencias</a><ul>
<li class="chapter" data-level="14.3.1" data-path="qta.html"><a href="qta.html#cuales-son-los-diez-hashtags-mas-usados-de-las-cuentas-de-los-diputados"><i class="fa fa-check"></i><b>14.3.1</b> ¿Cuáles son los diez hashtags más usados de las cuentas de los diputados?</a></li>
<li class="chapter" data-level="14.3.2" data-path="qta.html"><a href="qta.html#frecuencias-por-genero-cantidad-de-hashtags-usados-por-los-diputados-en-total"><i class="fa fa-check"></i><b>14.3.2</b> Frecuencias por género: cantidad de hashtags usados por los diputados en total</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="qta.html"><a href="qta.html#wordcloud-de-hashtags"><i class="fa fa-check"></i><b>14.4</b> Wordcloud de hashtags</a></li>
<li class="chapter" data-level="14.5" data-path="qta.html"><a href="qta.html#graficar-los-hashtags-mas-utilizados-por-grupos-de-interes"><i class="fa fa-check"></i><b>14.5</b> Graficar los hashtags más utilizados por grupos de interés</a><ul>
<li class="chapter" data-level="14.5.1" data-path="qta.html"><a href="qta.html#hashtags-mas-usados-entre-las-diputadas"><i class="fa fa-check"></i><b>14.5.1</b> Hashtags más usados entre las diputadas</a></li>
<li class="chapter" data-level="14.5.2" data-path="qta.html"><a href="qta.html#hashtags-mas-usados-entre-los-diputados"><i class="fa fa-check"></i><b>14.5.2</b> Hashtags más usados entre los diputados</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="qta.html"><a href="qta.html#hashtags-de-genero-por-caracteristicas-del-diputado"><i class="fa fa-check"></i><b>14.6</b> Hashtags de género por características del diputado</a><ul>
<li class="chapter" data-level="14.6.1" data-path="qta.html"><a href="qta.html#por-el-genero-del-diputado"><i class="fa fa-check"></i><b>14.6.1</b> Por el género del diputado</a></li>
<li class="chapter" data-level="14.6.2" data-path="qta.html"><a href="qta.html#por-la-coalicion-de-los-diputados"><i class="fa fa-check"></i><b>14.6.2</b> Por la coalición de los diputados</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="qta.html"><a href="qta.html#variacion-temporal-del-uso-de-estos-hashtags"><i class="fa fa-check"></i><b>14.7</b> Variación temporal del uso de estos hashtags</a><ul>
<li class="chapter" data-level="14.7.1" data-path="qta.html"><a href="qta.html#frecuencia-semanal-de-olafeminista"><i class="fa fa-check"></i><b>14.7.1</b> Frecuencia semanal de #olafeminista</a></li>
<li class="chapter" data-level="14.7.2" data-path="qta.html"><a href="qta.html#frecuencia-semanal-de-tres-hashtags-de-genero"><i class="fa fa-check"></i><b>14.7.2</b> Frecuencia semanal de tres hashtags de género</a></li>
<li class="chapter" data-level="14.7.3" data-path="qta.html"><a href="qta.html#grafiquemos-los-hashtags-de-genero-por-semana"><i class="fa fa-check"></i><b>14.7.3</b> Grafiquemos los hashtags de género por semana</a></li>
<li class="chapter" data-level="14.7.4" data-path="qta.html"><a href="qta.html#ponderamos-en-relacion-al-total-de-hashtags-por-semana"><i class="fa fa-check"></i><b>14.7.4</b> Ponderamos en relación al total de hashtags por semana</a></li>
<li class="chapter" data-level="14.7.5" data-path="qta.html"><a href="qta.html#grafiquemos-los-hashtags-interesantes-ponderados-por-el-total-semanal"><i class="fa fa-check"></i><b>14.7.5</b> Grafiquemos los hashtags interesantes ponderados por el total semanal</a></li>
<li class="chapter" data-level="14.7.6" data-path="qta.html"><a href="qta.html#diputadas"><i class="fa fa-check"></i><b>14.7.6</b> Diputadas</a></li>
</ul></li>
<li class="chapter" data-level="14.8" data-path="qta.html"><a href="qta.html#hashtags-de-genero-por-semana-a-nivel-de-diputados-ponderados-por-semana"><i class="fa fa-check"></i><b>14.8</b> Hashtags de género por semana a nivel de diputados (ponderados por semana)</a></li>
<li class="chapter" data-level="14.9" data-path="qta.html"><a href="qta.html#comentarios-finales"><i class="fa fa-check"></i><b>14.9</b> Comentarios finales</a></li>
<li class="chapter" data-level="14.10" data-path="qta.html"><a href="qta.html#anexo-problemas-que-se-presentan-cuando-analizas-discursos-debates-o-leyes"><i class="fa fa-check"></i><b>14.10</b> Anexo: Problemas que se presentan cuando analizas discursos, debates o leyes</a></li>
<li class="chapter" data-level="14.11" data-path="qta.html"><a href="qta.html#tidy-text"><i class="fa fa-check"></i><b>14.11</b> <code>Tidy text</code></a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="mapas.html"><a href="mapas.html"><i class="fa fa-check"></i><b>15</b> Generación de mapas</a><ul>
<li class="chapter" data-level="15.1" data-path="mapas.html"><a href="mapas.html#datos-espaciales"><i class="fa fa-check"></i><b>15.1</b> Datos Espaciales</a><ul>
<li class="chapter" data-level="15.1.1" data-path="mapas.html"><a href="mapas.html#que-son"><i class="fa fa-check"></i><b>15.1.1</b> ¿Qué son?</a></li>
<li class="chapter" data-level="15.1.2" data-path="mapas.html"><a href="mapas.html#estructura-de-los-datos-espaciales"><i class="fa fa-check"></i><b>15.1.2</b> Estructura de los Datos Espaciales</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="mapas.html"><a href="mapas.html#datos-espaciales-en-r"><i class="fa fa-check"></i><b>15.2</b> Datos Espaciales en R</a></li>
<li class="chapter" data-level="15.3" data-path="mapas.html"><a href="mapas.html#special-features-en-r"><i class="fa fa-check"></i><b>15.3</b> Special Features en R</a><ul>
<li class="chapter" data-level="15.3.1" data-path="mapas.html"><a href="mapas.html#estructura"><i class="fa fa-check"></i><b>15.3.1</b> Estructura</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="mapas.html"><a href="mapas.html#manejo-de-datos-espaciales"><i class="fa fa-check"></i><b>15.4</b> Manejo de Datos Espaciales</a><ul>
<li class="chapter" data-level="15.4.1" data-path="mapas.html"><a href="mapas.html#modificaciones"><i class="fa fa-check"></i><b>15.4.1</b> Modificaciones</a></li>
<li class="chapter" data-level="15.4.2" data-path="mapas.html"><a href="mapas.html#crear-nuevos-shapefiles-con-st_write"><i class="fa fa-check"></i><b>15.4.2</b> Crear nuevos shapefiles con <code>st_write</code></a></li>
<li class="chapter" data-level="15.4.3" data-path="mapas.html"><a href="mapas.html#incorporar-datos-de-otras-bases-con-merge"><i class="fa fa-check"></i><b>15.4.3</b> Incorporar datos de otras bases con <code>merge</code></a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="mapas.html"><a href="mapas.html#mapear-en-r"><i class="fa fa-check"></i><b>15.5</b> Mapear en R</a></li>
<li class="chapter" data-level="15.6" data-path="mapas.html"><a href="mapas.html#mapeando-variables"><i class="fa fa-check"></i><b>15.6</b> Mapeando variables</a><ul>
<li class="chapter" data-level="15.6.1" data-path="mapas.html"><a href="mapas.html#mapas-animados-con-gganimate"><i class="fa fa-check"></i><b>15.6.1</b> Mapas animados con <code>gganimate</code></a></li>
</ul></li>
<li class="chapter" data-level="15.7" data-path="mapas.html"><a href="mapas.html#inferencia-a-partir-de-datos-espaciales"><i class="fa fa-check"></i><b>15.7</b> Inferencia a partir de Datos Espaciales</a><ul>
<li class="chapter" data-level="15.7.1" data-path="mapas.html"><a href="mapas.html#indicadores-locales-de-asociacion-espacial-lisa"><i class="fa fa-check"></i><b>15.7.1</b> Indicadores locales de asociación espacial (LISA)</a></li>
<li class="chapter" data-level="15.7.2" data-path="mapas.html"><a href="mapas.html#matriz-de-pesos-espaciales"><i class="fa fa-check"></i><b>15.7.2</b> Matriz de Pesos Espaciales</a></li>
<li class="chapter" data-level="15.7.3" data-path="mapas.html"><a href="mapas.html#morans-i"><i class="fa fa-check"></i><b>15.7.3</b> Moran’s I</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">AnalizaR Datos Políticos</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="lineal" class="section level1">
<h1><span class="header-section-number">Capítulo 6</span> Modelos lineales</h1>
<p><em>Por Inés Fynn y Lihuen Nocetto</em></p>
<hr />
<p><strong>Lecturas de referencia</strong></p>
<ul>
<li><p>Angrist, Joshua, Jörn-Steffen Pischke. (2008). <em>Mostly Harmless Econometrics: An Empiricist’s Companion</em>. Princeton University Press.</p></li>
<li><p>Dunning, Thad. (2012). <em>Natural Experiments in the Social Sciences. A design-based approach</em>. Cambridge University Press.</p></li>
<li><p>Gelman, Andrew, Jennifer Hill. (2006). <em>Data Analysis Using Regression and Multilevel/Hierarchical Models</em>. Cambridge University Press.</p></li>
<li><p>Wooldridge, Jeffrey.(2010). <em>Introducción a la econometría. Un enfoque moderno</em>. Ed. Cengage</p></li>
<li><p>Lewis-Beck, C., &amp; Lewis-Beck, M. (2015). <em>Applied regression: An introduction (Vol. 22)</em>. Sage publications.</p></li>
</ul>
<hr />
<div id="introduccion-2" class="section level2">
<h2><span class="header-section-number">6.1</span> Introducción</h2>
<p>Este es el primer capítulo donde veremos como hacer regresiones. Comenzaremos por regresiones lineales, comunmente usado para variables dependientes continuas. Aquí la función es lineal, es decir, requiere la determinación de dos parámetros: la pendiente y la ordenada en el origen. Cuando este análisis es multivariado, se complejiza más aún. Cubriremos como interpretar coeficientes, como crear tablas de regresión, visualizar valores predichos, y además nos detendremos a evaluar los supuestos de Minimos Cuadrados Ordinarios, para que puedas hacer diagnosticos respecto al buen ajuste de tus modelos.</p>
</div>
<div id="aplicacion-en-r" class="section level2">
<h2><span class="header-section-number">6.2</span> Aplicación en <code>R</code></h2>
<p>La base de datos con la que trabajaremos en este capítulo se nutre de dos bases de datos construidas por <a href="http://huberandstephens.web.unc.edu/common-works/data/">Evelyne Huber y John D. Stephens</a>. Estas dos bases de datos son:</p>
<ul>
<li><p>Latin America Welfare Dataset, 1960-2014 (Evelyne Huber and John D. Stephens, Latin American Welfare Dataset, 1960-2014, University of North Carolina at Chapel Hill, 2014.): contiene variables sobre Estados de Bienestar en todos los países de América Latina y el Caribe entre los años 1960 y 2014.</p></li>
<li><p>Latin America and Caribbean Political Data Set, 1945-2012 (Evelyne Huber and John D. Stephens, Latin America and the Caribbean Political Dataset, 1945-2012, University of North Carolina at Chapel Hill, 2012.): contiene variables políticas para todos los países de América Latina y el Caribe entre los años 1945 y 2012.</p></li>
</ul>
<p>La base de datos resultante contiene 1074 observaciones de 25 países entre los años 1970 y 2012 (se dejaron por fuera los datos de la década del 60 por tener demasiados valores perdidos).</p>
<p>Primero cargamos el paquete <code>tidyverse</code> que incluye un conjunto amplio de funciones para el manejo de bases de datos</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)</code></pre>
<p>Vamos a importar esta base de datos.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(paqueteadp)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(bienestar_la)</code></pre>
<p>Ahora la base se ha cargado en nuestra sesión de <code>R</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ls</span>()
<span class="co">## [1] &quot;bienestar_la&quot;</span></code></pre>
<p>Como base para el análisis en este capítulo tomaremos el paper de <a href="https://journals.sagepub.com/doi/abs/10.1177/000312240607100604">Huber, E., Nielsen, F., Pribble, J., &amp; Stephens, J. D. (2006). Politics and inequality in Latin America and the Caribbean. American Sociological Review, 71(6), 943-963</a> donde se estiman los determinantes de la desigualdad en los países de América Latina y el Caribe. Trabajar sobre la base de este artículo nos permite estimar un modelo con varias variables de control que ya se ha probado son importantes para explicar la variación de la desigualdad en la región. Por tanto, la variable dependiente que nos interesa explicar es la desigualdad de ingresos en países de América Latina y el Caribe, operacionalizada a partir del Índice de Gini (<code>gini_slc</code>). Las variables independientes que incorporaremos al modelo son las siguientes:</p>
<ul>
<li>Dualismosectorial (refiere a la la coexistencia de un sector tradicional de baja productividad y un sector moderno de alta productividad) - <code>s_dualism</code></li>
<li>PBI - <code>rgdpch</code></li>
<li>Inversión Extranjera Directa (ingresos netos - % del PIB) - <code>fdiingdp</code></li>
<li>Diversidad étnica (variable dummy codificada 1 cuando al menos el 20 %, pero no más del 80 % de la población es étnicamente diversa) - <code>ethnicdicot</code></li>
<li>Democracia (tipo de régimen) - <code>demrss</code></li>
<li>Gasto en educación (como porcentaje del PBI) - <code>cseduc</code></li>
<li>Gasto en salud (comoporcentaje del PBI) - <code>cshlth</code></li>
<li>Gasto en seguridad social (comoporcentaje del PBI) - <code>csssw</code></li>
<li>Balance legislativo - <code>legbal</code></li>
<li>AutoritarismoRepresivo - <code>repressauthor</code></li>
</ul>
<p>Durante este capítulo intentaremos estimar cuál es el efecto del gasto en educación sobre la desigualdad en los países de América Latina y el Caribe. De este modo, nuestra variable independiente de interés será Gasto en Educación (<code>cseduc</code>).</p>
<div id="estadisticos-descriptivos" class="section level3">
<h3><span class="header-section-number">6.2.1</span> Estadísticos Descriptivos</h3>
<p>Antes de estimar un modelo con Mínimos Cuadrados Ordinarios (MCO, o OLS por su sigla en inglés), o con cualquier estimador, es recomendable reconocer la distribución de las variables de interés: la variable dependiente <span class="math inline">\(y\)</span> (también llamada variable explicada o regresando) y la variable independiente de interés <span class="math inline">\(x\)</span> (también llamada variable explicativa o regresor). Por lo general, en nuestros modelos tendremos, además de la variable independiente de interés, otras variables independientes (o explicativas) que les llamaremos “controles” pues su función será hacer el escenario <em>ceteris paribus</em> lo más creíble posible. Es decir, “mantener el resto de los factores constantes” para acercarnos lo más posible a un mundo experimental, en el que podemos controlar todas las variables que afectan <span class="math inline">\(y\)</span> y observar cómo la variación en una sola variable independiente <span class="math inline">\(x\)</span> afecta la variación de la variable dependiente (<span class="math inline">\(y\)</span>).</p>
<p>Entonces, antes de estimar el modelo, vamos a observar los estadísticos descriptivos de las variables que estarán incorporadas a dicho modelo (tanto de la dependiente como de las independientes). El objetivo es prestar atención a los siguientes puntos:</p>
<ol style="list-style-type: decimal">
<li><p>Variación en <span class="math inline">\(x\)</span>: que las variables independientes (pero sobre todo la de interés) tengan variación en nuestra muestra. Pues si no hay variación de <span class="math inline">\(x\)</span>, no podremos estimar cómo esta variación afecta la variación de <span class="math inline">\(y\)</span>.</p></li>
<li><p>Variación en <span class="math inline">\(y\)</span>: si la variable dependiente no varía, no vamos a poder explicar su variación en función de las <span class="math inline">\(x\)</span>.</p></li>
<li><p>Unidad de medición de las variables: es en esta instancia donde evaluamos cómo están medidas nuestras variables (además de revisar los diccionarios que por lo general acompañan las bases de datos con las que trabajamos), para poder entender qué tipo de variables estas debieran ser (nominales, ordinales, continuas), y además para luego poder interpretar correctamente los resultados obtenidos.</p></li>
<li><p>Tipos de variables: en la estimación por Mínimos Cuadrados Ordinarios las variables dependientes deben ser, generalmente, <em>continuas</em> (aunque es posible trabajar con variables dependientes dicotómicas). Por tanto, debemos asegurarnos que la variable dependiente sea continua y numérica. Además, es importante conocer el tipo de variables independientes y chequear que su tipo sea coherente con cómo está codificada (i.e si tenemos una variable independiente de “rangos de edad” la variable debe ser categórica o de factor, y no númerica), para que luego nuestras interpretaciones de los resultados sean correctas.</p></li>
<li><p>Identificar valores perdidos: Si nuestras variables tienen demasiados valores perdidos debemos revisar a qué se debe esto y, eventualmente, imputar datos (como se explica en el Capítulo <a href="casos.html#casos">11</a>).</p></li>
</ol>
</div>
<div id="estadisticos-descriptivos-y-distribucion-de-las-variables-del-modelo" class="section level3">
<h3><span class="header-section-number">6.2.2</span> Estadísticos descriptivos y distribución de las variables del modelo</h3>
<p>Una primera visualización de nuestras variables de interés la podemos hacer utilizando el comando <code>skmir</code> que nos otorga no solo algunos estadísticos descriptivos sino también la distribución de las variables.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(skimr)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">skim</span>(bienestar_la <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(gini_slc, cseduc, fdiingdp, rgdpch, cseduc, cshlth, csssw, ethnicdicot, pop014wdi))<span class="op">%&gt;%</span><span class="st"> </span>skimr<span class="op">::</span><span class="kw">kable</span>()
<span class="co">## Skim summary statistics  </span>
<span class="co">##  n obs: 1074    </span>
<span class="co">##  n variables: 8    </span>
<span class="co">## </span>
<span class="co">## Variable type: numeric</span>
<span class="co">## </span>
<span class="co">##   variable      missing    complete     n       mean        sd         p0         p25        p50        p75       p100        hist   </span>
<span class="co">## -------------  ---------  ----------  ------  ---------  ---------  ---------  ---------  ---------  ---------  ---------  ----------</span>
<span class="co">##    cseduc         325        749       1074      3.8       1.65        0.4        2.6        3.8        4.8        9.1      ▂▅▇▇▅▂▁▁ </span>
<span class="co">##    cshlth         325        749       1074      2.5       1.89        0.1        1.1        2.1        3.4        15       ▇▆▃▁▁▁▁▁ </span>
<span class="co">##     csssw         467        607       1074      4.1       3.57         0         1.5         3         5.7       16.8      ▇▆▃▂▁▁▁▁ </span>
<span class="co">##  ethnicdicot      370        704       1074     0.45        0.5         0          0          0          1          1       ▇▁▁▁▁▁▁▇ </span>
<span class="co">##   fdiingdp        198        876       1074     2.19       4.18      -55.24      0.48       1.43       3.29       39.81     ▁▁▁▁▇▂▁▁ </span>
<span class="co">##   gini_slc        649        425       1074     49.54      6.73       28.9        44        50.6        55        68.3      ▁▁▅▆▆▇▁▁ </span>
<span class="co">##   pop014wdi       129        945       1074     36.36      7.01       18.99      30.79      36.57      42.26      48.73     ▁▃▆▆▇▆▇▆ </span>
<span class="co">##    rgdpch         194        880       1074    7345.94    4981.75    1421.71    4046.04    6264.85    8667.02    29343.9    ▇▇▃▁▁▁▁▁</span></code></pre>
<p>En el output se ordenan los resultados por tipo de variable, nos indica la cantidad de missing para cada una de ellas, su respectiva media, desvío estandar, los valores correspondientes a los percentiles y un pequeño histograma que nos muestra cómoestán distribuidas. Además, si quisieramos, podriamos realizar una tabla seleccionando solo algunos de los estadísticos que te interesan. Aquí por ejemplo, solo nos interesa ver la media y desviación estándar:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># skim(bienestar_la %&gt;% select(cseduc, fdiingdp, rgdpch, cseduc, cshlth, csssw, ethnicdicot, pop014wdi))%&gt;% dplyr::filter(stat==c(&quot;mean&quot;,&quot;sd&quot;))%&gt;% skimr::kable()</span></code></pre>
<p>En este caso solo nos interesa observar su distribución en histogramas:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># skim(bienestar_la %&gt;% select(cseduc, fdiingdp, rgdpch, cseduc, cshlth, csssw))%&gt;% dplyr::filter(stat==&quot;hist&quot;)%&gt;% skimr::kable()</span></code></pre>
</div>
<div id="matriz-de-correlacion-de-variables-independientes" class="section level3">
<h3><span class="header-section-number">6.2.3</span> Matriz de correlación de variables independientes</h3>
<p>Luego de reconocer todas las variables que incorporaremos al modelo, es recomendable observar cómo están relacionadas entre ellas. Para esto, realizamos una matriz de correlación de las variables independientes con el comando <code>rcorr</code> del paquete <code>Hmisc</code> donde podemos evaluar la correlaicón de Pearson entre todas las variables. Además, este comando también nos da el <em>p value</em> para cada correlación, donde podemos evaluar si la correlación observada es significativa.</p>
<p>De todos modos, es importante recordar que la <strong>correlación no implica causalidad</strong>. Aquí simplemente queremos comprender si las variables del modelo están de algún modo relacionadas. Este paso es importante no solo para un reconocimiento de nuestros datos y variables, sino también porque queremos evitar que nuestro modelo tenga multicolinealidad perfecta (que hayan variables independientes que estén perfectamente corrrelacionadas) pues es uno de los supuestos centrales de OLS que revisaremos al final de este capítuo.</p>
<pre class="sourceCode r"><code class="sourceCode r">variables &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;gini_slc&quot;</span>,<span class="st">&quot;cseduc&quot;</span>,<span class="st">&quot;s_dualism&quot;</span>,<span class="st">&quot;fdiingdp&quot;</span>,<span class="st">&quot;rgdpch&quot;</span>,<span class="st">&quot;ethnicdicot&quot;</span>,<span class="st">&quot;demrss&quot;</span>,<span class="st">&quot;cshlth&quot;</span>,<span class="st">&quot;csssw&quot;</span>,<span class="st">&quot;legbal&quot;</span>,<span class="st">&quot;repressauthor&quot;</span>,<span class="st">&quot;pop014wdi&quot;</span>)
vind &lt;-<span class="st"> </span>bienestar_la[variables]</code></pre>
<p>Cargamos el paquete ´Ggally´que nos será útil para ver las correlaciones.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># library(GGally)</span>
<span class="co"># ggcorr(vind, label = T)</span></code></pre>
<p>Ahora que conocemos todas las variables que incorporaremos al modelo, y cómo se relacionan entre sí, profundizaremos sobre las variables de interés: la dependiente y la independiente.</p>
</div>
<div id="distribucion-de-las-variables-de-interes" class="section level3">
<h3><span class="header-section-number">6.2.4</span> Distribución de las variables de interés</h3>
<p>Como mencionamos anteriormente, siempre nos interesa estimar cómo el cambio en una variable independiente (su variación) afecta la variación de una variable dependiente. Es decir, cómo cambia <span class="math inline">\(y\)</span> cuando cambia <span class="math inline">\(x\)</span>. En este caso, supongamos que nos interesa estimar cómo varían los niveles de desigualdad de un país (medido a partir del Índice de Gini) en relación al gasto en la educación (medido como porcentaje del PBI destinado a la educación). De este modo, nuestra variable independiente de interés es el gasto en la educación, mientras que la variable dependiente es la desigualdad.</p>
<p>Veamos cómose distribuyen estas variables en nuestra base de datos:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(bienestar_la, <span class="kw">aes</span>(<span class="dt">x=</span>gini_slc, <span class="dt">na.rm=</span><span class="ot">TRUE</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">1</span>,<span class="dt">color=</span><span class="st">&quot;white&quot;</span>, <span class="dt">fill=</span><span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="kw">labs</span>(<span class="dt">title =</span> <span class="kw">paste</span>(
          <span class="st">&quot;Distribución de la Variable Dependiente&quot;</span>),
        <span class="dt">caption =</span> <span class="kw">paste</span> (<span class="st">&quot;Fuente: Huber et al (2012)&quot;</span>),
        <span class="dt">x =</span> <span class="st">&quot;Índice de Gini&quot;</span>,
        <span class="dt">y =</span> <span class="st">&quot;Frecuencia&quot;</span>
)
<span class="co">## Warning: Removed 649 rows containing non-finite values (stat_bin).</span></code></pre>
<div class="figure" style="text-align: center"><span id="fig:hist1"></span>
<img src="lineal_files/figure-html/hist1-1.png" alt="La variable dependiente: Índice de Gini" width="70%" />
<p class="caption">
Figura 6.1: La variable dependiente: Índice de Gini
</p>
</div>
<p>La variable independiente: Gasto en Educación (% de PBI)</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(bienestar_la, <span class="kw">aes</span>(<span class="dt">x=</span>cseduc, <span class="dt">na.rm=</span><span class="ot">TRUE</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">1</span>,<span class="dt">color=</span><span class="st">&quot;white&quot;</span>, <span class="dt">fill=</span><span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="kw">labs</span>(<span class="dt">title =</span> <span class="kw">paste</span>(
          <span class="st">&quot;Distribución de la Variable Independiente&quot;</span>),<span class="dt">subtitle =</span> <span class="kw">paste</span>(<span class="st">&quot;% de PBI destinado a la Educación&quot;),</span>
<span class="st">        caption = paste (&quot;</span>Fuente<span class="op">:</span><span class="st"> </span>Huber et <span class="kw">al</span> (<span class="dv">2012</span>))<span class="st">&quot;</span>
<span class="st">      ),</span>
<span class="st">        x = &quot;</span>Gasto en Educación&quot;,
        <span class="dt">y =</span> <span class="st">&quot;Frecuencia&quot;</span>
)
<span class="co">## Warning: Removed 325 rows containing non-finite values (stat_bin).</span></code></pre>
<div class="figure" style="text-align: center"><span id="fig:hist2"></span>
<img src="lineal_files/figure-html/hist2-1.png" alt="Distribución de la Variable Independiente: Gasto en Educación" width="70%" />
<p class="caption">
Figura 6.2: Distribución de la Variable Independiente: Gasto en Educación
</p>
</div>
</div>
<div id="relacion-entre-la-variable-dependiente-e-independiente" class="section level3">
<h3><span class="header-section-number">6.2.5</span> Relación entre la variable dependiente e independiente</h3>
<p>Luego de observar cómo distribuyen las variables de interés, podemos ver gráficamente cómo se relacionan. Es decir, graficamos la correlación entre estas dos variables: en el eje de <span class="math inline">\(x\)</span> (horizontal) ubicamos a la variable independiente, mientras que en el eje de <span class="math inline">\(y\)</span> (vertical) la variable dependiente. Como resultado, cada “punto” del gráfico <a href="lineal.html#fig:scatter1">6.3</a> representa una observación de nuestra muestra con un determinado valor de gasto en educación (<span class="math inline">\(x\)</span>) y un determinado valor en el índice de Gini (<span class="math inline">\(y\)</span>).</p>
<pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">ggplot</span>(bienestar_la, <span class="kw">aes</span>(cseduc, gini_slc)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()<span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Gasto en Educación (%de PBI)&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Gini&quot;</span>, <span class="dt">caption =</span> <span class="kw">paste</span> (<span class="st">&quot;Fuente: Huber and Stephens, 2012&quot;</span>))
<span class="co">## Warning: Removed 718 rows containing missing values (geom_point).</span></code></pre>
<div class="figure" style="text-align: center"><span id="fig:scatter1"></span>
<img src="lineal_files/figure-html/scatter1-1.png" alt="Relación entre Gasto en Educación e Índice de Gini" width="70%" />
<p class="caption">
Figura 6.3: Relación entre Gasto en Educación e Índice de Gini
</p>
</div>
<p>Esta es una primera visualización de la relación entre nuestras variables que nos permite observar si hay algún tipo de vínculo entre ellas. Aquí claramente se observa una relación positiva (a mayor gasto en educación, mayor Gini). De todos modos, hasta el momento no podemos decir nada concluyente sobre la relación entre gasto en educación y nivel de desigualdad, para esto es necesario estimar el modelo. Hasta ahora solo estuvimos conociendo nuestros datos, avancemos hacia la regresión.</p>
</div>
</div>
<div id="modelo-bivariado-regresion-lineal-simple" class="section level2">
<h2><span class="header-section-number">6.3</span> Modelo bivariado: regresión lineal simple</h2>
<p>El modelo lineal simple asume que una variable aleatoria de respuesta <span class="math inline">\(y\)</span> es una función lineal de una variable independiente <span class="math inline">\(x\)</span> más un término de error <span class="math inline">\(u\)</span>. También decimos que la variable dependiente <span class="math inline">\(y\)</span> es resultado de un Proceso de Generación del Dato (DGP por sus siglas en inglés) que puede escribirse
<span class="math display">\[ Y = \beta_0 + \beta_1x + u   \]</span></p>
<p>Entonces, el modelo lineal implica precisamente definir que <span class="math inline">\(Y\)</span> está generada por una función lineal de <span class="math inline">\(x_1\)</span>, además de un término constante <span class="math inline">\(\beta_0\)</span> y la variable <span class="math inline">\(u\)</span> que es inobservada.
Dos supuestos son necesarios para derivar los estimadores de Mínimos Cuadrados Ordinarios. El primero refiere a que la esperanza de <span class="math inline">\(u\)</span> es igual a 0 <span class="math display">\[E(u)=0\]</span>. Esto implica que a nivel poblacional, todos los factores inobservados promedian cero. El supuesto más importante refiere a que la media de <span class="math inline">\(u\)</span> para cada valor de <span class="math inline">\(x\)</span> es cero: <span class="math display">\[E(u|x)=0\]</span></p>
<p>Este supuesto se conoce en la literatura econométrica comomedia condicional cero, o independencia condicional. En la literatura experimentalista se conoce comoexogeneidad de la <span class="math inline">\(x\)</span> o también que <span class="math inline">\(x\)</span> y <span class="math inline">\(u\)</span> son ortogonales. Todos estos términos implican que se asume que para cada valor de la variable independiente de interés <span class="math inline">\(x\)</span> los factores inobservados promediarán cero. En otras palabras, conocer un valor determinado de la <span class="math inline">\(x\)</span> no nos dice nada acerca de los inobservados.
Cuando <span class="math inline">\(E(u|x) = 0\)</span>, entonces se cumple que
<span class="math display">\[cov(x,u) = 0\]</span>.</p>
<p>En definitiva, bajo el supuesto de independencia condicional, <span class="math inline">\(x\)</span> y <span class="math inline">\(u\)</span> no correlacionan y esto permite derivar los estimadores de Mínimos Cuadrados Ordinarios a través de las <em>condiciones de primer orden</em>. Las dos condiciones de primer orden son que <span class="math display">\[E(u)=0\]</span> y <span class="math display">\[E(u|x)=0\]</span></p>
<p>Entender que estas son las condiciones que permiten derivar el <em>estimador</em> de MCO es clave para entender porqué a partir de la estimación por MCO no podemos testear la independencia del error. Esto es, por construcción, los residuos (<span class="math inline">\(\hat{u}\)</span>) de la regresión siempre promediarán cero en la muestra y en cada valor de <span class="math inline">\(x\)</span>. Demandar exogeneidad implica poder argumentar que <span class="math inline">\(u\)</span> es efectivamente ortogonal a las <span class="math inline">\(x&#39;s\)</span>, algo más creíble para experimentos y cuasi experimentos (ver Gerber y Green 2012, Dunning 2012, Glennester y Takavarsha 2013).</p>
<p>Si damos por válido que <span class="math inline">\(E(u|x)= 0\)</span>,entonces por álgebra podemos escribir la esperanza de una variable Y dado X como</p>
<p><span class="math display">\[E(y|x)= \beta_0+ \beta_1x\]</span></p>
<p>Como se ve, el término inobservado <span class="math inline">\(u\)</span> desaparece de la ecuación cuando se considera la esperanza de la distribución de <span class="math inline">\(Y\)</span> (la esperanza de <span class="math inline">\(u\)</span> es cero). Al término constante <span class="math inline">\(\beta_0\)</span> y al efecto de la <span class="math inline">\(x_1\)</span> se lo conoce como “parte sistemática del modelo”&quot;, o también Función de Regresión Poblacional (FRP). Es clave entender que el supuesto de <span class="math inline">\(E(u)=0\)</span> refiere al promedio de los factores inobservables y que por tanto, en promedio <span class="math inline">\(u\)</span> no afecta a <span class="math inline">\(Y\)</span>.
Sin embargo, debe recordarse que cada realización de la variable aleatoria Y está generada por la ecuación 1, y que por tanto, la variable Y de un individuo aleatoriamente seleccionado de esa población es
<span class="math display">\[Y_i= \beta_0+\beta_1x_{1i}+u_i\]</span></p>
<p>Esto quiere decir que la realización de la variable aleatoria <span class="math inline">\(Y\)</span> para el individuo <span class="math inline">\(i\)</span> es una función de <span class="math inline">\(x_1\)</span> y <span class="math inline">\(u\)</span>. O sea, del valor que toma la <span class="math inline">\(x_1\)</span> en ese individuo y el valor que toma <span class="math inline">\(u\)</span>. Todos los factores inobservados que se anotan como<span class="math inline">\(u\)</span> son los que explican que cada individuo se aleje de la FRP.</p>
<div id="estimando-un-modelo-lineal-en-r" class="section level3">
<h3><span class="header-section-number">6.3.1</span> Estimando un modelo lineal en <code>R</code></h3>
<p>Una vez que hemos definido un modelo poblacional como el descrito por la ecuación (1), nuestro trabajo es estimar el impacto de la variable independiente sobre la dependiente. La función <code>lm</code> que se encuentra en <code>R</code> base es la principal herramienta para estimar modelos lineales. La forma general que toma la función es</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lm</span>(Y <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>X)</code></pre>
<p>De donde se entiende que se estima un <em>linear model</em> (lm) para una variable dependiente Y regresada (~) en una variable independiente X. El “1” no es necesario, pero por estilo, se agrega para denotar el intercepto (<span class="math inline">\(\beta_0\)</span>). Con base a la investigación de Huber y Stephens (2006) asumamos que la Desigualdad es una función lineal del Gasto en Educación más un término de error inobservado <span class="math inline">\(u\)</span> y una constante <span class="math inline">\(\beta_0\)</span>.
Formalmente:</p>
<p><span class="math display">\[ Desigualdad = \beta_0 + \beta_1 GastoEducacion + u \]</span></p>
<p>Por el momento, vamos a asumir que la base de datos tiene 1074 observaciones independientes. En realidad, la estructura es de datos de panel: el mismo país tiene distintas observaciones a lo largo del tiempo. Sin embargo, por el momento no estamos en condiciones de abordar correctamente estos datos. El supuesto de observaciones independientes e idénticamente distribuidas es lo que permite escribir la realización del modelo para un individuo <span class="math inline">\(i\)</span> aleatoriamente seleccionado como<span class="math display">\[Desigualdad_i= \beta_0 +  \beta_1GastoEducacion_i + u_i\]</span></p>
<p>Para estimar el modelo, utilizaremos los datos de la base de Huber y Stephens (2006). La variable dependiente “Desigualdad” está medida a través del índice de Gini y el nombre de la variable es <code>gini_slc</code>. La variable independiente “Gasto en Educación” es <code>cseduc</code>. Como los datos están alojados en un data.frame, a la función le tenemos que indicar que traiga esos datos de la base correspondiente. Eso es lo que ocurre luego de la coma</p>
<pre class="sourceCode r"><code class="sourceCode r">modelo_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">lm</span>(gini_slc<span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>cseduc , <span class="dt">data=</span>bienestar_la) <span class="co">#luego de la coma le indicamos el data.frame que contiene los datos.</span>
<span class="kw">class</span>(modelo_<span class="dv">1</span>) <span class="co"># verificamos que la clase del objeto  es &quot;lm&quot;</span>
<span class="co">## [1] &quot;lm&quot;</span></code></pre>
<p>En la primera línea del código se creó un objeto (modelo_1) en que se está guardando el resultado de la función <code>lm</code>. Esta función arroja objetos de clase “lm” que son vectores que incluyen los coeficientes estimados, los errores estándar, residuos, la bondad de ajuste, entre otros resultados de la estimación. Para ver los componentes del objeto, una forma rápida es utilizar la función <code>summary</code></p>
<pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">summary</span>( modelo_<span class="dv">1</span>)
<span class="co">## </span>
<span class="co">## Call:</span>
<span class="co">## lm(formula = gini_slc ~ 1 + cseduc, data = bienestar_la)</span>
<span class="co">## </span>
<span class="co">## Residuals:</span>
<span class="co">##    Min     1Q Median     3Q    Max </span>
<span class="co">## -20.04  -5.62   1.09   4.99  15.57 </span>
<span class="co">## </span>
<span class="co">## Coefficients:</span>
<span class="co">##             Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="co">## (Intercept)    44.80       1.02   43.80  &lt; 2e-16 ***</span>
<span class="co">##  [ reached getOption(&quot;max.print&quot;) -- omitted 1 row ]</span>
<span class="co">## ---</span>
<span class="co">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span>
<span class="co">## </span>
<span class="co">## Residual standard error: 6.7 on 354 degrees of freedom</span>
<span class="co">##   (718 observations deleted due to missingness)</span>
<span class="co">## Multiple R-squared:  0.0642, Adjusted R-squared:  0.0615 </span>
<span class="co">## F-statistic: 24.3 on 1 and 354 DF,  p-value: 1.29e-06</span></code></pre>
<p>Presentaciones más elegantes pueden obtenerse con la función <code>screenreg</code>del paquete <code>texreg</code>. Veamos la presentación de resultados con la función <code>screenreg</code></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(texreg)
<span class="co">## Version:  1.36.23</span>
<span class="co">## Date:     2017-03-03</span>
<span class="co">## Author:   Philip Leifeld (University of Glasgow)</span>
<span class="co">## </span>
<span class="co">## Please cite the JSS article in your publications -- see citation(&quot;texreg&quot;).</span>
<span class="co">## </span>
<span class="co">## Attaching package: &#39;texreg&#39;</span>
<span class="co">## The following object is masked from &#39;package:tidyr&#39;:</span>
<span class="co">## </span>
<span class="co">##     extract</span>
<span class="kw">screenreg</span>(modelo_<span class="dv">1</span>)
<span class="co">## </span>
<span class="co">## =======================</span>
<span class="co">##              Model 1   </span>
<span class="co">## -----------------------</span>
<span class="co">## (Intercept)   44.81 ***</span>
<span class="co">##               (1.02)   </span>
<span class="co">## cseduc         1.23 ***</span>
<span class="co">##               (0.25)   </span>
<span class="co">## -----------------------</span>
<span class="co">## R^2            0.06    </span>
<span class="co">## Adj. R^2       0.06    </span>
<span class="co">## Num. obs.    356       </span>
<span class="co">## RMSE           6.70    </span>
<span class="co">## =======================</span>
<span class="co">## *** p &lt; 0.001, ** p &lt; 0.01, * p &lt; 0.05</span></code></pre>
<p>Podemos agregar nombre a las variables</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(texreg)
<span class="kw">screenreg</span>(modelo_<span class="dv">1</span>, 
          <span class="dt">custom.model.names =</span> <span class="st">&quot;Modelo 1&quot;</span>,  
          <span class="dt">custom.coef.names =</span> <span class="kw">c</span>(<span class="st">&quot;Constante&quot;</span>, <span class="st">&quot;Gasto en educacion&quot;</span>))
<span class="co">## </span>
<span class="co">## ==============================</span>
<span class="co">##                     Modelo 1  </span>
<span class="co">## ------------------------------</span>
<span class="co">## Constante            44.81 ***</span>
<span class="co">##                      (1.02)   </span>
<span class="co">## Gasto en educacion    1.23 ***</span>
<span class="co">##                      (0.25)   </span>
<span class="co">## ------------------------------</span>
<span class="co">## R^2                   0.06    </span>
<span class="co">## Adj. R^2              0.06    </span>
<span class="co">## Num. obs.           356       </span>
<span class="co">## RMSE                  6.70    </span>
<span class="co">## ==============================</span>
<span class="co">## *** p &lt; 0.001, ** p &lt; 0.01, * p &lt; 0.05</span></code></pre>
<p>Y podemos exportar la tabla en formato .doc para agregarla a nuestro trabajo. El archivo se guardará en nuestro directorio de trabajo</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">htmlreg</span>(<span class="kw">list</span>(modelo_<span class="dv">1</span>), <span class="dt">file =</span> <span class="st">&quot;modelo_1.doc&quot;</span>, 
    <span class="dt">custom.model.names =</span> <span class="st">&quot;Modelo 1&quot;</span>,  
    <span class="dt">custom.coef.names =</span> <span class="kw">c</span>(<span class="st">&quot;Constante&quot;</span>, <span class="st">&quot;Gasto en educacion&quot;</span>),
    <span class="dt">inline.css =</span> <span class="ot">FALSE</span>, <span class="dt">doctype =</span> <span class="ot">TRUE</span>, <span class="dt">html.tag =</span> <span class="ot">TRUE</span>, 
    <span class="dt">head.tag =</span> <span class="ot">TRUE</span>, <span class="dt">body.tag =</span> <span class="ot">TRUE</span>)
<span class="co">## The table was written to the file &#39;modelo_1.doc&#39;.</span></code></pre>
<p>Como se ve, resulta más cómodo ver los resultados con <code>texreg</code> que con <code>summary</code>. Allí se ve claramente que la variable <code>cseduc</code>, gasto en educación, tiene un efecto positivo, de magnitud 1.233, estadísticamente significativo. En concreto, cuando el gasto en educación como porcentaje del PIB aumenta en una unidad, la desigualdad aumenta en un 1,23%. Esto es así ya que nuestra variable dependiente está medida del 1 al 100 al igual que la independiente. El efecto del Gasto en Educación es significativo al 99.9% de confianza. Sabemos eso porque al lado del coeficiente aparecen tres estrellas, que refieren a un nivel de significancia de 0,01 %.</p>
<p>La significancia estadística es resultado de la prueba t. Esta nos indica la distancia estandarizada donde se encuentra el beta estimado en la distribución del estimador bajo la hipótesis nula de que <span class="math inline">\(\beta_1=0\)</span>. El estimador tiene una distribución t-Student con grados de libertad igual a <span class="math inline">\(n-k-1\)</span> donde <span class="math inline">\(k\)</span> es el número de variables independientes y se le suma 1 por la estimación de la constante <span class="math inline">\(\beta_0\)</span>. Una aproximación manual de la distancia del beta estimado en la distribución del estimador bajo la hipótesis nula <span class="math inline">\(\beta_1=0\)</span>, la obtenemos cuando dividimos la estimación por su error estándar:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="fl">1.233</span> <span class="op">/</span><span class="st"> </span><span class="fl">0.25</span>
<span class="co">## [1] 4.9</span></code></pre>
<p>Este valor es el mismo que arroja la tercera columna de la sección “Coefficients” del <code>summary</code> del modelo_1. El valor t se interpreta como la distancia de la estimación de <span class="math inline">\(\hat\beta_1\)</span> de la media de una distribución del estimador bajo <span class="math inline">\(H_0=\beta_1=0\)</span>. En este caso, el valor 1.233 está a 4.93 desvíos estándar de la distribución del estimador cuando H0 es verdadera (la media de la distribución es 0).
Como las distribuciones t colapsan sobre la normal a medida que aumentan los grados de libertad, y sabemos que aproximadamente hasta 2 desvíos estándar se encuentra el 95% de la probabilidad de una normal, entonces cuando el estadístico t supera el valor de 2 podemos saber que la probabilidad de observar nuestra estimación si H0 fuera cierta es menor a 0.05. Cuando esto sucede, rechazamos la hipótesis nula a un nivel de confianza del 95%.</p>
<p>En este caso, el <span class="math inline">\(\hat\beta_1\)</span> estimado está a más de 4.93 desvíos estándar de la media de la distribución bajo <span class="math inline">\(H_0=\beta_1=0\)</span> por lo que es muy poco probable haber observado un efecto de 1.23 si <span class="math inline">\(H_0\)</span> es verdadera. La probabilidad precisa puede observarse en la cuarta columna del <code>summary</code>del modelo, que puede solicitarse a R con el siguente comando.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">coef</span>(<span class="kw">summary</span>( modelo_<span class="dv">1</span>))[, <span class="st">&quot;Pr(&gt;|t|)&quot;</span>]
<span class="co">## (Intercept)      cseduc </span>
<span class="co">##    5.5e-145     1.3e-06</span></code></pre>
<p>La probabilidad de observar una estimación de 1.23 si H0 es verdadera es de 0,00000128. Por tanto, podemos rechazar H0 aún a un nivel de confianza de 99.9%.</p>
<p>#*****errores robustos</p>
</div>
<div id="representacion-grafica" class="section level3">
<h3><span class="header-section-number">6.3.2</span> Representación gráfica</h3>
<p>Como vimos anteriormente, una de las maneras más fáciles de mostrar la relación entre dos variables es a través de gráficos. El paquete <code>ggplot2</code>es una herramienta de suma utilidad para realizar diverso tipo de representaciones. En el primer código se grafican todas las observaciones en función de sus valores de variable independiente y dependiente.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span> (ggplot2)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">ggplot</span>(<span class="dt">data =</span> bienestar_la, <span class="co">#se especifica el origen de la base de datos</span>
       <span class="kw">aes</span>(<span class="dt">x =</span> cseduc, <span class="dt">y =</span> gini_slc))<span class="op">+</span><span class="st"> </span><span class="co">#se seleccionan las variables independiente y dependiente</span>
<span class="st">       </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="co">#se plotean los valores observados</span>
<span class="st">       </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="co"># se superpone la línea de regresión</span>
                   <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="co">#no se plotea el área de error al 95% de confianza</span>
                   <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>)<span class="op">+</span><span class="st"> </span><span class="co">#color de línea</span>
<span class="st">       </span><span class="kw">labs</span> (<span class="dt">x =</span> <span class="st">&quot;Gasto Educación&quot;) + # título del eje X</span>
<span class="st">       labs( y= &quot;</span>Desigualdad<span class="st">&quot;)  #título del eje Y</span>
<span class="st">## Warning: Removed 718 rows containing non-finite values (stat_smooth).</span>
<span class="st">## Warning: Removed 718 rows containing missing values (geom_point).</span>
<span class="st">       #+ labs ( title =&quot;&quot;) #título del gráfico</span></code></pre>
<div class="figure" style="text-align: center"><span id="fig:scatter2"></span>
<img src="lineal_files/figure-html/scatter2-1.png" alt="Relación lineal entre Gasto Educación y Desigualdad" width="80%" />
<p class="caption">
Figura 6.4: Relación lineal entre Gasto Educación y Desigualdad
</p>
</div>
<p>Usualmente es útil mostrar también una representación gráfica del error de la predicción de la recta. <code>ggplot2</code>nos permite editar un área sombreada donde podrían haber estado los valores predichos con un determinado nivel de significancia. Si bien el 95% de confianza es el valor que viene por defecto, también podemos editar este valor. El primer bloque muestra la línea de regresión y su error para un nivel de significancia estadística del 95%.</p>
<pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">ggplot</span>(<span class="dt">data =</span> bienestar_la, <span class="co">#se especifica el origen de la base de datos</span>
       <span class="kw">aes</span>(<span class="dt">x =</span> cseduc, <span class="dt">y =</span> gini_slc))<span class="op">+</span><span class="st"> </span>
<span class="st">       </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">       </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, 
                   <span class="dt">se =</span> T, <span class="co">#se agrega error de predicción</span>
                   <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>)<span class="op">+</span><span class="st"> </span>
<span class="st">       </span><span class="kw">labs</span> (<span class="dt">x =</span> <span class="st">&quot;Gasto Educación&quot;) +</span>
<span class="st">       labs( y= &quot;</span>Desigualdad<span class="st">&quot;) +</span>
<span class="st">       labs ( title =&quot;</span>Relación lineal entre Gasto Educación y Desigualdad<span class="st">&quot;) </span>
<span class="st">## Warning: Removed 718 rows containing non-finite values (stat_smooth).</span>
<span class="st">## Warning: Removed 718 rows containing missing values (geom_point).</span></code></pre>
<div class="figure" style="text-align: center"><span id="fig:scatter3"></span>
<img src="lineal_files/figure-html/scatter3-1.png" alt="En esta figura adicionamos un intérvalo de confianza de 95%" width="80%" />
<p class="caption">
Figura 6.5: En esta figura adicionamos un intérvalo de confianza de 95%
</p>
</div>
</div>
</div>
<div id="modelo-multivariado-regresion-multiple" class="section level2">
<h2><span class="header-section-number">6.4</span> Modelo multivariado: regresión múltiple</h2>
<p>Si bien suele interesar el efecto de una variable independiente sobre una dependiente, lo más común es estimar modelos en los que la <span class="math inline">\(Y\)</span> es resultado tanto de una variable independiente de interés como de un conjunto de variables de control. Formalmente,</p>
<p><span class="math display">\[Y= \beta_0+\beta_1x_{1}+\beta_1x_{2}+...+\beta_jx_{j}+u\]</span></p>
<p>A diferencia de la regresión simple, ahora la variable aleatoria <span class="math inline">\(Y\)</span> es una función de diversas variables más un término de error <span class="math inline">\(u\)</span>. Al igual que la regresión simple, la esperanza del error condicional en los valores de las <span class="math inline">\(x_j\)</span> debe ser igual a cero. Formalmente, <span class="math inline">\(E(u|x_1, x_2, ..., x_j)=0\)</span>.
Para estimar insesgadamente un modelo lineal múltiple no sólo se necesita el supuesto de media condicional cero, pero se presentarán todos los supuestos en una sección posterior.</p>
<p>Por el momento estimaremos un modelo poblacional en que la desigualdad social (<code>gini_slc</code>) es una función lineal del gasto en educación como porcentaje del PIB (<code>cseduc</code>), de la inversión extranjera directa (<code>fdiingdp</code>), del gasto en salud como porcentaje del PIB (<code>cshlth</code>), del gasto en Seguridad Social como porcentaje del PIB (<code>csssw</code>), de la población joven (<code>pop014wdi</code>), del dualismo estructural de la economía (<code>s_dualism</code>), de la división étnica (<code>ethnicdicot</code>), del PIB per cápita real (<code>rgdpch</code>), del tipo de régimen (<code>demrss</code>), del balance entre los poderes del Estado (<code>legbal</code>) y del autoritarismo (<code>repressauthor</code>).</p>
<p>Como se ve, se han incluido una multiplicidad de variables que se piensa que predicen la desigualdad (Huber et al, 2006). El análisis de regresión múltiple nos permitirá estimar hasta qué punto nuestro modelo es correcto. En primer término se debe correr la estimación de MCO. La función <code>lm</code>también estima modelos múltiples y la única diferencia es que deben sumarse las variables independientes. Antes de estimar el modelo, filtraremos la base de datos, eliminando todos los casos con valores perdidos (NAs) en nuestras variables de control. Hay mejores formas de lidiar con los valores perdidos, para esto puedes revisar el Capítulo <a href="casos.html#casos">11</a> sobre imputación de valores perdidos. Aquí, por practicidad, simplemente nos quedaremos con aquellos casos (país/año) que están completos para las variables de nuestro modelo:</p>
<pre class="sourceCode r"><code class="sourceCode r">bienestar_la_sinna&lt;-<span class="st"> </span>bienestar_la <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">drop_na</span>(gini_slc, cseduc , fdiingdp , cshlth , csssw , pop014wdi, s_dualism , ethnicdicot , rgdpch ,  demrss, legbal ,  repressauthor)</code></pre>
<p>Ahora si estamos en condiciones de estimar el modelo 2:</p>
<pre class="sourceCode r"><code class="sourceCode r">modelo_<span class="dv">2</span>&lt;-<span class="st"> </span><span class="kw">lm</span>(gini_slc<span class="op">~</span><span class="st"> </span><span class="dv">1</span><span class="op">+</span><span class="st"> </span>cseduc <span class="op">+</span><span class="st"> </span>fdiingdp <span class="op">+</span><span class="st"> </span>cshlth <span class="op">+</span><span class="st"> </span>csssw <span class="op">+</span><span class="st"> </span>pop014wdi<span class="op">+</span><span class="st"> </span>s_dualism <span class="op">+</span><span class="st"> </span>ethnicdicot <span class="op">+</span><span class="st"> </span>rgdpch <span class="op">+</span><span class="st">  </span><span class="kw">as.factor</span>(demrss) <span class="op">+</span><span class="st"> </span>legbal <span class="op">+</span><span class="st">  </span>repressauthor,<span class="dt">data =</span> bienestar_la_sinna )</code></pre>
<p>Recordemos que el 1 no es necesario, puedes probar rodando el modelo sin el, pero lo colocamos para recordarte que estamos también estimando el intercepto.
Hemos indicado que la variable <code>demres</code> es categórica mediante <code>as.factor</code>. De esta manera, cada categoría de régimen se mide mediante un coeficiente ´dummy´.</p>
<p>Al igual que el modelo simple, podemos visualizar e imprimir los resultados de la estimación con <code>summary</code>o <code>screenreg</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">screenreg</span>(modelo_<span class="dv">2</span>)
<span class="co">## </span>
<span class="co">## ==============================</span>
<span class="co">##                     Model 1   </span>
<span class="co">## ------------------------------</span>
<span class="co">## (Intercept)          85.94 ***</span>
<span class="co">##                      (8.73)   </span>
<span class="co">## cseduc                1.59 ***</span>
<span class="co">##                      (0.45)   </span>
<span class="co">## fdiingdp              0.24    </span>
<span class="co">##                      (0.18)   </span>
<span class="co">## cshlth               -0.83 ** </span>
<span class="co">##                      (0.26)   </span>
<span class="co">## csssw                -0.83 ***</span>
<span class="co">##                      (0.20)   </span>
<span class="co">## pop014wdi            -0.93 ***</span>
<span class="co">##                      (0.17)   </span>
<span class="co">## s_dualism            -0.17 ***</span>
<span class="co">##                      (0.03)   </span>
<span class="co">## ethnicdicot           3.68 ***</span>
<span class="co">##                      (1.04)   </span>
<span class="co">## rgdpch               -0.00 ** </span>
<span class="co">##                      (0.00)   </span>
<span class="co">## as.factor(demrss)2   -2.29    </span>
<span class="co">##                      (4.75)   </span>
<span class="co">## as.factor(demrss)3   -2.90    </span>
<span class="co">##                      (4.70)   </span>
<span class="co">## as.factor(demrss)4   -5.14    </span>
<span class="co">##                      (4.62)   </span>
<span class="co">## legbal              -10.40 ***</span>
<span class="co">##                      (2.22)   </span>
<span class="co">## ------------------------------</span>
<span class="co">## R^2                   0.59    </span>
<span class="co">## Adj. R^2              0.56    </span>
<span class="co">## Num. obs.           167       </span>
<span class="co">## RMSE                  4.52    </span>
<span class="co">## ==============================</span>
<span class="co">## *** p &lt; 0.001, ** p &lt; 0.01, * p &lt; 0.05</span></code></pre>
<p>Estas funciones también nos permiten comparar dos o más modelos. Al momento de presentar una investigación suele ser recomendable mostrar cómo cambian (o no) los resultados ante distintas especificaciones. Primeo guardamos los modelos en una lista. Al comando de <code>screenreg</code> le agregremos los nombres de las variables como ya hemos visto. En el caso que se trabaja aquí la comparación de modelos es</p>
<pre class="sourceCode r"><code class="sourceCode r">modelos&lt;-<span class="kw">list</span>(modelo_<span class="dv">1</span>, modelo_<span class="dv">2</span>)

<span class="kw">screenreg</span>(modelos,
          <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;Modelo 1&quot;</span>, <span class="st">&quot;Modelo 2&quot;</span>),  
           <span class="dt">custom.coef.names =</span> <span class="kw">c</span>(<span class="st">&quot;Constante&quot;</span>, <span class="st">&quot;Gasto en educacion&quot;</span>, <span class="st">&quot;IED&quot;</span>, <span class="st">&quot;Gasto en salud&quot;</span>, <span class="st">&quot;Gasto en seg. social&quot;</span>, <span class="st">&quot;Población jóven&quot;, &quot;</span>Dualismo de economía<span class="st">&quot;, &quot;</span>División étnica<span class="st">&quot;, &quot;</span>PBI pc<span class="st">&quot;, &quot;</span>Reg. democrático<span class="st">&quot;, &quot;</span>Reg. mixto<span class="st">&quot;, &quot;</span>Reg. autoritario<span class="st">&quot;, &quot;</span>Balance entre poderes<span class="st">&quot;))</span>
<span class="st">## </span>
<span class="st">## =============================================</span>
<span class="st">##                        Modelo 1    Modelo 2  </span>
<span class="st">## ---------------------------------------------</span>
<span class="st">## Constante               44.81 ***   85.94 ***</span>
<span class="st">##                         (1.02)      (8.73)   </span>
<span class="st">## Gasto en educacion       1.23 ***    1.59 ***</span>
<span class="st">##                         (0.25)      (0.45)   </span>
<span class="st">## IED                                  0.24    </span>
<span class="st">##                                     (0.18)   </span>
<span class="st">## Gasto en salud                      -0.83 ** </span>
<span class="st">##                                     (0.26)   </span>
<span class="st">## Gasto en seg. social                -0.83 ***</span>
<span class="st">##                                     (0.20)   </span>
<span class="st">## Población jóven                     -0.93 ***</span>
<span class="st">##                                     (0.17)   </span>
<span class="st">## Dualismo de economía                -0.17 ***</span>
<span class="st">##                                     (0.03)   </span>
<span class="st">## División étnica                      3.68 ***</span>
<span class="st">##                                     (1.04)   </span>
<span class="st">## PBI pc                              -0.00 ** </span>
<span class="st">##                                     (0.00)   </span>
<span class="st">## Reg. democrático                    -2.29    </span>
<span class="st">##                                     (4.75)   </span>
<span class="st">## Reg. mixto                          -2.90    </span>
<span class="st">##                                     (4.70)   </span>
<span class="st">## Reg. autoritario                    -5.14    </span>
<span class="st">##                                     (4.62)   </span>
<span class="st">## Balance entre poderes              -10.40 ***</span>
<span class="st">##                                     (2.22)   </span>
<span class="st">## ---------------------------------------------</span>
<span class="st">## R^2                      0.06        0.59    </span>
<span class="st">## Adj. R^2                 0.06        0.56    </span>
<span class="st">## Num. obs.              356         167       </span>
<span class="st">## RMSE                     6.70        4.52    </span>
<span class="st">## =============================================</span>
<span class="st">## *** p &lt; 0.001, ** p &lt; 0.01, * p &lt; 0.05</span></code></pre>
<p>Como se observa, la estimación puntual del efecto del gasto en Educación cambió ligeramente. Mientras en el modelo simple el efecto es de 1,23 en el modelo múltiple este efecto pasa a 1,59. En este caso, la interpretación es que cuando el gasto en educación aumenta en una unidad, la desigualdad aumenta en promedio 1,59 puntos porcentuales <em>manteniendo todos los demás factores constantes</em>. Esto es, una vez que se descuenta el efecto de las variables de control. Al igual que en el modelo 1, la variable sigue siendo significativa al 99,9% de confianza por lo que decimos que el efecto del Gasto en Educación es <em>robusto</em> a diferentes especificaciones. Cuando los investigadores incluyen nuevos controles al modelo y la principal variable de interés se mantiene significativa y con magnitudes relativamente estables se gana evidencia a favor del efecto de la misma. En otras palabras, cada vez es menos probable que el efecto observado en primera instancia fuese espurio.</p>
<p>Otra de las contribuciones del modelo 2 es la incorporación de variables nominales. Las variables dicotómicas y las categóricas plantean un ligero desafío de interpretación. Obsérvese la variable Diversidad Étnica que es dicotómica donde el valor 1 implica que más del 20% de la población pertenece a una minoría étnica y 0 si no hay una minoría tan relevante. El coeficiente de “ethicdicot” es 3,7 significativo al 99,9%. ¿Cómo interpretarlo? Sencillamente, el valor predicho de la desigualdad es 3.7 puntos mayor cuando existe una minoría étnica, a cualquier valor de las otras <span class="math inline">\(x&#39;s\)</span>. Para interpretar estos coeficientes siempre debe conocerse la categoría base. Como ethicdicot es igual a 0 cuando no hay minorías étnicas, el coeficiente se interpreta como el pasaje hacia tener minoría étnica.</p>
<p>En el caso de la variable <code>s_dualism</code>, dado que la categoría base es 0 para “sin dualismo”, el coeficiente se interpreta tal que tener una economía dual <em>disminuye</em> (coeficiente negativo) la desigualdad en aproximadamente 0.17 puntos.</p>
<div class="books">
<p>
Como práctica exporta la tabla con los dos modelos a un archivo de Word, te esperamos.
</p>
</div>
<p>Se puede observar gráficamente la incidencia de las variables dicotómicas utilizando <code>plot_model</code> del paquete <code>sjPlot</code></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(sjPlot)</code></pre>
<p>En la gráfica que sigue se muestra el efecto del gasto en educación sobre la desigualdad para las distintas categorías de diversidad étnica, manteniendo todas las demás variables constantes. Se aprecia claramente que lo único que cambia entre las categorías es el intercepto. Los países que tienen una minoría étnica importante tienen aproximadamente 3,7 puntos más de desigualdad que los que no tienen minorías étnicas, a cualquier valor de gasto en educación, manteniendo todas las demás variables constantes.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot_model(model = modelo_2, </span>
<span class="co">#         type = &quot;pred&quot;,</span>
<span class="co">#         terms =   c(&quot;cseduc&quot;,  &quot;ethnicdicot&quot;), </span>
<span class="co">#         facet.grid = F,</span>
<span class="co">#             show.ci = T, </span>
<span class="co">#         title = &quot;Valores predichos de desigualdad según gasto en educación y etnicidad&quot;)</span></code></pre>
<div id="ajuste-del-modelo" class="section level3">
<h3><span class="header-section-number">6.4.1</span> Ajuste del modelo</h3>
<p>La bondad de ajuste se define como la capacidad explicativa del modelo. Intuitivamente refiere a qué porción de la variación de la variable dependiente <span class="math inline">\(y\)</span> es explicada por el modelo especificado. La medida de la bondad de ajuste es el <span class="math inline">\(R^2\)</span> y se define como 1- SRC/STC, donde SRC es la Suma de los Residuos al Cuadrado y STC la Suma de los Totales Cuadrados. De manera simple SRC es una medida de todo lo que el modelo <em>no</em> explica, mientras que STC es la variabilidad de la <span class="math inline">\(y\)</span>.
Un modelo que explique <em>toda</em> la variación de <span class="math inline">\(y\)</span> tendrá un <span class="math inline">\(R^2\)</span> de 1. Un modelo que no explique nada de la variabilidad de la variable dependiente tendrá un valor de 0.</p>
<p>Por regla general, a medida que se aumenta el número de variables independientes el <span class="math inline">\(R^2\)</span> nunca disminuye por lo que se suele utilizar el <span class="math inline">\(R^2\)</span> ajustado como una medida que penaliza la inclusión de variables sin fundamento. Como se puede observar en la comparación de los modelos estimados previamente, el modelo lineal simple tiene un <span class="math inline">\(R^2\)</span> de 0.06. Eso puede leerse como que el modelo 1 explica el 6% de la variabilidad de la desigualdad. El modelo múltiple 2 aumenta su capacidad explicativa al 59%.</p>
<p>Algunos investigadores buscan aumentar la bondad de ajuste del modelo. Sin embargo, estimar el efecto de una variable en concreto no requiere aumentar la bondad de ajuste sino simplemente que se cumplan los supuestos del Modelo Lineal Clásico como la media condicional 0, la linealidad de los parámentros y demás supuestos que se describen en la sección correspondiente.</p>
</div>
<div id="inferencia-en-modelos-lineales-multiples" class="section level3">
<h3><span class="header-section-number">6.4.2</span> Inferencia en modelos lineales múltiples</h3>
<p>Al igual que en la regresión lineal simple, los estimadores de cada uno de los parámentros <span class="math inline">\(\beta_j\)</span> tienen una distribución t-Student por lo que puede realizarse inferencia acerca de las estimaciones puntuales de cada <span class="math inline">\(\hat{\beta_j}\)</span> a través de una prueba t. Sin embargo, a veces se desea imponer restricciones lineales múltiples al modelo del tipo <span class="math inline">\(H_0= \beta_1= \beta_2 = 0\)</span>. Aquí se está sosteniendo que el efecto de dos variables <span class="math inline">\(x_1\)</span> y <span class="math inline">\(x_2\)</span> es igual a cero. Un caso típico que requiere este tipo de hipótesis nula refiere a las variables categóricas que ingresan al modelo como variables dicotómicas ficticias. La variable dicotómica “educación media” y la dicotómica “educación superior” son en realidad categorías de una única variable nominal “nivel educativo” que sólo puede entrar en un análisis de regresión en la forma de <em>dummies</em> ficticias.</p>
<p>La prueba que permite hacer inferencia para restricción lineal múltiple es la prueba F. Esto implica que la <span class="math inline">\(H_0\)</span> de una restricción múltiple distribuye F de Fisher. Aquí se muestran dos maneras de testear una restricción lineal múltiple. La primera muestra cada uno de los pasos del test mientras que la segunda es más breve. Supongamos que se quiere testear la hipótesis nula que $H_0= _1= _2 = _3 =0 $. Según esta hipótesis las variables <span class="math inline">\(x_1\)</span>, <span class="math inline">\(x_2\)</span> y <span class="math inline">\(x_3\)</span> no afectan a <span class="math inline">\(Y\)</span> cuando se las considera en conjunto. La hipótesis alternativa es que al menos uno de los betas es distinto de 0. Si <span class="math inline">\(H_0\)</span> es verdadera entonces un modelo que excluya estas variables debería explicar lo mismo que un modelo que las incluya, o sea, estas variables son redundantes.</p>
<p>La manera de testear esta hipótesis es a través de un test F en el que se compara la suma de los residuos cuadrados del modelo completo y el modelo restringido. En términos simples, si las variables deben ser excluidas porque no explican la variabilidad de <span class="math inline">\(y\)</span> la Suma de los Residuos Cuadrados de ambos modelos (otra manera es ver el <span class="math inline">\(R^2\)</span>) no debe cambiar significativamente.</p>
<p>Se utiliza el hecho que la comparación de los residuos cuadrados distribuye F</p>
<p><span class="math display">\[F= \frac{(SRC_r-SRC_c)/q}{SRC_c/(n-k-1)}\]</span></p>
<p>Donde <span class="math inline">\(SRC_r\)</span> es la Suma de los Residuos Cuadrados del modelo restringido, <span class="math inline">\(SRC_c\)</span> es la Suma de los Residuos Cuadrados del modelo completo, <span class="math inline">\(q\)</span> es la cantidad de variables excluidas y <span class="math inline">\(n-k-1\)</span> son los grados de libertad del modelo completo. En R se puede utilizar la función <code>anova</code> para comparar los modelos.
Por ejemplo, supongamos que un colega asegura que el balance del legislativo (<code>legbal</code>), el tipo de régimen (<code>demrss</code>) y la diversidad étnica (<code>ethnicdicot</code>) deben excluirse del modelo. Entonces debemos estimar un modelo restringido tal que</p>
<pre class="sourceCode r"><code class="sourceCode r">modelo_<span class="dv">2</span>_restringido &lt;-<span class="st"> </span><span class="kw">lm</span>(gini_slc <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>cseduc <span class="op">+</span><span class="st"> </span>fdiingdp <span class="op">+</span><span class="st"> </span>cshlth <span class="op">+</span><span class="st"> </span>csssw <span class="op">+</span><span class="st"> </span>pop014wdi<span class="op">+</span><span class="st"> </span>s_dualism  <span class="op">+</span><span class="st"> </span>rgdpch <span class="op">+</span><span class="st"> </span>repressauthor,<span class="dt">data =</span> bienestar_la_sinna)</code></pre>
<p>Como se ve, las variables mencionadas fueron excluidas de la sintaxis. Ahora se debe comparar el poder explicativo de cada modelo</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anova</span>( modelo_<span class="dv">2</span>, modelo_<span class="dv">2</span>_restringido)
<span class="co">## Analysis of Variance Table</span>
<span class="co">## </span>
<span class="co">## Model 1: gini_slc ~ 1 + cseduc + fdiingdp + cshlth + csssw + pop014wdi + </span>
<span class="co">##     s_dualism + ethnicdicot + rgdpch + as.factor(demrss) + legbal + </span>
<span class="co">##     repressauthor</span>
<span class="co">## Model 2: gini_slc ~ 1 + cseduc + fdiingdp + cshlth + csssw + pop014wdi + </span>
<span class="co">##     s_dualism + rgdpch + repressauthor</span>
<span class="co">##   Res.Df  RSS Df Sum of Sq    F  Pr(&gt;F)    </span>
<span class="co">## 1    154 3148                              </span>
<span class="co">##  [ reached getOption(&quot;max.print&quot;) -- omitted 1 row ]</span>
<span class="co">## ---</span>
<span class="co">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></code></pre>
<p>La significancia de la última columna del test muestra con claridad que se rechaza la hipótesis nula por lo que esas variables <em>no</em> deben excluirse del modelo.</p>
</div>
<div id="supuestos-de-ols" class="section level3">
<h3><span class="header-section-number">6.4.3</span> Supuestos de OLS</h3>
<p>El estimador de Mínimos Cuadrados Ordinarios será de utilidad (estimará insesgadamente el parámetro poblacional) si es que se cumplen los supuestos de Gauss-Markov que permiten que sea el Mejor Estimador Lineal Insesgado (MELI, o BLUE por sus siglas en inglés). Para profundizar sobre los supuestos es recomendable consultar Wooldrige (2006) y Stock y Watson (2012). Es importante evaluar que en nuestra estimación se estén cumpliendo estos supuestos. Como veremos a continuación, esta evaluación es teórica y, en algunos casos, se podrá aproximar empíricamente. Todos estos diagnósticos suelen ir incorporados a los artículos como anexos o en los archivos de replicación de datos, y no necesariamente en el cuerpo del texto.</p>
<div id="media-condicional-cero" class="section level4">
<h4><span class="header-section-number">6.4.3.1</span> 1. Media condicional cero</h4>
<p>El supuesto central para utilizar el estimador de MCO. El postulado crucial de este supuesto es la independencia entre las variables indpendientes y el término de error, esto nos permite aislar de los factores no observables (contenidos en el término de error <span class="math inline">\(u\)</span>) el efecto de las <span class="math inline">\(x\)</span>.
Este supuesto no puede ser evaluado empíricamente porque, por definición, no conocemos los factores contenidos en el término de error. Por lo tanto, la defensa de este supuesto siempre será <em>teórica</em>.</p>
</div>
<div id="muestreo-aleatorio" class="section level4">
<h4><span class="header-section-number">6.4.3.2</span> 2. Muestreo aleatorio</h4>
<p>Este es un supuesto sobre la generación de los datos. Se asume un muestreo aleatorio de tamaño <span class="math inline">\(n\)</span> que implica que la muestra fue tomada de forma tal que todas las unidades poblacionales tuvieron la misma probabilidad de ser seleccionadas. Es decir, no hay un sesgo de selección muestral.</p>
</div>
<div id="linealidad-en-los-parametros" class="section level4">
<h4><span class="header-section-number">6.4.3.3</span> 3. Linealidad en los Parámetros</h4>
<p>MCO asume que la variable dependiente (<span class="math inline">\(y\)</span>) esta relacionada linealmente con la variable(s) independiente(s) y el término de error (<span class="math inline">\(u\)</span>). Es decir, el aumento en una unidad de <span class="math inline">\(x\)</span> implica un efecto constante en la variable dependiente <span class="math inline">\(y\)</span>. De aquí la forma funcional de la ecuación de regresión:</p>
<p><span class="math display">\[Y = \beta_0 + \beta_1x + u\]</span></p>
<p>Si la relación en realidad no es lineal, entonces estaremos ante un problema de especificación del modelo. Es decir, los valores predichos por nuestro modelo no se ajustarán a la realidad de nuestros datos y, en consecuencia, las estimaciones serán sesgadas. Por tanto, es clave evaluar si la relación que queremos estimar es lineal o si la forma funcional que caracteriza dicha relación es otra (por ejemplo, podría ser cuadrática, cúbica, logarítmica, etc).</p>
<p>La buena noticia es que si tenemos motivos teóricos y empíricos para creer que la relación no es lineal, es posible realizar transformaciones a nuestras variables para lograr una mejor especificación del modelo. Un clásico ejemplo refiere a la relación parabólica entre la edad y el salario: a medida que aumenta la edad aumenta el salario hasta que llega un punto de inflexión donde el aumento de la edad se relaciona con menores niveles de ingreso, como una U invertida. En este caso lo recomnedable es realizar una transformación cuadrática a la variable edad para lograr una mejor especificación del modelo.</p>
<p>Para evaluar la linealidad realizamos un gráfico de dispersión de los valores predichos contra los residuos <span class="math inline">\(u\)</span>. Lo que se intenta es evaluar si el promedio de los residuos tiende a ubicarse de manera aleatoria por encima y debajo del cero. Si los residuos muestran un patrón creciente o decreciente - o de cualquier otro tipo - entonces la forma funcional de alguna de las variables en cuestión no es lineal.
Para esto utilizamos el comando <code>plot</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r"> <span class="kw">plot</span>(<span class="dt">y=</span>modelo_<span class="dv">1</span><span class="op">$</span>residuals,<span class="dt">x=</span>modelo_<span class="dv">1</span><span class="op">$</span>fitted.values,
      <span class="dt">xlab=</span><span class="st">&quot;Valores Predichos&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Residuos&quot;</span>)
<span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:abline"></span>
<img src="lineal_files/figure-html/abline-1.png" alt="Test de linealidad en valores predichos" width="480" />
<p class="caption">
Figura 6.6: Test de linealidad en valores predichos
</p>
</div>
<p>Además, podemos hacer un gráfico de residuos parciales (o de componentes), donde se grafican cada una de las variables independientes del modelo contra los residuos. El objetivo es obtener un gráfico “parcial” para observar la relación entre la(s) variable(s) independiente(s) y la variable dependiente dando cuenta (controlando) de las demás variables del modelo. Una línea punteada nos muestra la predicción de OLS, y otra línea (rosada) nos muestra la relación “real”. Si observamos que alguna de nuestras variables <strong>no tiene una relación lineal</strong> podemos realizar transformaciones (a las variables!) para que la forma funcional se acerque a la empiria. Cabe destacar que, además de la justificación empírica, esta transformación lineal <strong>siempre</strong> debe ir acompañada de un argumento teórico de por qué la relación entre las dos variables toma esa forma.</p>
<p>Una transformación que verás con regularidad en papers es la de transformaciones logaritmicas de variables. Estas se presentan tanto en la variable dependiente como en la independiente. Para ello te ofrecemos una tabla que te será de gran utilidad. Te permite saber como cambia la interpretación de los resultados cuando una de las variables (o ambas) es transformada.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-30"></span>
<img src="00-images/tabla_cap_ols.PNG" alt="La tabla resume la interpretación de los coeficientes ante transformaciones logaritmicas" width="576" />
<p class="caption">
Figura 6.7: La tabla resume la interpretación de los coeficientes ante transformaciones logaritmicas
</p>
</div>
<p>Por ejemplo, si decidimos transformar nuestra variable dependiente de tal forma que</p>
<pre class="sourceCode r"><code class="sourceCode r">modelo_<span class="dv">1</span>_log &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(gini_slc)<span class="op">~</span><span class="st"> </span><span class="dv">1</span><span class="op">+</span><span class="st"> </span>cseduc,<span class="dt">data =</span> bienestar_la)
<span class="kw">screenreg</span>(modelo_<span class="dv">1</span>_log)
<span class="co">## </span>
<span class="co">## =======================</span>
<span class="co">##              Model 1   </span>
<span class="co">## -----------------------</span>
<span class="co">## (Intercept)    3.78 ***</span>
<span class="co">##               (0.02)   </span>
<span class="co">## cseduc         0.03 ***</span>
<span class="co">##               (0.01)   </span>
<span class="co">## -----------------------</span>
<span class="co">## R^2            0.07    </span>
<span class="co">## Adj. R^2       0.07    </span>
<span class="co">## Num. obs.    356       </span>
<span class="co">## RMSE           0.14    </span>
<span class="co">## =======================</span>
<span class="co">## *** p &lt; 0.001, ** p &lt; 0.01, * p &lt; 0.05</span></code></pre>
<p>La interpretación sería: si aumentamos el gasto en salud en una unidad, esperaríamos que el Gini aumente un 3%, <em>ceteris paribus</em>. Para poder saber cuando transformar nuestras variables, veremos con un ejemplo como podemos diagnosticar un problema en la forma en que nuestras variables son medidas.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(car)
<span class="co">## Loading required package: carData</span>
<span class="co">## </span>
<span class="co">## Attaching package: &#39;car&#39;</span>
<span class="co">## The following object is masked from &#39;package:dplyr&#39;:</span>
<span class="co">## </span>
<span class="co">##     recode</span>
<span class="co">## The following object is masked from &#39;package:purrr&#39;:</span>
<span class="co">## </span>
<span class="co">##     some</span>
<span class="kw">crPlots</span>(modelo_<span class="dv">1</span>)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-32"></span>
<img src="lineal_files/figure-html/unnamed-chunk-32-1.png" alt="Test de linealidad" width="480" />
<p class="caption">
Figura 6.8: Test de linealidad
</p>
</div>
<p>La relación de nuestra variable de interés con la variable dependiente parece ser cuadrática creciente. Por tanto, podría ser razonable realizar una transformación cuadrática a la variable. Evaluemos esto gráficamente:</p>
<pre class="sourceCode r"><code class="sourceCode r">bienestar_la_sinna &lt;-<span class="st"> </span>bienestar_la_sinna <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">cseduc2 =</span> cseduc<span class="op">*</span>cseduc)

modelo_<span class="dv">1</span>_cuadratico&lt;-<span class="st"> </span><span class="kw">lm</span>(gini_slc <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>cseduc2 <span class="op">+</span><span class="st"> </span>cseduc, <span class="dt">data=</span>bienestar_la_sinna)

<span class="kw">crPlots</span>(modelo_<span class="dv">1</span>_cuadratico)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-33"></span>
<img src="lineal_files/figure-html/unnamed-chunk-33-1.png" alt="Test de linealidad alternativo" width="480" />
<p class="caption">
Figura 6.9: Test de linealidad alternativo
</p>
</div>
<p>A partir de un diagnostico visual, se observa una tendencia creciente en los residuos a medida que se avanza en los valores predichos. Además, se detectó una relación no lineal entre el gasto en educación y los niveles de desigualdad. La sospecha es que esta relación pueda ser cuadrática (parábola cuadrática creciente) y, de acuerdo al gráfico de residuales parciales parece ser que la variable transformada se acerca bastante más a la relación lineal que estima MCO (marcada por la línea punteada). Ayuda notar que la escala en la figura de la izquierda es de 0 a 15, mientras que la de la derecha es de 0 a 20, denotando una pendiente más pronunciada.</p>
<p>Para confirmar las observaciones visuales, se suele utilizar un test estadístico para diagnosticar una mala especificación funcional del modelo: RESET Test de Ramsey. La idea es justamente evaluar si es que existe un error de especificación de la ecuación de regresión. Este test lo que hace es volver a estimar el modelo pero incorporando los valores predichos del modelo original con alguna transformación no lineal de las variables. Luego, a partir de un Test-F se evalúa si el modelo con la especificación no lineal tiene un mejor ajuste que el modelo original sin la transformación no lineal. La hipótesis nula postula que las nuevas variables (en este caso <code>cseduc^2</code>) no aportan significativamente para explicar la variación de la variable dependiente; es decir, que su coeficiente es igual a cero (<span class="math inline">\(\beta=0\)</span>).</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(lmtest)
<span class="co">## Loading required package: zoo</span>
<span class="co">## </span>
<span class="co">## Attaching package: &#39;zoo&#39;</span>
<span class="co">## The following objects are masked from &#39;package:base&#39;:</span>
<span class="co">## </span>
<span class="co">##     as.Date, as.Date.numeric</span>
<span class="kw">resettest</span>(modelo_<span class="dv">1</span>, <span class="dt">power=</span><span class="dv">2</span>, <span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;fitted&quot;</span>), <span class="dt">data=</span>bienestar_la_sinna)
<span class="co">## </span>
<span class="co">##  RESET test</span>
<span class="co">## </span>
<span class="co">## data:  modelo_1</span>
<span class="co">## RESET = 9, df1 = 1, df2 = 400, p-value = 0.004</span></code></pre>
<p>De acuerdo al resultado del Test F, confirmamos lo observado gráficamente: el incorporar un término cuadrático del gasto en educación mejora el ajuste de nuestra estimación. A esta conclusión llegamos observando el <em>valor-p</em> del test RESET de Ramsey: a un nivel de significancia estadística del 5%, se rechaza la hipótesis nula de que la incorporación del término cuadrático no mejora el ajuste del modelo.</p>
<ul>
<li><em>Nota</em>: Esta evaluación se realizó para un modelo de regresión simple (bivariado). Pero bien puede realizarse exactamente lo mismo para modelos multivariados.</li>
</ul>
</div>
<div id="variacion-en-las-variables-independientes-y-no-colinealidad-perfecta" class="section level4">
<h4><span class="header-section-number">6.4.3.4</span> Variación en las variables independientes y no colinealidad perfecta</h4>
<p>En primer lugar, es necesario que exista variación en la(s) variable(s) independiente(s). Una variable que no varía, ¡no es variable! Si no tengo variación, la estimación de los coeficientes será indeterminada. Además, mayor variación en las variables independientes me permitirá realizar estimaciones más precisas.</p>
<p>Por otra parte, la no-colinealidad perfecta implica que las variables independientes no estén perfectamente correlacionadas <em>linealmente</em>. Es decir, si bien las variables independientes por lo general suelen tener alguna relación entre ellas, ¡no queremos que midan prácticamente lo mismo! Eso lo evaluaremos con tests de multicolinealidad.</p>
<p><strong>Problemas de la multicolinealidad:</strong></p>
<p>A. <em>Pérdida de eficiencia</em>, pues sus errores estándar serán infinitos. Aún si la multicolinealidad es menos que perfecta los coeficientes de regresión poseen grandes errores estándar, lo que hace que no puedan ser estimados con gran precisión.</p>
<p>Repasemos la fórmula del error estándar de los coeficientes:</p>
<p><span class="math display">\[\hat{\sigma}{_\hat{\beta}{_1}} = \frac{\hat{\sigma}} {\sqrt{\sum(X_j – \bar{X})^2(1 - R^2_j)}}\]</span></p>
<ul>
<li><p><span class="math inline">\(\hat{\sigma}\)</span> Es la varianza del término de error: <span class="math inline">\(\frac{\sum\hat{u}}{n-k-1}\)</span></p></li>
<li><p><span class="math inline">\(\sum(X_j – \bar{X})^2\)</span> Es la variabilidad de <span class="math inline">\(x_j\)</span> (<span class="math inline">\(STCx_j\)</span>)</p></li>
<li><p><span class="math inline">\(1 - R^2_j\)</span> Es la porción de <span class="math inline">\(x_j\)</span> que no es explicada por el resto de las <em>x</em> en el modelo (<span class="math inline">\(R^2_j\)</span> indica la varianza de <span class="math inline">\(x_j\)</span> que es explicada por el resto de las equis del modelo). Es por este término que la no colinealidad perfecta es tan importante!</p></li>
</ul>
<p>B. Las <em>estimaciones de los coeficientes pueden oscilar demasiado</em> en función de qué otras variables independientes están en el modelo. En una estimación OLS la idea es que puedes cambiar el valor de una variable independiente y no de las otras (de esto se trata <em>ceteris paribus</em>, es decir, manteniendo las otras covariables constantes). Sin embargo, cuando las variables independientes están correlacionadas, los cambios en una variable están asociados con los cambios en otra variable. Cuanto más fuerte es la correlación, más difícil es cambiar una variable sin cambiar otra. Se vuelve difícil para el modelo estimar la relación entre cada variable independiente y la variable dependiente manteniendo el resto constante porque las variables independientes tienden a cambiar simultáneamente. Repasemos la fórmula del estimación del coeficiente en una regresión múltiple:</p>
<p><span class="math display">\[\hat{\beta_1} = \frac{\sum(\hat{r_{i1}}\hat{y_i})}{\sum(\hat{r^2_{i1}})}\]</span></p>
<p>Donde:</p>
<ul>
<li><span class="math inline">\(\hat{r_{i1}}\)</span> son los residuales de una regresión de <span class="math inline">\(x_1\)</span> sobre el resto de las <span class="math inline">\(x\)</span> en el modelo (osea la parte de <span class="math inline">\(x_1\)</span> que no puede ser explicada - o que no está correlacionada - con el resto de las <span class="math inline">\(x\)</span>)</li>
</ul>
<p>Por tanto, <span class="math inline">\(\hat{\beta_1}\)</span> mide la relación muestral entre <span class="math inline">\(y\)</span> y <span class="math inline">\(x_1\)</span> luego de haber descontado los efectos parciales de <span class="math inline">\(x_2\)</span>, <span class="math inline">\(x_3\)</span>…<span class="math inline">\(x_k\)</span>. Para evaluar la multicolinealidad, un primer paso es observar la matriz de correlación de las variables de nuestro modelo (tal como hicimos en la etapa de analizar los estadísticos descriptivos):</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(GGally)
<span class="co">## </span>
<span class="co">## Attaching package: &#39;GGally&#39;</span>
<span class="co">## The following object is masked from &#39;package:dplyr&#39;:</span>
<span class="co">## </span>
<span class="co">##     nasa</span>
vind &lt;-<span class="st"> </span>bienestar_la[variables]
<span class="kw">ggcorr</span>(vind, <span class="dt">label =</span> T)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-35"></span>
<img src="lineal_files/figure-html/unnamed-chunk-35-1.png" alt="Matriz de correlación, donde diagnosticaremos problemas de multicolinearidad" width="480" />
<p class="caption">
Figura 6.10: Matriz de correlación, donde diagnosticaremos problemas de multicolinearidad
</p>
</div>
<p>Vemos que algunas de nuestras variables tienen correlaciones fuertes, como el gasto en seguridad social <code>csssw</code> y la cantidad de población jóven que tiene el país <code>pop014w</code>, que tienen una correlacion negativa de 0.7. De todos modos, para detectar si la multicolinealidad es problemática es necesario realizar un test de vif (<em>variance inflation factors</em>) porque ver correlación de a pares no nos ayuda a dilucidar si más de dos variables tienen una correlación lineal. Lo que nos dice este test vif es qué tanto se “agrandan” los errores de cada coeficiente en presencia de las demás variables (qué tanto se incrementa la varianza del error).</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># modelo_2 &lt;- lm(gini_slc ~ 1 + cseduc + fdiingdp + cshlth + csssw + pop014wdi + s_dualism + ethnicdicot + rgdpch + demrss + legbal +  repressauthor,data = bienestar_la_sinna )</span>
<span class="co"># </span>
<span class="co"># vif(modelo_2)</span></code></pre>
<p>Luego, realizo una consulta sobre si la raíz cuadrada de vif para cada variable es menor que 2 (la raíz cuadrada porque lo que me interesa es el error estándar y no la varianza). Vif: debería ser menor a 2, si es mayor a dos quiere decir que la varianza es demasiado alta y por tanto hay problema de multicolinealidad.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># sqrt(vif(modelo_2)) &gt; 2</span></code></pre>
<p>De acuerdo a la consulta, parece ser que no tenemos un problema de multicolinealidad. Pero si lo tenemos, debríamos corregirlo? En general los manuales de econometría que te recomendamos coinciden en que la necesidad de reducir la multicolinealidad depende de su gravedad y de cuál es el objetivo principal del modelo de regresión. Hay que tener en cuenta los siguientes tres puntos:</p>
<ol style="list-style-type: decimal">
<li><p>La gravedad de los problemas aumenta con el grado de multicolinealidad. Por lo tanto, si la multicolinealidad es moderada, es posible que no necesitemos resolverla.</p></li>
<li><p>La multicolinealidad afecta solo a las variables independientes específicas que están correlacionadas. Por lo tanto, si la multicolinealidad no está presente para las variables independientes de interés, es posible que no necesitemos resolverla.</p></li>
<li><p>La multicolinealidad afecta los coeficientes y los valores-p, y el error estándar, pero no influye directamente en los valores predichos del modelo, la precisión de estas predicciones y las estadísticas de bondad de ajuste. Si el objetivo principal es hacer predicciones, y no necesitamos comprender el papel de cada variable independiente, no necesitamos reducir la multicolinealidad.</p></li>
</ol>
<p><strong>Soluciones a la multicolinealidad</strong></p>
<ol style="list-style-type: decimal">
<li><p>Remover una de las variables indpendientes que esté altamente correlacionada. Esto constituye un trade-off, y se tiene que justificar teóricamente por qué se mantiene una variable y no la otra, además de hacer evidente el alto grado de correlación.</p></li>
<li><p>Puedo combinar las variables que estén altamente correlacionadas, hacer un índice por ejemplo como enseñamos en el Capítulo <a href="pca.html#pca">10</a>.</p></li>
</ol>
<ul>
<li>Hasta ahora hemos visto cuatro supuestos, que permiten derivar que nuestros estimadores por MCO no son sesgados. Es decir, nos permiten confiar en que la esperanza de la estimación realizada a través de MCO será igual al promedio poblacional: <span class="math inline">\(E(\hat\beta)=\beta\)</span></li>
</ul>
</div>
<div id="homocedasticidad" class="section level4">
<h4><span class="header-section-number">6.4.3.5</span> 5. Homocedasticidad</h4>
<p>El quinto supuesto tiene que ver con la eficiencia. Esto es, con la varianza del término de error de nuestra estimación. La varianza del término de error es constante. Es decir, dado cualquier valor de las variables explicativas, el error tiene la misma varianza:</p>
<p><span class="math inline">\(Var(u\mid{x})=\sigma^2\)</span>, es decir <span class="math inline">\(Var(u)=\sigma^2\)</span></p>
<p>De este modo, la varianza del error no observable, <span class="math inline">\(u\)</span>, condicional sobre las variables explicativas, es constante. Como mencionamos anteriormente, este supuesto <strong>no afecta el sesgo</strong> del estimador (es decir, que la distribución muestral de nuestra estimación <span class="math inline">\(_\hat{\beta_1}\)</span> esté centrada en <span class="math inline">\(\beta_1\)</span>), sino su <em>eficiencia</em> (qué tanta dispersión hay en torno a la estimación <span class="math inline">\(_\hat{\beta_1}\)</span> del parámetro <span class="math inline">\(\beta_1\)</span>).</p>
<p>Este supuesto es central para poder calcular la varianza de los estimadores de MCO, y es el que permite que sea el estimador de mínima varianza entre los estimadores lineales insesgados. Si evaluamos la fórmula del error estándar de los coeficientes, se hace evidente la necesidad del supuesto:
<span class="math display">\[\hat{\sigma}{_\hat{\beta}{_1}} = \frac{\hat{\sigma}} {\sqrt{\sum(X_j – \bar{X})^2(1 - R^2_j)}}\]</span></p>
<ul>
<li><span class="math inline">\(\hat{\sigma}\)</span> Es la varianza del término de error: <span class="math inline">\(\frac{\sum\hat{u}}{n-k-1}\)</span></li>
</ul>
<p>Para poder aplicar esta fórmula, <strong>necesitamos</strong> que <span class="math inline">\({\sigma^2}\)</span> sea constante. Cuando este supuesto no se cumple, es decir el término de error no se mantiene constante para distintos valores de <span class="math inline">\(x\)</span>, estamos ante un escenario de <strong>heterocedasticidad</strong>. Es bastante frecuente tener heterocedasticidad. La buena noticia es que esto no imposibilita la utilización del estimador OLS: ¡hay una solución!</p>
<p><strong>A. Evaluando el supuesto</strong></p>
<p>Para la evaluación de este supuesto se suelen seguir dos pasos:</p>
<ol style="list-style-type: decimal">
<li>Diagnóstico visual: Lo que buscamos es observar si los residuales (distancia entre los puntos y la línea de regresión) son constantes para distintos valores de equis. En primer lugar, hacemos un simple diagrama de dispersión entre la variable independiente que nos interesa y la variable dependiente:</li>
</ol>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(bienestar_la_sinna, <span class="kw">aes</span>(cseduc, gini_slc)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">theme_bw</span>()<span class="op">+</span><span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span>lm)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-38"></span>
<img src="lineal_files/figure-html/unnamed-chunk-38-1.png" alt="Evaluación visual del supuesto de homocedasticidad" width="480" />
<p class="caption">
Figura 6.11: Evaluación visual del supuesto de homocedasticidad
</p>
</div>
<p>Otra manera de hacer lo mismo y donde es más evidente:</p>
<pre class="sourceCode r"><code class="sourceCode r">car<span class="op">::</span><span class="kw">scatterplot</span>(bienestar_la_sinna<span class="op">$</span>cseduc,bienestar_la_sinna<span class="op">$</span>gini_slc)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-39"></span>
<img src="lineal_files/figure-html/unnamed-chunk-39-1.png" alt="Evaluación alternativa del supuesto de homocedasticidad" width="480" />
<p class="caption">
Figura 6.12: Evaluación alternativa del supuesto de homocedasticidad
</p>
</div>
<p>Parece ser que en los niveles bajos de gasto en educación la variabilidad de los niveles de desigualdad es bastante más alta que a niveles más elevados de gasto en educación. Podemos hacer un mejor diagnóstico visual si utilizamos el modelo estimado (y no solo la relación entre las dos variables) y graficamos los residuos. Primero lo hacemos para el modelo bivariado:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))
<span class="kw">plot</span>(modelo_<span class="dv">1</span>)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-40"></span>
<img src="lineal_files/figure-html/unnamed-chunk-40-1.png" alt="Evaluación del supuesto de homocedasticidad incluyendo covariables" width="480" />
<p class="caption">
Figura 6.13: Evaluación del supuesto de homocedasticidad incluyendo covariables
</p>
</div>
<p>Luego para el modelo multivariado:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(modelo_<span class="dv">2</span>)
<span class="co">## Warning: not plotting observations with leverage one:</span>
<span class="co">##   123</span>

<span class="co">## Warning: not plotting observations with leverage one:</span>
<span class="co">##   123</span>
<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-41"></span>
<img src="lineal_files/figure-html/unnamed-chunk-41-1.png" alt="Evaluación recomendada del supuesto de homocedasticidad" width="480" /><img src="lineal_files/figure-html/unnamed-chunk-41-2.png" alt="Evaluación recomendada del supuesto de homocedasticidad" width="480" /><img src="lineal_files/figure-html/unnamed-chunk-41-3.png" alt="Evaluación recomendada del supuesto de homocedasticidad" width="480" /><img src="lineal_files/figure-html/unnamed-chunk-41-4.png" alt="Evaluación recomendada del supuesto de homocedasticidad" width="480" />
<p class="caption">
Figura 6.14: Evaluación recomendada del supuesto de homocedasticidad
</p>
</div>
<p>Los dos gráficos que nos interesa analizar son los de la izquierda: donde se grafican los valores predichos y los residuos. Recordemos que bajo el supuesto de homocedasticidad, como la <span class="math inline">\(Var(u\mid{x})=\sigma^2\)</span> , entonces la <span class="math inline">\(Var(Y\mid{x})=\sigma^2\)</span>. En otras palabras, la varianza de los residuos de los valores predichos a partir de las equis <strong>debiera ser constante</strong>. Por tanto, si no hay absolutamente ninguna heterocedasticidad (osea si estamos ante un escenario de homocedasticidad), deberíamos ver una distribución de puntos completamente aleatoria e igual en todo el rango del eje X y una línea roja constante. Sin embargo, claramente se observa que los residuos no son constantes para distintos valores de la variable de gasto en educación. Estamos frente a un caso de <strong>heterocedasticidad</strong>.</p>
<ul>
<li>Podemos también evaluar cada una de las variables del modelo y, así, identificar para qué variables específicas hay heterocedasticidad. Nuevamente, lo que esperamos es que la línea roja coincida con la línea punteada (en cero).</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">car<span class="op">::</span><span class="kw">residualPlots</span>(modelo_<span class="dv">2</span>)
<span class="co">##                   Test stat Pr(&gt;|Test stat|)    </span>
<span class="co">## cseduc                -1.80            0.074 .  </span>
<span class="co">## fdiingdp              -0.09            0.928    </span>
<span class="co">##  [ reached getOption(&quot;max.print&quot;) -- omitted 10 rows ]</span>
<span class="co">## ---</span>
<span class="co">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-42"></span>
<img src="lineal_files/figure-html/unnamed-chunk-42-1.png" alt="Análisis de residuos para cada covariable" width="480" /><img src="lineal_files/figure-html/unnamed-chunk-42-2.png" alt="Análisis de residuos para cada covariable" width="480" />
<p class="caption">
Figura 6.15: Análisis de residuos para cada covariable
</p>
</div>
<ol start="2" style="list-style-type: decimal">
<li>Diagnóstico estadístico: En un segundo paso realizamos un diagnóstico estadístico. Hay distintas maneras de evaluar la homocedasticidad, pero exisrw el test de <em>Breusch-Pagan</em> es el que se utiliza con más frecuencia. La lógica que está por detrás de este test es la siguiente: se realiza una regresión donde la variable dependiente son los residuos al cuadrado, para evaluar si las variables independientes del modelo tienen relación con <span class="math inline">\(u\)</span>. Lo que se quiere encontrar es que ese efecto sea 0, porque si la varianza del error es constante, el error (residuos) no debería variar según los valores de las <span class="math inline">\(x&#39;s\)</span>. En definitiva, ¡no se quiere rechazar la hipótesis nula!</li>
</ol>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">bptest</span>(modelo_<span class="dv">2</span>,<span class="dt">studentize=</span>T)
<span class="co">## </span>
<span class="co">##  studentized Breusch-Pagan test</span>
<span class="co">## </span>
<span class="co">## data:  modelo_2</span>
<span class="co">## BP = 30, df = 10, p-value = 0.001</span></code></pre>
<p>Como el p-value es menor a 0.05, se rechaza la hipótesis nula y, por tanto, estamos en un escenario de heterocedasticidad.</p>
<p><strong>B. Soluciones a la Heterocedasticidad</strong></p>
<p>Una vez que identificamos que tenemos heterocedasticidad, es necesario solucionarla. Una primera alternativa es corregir la <em>forma funcional</em>. Claramente podes estar ante el caso que la no constancia del término de error se deba a que la relación entre las variables no es lineal y oara esto ya vimos posibles soluciones a la no linealidad como exponenciar las variables. La segunda alternativa se da frecuentemente, cuando la naturaleza empírica de la relación hace que el error no sea constante. Sabemos que no podemos calcular los errores estándar de los estimadores como lo hacemos siempre en OLS: como la varianza del error <strong>no es constante</strong> es necesario modificar la forma en la que calculamos los errores.</p>
<p>Entonces, para poder hacer inferencia necesitamos ajustar la estimación del error de forma tal de hacer una estimación válida en presencia de <strong>heterocedasticidad de la forma desconocida</strong>. Esto es, aunque no sepa el tipo de heterocedasticidad que tengo, puedo mejorar mi precisión y, además, hacer inferencia estadística válida. La fórmula habitual del error estándar del estimador es:</p>
<p><span class="math display">\[\hat{\sigma}{_\hat{\beta}{_1}} = \frac{\sum_{i=1}^{n}(x_{i}-\overline{x})^2\hat{\sigma}} {\sqrt{\sum(X_j – \bar{X})^2(1 - R^2_j)}}\]</span></p>
<p>Lo que pasa es que cuando tenemos <strong>homocedasticidad</strong>, lo que está en el nominador: <span class="math inline">\(\sum_{i=1}^{n}(x_{i}-\overline{x})^2\hat{\sigma}=\hat\sigma\)</span>. Como ahora <span class="math inline">\(\hat{\sigma}\)</span> ya no es constante, esa igualdad ya no se mantiene! Esto porque el valor que adquiere <span class="math inline">\(\hat{\sigma}\)</span> si va a depender de los distintos valores de <span class="math inline">\(x\)</span>. Además, recordemos que al estimar una regresión <strong>múltiple</strong>, en la estimación del error estándar es necesario descontar la variación de la <span class="math inline">\(x_1\)</span> que es explicada por el resto de las <span class="math inline">\(x_k\)</span> del modelo.</p>
<p>De este modo, en una regresión múltiple, un estimador válido de <span class="math inline">\(\hat{\sigma}{_\hat{\beta}{_1}}\)</span> bajo heterocedasticidad, será:</p>
<p><span class="math display">\[\hat{\sigma}{_\hat{\beta}{_1}} = \frac{\sum_{i=1}^{n}r_{ij}^2\hat{u}^2}{\sqrt{\sum(X_j–\bar{X})^2(1 - R^2_j)}}\]</span></p>
<p>Donde:</p>
<ul>
<li><span class="math inline">\(r_{ij}^2\)</span> Representa los residuos cuadrados de la regresión del resto de las variables independientes sobre la variable independiente <span class="math inline">\(j\)</span>.</li>
<li> Representa la Varianza Total de equis luego de haber descontado el efecto del resto de las equis.</li>
</ul>
<p>A esta forma de estimar los errores estándar se la denomina <strong>“errores estándares robustos”</strong> o también le decimos <strong>“robustecer”</strong> el error, que no es otra cosa que dar cuenta y permitir la heterocedasticidad, volviendo los errores más exigentes.</p>
</div>
</div>
<div id="errores-estandares-robustos" class="section level3">
<h3><span class="header-section-number">6.4.4</span> Errores estándares robustos</h3>
<p>Si bien hay varias formas de robustecer los errores (incluso se podría hacer a mano), R nos permite calcularlos muy fácilmente con el comando <code>coeftest</code> del paquete <code>lmtest</code>. Además, el paquete <code>sandwich</code> con su función <code>vcovHC</code> nos permite incorporar la especificación de la matriz de varianza-covarianza robusta.</p>
<ul>
<li>HC0 = es la original de White (Wooldrige,2006)</li>
<li>HC1= Es la que utiliza el software de Stata</li>
<li>HC3 = Es la más conservadora y, por tanto, se suele ser altamente recomendada</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(lmtest)
<span class="kw">library</span>(sandwich)
modelo_<span class="dv">2</span>_robusto_<span class="dv">3</span>=<span class="kw">coeftest</span>(modelo_<span class="dv">2</span>, <span class="dt">vcov =</span> <span class="kw">vcovHC</span>(modelo_<span class="dv">2</span>, <span class="st">&quot;HC3&quot;</span>))
modelo_<span class="dv">2</span>_robusto_<span class="dv">1</span>=<span class="kw">coeftest</span>(modelo_<span class="dv">2</span>, <span class="dt">vcov =</span> <span class="kw">vcovHC</span>(modelo_<span class="dv">2</span>, <span class="st">&quot;HC1&quot;</span>))
modelo_<span class="dv">2</span>_robusto_<span class="dv">0</span>=<span class="kw">coeftest</span>(modelo_<span class="dv">2</span>, <span class="dt">vcov =</span> <span class="kw">vcovHC</span>(modelo_<span class="dv">2</span>, <span class="st">&quot;HC0&quot;</span>))
modelos_robustos&lt;-<span class="kw">list</span>(modelo_<span class="dv">2</span>, modelo_<span class="dv">2</span>_robusto_<span class="dv">0</span>, modelo_<span class="dv">2</span>_robusto_<span class="dv">1</span>, modelo_<span class="dv">2</span>_robusto_<span class="dv">3</span>)

<span class="kw">screenreg</span>(modelos_robustos,
          <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;sin ES robustos&quot;</span>, <span class="st">&quot;robusto HC0&quot;</span>, <span class="st">&quot;robusto HC1&quot;</span>, <span class="st">&quot;robusto HC3&quot;</span>))
<span class="co">## </span>
<span class="co">## ==========================================================================</span>
<span class="co">##                     sin ES robustos  robusto HC0  robusto HC1  robusto HC3</span>
<span class="co">## --------------------------------------------------------------------------</span>
<span class="co">## (Intercept)          85.94 ***        85.94 ***    85.94 ***    85.94     </span>
<span class="co">##                      (8.73)           (8.77)       (9.14)                 </span>
<span class="co">## cseduc                1.59 ***         1.59 **      1.59 **      1.59     </span>
<span class="co">##                      (0.45)           (0.50)       (0.52)                 </span>
<span class="co">## fdiingdp              0.24             0.24         0.24         0.24     </span>
<span class="co">##                      (0.18)           (0.14)       (0.14)                 </span>
<span class="co">## cshlth               -0.83 **         -0.83 ***    -0.83 ***    -0.83     </span>
<span class="co">##                      (0.26)           (0.22)       (0.23)                 </span>
<span class="co">## csssw                -0.83 ***        -0.83 **     -0.83 **     -0.83     </span>
<span class="co">##                      (0.20)           (0.25)       (0.26)                 </span>
<span class="co">## pop014wdi            -0.93 ***        -0.93 ***    -0.93 ***    -0.93     </span>
<span class="co">##                      (0.17)           (0.20)       (0.21)                 </span>
<span class="co">## s_dualism            -0.17 ***        -0.17 ***    -0.17 ***    -0.17     </span>
<span class="co">##                      (0.03)           (0.03)       (0.03)                 </span>
<span class="co">## ethnicdicot           3.68 ***         3.68 ***     3.68 ***     3.68     </span>
<span class="co">##                      (1.04)           (0.92)       (0.96)                 </span>
<span class="co">## rgdpch               -0.00 **         -0.00 *      -0.00 *      -0.00     </span>
<span class="co">##                      (0.00)           (0.00)       (0.00)                 </span>
<span class="co">## as.factor(demrss)2   -2.29            -2.29        -2.29        -2.29     </span>
<span class="co">##                      (4.75)           (1.36)       (1.41)                 </span>
<span class="co">## as.factor(demrss)3   -2.90            -2.90 *      -2.90 *      -2.90     </span>
<span class="co">##                      (4.70)           (1.16)       (1.20)                 </span>
<span class="co">## as.factor(demrss)4   -5.14            -5.14 ***    -5.14 ***    -5.14     </span>
<span class="co">##                      (4.62)           (0.84)       (0.88)                 </span>
<span class="co">## legbal              -10.40 ***       -10.40 ***   -10.40 ***   -10.40     </span>
<span class="co">##                      (2.22)           (2.29)       (2.38)                 </span>
<span class="co">## --------------------------------------------------------------------------</span>
<span class="co">## R^2                   0.59                                                </span>
<span class="co">## Adj. R^2              0.56                                                </span>
<span class="co">## Num. obs.           167                                                   </span>
<span class="co">## RMSE                  4.52                                                </span>
<span class="co">## ==========================================================================</span>
<span class="co">## *** p &lt; 0.001, ** p &lt; 0.01, * p &lt; 0.05</span></code></pre>
<p>Todas las alternativas nos dan errores robustos similares. Las diferencias están dadas por distintas especificaciones sobre la matriz de varianza-covarianza robusta (HC).</p>
</div>
<div id="un-caso-especial-de-heterocedasticidad-la-varianza-del-error-asociada-a-clusters" class="section level3">
<h3><span class="header-section-number">6.4.5</span> Un caso especial de Heterocedasticidad: la varianza del error asociada a clusters</h3>
<p>Sabemos que hay observaciones que pueden estar relacionadas entre sí dentro de determinados grupos (o clusters). Por ejemplo, los países de América Latina podrían estar relacionados por pertenecer a regiones similares (América del Sur versus América Central o Caribe, regiones Andinas versus no Andinas, etc). Así, sus errores podrían estar correlacionados en base a la región que pertenecen. Entonces, tengo que la varianza del error condicionada por región no es constante.</p>
<p>Cuando trabajamos con datos de panel, como es nuestro caso, esto es bastante más claro. Al contar con gasto en educación por país para varios años existe una <em>auto-correlación del error</em> entre observaciones de un mismo país. Es decir, los errores se encuentran correlacionados entre las observaciones de un mismo país para cada año (lo que se gasta en un año particular, probablemente esté relacionado con lo que se gastó en el año anterior). Entonces, cuando mis observaciones pertenecen a clusters y tengo motivos teóricos para pensar que sus errores estarán correlacionados dentro del cluster, la corrección supondrá clusterizar los errores estándar: <strong>cluster standard errors</strong>.</p>
<p>Lo que estamos haciendo cuando clusterizamos los errores estándar es permitir que exista correlación del error dentro de los clusters (se relaja el supuesto de homocedasticidad). Así, permitimos que la varianza del error no sea constante, sino que sea diferente según los clusters. La selección de cuáles son los clusters relevantes estará dada teóricamente. En nuestro caso, hace sentido pensar que los clusters son los países. Recordemos que nuestro interés era estimar el el efecto del gasto en educación sobre el índice de Gini en países de América Latina. Observemos esta relación en la región para evaluar si, a primera vista, parece haber clusterización:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">ggplot</span>(bienestar_la_sinna, <span class="kw">aes</span>(cseduc, gini_slc)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span>country) </code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-45"></span>
<img src="lineal_files/figure-html/unnamed-chunk-45-1.png" alt="Relación entre educación y Gini por país" width="480" />
<p class="caption">
Figura 6.16: Relación entre educación y Gini por país
</p>
</div>
<p>Parece ser que si existe cierta clusterización por país. Es deir, el gasto en educación por país suele mantenerse dentro de un rango que varía por poco. Cuando lo vemos así no queda tan claro porque son demasiados países, pero aún así pareciera haber cierta clusterización por país (las observaciones se agrupan por país; no parecen ser independientes).</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(bienestar_la_sinna, <span class="kw">aes</span>(cseduc, gini_slc, <span class="dt">color=</span>country)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">theme_bw</span>()</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-46"></span>
<img src="lineal_files/figure-html/unnamed-chunk-46-1.png" alt="Condensamos la figura anterior en una sola faceta" width="480" />
<p class="caption">
Figura 6.17: Condensamos la figura anterior en una sola faceta
</p>
</div>
<p>Para realizar la estimación por MCO con el error clusterizado, utilizamos el comando <code>lm.cluster</code> del paquete <code>miceadds</code>. Este comando lo que hace es clusterizar los errores estándar según la variable de clusterización indicada. En definitiva, lo que estamos haciendo es permitir que exista correlación del error dentro de los clusters, en este caso países (relajando el supuesto de homocedasticidad).</p>
<p>Los errores estándar robustos por cluster pueden aumentar o disminuir los errores estándar. Es decir, los errores estándar clusterizados pueden ser más grandes o más pequeños que los errores estándar convencionales. La dirección en la que cambiarán los errores estándar depende del signo de la correlación del error intragrupo. Es necesario para hacer este paso que instales los paquetes <code>miceadds</code> y <code>multiwayvcov</code>. Mediante la opción “cluster” indicamos que variable será la que agrupará los errores:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># install.packages(&quot;miceadds&quot;)</span>
<span class="kw">library</span>(miceadds)
<span class="co">## Loading required package: mice</span>
<span class="co">## Loading required package: lattice</span>
<span class="co">## </span>
<span class="co">## Attaching package: &#39;mice&#39;</span>
<span class="co">## The following object is masked from &#39;package:tidyr&#39;:</span>
<span class="co">## </span>
<span class="co">##     complete</span>
<span class="co">## The following objects are masked from &#39;package:base&#39;:</span>
<span class="co">## </span>
<span class="co">##     cbind, rbind</span>
<span class="co">## * miceadds 3.0-16 (2018-12-11 10:39:14)</span>
<span class="co">## </span>
<span class="co">## Attaching package: &#39;miceadds&#39;</span>
<span class="co">## The following objects are masked from &#39;package:GGally&#39;:</span>
<span class="co">## </span>
<span class="co">##     mean0, min0</span>
modelo_<span class="dv">2</span>_cluster &lt;-<span class="st"> </span>miceadds<span class="op">::</span><span class="kw">lm.cluster</span>( <span class="dt">data=</span>bienestar_la_sinna, <span class="dt">formula=</span>gini_slc <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>cseduc <span class="op">+</span><span class="st"> </span>s_dualism <span class="op">+</span><span class="st"> </span>fdiingdp <span class="op">+</span><span class="st"> </span>rgdpch <span class="op">+</span><span class="st"> </span>ethnicdicot <span class="op">+</span><span class="st"> </span>demrss <span class="op">+</span><span class="st"> </span>cshlth <span class="op">+</span><span class="st"> </span>csssw <span class="op">+</span><span class="st"> </span>legbal <span class="op">+</span><span class="st"> </span>repressauthor, <span class="dt">cluster=</span><span class="st">&quot;country&quot;</span>)
<span class="kw">summary</span>(modelo_<span class="dv">2</span>_cluster)
<span class="co">## R^2= 0.51 </span>
<span class="co">## </span>
<span class="co">##               Estimate Std. Error t value Pr(&gt;|t|)</span>
<span class="co">## (Intercept)    5.1e+01    3.96616   12.86  7.6e-38</span>
<span class="co">## cseduc         1.2e+00    0.63271    1.88  6.0e-02</span>
<span class="co">##  [ reached getOption(&quot;max.print&quot;) -- omitted 9 rows ]</span></code></pre>
<p>Al usar clusters, el coeficiente de nuestra variable independiente <code>cseduc</code> bajó de 1,56 a 1,19 pero se mantuvo con significancia estadística alta (t valor de &gt; 12).</p>
</div>
<div id="un-supuesto-adicional-para-poder-realizar-inferencia" class="section level3">
<h3><span class="header-section-number">6.4.6</span> Un supuesto adicional para poder realizar <strong>inferencia</strong></h3>
<p>Hasta aquí hemos repasado y evaluado empíricamente - en la medida de lo posible - los cinco supuestos del teorema de Gauss-Markov que aseguran que el estimador de MCO sea MELI (Mejor Estimador Lineal Insesgado). Sin embargo, estos no son suficientes para poder realizar inferencia estadística. Para esto, debemos asumir un supuesto adicional:</p>
<div id="normalidad-en-la-distribucion-del-error" class="section level4">
<h4><span class="header-section-number">6.4.6.1</span> 6. Normalidad en la distribución del error</h4>
<p>Como hemos visto anteriormente, para testear una hipótesis de significancia individual de un coeficiente estimado por MCO se utilizan los estadísticos <span class="math inline">\(t\)</span> que permiten contrastar el valor <span class="math inline">\(t\)</span> empírico contra un valor <span class="math inline">\(t\)</span> teórico (llamado “valor crítico”) dado un nivel de significancia determinado (<span class="math inline">\(\alpha\)</span>), comúnmente se utiliza un alpha del 5% (por esto se habla de significancia estadística al 95% de confianza). Sin embargo, para poder realizar esta prueba de hipótesis y, así, hacer inferencia estadística, es necesario asumir que el coeficiente (<span class="math inline">\(\beta\)</span>) sigue una distribución T-Student. Sólo así podemos realizar la prubea de hipótesis utilizando el estadístico <span class="math inline">\(t\)</span>.</p>
<p>El supuesto que permite esto es el de <em>normalidad en la distribución del error</em>. Como el estimador MCO (<span class="math inline">\(\beta\)</span>) es una combinación lineal de los errores (<span class="math inline">\(Y = \beta_0 + \beta_1x + u\)</span>), al asumir distribución normal del error (<span class="math inline">\(u\)</span>) podemos asumir distribución normal del estimador MCO. Sin embargo, como el error y su varianza son desconocidos, se estiman utilizando los residuos de la regresión (<span class="math inline">\(\hat{u}\)</span>), obteniendo así el error estándar de la estimación. Sin embargo, las estimaciones implican una pérdida de grados de libertad (por cada parámetro estimado pierdo un grado de libertad: n-k-1, n=tamaño muestral, k=cantidad de parámetros estimados - variables del modelo-, 1=la estimación del intercepto, <span class="math inline">\(\beta_0\)</span>) y, por tanto, la distribución del error estándar y, por tanto, del coeficiente, ya no distribuye normal sino T-Student (<span class="math inline">\(\hat\beta \sim t_{n-k-1}\)</span>). Los siguientes dos comandos nos permiten verificar que los residuos del modelo estimado a través de MCO siguen una distribución T-Student (aproximadamente normal).</p>
<ul>
<li>El comando <code>qqplot</code> viene por default en <code>R</code> y genera un gráfico de probabilidad normal que muestra la distribución de los datos contra una distribución normal teórica esperada. Por tanto, lo que es importante mirar del gráfico es que las observaciones (que son los residuos) no se salgan de las líneas punteadas (que delimitan la distribución normal).</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qqPlot</span>(modelo_<span class="dv">2</span><span class="op">$</span>residuals)
<span class="co">## [1] 160 118</span></code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-48"></span>
<img src="lineal_files/figure-html/unnamed-chunk-48-1.png" alt="Normalidad de los residuos. Note que los países 160 y 118 son valores extremos" width="480" />
<p class="caption">
Figura 6.18: Normalidad de los residuos. Note que los países 160 y 118 son valores extremos
</p>
</div>
<ul>
<li>El comando <code>ggpubr</code> del paquete <code>ggpubr</code> permite construir gráficos de densidad. De este modo, puedo graficar los residuos para evaluar visualmente si siguen una distribución aproximadamente normal.</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggpubr)
<span class="co">## Loading required package: magrittr</span>
<span class="co">## </span>
<span class="co">## Attaching package: &#39;magrittr&#39;</span>
<span class="co">## The following object is masked from &#39;package:texreg&#39;:</span>
<span class="co">## </span>
<span class="co">##     extract</span>
<span class="co">## The following object is masked from &#39;package:purrr&#39;:</span>
<span class="co">## </span>
<span class="co">##     set_names</span>
<span class="co">## The following object is masked from &#39;package:tidyr&#39;:</span>
<span class="co">## </span>
<span class="co">##     extract</span>
<span class="kw">ggdensity</span>(modelo_<span class="dv">2</span><span class="op">$</span>residuals, 
          <span class="dt">main =</span> <span class="st">&quot;Gráfico de Densidad de los Residuos&quot;</span>)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-49"></span>
<img src="lineal_files/figure-html/unnamed-chunk-49-1.png" alt="Test de normalidad de los residuos" width="480" />
<p class="caption">
Figura 6.19: Test de normalidad de los residuos
</p>
</div>
<p>Luego de la evaluación de los supuestos y buscar soluciones (cuando es necesario), podemos tener mayor confianza en nuestra estimación y la relación encontrada entre las variables. Aún así, una explicación completa de nuestro hallazgo implica profundizar en por qué y cómo se relacionan estas dos variables. Todo lo que hemos visto te será muy útil en el Capítulo <a href="casos.html#casos">11</a> de selección de casos de estudio. En el próximo capítulo pasaremos a estimar modelos con variables dependientes binarias por Estimación de Maxima Verosimilitud.</p>
<div class="books">
<p>
<strong>Ejercicios antes de continuar al próximo capítulo</strong>
</p>
<ul>
<li>
<p>
Haga un scatterplot entre la relación de la variable <code>gini_slc</code> y la variable <code>fdiingdp</code>. Agregue el nombre del país a cada observación.
</p>
</li>
<li>
<p>
Al modelo 1 agreguele como control la variable <code>fdiingdp</code> e interprete su coeficiente.
</p>
</li>
<li>
<p>
Haga los tests correspondientes para asegurarse de que los supuestos de OLS no son violados.
</p>
</li>
<li>
<p>
Usando <code>htmlreg</code>exporte la tabla de la regresión a Word.
</p>
</li>
</ul>
</div>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="carga.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="logit.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "night",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/arcruz0/libroadp/edit/master/lineal.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
