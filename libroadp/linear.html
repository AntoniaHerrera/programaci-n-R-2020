<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 5 Modelos lineales | AnalizaR Datos Políticos</title>
  <meta name="description" content="Capítulo 5 Modelos lineales | AnalizaR Datos Políticos" />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 5 Modelos lineales | AnalizaR Datos Políticos" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 5 Modelos lineales | AnalizaR Datos Políticos" />
  
  
  

<meta name="author" content="Francisco Urdinez y Andrés Cruz Labrín (editores)" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link rel="prev" href="load.html"/>
<link rel="next" href="case-sel.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<script>
% https://stackoverflow.com/a/4425214/8242291
var links = document.links;

for (var i = 0, linksLength = links.length; i < linksLength; i++) {

    if (links[i].hostname != window.location.hostname) {
        links[i].target = '_blank';
    }

}
</script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #2a211c;
    color: #bdae9d;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #bdae9d;  padding-left: 4px; }
div.sourceCode
  { color: #bdae9d; background-color: #2a211c; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ffff00; } /* Alert */
code span.an { color: #0066ff; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #44aa43; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #43a8ed; font-weight: bold; } /* ControlFlow */
code span.ch { color: #049b0a; } /* Char */
code span.cn { } /* Constant */
code span.co { color: #0066ff; font-weight: bold; font-style: italic; } /* Comment */
code span.do { color: #0066ff; font-style: italic; } /* Documentation */
code span.dt { text-decoration: underline; } /* DataType */
code span.dv { color: #44aa43; } /* DecVal */
code span.er { color: #ffff00; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #44aa43; } /* Float */
code span.fu { color: #ff9358; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #0066ff; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #43a8ed; font-weight: bold; } /* Keyword */
code span.op { } /* Operator */
code span.pp { font-weight: bold; } /* Preprocessor */
code span.sc { color: #049b0a; } /* SpecialChar */
code span.ss { color: #049b0a; } /* SpecialString */
code span.st { color: #049b0a; } /* String */
code span.va { } /* Variable */
code span.vs { color: #049b0a; } /* VerbatimString */
code span.wa { color: #ffff00; font-weight: bold; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><b><a href="./index.html"><img style="float: left; margin-right: 5px;" src="favicon.ico"></img>AnalizaR datos políticos</a></b></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introducción</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#inicio"><i class="fa fa-check"></i>Inicio</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#cómo-contribuir"><i class="fa fa-check"></i>¿Cómo contribuir?</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#sobre-los-autores-y-autoras"><i class="fa fa-check"></i>Sobre los autores y autoras</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#prefacio"><i class="fa fa-check"></i>Prefacio</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#agradecimientos"><i class="fa fa-check"></i>Agradecimientos</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#qué-esperar-del-libro"><i class="fa fa-check"></i>Qué esperar del libro</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#estructura-del-libro"><i class="fa fa-check"></i>Estructura del libro</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#cómo-utilizar-el-libro-en-un-curso-de-métodos"><i class="fa fa-check"></i>¿Cómo utilizar el libro en un curso de métodos?</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#primera-opción-curso-semestral-de-análisis-de-datos-políticos"><i class="fa fa-check"></i>Primera opción: Curso semestral de análisis de datos políticos</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#segunda-opción-curso-semestral-de-introducción-a-métodos-cuantitativos"><i class="fa fa-check"></i>Segunda opción: Curso semestral de introducción a métodos cuantitativos</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#prerrequisitos"><i class="fa fa-check"></i>Prerrequisitos</a></li>
</ul></li>
<li class="part"><span><b>I Introducción a R</b></span></li>
<li class="chapter" data-level="1" data-path="basic-r.html"><a href="basic-r.html"><i class="fa fa-check"></i><b>1</b> R Básico</a><ul>
<li class="chapter" data-level="1.1" data-path="basic-r.html"><a href="basic-r.html#instalación"><i class="fa fa-check"></i><b>1.1</b> Instalación</a><ul>
<li class="chapter" data-level="" data-path="basic-r.html"><a href="basic-r.html#r"><i class="fa fa-check"></i>R</a></li>
<li class="chapter" data-level="" data-path="basic-r.html"><a href="basic-r.html#rstudio"><i class="fa fa-check"></i>RStudio</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="basic-r.html"><a href="basic-r.html#consola"><i class="fa fa-check"></i><b>1.2</b> Consola</a></li>
<li class="chapter" data-level="1.3" data-path="basic-r.html"><a href="basic-r.html#script"><i class="fa fa-check"></i><b>1.3</b> Script</a></li>
<li class="chapter" data-level="1.4" data-path="basic-r.html"><a href="basic-r.html#objetos-y-funciones"><i class="fa fa-check"></i><b>1.4</b> Objetos (y funciones)</a><ul>
<li class="chapter" data-level="1.4.1" data-path="basic-r.html"><a href="basic-r.html#vectores"><i class="fa fa-check"></i><b>1.4.1</b> Vectores</a></li>
<li class="chapter" data-level="1.4.2" data-path="basic-r.html"><a href="basic-r.html#basic-r-functions"><i class="fa fa-check"></i><b>1.4.2</b> Functions</a></li>
<li class="chapter" data-level="1.4.3" data-path="basic-r.html"><a href="basic-r.html#archivos-gráficos-paquetes-ayuda"><i class="fa fa-check"></i><b>1.4.3</b> Archivos / gráficos / paquetes / ayuda</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>2</b> Manejo de datos</a><ul>
<li class="chapter" data-level="" data-path="data.html"><a href="data.html#los-paquetes-que-necesitas-instalar"><i class="fa fa-check"></i>Los paquetes que necesitas instalar</a></li>
<li class="chapter" data-level="2.1" data-path="data.html"><a href="data.html#introducción-al-manejo-de-datos"><i class="fa fa-check"></i><b>2.1</b> Introducción al manejo de datos</a><ul>
<li class="chapter" data-level="2.1.1" data-path="data.html"><a href="data.html#nuestra-base-de-datos"><i class="fa fa-check"></i><b>2.1.1</b> Nuestra base de datos</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="data.html"><a href="data.html#describiendo-una-base-de-datos"><i class="fa fa-check"></i><b>2.2</b> Describiendo una base de datos</a></li>
<li class="chapter" data-level="2.3" data-path="data.html"><a href="data.html#operaciones-básicas"><i class="fa fa-check"></i><b>2.3</b> Operaciones básicas</a><ul>
<li class="chapter" data-level="2.3.1" data-path="data.html"><a href="data.html#seleccionar-columnas"><i class="fa fa-check"></i><b>2.3.1</b> Seleccionar columnas</a></li>
<li class="chapter" data-level="2.3.2" data-path="data.html"><a href="data.html#renombra-las-columnas"><i class="fa fa-check"></i><b>2.3.2</b> Renombra las columnas</a></li>
<li class="chapter" data-level="2.3.3" data-path="data.html"><a href="data.html#filtrar-las-observaciones"><i class="fa fa-check"></i><b>2.3.3</b> Filtrar las observaciones</a></li>
<li class="chapter" data-level="2.3.4" data-path="data.html"><a href="data.html#cambiar-el-orden-de-una-base-de-datos"><i class="fa fa-check"></i><b>2.3.4</b> Cambiar el orden de una base de datos</a></li>
<li class="chapter" data-level="2.3.5" data-path="data.html"><a href="data.html#transformar-y-crear-variables"><i class="fa fa-check"></i><b>2.3.5</b> Transformar y crear variables</a></li>
<li class="chapter" data-level="2.3.6" data-path="data.html"><a href="data.html#resúmenes"><i class="fa fa-check"></i><b>2.3.6</b> Resúmenes</a></li>
<li class="chapter" data-level="2.3.7" data-path="data.html"><a href="data.html#resúmenes-por-grupo"><i class="fa fa-check"></i><b>2.3.7</b> Resúmenes por grupo</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="data.html"><a href="data.html#comandos-en-cadena"><i class="fa fa-check"></i><b>2.4</b> Comandos en cadena</a></li>
<li class="chapter" data-level="2.5" data-path="data.html"><a href="data.html#data-recodificar"><i class="fa fa-check"></i><b>2.5</b> Recodificar valores</a><ul>
<li class="chapter" data-level="2.5.1" data-path="data.html"><a href="data.html#pivoteo-de-datos-data-pivot"><i class="fa fa-check"></i><b>2.5.1</b> Pivoteo de datos {data-pivot}</a></li>
<li class="chapter" data-level="2.5.2" data-path="data.html"><a href="data.html#bases-de-datos-anchas-con-más-de-una-variable-de-interés"><i class="fa fa-check"></i><b>2.5.2</b> Bases de datos anchas con más de una variable de interés</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="dataviz.html"><a href="dataviz.html"><i class="fa fa-check"></i><b>3</b> Visualización de datos</a><ul>
<li class="chapter" data-level="" data-path="dataviz.html"><a href="dataviz.html#lecturas-sugeridas"><i class="fa fa-check"></i>Lecturas sugeridas</a></li>
<li class="chapter" data-level="" data-path="dataviz.html"><a href="dataviz.html#los-paquetes-que-necesitas-instalar-1"><i class="fa fa-check"></i>Los paquetes que necesitas instalar</a></li>
<li class="chapter" data-level="3.1" data-path="dataviz.html"><a href="dataviz.html#por-qué-visualizar-mis-datos"><i class="fa fa-check"></i><b>3.1</b> ¿Por qué visualizar mis datos?</a></li>
<li class="chapter" data-level="3.2" data-path="dataviz.html"><a href="dataviz.html#primeros-pasos"><i class="fa fa-check"></i><b>3.2</b> Primeros pasos</a><ul>
<li class="chapter" data-level="3.2.1" data-path="dataviz.html"><a href="dataviz.html#las-capas-del-universo-ggplotiano"><i class="fa fa-check"></i><b>3.2.1</b> Las capas del “universo ggplotiano”</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="dataviz.html"><a href="dataviz.html#ejemplo-aplicado-elecciones-locales-y-visualización-de-datos"><i class="fa fa-check"></i><b>3.3</b> Ejemplo aplicado: Elecciones locales y visualización de datos</a><ul>
<li class="chapter" data-level="3.3.1" data-path="dataviz.html"><a href="dataviz.html#gráfico-de-barras"><i class="fa fa-check"></i><b>3.3.1</b> Gráfico de barras</a></li>
<li class="chapter" data-level="3.3.2" data-path="dataviz.html"><a href="dataviz.html#gráfico-de-caja"><i class="fa fa-check"></i><b>3.3.2</b> Gráfico de caja</a></li>
<li class="chapter" data-level="3.3.3" data-path="dataviz.html"><a href="dataviz.html#histograma"><i class="fa fa-check"></i><b>3.3.3</b> Histograma</a></li>
<li class="chapter" data-level="3.3.4" data-path="dataviz.html"><a href="dataviz.html#relación-entre-las-variables"><i class="fa fa-check"></i><b>3.3.4</b> Relación entre las variables</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="dataviz.html"><a href="dataviz.html#para-continuar-aprendiendo"><i class="fa fa-check"></i><b>3.4</b> Para continuar aprendiendo</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="load.html"><a href="load.html"><i class="fa fa-check"></i><b>4</b> Carga de datos</a><ul>
<li class="chapter" data-level="" data-path="load.html"><a href="load.html#los-paquetes-que-necesitas-instalar-2"><i class="fa fa-check"></i>Los paquetes que necesitas instalar</a></li>
<li class="chapter" data-level="4.1" data-path="load.html"><a href="load.html#load-intro"><i class="fa fa-check"></i><b>4.1</b> Introducción</a></li>
<li class="chapter" data-level="4.2" data-path="load.html"><a href="load.html#carga-formatos"><i class="fa fa-check"></i><b>4.2</b> Diferentes formatos de bases de datos</a></li>
<li class="chapter" data-level="4.3" data-path="load.html"><a href="load.html#los-archivos-separados-por-delimitadores-.csv-y-.tsv"><i class="fa fa-check"></i><b>4.3</b> Los archivos separados por delimitadores (.csv y .tsv)</a><ul>
<li class="chapter" data-level="4.3.1" data-path="load.html"><a href="load.html#r-básico-utils"><i class="fa fa-check"></i><b>4.3.1</b> R básico: <code>utils</code></a></li>
<li class="chapter" data-level="4.3.2" data-path="load.html"><a href="load.html#load-r"><i class="fa fa-check"></i><b>4.3.2</b> Archivos creados con R (.Rdata y .rds)</a></li>
<li class="chapter" data-level="4.3.3" data-path="load.html"><a href="load.html#load-labels"><i class="fa fa-check"></i><b>4.3.3</b> Bases de datos con etiquetas (de Stata or SPSS)</a></li>
<li class="chapter" data-level="4.3.4" data-path="load.html"><a href="load.html#load-excel"><i class="fa fa-check"></i><b>4.3.4</b> Archivos de Excel</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="load.html"><a href="load.html#load-large"><i class="fa fa-check"></i><b>4.4</b> Grandes bases de datos tabulares</a></li>
</ul></li>
<li class="part"><span><b>II Modelos</b></span></li>
<li class="chapter" data-level="5" data-path="linear.html"><a href="linear.html"><i class="fa fa-check"></i><b>5</b> Modelos lineales</a><ul>
<li class="chapter" data-level="" data-path="linear.html"><a href="linear.html#lecturas-sugeridas-1"><i class="fa fa-check"></i>Lecturas sugeridas</a></li>
<li class="chapter" data-level="" data-path="linear.html"><a href="linear.html#los-paquetes-que-necesitas-instalar-3"><i class="fa fa-check"></i>Los paquetes que necesitas instalar</a></li>
<li class="chapter" data-level="" data-path="linear.html"><a href="linear.html#introducción-1"><i class="fa fa-check"></i>Introducción</a></li>
<li class="chapter" data-level="5.1" data-path="linear.html"><a href="linear.html#mínimos-cuadrados-ordinarios-en-r"><i class="fa fa-check"></i><b>5.1</b> Mínimos cuadrados ordinarios en R</a><ul>
<li class="chapter" data-level="5.1.1" data-path="linear.html"><a href="linear.html#cómo-obtener-estadísticas-descriptivas"><i class="fa fa-check"></i><b>5.1.1</b> Cómo obtener estadísticas descriptivas</a></li>
<li class="chapter" data-level="5.1.2" data-path="linear.html"><a href="linear.html#estadísticas-descriptivas-y-distribución-de-las-variables-en-el-modelo"><i class="fa fa-check"></i><b>5.1.2</b> Estadísticas descriptivas y distribución de las variables en el modelo</a></li>
<li class="chapter" data-level="5.1.3" data-path="linear.html"><a href="linear.html#matriz-de-correlación-de-variables-independientes"><i class="fa fa-check"></i><b>5.1.3</b> Matriz de correlación de variables independientes</a></li>
<li class="chapter" data-level="5.1.4" data-path="linear.html"><a href="linear.html#distribución-de-las-variables-de-interés"><i class="fa fa-check"></i><b>5.1.4</b> Distribución de las variables de interés</a></li>
<li class="chapter" data-level="5.1.5" data-path="linear.html"><a href="linear.html#relación-entre-la-variable-dependiente-e-independiente"><i class="fa fa-check"></i><b>5.1.5</b> Relación entre la variable dependiente e independiente</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="linear.html"><a href="linear.html#modelo-bivariado-regresión-lineal-simple"><i class="fa fa-check"></i><b>5.2</b> Modelo bivariado: regresión lineal simple</a><ul>
<li class="chapter" data-level="5.2.1" data-path="linear.html"><a href="linear.html#la-función-lm"><i class="fa fa-check"></i><b>5.2.1</b> La función <code>lm</code></a></li>
<li class="chapter" data-level="5.2.2" data-path="linear.html"><a href="linear.html#representación-gráfica"><i class="fa fa-check"></i><b>5.2.2</b> Representación gráfica</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="linear.html"><a href="linear.html#modelo-multivariado-regresión-múltiple"><i class="fa fa-check"></i><b>5.3</b> Modelo multivariado: regresión múltiple</a></li>
<li class="chapter" data-level="5.4" data-path="linear.html"><a href="linear.html#ajuste-del-modelo"><i class="fa fa-check"></i><b>5.4</b> Ajuste del modelo</a></li>
<li class="chapter" data-level="5.5" data-path="linear.html"><a href="linear.html#inferencia-en-los-modelos-lineales-múltiples"><i class="fa fa-check"></i><b>5.5</b> Inferencia en los modelos lineales múltiples</a></li>
<li class="chapter" data-level="5.6" data-path="linear.html"><a href="linear.html#testeando-los-supuestos-de-mco"><i class="fa fa-check"></i><b>5.6</b> Testeando los supuestos de MCO</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="case-sel.html"><a href="case-sel.html"><i class="fa fa-check"></i><b>6</b> Selección de casos basada en regresiones</a><ul>
<li class="chapter" data-level="" data-path="case-sel.html"><a href="case-sel.html#lecturas-sugeridas-2"><i class="fa fa-check"></i>Lecturas sugeridas</a></li>
<li class="chapter" data-level="" data-path="case-sel.html"><a href="case-sel.html#los-paquetes-que-necesitas-instalar-4"><i class="fa fa-check"></i>Los paquetes que necesitas instalar</a></li>
<li class="chapter" data-level="6.1" data-path="case-sel.html"><a href="case-sel.html#selección-de-estudios-de-casos"><i class="fa fa-check"></i><b>6.1</b> Selección de estudios de casos</a></li>
<li class="chapter" data-level="6.2" data-path="case-sel.html"><a href="case-sel.html#qué-estudio-de-caso-debería-seleccionar-para-la-investigación-cualitativa"><i class="fa fa-check"></i><b>6.2</b> ¿Qué estudio de caso debería seleccionar para la investigación cualitativa?</a><ul>
<li class="chapter" data-level="6.2.1" data-path="case-sel.html"><a href="case-sel.html#casos-típicos"><i class="fa fa-check"></i><b>6.2.1</b> Casos típicos</a></li>
<li class="chapter" data-level="6.2.2" data-path="case-sel.html"><a href="case-sel.html#los-valores-atípicos"><i class="fa fa-check"></i><b>6.2.2</b> Los valores atípicos</a></li>
<li class="chapter" data-level="6.2.3" data-path="case-sel.html"><a href="case-sel.html#casos-influyentes"><i class="fa fa-check"></i><b>6.2.3</b> Casos influyentes</a></li>
<li class="chapter" data-level="6.2.4" data-path="case-sel.html"><a href="case-sel.html#casos-extremos"><i class="fa fa-check"></i><b>6.2.4</b> Casos extremos</a></li>
<li class="chapter" data-level="6.2.5" data-path="case-sel.html"><a href="case-sel.html#casos-más-similares"><i class="fa fa-check"></i><b>6.2.5</b> Casos más similares</a></li>
<li class="chapter" data-level="6.2.6" data-path="case-sel.html"><a href="case-sel.html#casos-mas-diferentes"><i class="fa fa-check"></i><b>6.2.6</b> Casos mas diferentes</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="case-sel.html"><a href="case-sel.html#la-importancia-de-la-combinación-de-métodos"><i class="fa fa-check"></i><b>6.3</b> La importancia de la combinación de métodos</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="panel.html"><a href="panel.html"><i class="fa fa-check"></i><b>7</b> Datos de panel</a><ul>
<li class="chapter" data-level="" data-path="panel.html"><a href="panel.html#lecturas-sugeridas-3"><i class="fa fa-check"></i>Lecturas sugeridas</a></li>
<li class="chapter" data-level="" data-path="panel.html"><a href="panel.html#los-paquetes-que-necesitas-instalar-5"><i class="fa fa-check"></i>Los paquetes que necesitas instalar</a></li>
<li class="chapter" data-level="7.1" data-path="panel.html"><a href="panel.html#introducción-2"><i class="fa fa-check"></i><b>7.1</b> Introducción</a></li>
<li class="chapter" data-level="7.2" data-path="panel.html"><a href="panel.html#describiendo-la-base-de-datos-en-panel"><i class="fa fa-check"></i><b>7.2</b> Describiendo la base de datos en panel</a><ul>
<li class="chapter" data-level="7.2.1" data-path="panel.html"><a href="panel.html#opción-a.-gráfico-de-líneas"><i class="fa fa-check"></i><b>7.2.1</b> Opción A. Gráfico de líneas</a></li>
<li class="chapter" data-level="7.2.2" data-path="panel.html"><a href="panel.html#option-b.-gráfico-de-cajas"><i class="fa fa-check"></i><b>7.2.2</b> Option B. Gráfico de cajas</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="panel.html"><a href="panel.html#modelización-de-la-variación-a-nivel-de-grupo"><i class="fa fa-check"></i><b>7.3</b> Modelización de la variación a nivel de grupo</a></li>
<li class="chapter" data-level="7.4" data-path="panel.html"><a href="panel.html#efectos-fijos-vs.-efectos-aleatorios"><i class="fa fa-check"></i><b>7.4</b> Efectos fijos vs. efectos aleatorios</a><ul>
<li class="chapter" data-level="7.4.1" data-path="panel.html"><a href="panel.html#test-de-hausman"><i class="fa fa-check"></i><b>7.4.1</b> Test de Hausman</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="panel.html"><a href="panel.html#testeando-raíces-unitarias"><i class="fa fa-check"></i><b>7.5</b> Testeando raíces unitarias</a><ul>
<li class="chapter" data-level="7.5.1" data-path="panel.html"><a href="panel.html#creación-de-variables-rezagadas-lags-y-variables-prospectivas-leads"><i class="fa fa-check"></i><b>7.5.1</b> Creación de variables rezagadas (<em>lags</em>) y variables prospectivas (<em>leads</em>)</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="panel.html"><a href="panel.html#errores-estándar-robustos-corregidos-para-panel"><i class="fa fa-check"></i><b>7.6</b> Errores estándar robustos corregidos para panel</a><ul>
<li class="chapter" data-level="7.6.1" data-path="panel.html"><a href="panel.html#errores-estándar-robustos-1"><i class="fa fa-check"></i><b>7.6.1</b> Errores estándar robustos</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="logit.html"><a href="logit.html"><i class="fa fa-check"></i><b>8</b> Modelos logísticos</a><ul>
<li class="chapter" data-level="" data-path="logit.html"><a href="logit.html#lecturas-sugeridas-4"><i class="fa fa-check"></i>Lecturas sugeridas</a></li>
<li class="chapter" data-level="" data-path="logit.html"><a href="logit.html#los-paquetes-que-necesitas-instalar-6"><i class="fa fa-check"></i>Los paquetes que necesitas instalar</a></li>
<li class="chapter" data-level="8.1" data-path="logit.html"><a href="logit.html#introducción-3"><i class="fa fa-check"></i><b>8.1</b> Introducción</a></li>
<li class="chapter" data-level="8.2" data-path="logit.html"><a href="logit.html#uso-de-los-modelos-logísticos"><i class="fa fa-check"></i><b>8.2</b> Uso de los modelos logísticos</a></li>
<li class="chapter" data-level="8.3" data-path="logit.html"><a href="logit.html#cómo-se-estiman-las-probabilidades"><i class="fa fa-check"></i><b>8.3</b> ¿Cómo se estiman las probabilidades?</a></li>
<li class="chapter" data-level="8.4" data-path="logit.html"><a href="logit.html#estimación-de-los-modelos"><i class="fa fa-check"></i><b>8.4</b> Estimación de los modelos</a></li>
<li class="chapter" data-level="8.5" data-path="logit.html"><a href="logit.html#creando-tablas"><i class="fa fa-check"></i><b>8.5</b> Creando tablas</a></li>
<li class="chapter" data-level="8.6" data-path="logit.html"><a href="logit.html#representación-visual-de-los-resultados"><i class="fa fa-check"></i><b>8.6</b> Representación visual de los resultados</a><ul>
<li class="chapter" data-level="8.6.1" data-path="logit.html"><a href="logit.html#visualización-de-las-interacciones-entre-las-variables"><i class="fa fa-check"></i><b>8.6.1</b> Visualización de las interacciones entre las variables</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="logit.html"><a href="logit.html#medidas-para-evaluar-el-ajuste-de-los-modelos"><i class="fa fa-check"></i><b>8.7</b> Medidas para evaluar el ajuste de los modelos</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="surv.html"><a href="surv.html"><i class="fa fa-check"></i><b>9</b> Modelos de supervivencia</a><ul>
<li class="chapter" data-level="" data-path="surv.html"><a href="surv.html#lecturas-sugeridas-5"><i class="fa fa-check"></i>Lecturas sugeridas</a></li>
<li class="chapter" data-level="" data-path="surv.html"><a href="surv.html#los-paquetes-que-necesitas-instalar-7"><i class="fa fa-check"></i>Los paquetes que necesitas instalar</a></li>
<li class="chapter" data-level="9.1" data-path="surv.html"><a href="surv.html#introducción-4"><i class="fa fa-check"></i><b>9.1</b> Introducción</a></li>
<li class="chapter" data-level="9.2" data-path="surv.html"><a href="surv.html#cómo-interpretamos-las-tasas-de-riesgo"><i class="fa fa-check"></i><b>9.2</b> ¿Cómo interpretamos las tasas de riesgo?</a></li>
<li class="chapter" data-level="9.3" data-path="surv.html"><a href="surv.html#el-modelo-cox-de-riesgos-proporcionales"><i class="fa fa-check"></i><b>9.3</b> El modelo Cox de riesgos proporcionales</a></li>
<li class="chapter" data-level="9.4" data-path="surv.html"><a href="surv.html#estimación-de-los-modelos-de-cox-en-r"><i class="fa fa-check"></i><b>9.4</b> Estimación de los modelos de Cox en R</a></li>
<li class="chapter" data-level="9.5" data-path="surv.html"><a href="surv.html#modelos-de-supervivencia-e-interpretación-sus-coeficientes-como-hazard-ratios."><i class="fa fa-check"></i><b>9.5</b> Modelos de supervivencia e interpretación sus coeficientes como Hazard Ratios.</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="causal-inf.html"><a href="causal-inf.html"><i class="fa fa-check"></i><b>10</b> Inferencia causal</a><ul>
<li class="chapter" data-level="" data-path="causal-inf.html"><a href="causal-inf.html#lecturas-sugeridas-6"><i class="fa fa-check"></i>Lecturas sugeridas</a></li>
<li class="chapter" data-level="" data-path="causal-inf.html"><a href="causal-inf.html#los-paquetes-que-necesitas-instalar-8"><i class="fa fa-check"></i>Los paquetes que necesitas instalar</a></li>
<li class="chapter" data-level="10.1" data-path="causal-inf.html"><a href="causal-inf.html#introducción-5"><i class="fa fa-check"></i><b>10.1</b> Introducción</a></li>
<li class="chapter" data-level="10.2" data-path="causal-inf.html"><a href="causal-inf.html#causalidad-y-gráficos-causales"><i class="fa fa-check"></i><b>10.2</b> Causalidad y gráficos causales</a></li>
<li class="chapter" data-level="10.3" data-path="causal-inf.html"><a href="causal-inf.html#midiendo-efectos-causales"><i class="fa fa-check"></i><b>10.3</b> Midiendo efectos causales</a></li>
<li class="chapter" data-level="10.4" data-path="causal-inf.html"><a href="causal-inf.html#dags-y-asociaciones-estadísticas"><i class="fa fa-check"></i><b>10.4</b> DAGs y asociaciones estadísticas</a></li>
<li class="chapter" data-level="10.5" data-path="causal-inf.html"><a href="causal-inf.html#puertas-traseras-y-cálculos-hacer"><i class="fa fa-check"></i><b>10.5</b> Puertas traseras y cálculos “<em>hacer</em>”</a></li>
<li class="chapter" data-level="10.6" data-path="causal-inf.html"><a href="causal-inf.html#dibujar-y-analizar-dags"><i class="fa fa-check"></i><b>10.6</b> Dibujar y analizar DAGs</a><ul>
<li class="chapter" data-level="10.6.1" data-path="causal-inf.html"><a href="causal-inf.html#dibujar-un-dag-con-dagitty"><i class="fa fa-check"></i><b>10.6.1</b> Dibujar un DAG con DAGitty</a></li>
<li class="chapter" data-level="10.6.2" data-path="causal-inf.html"><a href="causal-inf.html#encontrar-sets-de-ajuste-con-dagitty"><i class="fa fa-check"></i><b>10.6.2</b> Encontrar sets de ajuste con DAGitty</a></li>
<li class="chapter" data-level="10.6.3" data-path="causal-inf.html"><a href="causal-inf.html#diseñar-dags-en-r"><i class="fa fa-check"></i><b>10.6.3</b> Diseñar DAGs en R</a></li>
<li class="chapter" data-level="10.6.4" data-path="causal-inf.html"><a href="causal-inf.html#encontrar-caminos-y-sets-de-ajustes-con-r"><i class="fa fa-check"></i><b>10.6.4</b> Encontrar caminos y sets de ajustes con R</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="causal-inf.html"><a href="causal-inf.html#haciendo-ajustes-causales"><i class="fa fa-check"></i><b>10.7</b> Haciendo ajustes causales</a><ul>
<li class="chapter" data-level="10.7.1" data-path="causal-inf.html"><a href="causal-inf.html#datos-de-redes-para-mosquitos"><i class="fa fa-check"></i><b>10.7.1</b> Datos de redes para mosquitos</a></li>
<li class="chapter" data-level="10.7.2" data-path="causal-inf.html"><a href="causal-inf.html#verificar-las-independencias-condicionales"><i class="fa fa-check"></i><b>10.7.2</b> Verificar las independencias condicionales</a></li>
<li class="chapter" data-level="10.7.3" data-path="causal-inf.html"><a href="causal-inf.html#encuentra-el-set-de-ajuste"><i class="fa fa-check"></i><b>10.7.3</b> Encuentra el set de ajuste</a></li>
<li class="chapter" data-level="10.7.4" data-path="causal-inf.html"><a href="causal-inf.html#estimación-ingenua-no-ajustada"><i class="fa fa-check"></i><b>10.7.4</b> Estimación ingenua no ajustada</a></li>
<li class="chapter" data-level="10.7.5" data-path="causal-inf.html"><a href="causal-inf.html#regresiones"><i class="fa fa-check"></i><b>10.7.5</b> Regresiones</a></li>
<li class="chapter" data-level="10.7.6" data-path="causal-inf.html"><a href="causal-inf.html#matching"><i class="fa fa-check"></i><b>10.7.6</b> Matching</a></li>
<li class="chapter" data-level="10.7.7" data-path="causal-inf.html"><a href="causal-inf.html#ponderación-de-probabilidad-inversa"><i class="fa fa-check"></i><b>10.7.7</b> Ponderación de probabilidad inversa</a></li>
<li class="chapter" data-level="10.7.8" data-path="causal-inf.html"><a href="causal-inf.html#comparando-todos-los-métodos"><i class="fa fa-check"></i><b>10.7.8</b> Comparando todos los métodos</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="causal-inf.html"><a href="causal-inf.html#cconsejos-finales"><i class="fa fa-check"></i><b>10.8</b> CConsejos finales</a></li>
</ul></li>
<li class="part"><span><b>III Aplicaciones</b></span></li>
<li class="chapter" data-level="11" data-path="adv-data.html"><a href="adv-data.html"><i class="fa fa-check"></i><b>11</b> Manejo avanzado de datos políticos</a><ul>
<li class="chapter" data-level="" data-path="adv-data.html"><a href="adv-data.html#lecturas-sugeridas-7"><i class="fa fa-check"></i>Lecturas sugeridas</a></li>
<li class="chapter" data-level="" data-path="adv-data.html"><a href="adv-data.html#los-paquetes-que-necesitas-instalar-9"><i class="fa fa-check"></i>Los paquetes que necesitas instalar</a></li>
<li class="chapter" data-level="11.1" data-path="adv-data.html"><a href="adv-data.html#introducción-6"><i class="fa fa-check"></i><b>11.1</b> Introducción</a></li>
<li class="chapter" data-level="11.2" data-path="adv-data.html"><a href="adv-data.html#uniendo-bases-de-datos"><i class="fa fa-check"></i><b>11.2</b> Uniendo bases de datos</a></li>
<li class="chapter" data-level="11.3" data-path="adv-data.html"><a href="adv-data.html#estandarizando-los-códigos-de-país"><i class="fa fa-check"></i><b>11.3</b> Estandarizando los códigos de país</a></li>
<li class="chapter" data-level="11.4" data-path="adv-data.html"><a href="adv-data.html#la-unión-borrosa-o-inexacta-de-los-datos"><i class="fa fa-check"></i><b>11.4</b> La unión borrosa o inexacta de los datos</a></li>
<li class="chapter" data-level="11.5" data-path="adv-data.html"><a href="adv-data.html#gestión-de-valores-perdidos"><i class="fa fa-check"></i><b>11.5</b> Gestión de valores perdidos</a><ul>
<li class="chapter" data-level="11.5.1" data-path="adv-data.html"><a href="adv-data.html#tipos-de-valores-perdidos"><i class="fa fa-check"></i><b>11.5.1</b> Tipos de valores perdidos</a></li>
<li class="chapter" data-level="11.5.2" data-path="adv-data.html"><a href="adv-data.html#descripción-de-los-valores-que-faltan-en-la-base-de-datos"><i class="fa fa-check"></i><b>11.5.2</b> Descripción de los valores que faltan en la base de datos</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="adv-data.html"><a href="adv-data.html#imputación-de-valores-perdidos"><i class="fa fa-check"></i><b>11.6</b> Imputación de valores perdidos</a><ul>
<li class="chapter" data-level="11.6.1" data-path="adv-data.html"><a href="adv-data.html#regresiones-luego-de-imputar-datos"><i class="fa fa-check"></i><b>11.6.1</b> Regresiones luego de imputar datos</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="web-mining.html"><a href="web-mining.html"><i class="fa fa-check"></i><b>12</b> Web Scraping</a><ul>
<li class="chapter" data-level="" data-path="web-mining.html"><a href="web-mining.html#lecturas-sugeridas-8"><i class="fa fa-check"></i>Lecturas sugeridas</a></li>
<li class="chapter" data-level="" data-path="web-mining.html"><a href="web-mining.html#los-paquetes-que-necesitas-instalar-10"><i class="fa fa-check"></i>Los paquetes que necesitas instalar</a></li>
<li class="chapter" data-level="12.1" data-path="web-mining.html"><a href="web-mining.html#introducción-7"><i class="fa fa-check"></i><b>12.1</b> Introducción</a></li>
<li class="chapter" data-level="12.2" data-path="web-mining.html"><a href="web-mining.html#formas-de-hacer-web-scraping"><i class="fa fa-check"></i><b>12.2</b> Formas de hacer web scraping</a><ul>
<li class="chapter" data-level="12.2.1" data-path="web-mining.html"><a href="web-mining.html#estándar-de-exclusión-de-robot"><i class="fa fa-check"></i><b>12.2.1</b> Estándar de exclusión de robot</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="web-mining.html"><a href="web-mining.html#web-scraping-en-r"><i class="fa fa-check"></i><b>12.3</b> Web scraping en R</a><ul>
<li class="chapter" data-level="12.3.1" data-path="web-mining.html"><a href="web-mining.html#ejemplo-aplicado-los-comunicados-de-prensa-de-la-organización-de-estados-americanos-oea"><i class="fa fa-check"></i><b>12.3.1</b> Ejemplo aplicado: los comunicados de prensa de la Organización de Estados Americanos (OEA)</a></li>
<li class="chapter" data-level="12.3.2" data-path="web-mining.html"><a href="web-mining.html#caraga-el-html-para-trabajar-con-r"><i class="fa fa-check"></i><b>12.3.2</b> Caraga el html para trabajar con R</a></li>
<li class="chapter" data-level="12.3.3" data-path="web-mining.html"><a href="web-mining.html#extraer-la-información-con-html_nodes-html_text"><i class="fa fa-check"></i><b>12.3.3</b> Extraer la información con <code>html_nodes()</code> + <code>html_text()</code></a></li>
<li class="chapter" data-level="12.3.4" data-path="web-mining.html"><a href="web-mining.html#iteraciones"><i class="fa fa-check"></i><b>12.3.4</b> Iteraciones</a></li>
<li class="chapter" data-level="12.3.5" data-path="web-mining.html"><a href="web-mining.html#funciones-personalizadas-recetas"><i class="fa fa-check"></i><b>12.3.5</b> Funciones personalizadas (recetas)</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="web-mining.html"><a href="web-mining.html#usando-apis-y-extrayendo-datos-de-twitter"><i class="fa fa-check"></i><b>12.4</b> Usando APIs y extrayendo datos de Twitter</a><ul>
<li class="chapter" data-level="12.4.1" data-path="web-mining.html"><a href="web-mining.html#buscar-una-palabra-clave"><i class="fa fa-check"></i><b>12.4.1</b> Buscar una palabra clave</a></li>
<li class="chapter" data-level="12.4.2" data-path="web-mining.html"><a href="web-mining.html#buscar-una-frase"><i class="fa fa-check"></i><b>12.4.2</b> Buscar una frase</a></li>
<li class="chapter" data-level="12.4.3" data-path="web-mining.html"><a href="web-mining.html#descargando-características-relacionadas-con-los-usuarios-de-twitter"><i class="fa fa-check"></i><b>12.4.3</b> Descargando características relacionadas con los usuarios de Twitter</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="qta.html"><a href="qta.html"><i class="fa fa-check"></i><b>13</b> Análisis cuantitativo de textos políticos</a><ul>
<li class="chapter" data-level="" data-path="qta.html"><a href="qta.html#lecturas-recomendadas"><i class="fa fa-check"></i>Lecturas recomendadas</a></li>
<li class="chapter" data-level="" data-path="qta.html"><a href="qta.html#paquetes-que-necesitas-instalar"><i class="fa fa-check"></i>Paquetes que necesitas instalar</a></li>
<li class="chapter" data-level="13.1" data-path="qta.html"><a href="qta.html#sqta1"><i class="fa fa-check"></i><b>13.1</b> Análisis de hashtags políticos</a><ul>
<li class="chapter" data-level="13.1.1" data-path="qta.html"><a href="qta.html#exploración-de-datos-de-twitter"><i class="fa fa-check"></i><b>13.1.1</b> Exploración de datos de Twitter</a></li>
<li class="chapter" data-level="13.1.2" data-path="qta.html"><a href="qta.html#diagnóstico-visual"><i class="fa fa-check"></i><b>13.1.2</b> Diagnóstico visual</a></li>
<li class="chapter" data-level="13.1.3" data-path="qta.html"><a href="qta.html#hashtags-más-utilizados"><i class="fa fa-check"></i><b>13.1.3</b> Hashtags más utilizados</a></li>
<li class="chapter" data-level="13.1.4" data-path="qta.html"><a href="qta.html#wordclouds-nubes-de-palabras"><i class="fa fa-check"></i><b>13.1.4</b> Wordclouds (Nubes de palabras)</a></li>
<li class="chapter" data-level="13.1.5" data-path="qta.html"><a href="qta.html#nubes-de-palabras-por-grupos"><i class="fa fa-check"></i><b>13.1.5</b> Nubes de palabras por grupos</a></li>
<li class="chapter" data-level="13.1.6" data-path="qta.html"><a href="qta.html#gráficos-de-barras"><i class="fa fa-check"></i><b>13.1.6</b> Gráficos de barras</a></li>
<li class="chapter" data-level="13.1.7" data-path="qta.html"><a href="qta.html#variación-temporal-en-el-uso-de-hashtags"><i class="fa fa-check"></i><b>13.1.7</b> Variación temporal en el uso de hashtags</a></li>
<li class="chapter" data-level="13.1.8" data-path="qta.html"><a href="qta.html#para-resumir"><i class="fa fa-check"></i><b>13.1.8</b> Para resumir</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="qta.html"><a href="qta.html#wordfish"><i class="fa fa-check"></i><b>13.2</b> Wordfish</a><ul>
<li class="chapter" data-level="13.2.1" data-path="qta.html"><a href="qta.html#inspección-y-limpieza-de-datos"><i class="fa fa-check"></i><b>13.2.1</b> Inspección y limpieza de datos</a></li>
<li class="chapter" data-level="13.2.2" data-path="qta.html"><a href="qta.html#pre-procesamiento"><i class="fa fa-check"></i><b>13.2.2</b> Pre-procesamiento</a></li>
<li class="chapter" data-level="13.2.3" data-path="qta.html"><a href="qta.html#sqta2"><i class="fa fa-check"></i><b>13.2.3</b> Wordfish</a></li>
<li class="chapter" data-level="13.2.4" data-path="qta.html"><a href="qta.html#qué-aprendimos-de-wordfish"><i class="fa fa-check"></i><b>13.2.4</b> ¿Qué aprendimos de Wordfish?</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="qta.html"><a href="qta.html#sqta3"><i class="fa fa-check"></i><b>13.3</b> Structural Topic Modeling (STM)</a><ul>
<li class="chapter" data-level="13.3.1" data-path="qta.html"><a href="qta.html#pre-procesamiento-1"><i class="fa fa-check"></i><b>13.3.1</b> Pre-procesamiento</a></li>
<li class="chapter" data-level="13.3.2" data-path="qta.html"><a href="qta.html#diagnósticos"><i class="fa fa-check"></i><b>13.3.2</b> Diagnósticos</a></li>
<li class="chapter" data-level="13.3.3" data-path="qta.html"><a href="qta.html#análisis"><i class="fa fa-check"></i><b>13.3.3</b> Análisis</a></li>
<li class="chapter" data-level="13.3.4" data-path="qta.html"><a href="qta.html#observaciones-finales"><i class="fa fa-check"></i><b>13.3.4</b> Observaciones finales</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="networks.html"><a href="networks.html"><i class="fa fa-check"></i><b>14</b> Análisis de redes</a><ul>
<li class="chapter" data-level="" data-path="networks.html"><a href="networks.html#lecturas-sugeridas-9"><i class="fa fa-check"></i>Lecturas sugeridas</a></li>
<li class="chapter" data-level="" data-path="networks.html"><a href="networks.html#los-paquetes-que-necesitas-instalar-11"><i class="fa fa-check"></i>Los paquetes que necesitas instalar</a></li>
<li class="chapter" data-level="14.1" data-path="networks.html"><a href="networks.html#introducción-8"><i class="fa fa-check"></i><b>14.1</b> Introducción</a></li>
<li class="chapter" data-level="14.2" data-path="networks.html"><a href="networks.html#conceptos-básicos-en-una-red"><i class="fa fa-check"></i><b>14.2</b> Conceptos básicos en una red</a><ul>
<li class="chapter" data-level="14.2.1" data-path="networks.html"><a href="networks.html#nodos-y-enlaces"><i class="fa fa-check"></i><b>14.2.1</b> Nodos y enlaces</a></li>
<li class="chapter" data-level="14.2.2" data-path="networks.html"><a href="networks.html#matriz-de-adyacencia"><i class="fa fa-check"></i><b>14.2.2</b> Matriz de adyacencia</a></li>
<li class="chapter" data-level="14.2.3" data-path="networks.html"><a href="networks.html#pesos-y-direcciones"><i class="fa fa-check"></i><b>14.2.3</b> Pesos y direcciones</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="networks.html"><a href="networks.html#bases-de-datos-de-la-red"><i class="fa fa-check"></i><b>14.3</b> Bases de datos de la red</a></li>
<li class="chapter" data-level="14.4" data-path="networks.html"><a href="networks.html#presentación-gráfica-de-una-red"><i class="fa fa-check"></i><b>14.4</b> Presentación gráfica de una red</a></li>
<li class="chapter" data-level="14.5" data-path="networks.html"><a href="networks.html#medidas-de-centralidad"><i class="fa fa-check"></i><b>14.5</b> Medidas de centralidad</a><ul>
<li class="chapter" data-level="14.5.1" data-path="networks.html"><a href="networks.html#grado"><i class="fa fa-check"></i><b>14.5.1</b> Grado</a></li>
<li class="chapter" data-level="14.5.2" data-path="networks.html"><a href="networks.html#centralidad-del-eigenvector"><i class="fa fa-check"></i><b>14.5.2</b> Centralidad del eigenvector</a></li>
<li class="chapter" data-level="14.5.3" data-path="networks.html"><a href="networks.html#centralidad-de-intermediación-betweenness"><i class="fa fa-check"></i><b>14.5.3</b> Centralidad de intermediación (<em>betweenness</em>)</a></li>
<li class="chapter" data-level="14.5.4" data-path="networks.html"><a href="networks.html#cercanía"><i class="fa fa-check"></i><b>14.5.4</b> Cercanía</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="networks.html"><a href="networks.html#aplicación-en-r"><i class="fa fa-check"></i><b>14.6</b> Aplicación en R</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="indexes.html"><a href="indexes.html"><i class="fa fa-check"></i><b>15</b> Análisis de componentes principales</a><ul>
<li class="chapter" data-level="" data-path="indexes.html"><a href="indexes.html#lecturas-sugeridas-10"><i class="fa fa-check"></i>Lecturas sugeridas</a></li>
<li class="chapter" data-level="" data-path="indexes.html"><a href="indexes.html#los-paquetes-que-necesitas-instalar-12"><i class="fa fa-check"></i>Los paquetes que necesitas instalar</a></li>
<li class="chapter" data-level="15.1" data-path="indexes.html"><a href="indexes.html#introducción-9"><i class="fa fa-check"></i><b>15.1</b> Introducción</a><ul>
<li class="chapter" data-level="15.1.1" data-path="indexes.html"><a href="indexes.html#conceptos-medidas-y-validez"><i class="fa fa-check"></i><b>15.1.1</b> Conceptos, medidas y validez</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="indexes.html"><a href="indexes.html#cómo-funciona-el-análisis-de-componentes-principales"><i class="fa fa-check"></i><b>15.2</b> Cómo funciona el Análisis de Componentes Principales</a></li>
<li class="chapter" data-level="15.3" data-path="indexes.html"><a href="indexes.html#nociones-básicas-en-r"><i class="fa fa-check"></i><b>15.3</b> Nociones básicas en R</a></li>
<li class="chapter" data-level="15.4" data-path="indexes.html"><a href="indexes.html#dimensionalidad-del-concepto"><i class="fa fa-check"></i><b>15.4</b> Dimensionalidad del concepto</a></li>
<li class="chapter" data-level="15.5" data-path="indexes.html"><a href="indexes.html#variación-del-concepto"><i class="fa fa-check"></i><b>15.5</b> Variación del concepto</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="maps.html"><a href="maps.html"><i class="fa fa-check"></i><b>16</b> Mapas y datos espaciales</a><ul>
<li class="chapter" data-level="" data-path="maps.html"><a href="maps.html#lecturas-sugeridas-11"><i class="fa fa-check"></i>Lecturas sugeridas</a></li>
<li class="chapter" data-level="" data-path="maps.html"><a href="maps.html#los-paquetes-que-necesitas-instalar-13"><i class="fa fa-check"></i>Los paquetes que necesitas instalar</a></li>
<li class="chapter" data-level="16.1" data-path="maps.html"><a href="maps.html#introducción-10"><i class="fa fa-check"></i><b>16.1</b> Introducción</a><ul>
<li class="chapter" data-level="16.1.1" data-path="maps.html"><a href="maps.html#datos-espaciales-qué-son"><i class="fa fa-check"></i><b>16.1.1</b> Datos espaciales: ¿qué son?</a></li>
<li class="chapter" data-level="16.1.2" data-path="maps.html"><a href="maps.html#estructura-de-datos-espaciales"><i class="fa fa-check"></i><b>16.1.2</b> Estructura de datos espaciales</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="maps.html"><a href="maps.html#datos-espaciales-en-r"><i class="fa fa-check"></i><b>16.2</b> Datos espaciales en R</a><ul>
<li class="chapter" data-level="16.2.1" data-path="maps.html"><a href="maps.html#características-simples-en-r"><i class="fa fa-check"></i><b>16.2.1</b> Características simples en R</a></li>
<li class="chapter" data-level="16.2.2" data-path="maps.html"><a href="maps.html#estructura"><i class="fa fa-check"></i><b>16.2.2</b> Estructura</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="maps.html"><a href="maps.html#gestión-de-datos-espaciales"><i class="fa fa-check"></i><b>16.3</b> Gestión de Datos Espaciales</a><ul>
<li class="chapter" data-level="16.3.1" data-path="maps.html"><a href="maps.html#modificaciones"><i class="fa fa-check"></i><b>16.3.1</b> Modificaciones</a></li>
<li class="chapter" data-level="16.3.2" data-path="maps.html"><a href="maps.html#añade-datos-de-otras-bases-de-datos-con-left_join"><i class="fa fa-check"></i><b>16.3.2</b> Añade datos de otras bases de datos con <code>left_join()</code></a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="maps.html"><a href="maps.html#mapeo"><i class="fa fa-check"></i><b>16.4</b> Mapeo</a><ul>
<li class="chapter" data-level="16.4.1" data-path="maps.html"><a href="maps.html#generando-centroides"><i class="fa fa-check"></i><b>16.4.1</b> Generando centroides</a></li>
<li class="chapter" data-level="16.4.2" data-path="maps.html"><a href="maps.html#mapeando-variables"><i class="fa fa-check"></i><b>16.4.2</b> Mapeando variables</a></li>
<li class="chapter" data-level="16.4.3" data-path="maps.html"><a href="maps.html#mapeando-puntos"><i class="fa fa-check"></i><b>16.4.3</b> Mapeando puntos</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="maps.html"><a href="maps.html#inferencia-a-partir-de-datos-espaciales"><i class="fa fa-check"></i><b>16.5</b> Inferencia a partir de datos espaciales</a><ul>
<li class="chapter" data-level="16.5.1" data-path="maps.html"><a href="maps.html#indicador-local-de-asociación-espacial-lisa-por-sus-siglas-en-inglés"><i class="fa fa-check"></i><b>16.5.1</b> Indicador local de asociación espacial (LISA, por sus siglas en inglés)</a></li>
<li class="chapter" data-level="16.5.2" data-path="maps.html"><a href="maps.html#matriz-de-pesos-espaciales"><i class="fa fa-check"></i><b>16.5.2</b> Matriz de pesos espaciales</a></li>
<li class="chapter" data-level="16.5.3" data-path="maps.html"><a href="maps.html#i-de-moran"><i class="fa fa-check"></i><b>16.5.3</b> I de Moran</a></li>
<li class="chapter" data-level="" data-path="maps.html"><a href="maps.html#comentarios-finales-referencias-para-un-mejor-análisis-de-datos-espaciales"><i class="fa fa-check"></i>Comentarios finales: Referencias para un mejor análisis de datos espaciales</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Referencias</b></span></li>
<li class="chapter" data-level="17" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i><b>17</b> Referencias</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">AnalizaR Datos Políticos</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="linear" class="section level1">
<h1><span class="header-section-number">Capítulo 5</span> Modelos lineales</h1>
<p>Inés Fynn<a href="#fn23" class="footnote-ref" id="fnref23"><sup>23</sup></a> y Lihuen Nocetto<a href="#fn24" class="footnote-ref" id="fnref24"><sup>24</sup></a></p>
<div id="lecturas-sugeridas-1" class="section level3 unnumbered">
<h3>Lecturas sugeridas</h3>
<ul>
<li><p>Angrist, Joshua, Jörn-Steffen Pischke. (2008). <em>Mostly Harmless Econometrics: An Empiricist’s Companion</em>. Princeton: Princeton University Press.</p></li>
<li><p>Dunning, Thad. (2012). <em>Natural Experiments in the Social Sciences. A design-based approach</em>. Cambridge: Cambridge University Press.</p></li>
<li><p>Lewis-Beck, C., &amp; Lewis-Beck, M. (2016). <em>Applied Regression: An Introduction</em>. SAGE Publications.</p></li>
<li><p>Wooldridge, J. M. (2016). <em>Introductory econometrics: A modern approach</em> (6th ed.). Cengage Learning.</p></li>
</ul>
</div>
<div id="los-paquetes-que-necesitas-instalar-3" class="section level3 unnumbered">
<h3>Los paquetes que necesitas instalar</h3>
<ul>
<li><code>tidyverse</code> <span class="citation">(Wickham <a href="referencias.html#ref-R-tidyverse" role="doc-biblioref">2019</a><a href="referencias.html#ref-R-tidyverse" role="doc-biblioref">b</a>)</span>, <code>paqueteadp</code> <span class="citation">(Urdinez and Cruz <a href="referencias.html#ref-R-paqueteadp" role="doc-biblioref">2020</a>)</span>, <code>skimr</code> <span class="citation">(Waring et al. <a href="referencias.html#ref-R-skimr" role="doc-biblioref">2020</a>)</span>, <code>car</code> <span class="citation">(Fox, Weisberg, and Price <a href="referencias.html#ref-R-car" role="doc-biblioref">2020</a>)</span>, <code>ggcorrplot</code> <span class="citation">(Kassambara <a href="referencias.html#ref-R-ggcorrplot" role="doc-biblioref">2019</a>)</span>, <code>texreg</code> <span class="citation">(Leifeld <a href="referencias.html#ref-R-texreg" role="doc-biblioref">2020</a>)</span>, <code>prediction</code> <span class="citation">(Leeper <a href="referencias.html#ref-R-prediction" role="doc-biblioref">2019</a>)</span>, <code>lmtest</code> <span class="citation">(Hothorn et al. <a href="referencias.html#ref-R-lmtest" role="doc-biblioref">2019</a>)</span>, <code>sandwich</code> <span class="citation">(Zeileis and Lumley <a href="referencias.html#ref-R-sandwich" role="doc-biblioref">2019</a>)</span>, <code>miceadds</code> <span class="citation">(Robitzsch, Grund, and Henke <a href="referencias.html#ref-R-miceadds" role="doc-biblioref">2020</a>)</span>.</li>
</ul>
</div>
<div id="introducción-1" class="section level3 unnumbered">
<h3>Introducción</h3>
<p>En este capítulo, aprenderemos a hacer regresiones lineales en R. Aquí la función a modelar es lineal, es decir, se estima por dos parámetros: la pendiente y el intercepto. Cuando nos enfrentamos a un análisis multivariado, la estimación se vuelve más compleja. Cubriremos en R cómo interpretar los diferentes coeficientes, cómo crear tablas de regresión, cómo visualizar los valores predichos, y profundizaremos en la evaluación de los supuestos de los mínimos cuadrados ordinarios (MCO), para que pueda evaluar lo bien que encajan tus modelos.</p>
</div>
<div id="mínimos-cuadrados-ordinarios-en-r" class="section level2">
<h2><span class="header-section-number">5.1</span> Mínimos cuadrados ordinarios en R</h2>
<p>En este capítulo, la base de datos que trabajaremos es una mezcla de dos bases de datos construidas por <a href="http://huberandstephens.web.unc.edu/common-works/data/">Evelyne Huber y John D. Stephens</a>. Estas base de datos son:</p>
<ul>
<li><p>Base de datos bienestar en América Latina, 1960-2014 (Evelyne Huber y John D. Stephens, Latin American Welfare Dataset, 1960-2014, Universidad de Carolina del Norte en Chapel Hill, 2014): contiene variables sobre los Estados de bienestar en todos los países de América Latina y el Caribe entre 1960 y 2014.</p></li>
<li><p>Base de datos política de América Latina y el Caribe, 1945-2012 (Evelyne Huber and John D. Stephens, Latin America and the Caribbean Political Dataset, 1945-2012, University of North Carolina at Chapel Hill, 2012): contiene variables políticas de todos los países de América Latina y el Caribe entre 1945 y 2012.</p></li>
</ul>
<p>La base de datos resultante tiene 1074 observaciones para 25 países entre 1970 y 2012 (se excluyeron los datos del decenio de 1960 porque contenían muchos valores perdidos o <em>missing values</em>).</p>
<p>En primer lugar, cargamos el paquete <code>tidyverse</code>.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="linear.html#cb149-1"></a><span class="kw">library</span>(tidyverse)</span></code></pre></div>
<p>Vamos a importar la base de datos del paquete del libro:</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="linear.html#cb150-1"></a><span class="kw">library</span>(paqueteadp)</span>
<span id="cb150-2"><a href="linear.html#cb150-2"></a><span class="kw">data</span>(<span class="st">&quot;bienestar&quot;</span>)</span></code></pre></div>
<p>Ahora, la base de datos ha sido cargada en nuestra sesión de R</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="linear.html#cb151-1"></a><span class="kw">ls</span>()</span>
<span id="cb151-2"><a href="linear.html#cb151-2"></a><span class="co">## [1] &quot;bienestar&quot;</span></span></code></pre></div>
<p>En el capítulo, utilizaremos el documento de <span class="citation">Huber et al. (<a href="referencias.html#ref-huberPoliticsInequalityLatin2006" role="doc-biblioref">2006</a>)</span> como ejemplo para el análisis. En este artículo, se estiman los determinantes de la desigualdad en América Latina y el Caribe. Trabajar a partir de este artículo nos permite estimar un modelo con múltiples variables de control que ya han sido identificadas como relevantes para explicar la variación de la desigualdad en la región. Así, la variable dependiente que nos interesa explicar es la desigualdad de ingresos en los países de América Latina y el Caribe, operada de acuerdo al Índice de Gini (<code>gini</code>). Las variables independientes que incorporaremos al modelo son las siguientes:</p>
<ul>
<li><p>Dualismo sectorial (se refiere a la coexistencia de un sector tradicional de baja productividad y un sector moderno de alta productividad) - <code>dualismo_sectorial</code></p></li>
<li><p>PBI del país - <code>pib</code></p></li>
<li><p>Inversión Extranjera Directa (ingresos netos como % del PIB) - <code>inversion_extranjera</code></p></li>
<li><p>Diversidad étnica (variable <em>dummy</em> codificada como 1 cuando al menos el 20% pero no más allá del 80% de la población es étnicamente diversa) - <code>diversidad_etnica</code></p></li>
<li><p>Democracia (tipo de régimen) - <code>tipo_regimen</code></p></li>
<li><p>Gasto en educación (como porcentaje del PIB) - <code>gasto_educ</code></p></li>
<li><p>Gasto en salud (como porcentaje del PIB) - <code>gasto_salud</code></p></li>
<li><p>Gasto de seguridad social (como porcentaje del PIB) - <code>gasto_segsocial</code></p></li>
<li><p>Equilibrio legislativo - <code>bal_legislativo</code></p></li>
</ul>
<p>En este capítulo se intentará estimar cuál es el efecto del gasto educativo en los niveles de desigualdad de los países de América Latina y el Caribe. Así, nuestra variable independiente de interés será <code>gasto_educ</code>.</p>
<div id="cómo-obtener-estadísticas-descriptivas" class="section level3">
<h3><span class="header-section-number">5.1.1</span> Cómo obtener estadísticas descriptivas</h3>
<p>Antes de estimar un modelo lineal con mínimos cuadrados ordinarios (MCO) se recomienda identificar primero la distribución de las variables que te interesan: la variable dependiente <span class="math inline">\(y\)</span> (también llamada variable de respuesta) y la variable independiente de interés <span class="math inline">\(x\)</span> (también llamada variable explicativa o regresiva). En general, nuestros modelos tendrán, además de la variable independiente de interés, otras variables independientes (o explicativas) que llamaremos “controles”, ya que su tarea es hacer el escenario <em>ceteris paribus</em> lo más creíble posible. Es decir, los controles ayudarán a “mantener constantes todos los demás factores” para acercarnos lo más posible a un escenario en el que podamos controlar todas las variables que afectan a <span class="math inline">\(y\)</span>, y observar cómo la variación de una única variable independiente <span class="math inline">\(x\)</span> afecta a la variación de la variable dependiente (<span class="math inline">\(y\)</span>).
Así, antes de estimar el modelo, observaremos las estadísticas descriptivas de las variables que se incluirán en el modelo (tanto las dependientes como las independientes). El objetivo es prestar atención a las siguientes cuestiones:</p>
<ol style="list-style-type: decimal">
<li><p>Variación en <span class="math inline">\(x\)</span>: que las variables independientes (pero sobre todo la de interés) tengan variación en nuestra muestra. Si no hay variación en <span class="math inline">\(x\)</span>, no podemos estimar cómo esta variación afecta a la variación de <span class="math inline">\(y\)</span>.</p></li>
<li><p>Variación en <span class="math inline">\(y\)</span>: si la variable dependiente no varía, no podemos explicar su variación según la variación de <span class="math inline">\(x\)</span>.</p></li>
<li><p>Unidad de medida de las variables: aquí es donde evaluamos cómo se miden nuestras variables (además de revisar los libros de códigos que suelen venir con las bases de datos con los que estamos trabajando), para poder entender qué tipos de variables son (nominales, ordinales, continuas), y también para interpretar correctamente los resultados más adelante.</p></li>
<li><p>Tipo de variables: en la estimación del MCO, la variable dependiente debe ser, en general, <em>continua</em>, (aunque es posible trabajar con variables dependientes dicotómicas). Por lo tanto, debemos asegurarnos de que la variable dependiente es continua y numérica. Además, es importante conocer el tipo de variable independiente y comprobar que su tipo es coherente con su formato de codificación (es decir, si tenemos una variable independiente de “rangos de edad”, la variable debe ser categórica o factorial, no numérica), para que nuestras interpretaciones de los resultados sean correctas. Los problemas con el formato de codificación son muy comunes, ¡ten cuidado!</p></li>
<li><p>Identificar los valores perdidos: si nuestras variables tienen demasiados valores perdidos, debemos comprobar dónde están (en qué variables, para cuales observaciones) y, eventualmente, decidir si una imputación es deseable y posible (como se explica en el capítulo <a href="adv-data.html#adv-data">11</a>).</p></li>
</ol>
</div>
<div id="estadísticas-descriptivas-y-distribución-de-las-variables-en-el-modelo" class="section level3">
<h3><span class="header-section-number">5.1.2</span> Estadísticas descriptivas y distribución de las variables en el modelo</h3>
<p>Una visualización inicial de nuestras variables de interés se puede hacer utilizando el comando <code>skimr::skim()</code> que nos da una idea de las variables (Figura <a href="linear.html#fig:skim-linear">5.1</a>):</p>
<div class="figure" style="text-align: center"><span id="fig:skim-linear"></span>
<img src="00-images/linear/skim_linear.png" alt="Skim de nuestra base de datos" width="100%" />
<p class="caption">
Figura 5.1: Skim de nuestra base de datos
</p>
</div>
<p>Notarás que los resultados están ordenados por el tipo de variable, e indica el número de valores perdidos de cada una de ellas, su respectiva media, su desviación estándar, los valores correspondientes de los percentiles y un pequeño histograma que muestra cómo está distribuida la variable.</p>
</div>
<div id="matriz-de-correlación-de-variables-independientes" class="section level3">
<h3><span class="header-section-number">5.1.3</span> Matriz de correlación de variables independientes</h3>
<p>Después de identificar todas las variables que incorporaremos al modelo, se recomienda observar cómo se relacionan entre sí. Para ello, crearemos una matriz de correlación de las variables independientes con el comando <code>ggcorrplot()</code> del paquete homónimo, con la que podremos evaluar la correlación de Pearson entre todas las variables.</p>
<p>De todas formas, es importante recordar que <strong>la correlación no implica causalidad</strong>. Aquí, simplemente queremos entender si las variables del modelo están relacionadas de cierta manera. Este paso no sólo es importante para reconocer nuestros datos y variables, sino también porque queremos evitar tener multicolinealidad perfecta (que haya variables independientes que estén perfectamente correlacionadas) en nuestro modelo, ya que ésta es una suposición central de el MCO.</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="linear.html#cb152-1"></a><span class="kw">library</span>(ggcorrplot)</span>
<span id="cb152-2"><a href="linear.html#cb152-2"></a></span>
<span id="cb152-3"><a href="linear.html#cb152-3"></a>corr_selected &lt;-<span class="st"> </span>bienestar <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb152-4"><a href="linear.html#cb152-4"></a><span class="st">  </span><span class="kw">select</span>(gini, gasto_educ, dualismo_sectorial, inversion_extranjera, pib, </span>
<span id="cb152-5"><a href="linear.html#cb152-5"></a>         diversidad_etnica, tipo_regimen, gasto_salud, gasto_segsocial,</span>
<span id="cb152-6"><a href="linear.html#cb152-6"></a>         bal_legislativo, poblacion) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb152-7"><a href="linear.html#cb152-7"></a><span class="st">  </span><span class="co"># calcular la matriz de correlación y redondear a un decimal</span></span>
<span id="cb152-8"><a href="linear.html#cb152-8"></a><span class="st">  </span><span class="kw">cor</span>(<span class="dt">use =</span> <span class="st">&quot;pairwise&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb152-9"><a href="linear.html#cb152-9"></a><span class="st">  </span><span class="kw">round</span>(<span class="dv">1</span>)</span>
<span id="cb152-10"><a href="linear.html#cb152-10"></a></span>
<span id="cb152-11"><a href="linear.html#cb152-11"></a><span class="kw">ggcorrplot</span>(corr_selected, <span class="dt">type =</span> <span class="st">&quot;lower&quot;</span>, <span class="dt">lab =</span> T, <span class="dt">show.legend =</span> F)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-4"></span>
<img src="05-linear_es_files/figure-html/unnamed-chunk-4-1.png" alt="Matriz de correlación entre las variables seleccionadas" width="100%" />
<p class="caption">
Figura 3.3: Matriz de correlación entre las variables seleccionadas
</p>
</div>
<p>Ahora que conocemos todas las variables que se incorporarán al modelo, y cómo se correlacionan entre sí, profundizaremos en las variables clave de interés: las dependientes y las independientes.</p>
</div>
<div id="distribución-de-las-variables-de-interés" class="section level3">
<h3><span class="header-section-number">5.1.4</span> Distribución de las variables de interés</h3>
<p>Como hemos mencionado anteriormente, queremos estimar cómo el cambio de una variable independiente (su variación) afecta a la variación de una variable dependiente. Es decir, cómo cambia <span class="math inline">\(y\)</span> cuando cambia <span class="math inline">\(x\)</span>. En este caso, supongamos que nos interesa estimar cómo varían los niveles de desigualdad de un país (medidos como el porcentaje del PIB asignado al presupuesto de educación). Así, nuestra variable de interés independiente es el gasto en educación, mientras que la variable dependiente es la desigualdad.</p>
<p>Observemos cómo se distribuyen estas variables en nuestra base de datos:</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="linear.html#cb153-1"></a><span class="kw">ggplot</span>(bienestar, <span class="kw">aes</span>(<span class="dt">x =</span> gini, <span class="dt">na.rm =</span> T)) <span class="op">+</span></span>
<span id="cb153-2"><a href="linear.html#cb153-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb153-3"><a href="linear.html#cb153-3"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Gini Index&quot;</span>, <span class="dt">y =</span> <span class="st">&quot; Frecuencia&quot;</span>,</span>
<span id="cb153-4"><a href="linear.html#cb153-4"></a>       <span class="dt">title =</span> <span class="st">&quot; Distribución de la variable dependiente&quot;</span>,</span>
<span id="cb153-5"><a href="linear.html#cb153-5"></a>       <span class="dt">caption =</span> <span class="st">&quot;Fuente: Huber et al (2012)&quot;</span>)</span>
<span id="cb153-6"><a href="linear.html#cb153-6"></a><span class="co">## Warning: Removed 649 rows containing non-finite values (stat_bin).</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:hist1"></span>
<img src="05-linear_es_files/figure-html/hist1-1.png" alt=" Histograma de nuestra variable dependiente" width="70%" />
<p class="caption">
Figura 5.2:  Histograma de nuestra variable dependiente
</p>
</div>
<p>La variable independiente: Gasto en educación (% del PIB)</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="linear.html#cb154-1"></a><span class="kw">ggplot</span>(bienestar, <span class="kw">aes</span>(<span class="dt">x =</span> gasto_educ, <span class="dt">na.rm =</span> T))<span class="op">+</span></span>
<span id="cb154-2"><a href="linear.html#cb154-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb154-3"><a href="linear.html#cb154-3"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">caption =</span> <span class="st">&quot;Fuente: Huber et al (2012))&quot;</span>,</span>
<span id="cb154-4"><a href="linear.html#cb154-4"></a>       <span class="dt">x =</span> <span class="st">&quot;Gasto en educacion&quot;</span>,</span>
<span id="cb154-5"><a href="linear.html#cb154-5"></a>       <span class="dt">y =</span> <span class="st">&quot;Frecuencia&quot;</span>)</span>
<span id="cb154-6"><a href="linear.html#cb154-6"></a><span class="co">## Warning: Removed 325 rows containing non-finite values (stat_bin).</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:hist2"></span>
<img src="05-linear_es_files/figure-html/hist2-1.png" alt=" Histograma de nuestra variable independiente: Gasto en educación como porcentaje del PIB " width="70%" />
<p class="caption">
Figura 5.3:  Histograma de nuestra variable independiente: Gasto en educación como porcentaje del PIB
</p>
</div>
</div>
<div id="relación-entre-la-variable-dependiente-e-independiente" class="section level3">
<h3><span class="header-section-number">5.1.5</span> Relación entre la variable dependiente e independiente</h3>
<p>Después de observar cómo se distribuyen las variables de interés, podemos ver gráficamente cómo se relacionan. Es decir, graficamos la correlación entre estas dos variables: en el eje <span class="math inline">\(x\)</span> (horizontal) ubicamos la variable independiente, mientras que en el eje <span class="math inline">\(y\)</span> (vertical) la variable dependiente. Como resultado, cada “punto” de la Figura <a href="linear.html#fig:scatter1">5.4</a> representa una observación de nuestra muestra con un valor particular del gasto en educación (<span class="math inline">\(x\)</span>) y un valor particular en el índice de Gini (<span class="math inline">\(y\)</span>).</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="linear.html#cb155-1"></a><span class="kw">ggplot</span>(bienestar, <span class="kw">aes</span>(gasto_educ, gini)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb155-2"><a href="linear.html#cb155-2"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb155-3"><a href="linear.html#cb155-3"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot; Gasto en educación (% del PIB)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Gini&quot;</span>, </span>
<span id="cb155-4"><a href="linear.html#cb155-4"></a>       <span class="dt">caption =</span> <span class="st">&quot;Fuente: Huber and Stephens, 2012&quot;</span>)</span>
<span id="cb155-5"><a href="linear.html#cb155-5"></a><span class="co">## Warning: Removed 718 rows containing missing values (geom_point).</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:scatter1"></span>
<img src="05-linear_es_files/figure-html/scatter1-1.png" alt="Scatter plot del gasto en educación y el índice de Gini" width="70%" />
<p class="caption">
Figura 5.4: Scatter plot del gasto en educación y el índice de Gini
</p>
</div>
<p>Esta es una primera visualización de la relación entre nuestras variables que nos permite observar si hay algún tipo de relación entre ellas. Aquí vemos claramente una relación positiva (cuanto más alto es el gasto en educación, más alto es el Gini). De todos modos, hasta ahora no podemos decir nada concluyente sobre el efecto del gasto en educación en los niveles de desigualdad. Para ello es necesario estimar un modelo. Hasta ahora sólo hemos explorado nuestros datos. ¡Pasemos a las regresiones!</p>
<blockquote>
<p><strong>Ejercicio 5A.</strong> Imagina que ahora estamos interesados en el efecto de la Inversión Extranjera Directa <code>inversion_extranjera</code> en la desigualdad económica (Gini). Analiza la distribución de esta variable y haga un gráfico para evaluar la relación entre esta variable y nuestra variable independiente (<code>gini</code>), ¿Hay algún signo de correlación entre las variables? ¿Cuál es la dirección (positiva/negativa) de la relación?</p>
</blockquote>
</div>
</div>
<div id="modelo-bivariado-regresión-lineal-simple" class="section level2">
<h2><span class="header-section-number">5.2</span> Modelo bivariado: regresión lineal simple</h2>
<p>El modelo lineal simple asume que una variable de respuesta aleatoria <span class="math inline">\(y\)</span> es una función lineal de una variable independiente <span class="math inline">\(x\)</span> más un término de error <span class="math inline">\(u\)</span>. También decimos que la variable dependiente <span class="math inline">\(y\)</span> es el resultado de un proceso de generación de datos (DGP, por sus siglas en inglés) que puede escribirse como
<span class="math display">\[ Y = \beta_0 + \beta_1x + u  \]</span></p>
<p>Así, el modelo lineal implica definir que <span class="math inline">\(Y\)</span> es generado por una función lineal de <span class="math inline">\(x_1\)</span>, además de un término constante <span class="math inline">\(\beta_0\)</span> y la variable <span class="math inline">\(u\)</span> no observada.</p>
<p>Otros dos supuestos son necesarios para derivar los estimadores del MCO. La primera se refiere a la expectativa de que <span class="math inline">\(u\)</span> sea igual a 0 <span class="math display">\[E(u)=0\]</span>
Esto implica que, a nivel de población, todos los factores no observados tienen un promedio de cero. La suposición más importante es que el promedio de <span class="math inline">\(u\)</span> cada valor de <span class="math inline">\(x\)</span> es cero: <span class="math display">\[E(u|x)=0\]</span></p>
<p>Esta suposición se conoce en la literatura econométrica como la media condicional cero, o independencia condicional. En la literatura experimentalista, se conoce como exogeneidad de <span class="math inline">\(x\)</span>, o que <span class="math inline">\(x\)</span> y <span class="math inline">\(u\)</span> son ortogonales. Todos estos términos implican la suposición de que, para cada valor de la variable independiente de interés <span class="math inline">\(x\)</span>, los factores no observados promediarán cero. En otras palabras, si la expectativa de los no observados es cero para cada valor <span class="math inline">\(x\)</span>, el valor esperado de <span class="math inline">\(Y\)</span> sólo depende de <span class="math inline">\(x\)</span> y de la constante. Cuando se cumplen estas suposiciones, podemos identificar el efecto de <span class="math inline">\(x\)</span> en <span class="math inline">\(y\)</span>, manteniendo todo lo demás constante. Además, cuando <span class="math inline">\(E(u|x) = 0\)</span>, también es cierto que
<span class="math display">\[cov(x,u) = 0\]</span></p>
<p>En resumen, bajo el supuesto de independencia condicional, <span class="math inline">\(x\)</span> y <span class="math inline">\(y\)</span> no se correlacionan y esto permite derivar los estimadores del MCO a través de las <em>condiciones de primer orden</em>. Las dos primeras condiciones de orden son que <span class="math display">\[E(u)=0\]</span> y <span class="math display">\[E(u|x)=0\]</span></p>
<p>Entender que estas son las condiciones que permiten derivar el <em>estimador</em> de MCO es clave para entender por qué no podemos probar la independencia del error a partir de una estimación. Esto significa que, por construcción, los residuos (<span class="math inline">\(\hat{u}\)</span>) de la regresión siempre promediarán cero en la muestra y en cada valor de <span class="math inline">\(x\)</span>. Exigir exogeneidad implica poder argumentar que <span class="math inline">\(u\)</span> es efectivamente ortogonal a los <span class="math inline">\(x\)</span>, algo más creíble para los experimentos y cuasi-experimentos que los datos de observación <span class="citation">(mira Gerber and Green <a href="referencias.html#ref-gerberFieldExperimentsDesign2012" role="doc-biblioref">2012</a>; Dunning <a href="referencias.html#ref-dunningNaturalExperimentsSocial2012" role="doc-biblioref">2012</a>)</span></p>
<div id="la-función-lm" class="section level3">
<h3><span class="header-section-number">5.2.1</span> La función <code>lm</code></h3>
<p>La función <code>lm</code> que forma parte de la base R es la principal herramienta para la estimación de los modelos lineales. La forma general que toma la función es</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="linear.html#cb156-1"></a><span class="kw">lm</span>(Y <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>X)</span></code></pre></div>
<p>A partir de la cual se entiende que un <em>modelo lineal</em> (lm, por sus siglas en inglés) se estima para una variable dependiente Y regresada (~) en una variable independiente X. El “1” no suele incluirse, pero lo añadimos para denotar la intercepción (<span class="math inline">\(\beta_0\)</span>). Basándonos en la investigación de <span class="citation">Huber et al. (<a href="referencias.html#ref-huberPoliticsInequalityLatin2006" role="doc-biblioref">2006</a>)</span>, nuestro modelo plantea que la desigualdad es una función lineal del gasto en educación, además de un término de error no observado <span class="math inline">\(u\)</span> y una constante <span class="math inline">\(\beta_0\)</span>.
Formalmente:
<span class="math display">\[ Desigualdad = \beta_0 + \beta_1 GastoEducacional + u \]</span></p>
<p>Por el momento, asumiremos que la base de datos contiene 1074 observaciones independientes.<a href="#fn25" class="footnote-ref" id="fnref25"><sup>25</sup></a>. El supuesto de observaciones independientes y distribuidas de forma idéntica es lo que nos permite escribir el modelo para un individuo de <span class="math inline">\(i\)</span> escogido al azar como <span class="math display">\[Desigualdad_i= \beta_0 + \beta_1GastoEducacional_i + u_i\]</span></p>
<p>Recuerda que la variable dependiente “Desigualdad” se representa con el índice de Gini y que el nombre de la variable es <code>gini</code>, mientras que la variable independiente “Gasto en educación” es <code>gasto_educ</code>. Dado que los datos se almacenan en un data.frame, necesitamos indicar su nombre en la función para traer los datos de la base de datos correspondiente. Eso es lo que ocurre después de la coma en el siguiente comando</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="linear.html#cb157-1"></a>model_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">lm</span>(gini <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>gasto_educ, <span class="dt">data =</span> bienestar) <span class="co"># después de la coma indicamos el data.frame que contiene los datos</span></span>
<span id="cb157-2"><a href="linear.html#cb157-2"></a></span>
<span id="cb157-3"><a href="linear.html#cb157-3"></a><span class="kw">class</span>(model_<span class="dv">1</span>) <span class="co"># verificamos que la clase de objeto es &quot;lm&quot;</span></span>
<span id="cb157-4"><a href="linear.html#cb157-4"></a><span class="co">## [1] &quot;lm&quot;</span></span></code></pre></div>
<p>En la primera línea de código creamos un objeto (<code>model_1</code>) que guarda los resultados de la función <code>lm</code>. Esta función crea objetos de clase <code>lm</code>, que son vectores que incluyen los coeficientes estimados, los errores estándar, los residuos, los valores predichos, entre otros resultados de la estimación. Para ver los componentes del objeto, una forma rápida de hacerlo es usar la función <code>summary</code>.</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="linear.html#cb158-1"></a><span class="kw">summary</span>( model_<span class="dv">1</span>)</span>
<span id="cb158-2"><a href="linear.html#cb158-2"></a><span class="co">## </span></span>
<span id="cb158-3"><a href="linear.html#cb158-3"></a><span class="co">## Call:</span></span>
<span id="cb158-4"><a href="linear.html#cb158-4"></a><span class="co">## lm(formula = gini ~ 1 + gasto_educ, data = bienestar)</span></span>
<span id="cb158-5"><a href="linear.html#cb158-5"></a><span class="co">## </span></span>
<span id="cb158-6"><a href="linear.html#cb158-6"></a><span class="co">## Residuals:</span></span>
<span id="cb158-7"><a href="linear.html#cb158-7"></a><span class="co">##    Min     1Q Median     3Q    Max </span></span>
<span id="cb158-8"><a href="linear.html#cb158-8"></a><span class="co">## -20.04  -5.62   1.09   4.99  15.57 </span></span>
<span id="cb158-9"><a href="linear.html#cb158-9"></a><span class="co">## </span></span>
<span id="cb158-10"><a href="linear.html#cb158-10"></a><span class="co">## Coefficients:</span></span>
<span id="cb158-11"><a href="linear.html#cb158-11"></a><span class="co">##             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb158-12"><a href="linear.html#cb158-12"></a><span class="co">## (Intercept)    44.80       1.02   43.80  &lt; 2e-16 ***</span></span>
<span id="cb158-13"><a href="linear.html#cb158-13"></a><span class="co">## gasto_educ      1.23       0.25    4.93  1.3e-06 ***</span></span>
<span id="cb158-14"><a href="linear.html#cb158-14"></a><span class="co">## ---</span></span>
<span id="cb158-15"><a href="linear.html#cb158-15"></a><span class="co">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb158-16"><a href="linear.html#cb158-16"></a><span class="co">## </span></span>
<span id="cb158-17"><a href="linear.html#cb158-17"></a><span class="co">## Residual standard error: 6.7 on 354 degrees of freedom</span></span>
<span id="cb158-18"><a href="linear.html#cb158-18"></a><span class="co">##   (718 observations deleted due to missingness)</span></span>
<span id="cb158-19"><a href="linear.html#cb158-19"></a><span class="co">## Multiple R-squared:  0.0642, Adjusted R-squared:  0.0615 </span></span>
<span id="cb158-20"><a href="linear.html#cb158-20"></a><span class="co">## F-statistic: 24.3 on 1 and 354 DF,  p-value: 1.29e-06</span></span></code></pre></div>
<p>Se pueden lograr presentaciones más elegantes con la función <code>screenreg</code> del paquete <code>texreg</code>. Esto se utilizará en todos los capítulos de los modelos econométricos. Veamos la presentación de los resultados con la función <code>screenreg</code></p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="linear.html#cb159-1"></a><span class="kw">library</span>(texreg)</span>
<span id="cb159-2"><a href="linear.html#cb159-2"></a><span class="kw">screenreg</span>(model_<span class="dv">1</span>)</span>
<span id="cb159-3"><a href="linear.html#cb159-3"></a><span class="co">## </span></span>
<span id="cb159-4"><a href="linear.html#cb159-4"></a><span class="co">## =======================</span></span>
<span id="cb159-5"><a href="linear.html#cb159-5"></a><span class="co">##              Model 1   </span></span>
<span id="cb159-6"><a href="linear.html#cb159-6"></a><span class="co">## -----------------------</span></span>
<span id="cb159-7"><a href="linear.html#cb159-7"></a><span class="co">## (Intercept)   44.81 ***</span></span>
<span id="cb159-8"><a href="linear.html#cb159-8"></a><span class="co">##               (1.02)   </span></span>
<span id="cb159-9"><a href="linear.html#cb159-9"></a><span class="co">## gasto_educ     1.23 ***</span></span>
<span id="cb159-10"><a href="linear.html#cb159-10"></a><span class="co">##               (0.25)   </span></span>
<span id="cb159-11"><a href="linear.html#cb159-11"></a><span class="co">## -----------------------</span></span>
<span id="cb159-12"><a href="linear.html#cb159-12"></a><span class="co">## R^2            0.06    </span></span>
<span id="cb159-13"><a href="linear.html#cb159-13"></a><span class="co">## Adj. R^2       0.06    </span></span>
<span id="cb159-14"><a href="linear.html#cb159-14"></a><span class="co">## Num. obs.    356       </span></span>
<span id="cb159-15"><a href="linear.html#cb159-15"></a><span class="co">## =======================</span></span>
<span id="cb159-16"><a href="linear.html#cb159-16"></a><span class="co">## *** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</span></span></code></pre></div>
<p>Podemos agregar nombres a las variables con <code>custom.coef.names</code></p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="linear.html#cb160-1"></a><span class="kw">library</span>(texreg)</span>
<span id="cb160-2"><a href="linear.html#cb160-2"></a><span class="kw">screenreg</span>(model_<span class="dv">1</span>, </span>
<span id="cb160-3"><a href="linear.html#cb160-3"></a>          <span class="dt">custom.model.names =</span> <span class="st">&quot;Modelo 1&quot;</span>,  </span>
<span id="cb160-4"><a href="linear.html#cb160-4"></a>          <span class="dt">custom.coef.names =</span> <span class="kw">c</span>(<span class="st">&quot;Constante&quot;</span>, <span class="st">&quot;Gasto en educación&quot;))</span></span>
<span id="cb160-5"><a href="linear.html#cb160-5"></a><span class="st">## </span></span>
<span id="cb160-6"><a href="linear.html#cb160-6"></a><span class="st">## ==============================</span></span>
<span id="cb160-7"><a href="linear.html#cb160-7"></a><span class="st">##                     Modelo 1  </span></span>
<span id="cb160-8"><a href="linear.html#cb160-8"></a><span class="st">## ------------------------------</span></span>
<span id="cb160-9"><a href="linear.html#cb160-9"></a><span class="st">## Constante            44.81 ***</span></span>
<span id="cb160-10"><a href="linear.html#cb160-10"></a><span class="st">##                      (1.02)   </span></span>
<span id="cb160-11"><a href="linear.html#cb160-11"></a><span class="st">## Gasto en educación    1.23 ***</span></span>
<span id="cb160-12"><a href="linear.html#cb160-12"></a><span class="st">##                      (0.25)   </span></span>
<span id="cb160-13"><a href="linear.html#cb160-13"></a><span class="st">## ------------------------------</span></span>
<span id="cb160-14"><a href="linear.html#cb160-14"></a><span class="st">## R^2                   0.06    </span></span>
<span id="cb160-15"><a href="linear.html#cb160-15"></a><span class="st">## Adj. R^2              0.06    </span></span>
<span id="cb160-16"><a href="linear.html#cb160-16"></a><span class="st">## Num. obs.           356       </span></span>
<span id="cb160-17"><a href="linear.html#cb160-17"></a><span class="st">## ==============================</span></span>
<span id="cb160-18"><a href="linear.html#cb160-18"></a><span class="st">## *** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</span></span></code></pre></div>
<p>Y podemos exportar la tabla en formato .doc para añadirla a nuestro manuscrito. El archivo se guardará en nuestra carpeta de trabajo.</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="linear.html#cb161-1"></a><span class="kw">htmlreg</span>(<span class="kw">list</span>(model_<span class="dv">1</span>), <span class="dt">file =</span> <span class="st">&quot;modelo_1.doc&quot;</span>, </span>
<span id="cb161-2"><a href="linear.html#cb161-2"></a>        <span class="dt">custom.model.names =</span> <span class="st">&quot;Modelo 1&quot;</span>,  </span>
<span id="cb161-3"><a href="linear.html#cb161-3"></a>        <span class="dt">custom.coef.names =</span> <span class="kw">c</span>(<span class="st">&quot;Constante&quot;</span>, <span class="st">&quot;Gasto en educación&quot;),</span></span>
<span id="cb161-4"><a href="linear.html#cb161-4"></a><span class="st">        inline.css = FALSE, doctype = T, html.tag = T, </span></span>
<span id="cb161-5"><a href="linear.html#cb161-5"></a><span class="st">        head.tag = T, body.tag = T)</span></span></code></pre></div>
<p>Como puedes notar, los resultados se muestran mejor con <code>texreg</code> que con <code>summary()</code>. Se ve claramente que <code>gasto_educ</code> –el gasto en educación– tiene un efecto positivo de magnitud 1.233. En particular, cuando el gasto en educación como porcentaje del PIB aumenta en una unidad, la desigualdad aumenta en 1,23%. El efecto del gasto en educación es significativo con un nivel de confianza del 99,9%. Lo sabemos porque además del coeficiente aparecen tres estrellas que se refieren a un nivel de significación del 0,01%.
La significancia estadística es el resultado de un test-t. Esta prueba indica la distancia estandarizada, donde la beta estimada se encuentra en la distribución bajo la hipótesis nula de que <span class="math inline">\(\beta_1=0\)</span>. El estimador tiene una distribución t-Student con grados de libertad iguales a <span class="math inline">\(n-k-1\)</span>, donde <span class="math inline">\(k\)</span> es el número de variables independientes y se suma 1 para la estimación de la constante <span class="math inline">\(\beta_0\)</span>. Una aproximación manual de la distancia beta estimada en la distribución del estimador bajo la hipótesis nula <span class="math inline">\(\beta_1=0\)</span> se obtiene cuando dividimos la estimación por su error estándar:</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="linear.html#cb162-1"></a><span class="fl">1.233</span> <span class="op">/</span><span class="st"> </span><span class="fl">0.25</span></span>
<span id="cb162-2"><a href="linear.html#cb162-2"></a><span class="co">## [1] 4.9</span></span></code></pre></div>
<p>El mismo valor es entregado por la tercera columna de la sección “Coeficientes” en el <code>summary()</code> del <em>modelo_1</em>. El valor t siempre se interpreta como la distancia de la estimación <span class="math inline">\(\hat\beta_1\)</span> de la media de la distribución del estimador bajo <span class="math inline">\(H_0 = \beta_1 = 0\)</span>. En este caso, el valor 1,233 está a 4,93 desviaciones estándar de la distribución del estimador cuando H0 es verdadero (la media de la distribución es 0).</p>
<p>Dado que las distribuciones t se superponen a la distribución normal a medida que aumentan los grados de libertad, y sabemos que aproximadamente hasta 2 desviaciones estándar el 95% de la probabilidad se encuentra en una distribución normal, podemos afirmar que la probabilidad de observar nuestra estimación, si H0 es verdadera, es menor de 0,05 cuando la estadística-t supera el valor de 2. Cuando esto ocurre, rechazamos la hipótesis nula con un nivel de confianza del 95%.</p>
<p>En este caso, la estimación de <span class="math inline">\(\hat\beta_1\)</span> es más de 4,93 desviaciones estándar de la media de la distribución bajo <span class="math inline">\(H_0=\beta_1=0\)</span>, por lo que es poco probable que se haya observado un efecto de 1,23 si <span class="math inline">\(H_0\)</span> fuera cierto. La probabilidad precisa se puede observar en la cuarta columna del modelo <code>summary</code>, que se puede solicitar a R con el siguiente comando.</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="linear.html#cb163-1"></a><span class="kw">coef</span>(<span class="kw">summary</span>(model_<span class="dv">1</span>))[, <span class="st">&quot;Pr(&gt;|t|)&quot;</span>]</span>
<span id="cb163-2"><a href="linear.html#cb163-2"></a><span class="co">## (Intercept)  gasto_educ </span></span>
<span id="cb163-3"><a href="linear.html#cb163-3"></a><span class="co">##    5.5e-145     1.3e-06</span></span></code></pre></div>
<p>La probabilidad de observar una estimación de 1,23 si el H0 fuera cierto es de 0,00000128. Por lo tanto, podemos rechazar H0 incluso con un nivel de confianza del 99,9%.</p>
<blockquote>
<p><strong>Ejercicio 5B.</strong> Utilizando los mismos datos, estima un modelo donde la variable independiente es Inversión Extranjera Directa (<code>inversion_extranjera</code>) y la variable dependiente es Desigualdad (<code>gini</code>) y exportarlo a un archivo .doc. ¿Es el efecto estadísticamente significativo?</p>
</blockquote>
</div>
<div id="representación-gráfica" class="section level3">
<h3><span class="header-section-number">5.2.2</span> Representación gráfica</h3>
<p>Como vimos anteriormente, una de las formas más fáciles de presentar la relación entre dos variables es a través de gráficos. Ya se ha dicho que <code>ggplot2</code> es una herramienta conveniente para generar varios tipos de gráficos. Exploremos su uso para MCO. En el primer código, todas las observaciones se grafican según sus valores de variables independientes y dependientes.</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="linear.html#cb164-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> bienestar, <span class="co"># seleccionamos la base de datos</span></span>
<span id="cb164-2"><a href="linear.html#cb164-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> gasto_educ, <span class="dt">y =</span> gini))<span class="op">+</span><span class="st"> </span><span class="co"># variables independientes y dependientes</span></span>
<span id="cb164-3"><a href="linear.html#cb164-3"></a><span class="st">       </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="co"># los valores observados son graficados</span></span>
<span id="cb164-4"><a href="linear.html#cb164-4"></a><span class="st">       </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="co"># La línea de regresión se superpone</span></span>
<span id="cb164-5"><a href="linear.html#cb164-5"></a>                   <span class="dt">se =</span> F, <span class="co"># el área de error no se grafica con un IC del 95%</span></span>
<span id="cb164-6"><a href="linear.html#cb164-6"></a>                   <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>)<span class="op">+</span><span class="st"> </span><span class="co"># color de la línea</span></span>
<span id="cb164-7"><a href="linear.html#cb164-7"></a><span class="st">       </span><span class="kw">labs</span> (<span class="dt">x =</span> <span class="st">&quot;Gasto en educación&quot;, y = &quot;</span>Desigualdad<span class="st">&quot;)</span></span>
<span id="cb164-8"><a href="linear.html#cb164-8"></a><span class="st">## Warning: Removed 718 rows containing non-finite values (stat_smooth).</span></span>
<span id="cb164-9"><a href="linear.html#cb164-9"></a><span class="st">## Warning: Removed 718 rows containing missing values (geom_point).</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:scatter2"></span>
<img src="05-linear_es_files/figure-html/scatter2-1.png" alt=" Ajuste lineal entre el gasto en educación y la desigualdad " width="80%" />
<p class="caption">
Figura 5.5:  Ajuste lineal entre el gasto en educación y la desigualdad
</p>
</div>
<p>Por lo general, también es útil mostrar una representación gráfica del error de predicción de la línea. <code>ggplot2</code> nos permite editar un área sombreada donde los valores predichos con un cierto nivel de significación podrían haber sido localizados. Aunque el 95% de confianza es el valor por defecto, también podemos editar ese valor. El primer bloque muestra la línea de regresión y su error para un nivel de significancia estadística del 95%. Ten en cuenta que esta línea no representará el coeficiente que obtuviste a través de <code>lm</code> después de incluir controles a tu regresión.</p>

<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="linear.html#cb165-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> bienestar, <span class="kw">aes</span>(<span class="dt">x =</span> gasto_educ, <span class="dt">y =</span> gini))<span class="op">+</span><span class="st"> </span></span>
<span id="cb165-2"><a href="linear.html#cb165-2"></a><span class="st">       </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb165-3"><a href="linear.html#cb165-3"></a><span class="st">       </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb165-4"><a href="linear.html#cb165-4"></a>                   <span class="dt">se =</span> T) <span class="op">+</span><span class="st"> </span><span class="co"># añadimos la predicción </span></span>
<span id="cb165-5"><a href="linear.html#cb165-5"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Gasto en educación&quot;, y = &quot;</span>Desigualdad<span class="st">&quot;,</span></span>
<span id="cb165-6"><a href="linear.html#cb165-6"></a><span class="st">       title = &quot;</span> Ajuste lineal entre el gasto en educación y la desigualdad<span class="st">&quot;) </span></span>
<span id="cb165-7"><a href="linear.html#cb165-7"></a><span class="st">## Warning: Removed 718 rows containing non-finite values (stat_smooth).</span></span>
<span id="cb165-8"><a href="linear.html#cb165-8"></a><span class="st">## Warning: Removed 718 rows containing missing values (geom_point).</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:scatter3"></span>
<img src="05-linear_es_files/figure-html/scatter3-1.png" alt="Ajuste lineal en el que añadimos un intervalo de confianza del 95%." width="100%" />
<p class="caption">
Figura 5.6: Ajuste lineal en el que añadimos un intervalo de confianza del 95%.
</p>
</div>
</div>
</div>
<div id="modelo-multivariado-regresión-múltiple" class="section level2">
<h2><span class="header-section-number">5.3</span> Modelo multivariado: regresión múltiple</h2>
<p>Aunque tendemos a interesarnos por el efecto de una sola variable independiente sobre una dependiente, es común estimar modelos en los que <span class="math inline">\(Y\)</span> es tanto el resultado de una variable independiente de interés como de un conjunto de variables de control. Formalmente,</p>
<p><span class="math display">\[Y= \beta_0+\beta_1x_{1}+\beta_1x_{2}+...+\beta_jx_{j}+u\]</span></p>
<p>En contraste con una simple regresión, ahora la variable aleatoria <span class="math inline">\(Y\)</span> es una función de múltiples variables más un término de error <span class="math inline">\(u\)</span>. Como en las regresiones simples, la expectativa del error condicional en los valores de <span class="math inline">\(x_j\)</span> tiene que ser igual a cero. Formalmente, <span class="math inline">\(E(u|x_1, x_2, ..., x_j)=0\)</span>.
Para estimar un modelo lineal múltiple no sesgado, la suposición de una media condicional cero no es el único requisito, pero todas las suposiciones necesarias se presentarán en una sección posterior.</p>
<p>Por el momento, estimaremos un modelo de población en el que la desigualdad social (<code>gini</code>) es una función lineal del gasto en educación como porcentaje del PIB (<code>gasto_educ</code>), de la inversión extranjera directa (<code>inversion_extranjera</code>), del gasto en salud como porcentaje del PIB (<code>gasto_salud</code>), del gasto en seguridad social como porcentaje del PIB. (<code>gasto_segsocial</code>), de la población joven (<code>poblacion</code>), del dualismo estructural de la economía (<code>s_dualismo</code>), de la división étnica (<code>diversidad_etnica</code>), del PIB real per cápita (<code>pib</code>), del tipo de régimen (<code>tipo_regimen</code>), y del equilibrio entre los poderes del Estado (<code>bal_legislativo</code>).</p>
<p>Como puede verse, se han añadido diversas variables que se sospecha que predicen la desigualdad <span class="citation">(Huber et al. <a href="referencias.html#ref-huberPoliticsInequalityLatin2006" role="doc-biblioref">2006</a>)</span>. El análisis de regresión múltiple nos permitirá estimar hasta qué punto nuestro modelo es correcto. La función <code>lm</code> también estima múltiples modelos, y la única diferencia es que las variables independientes deben ser añadidas. Antes de estimar el modelo, filtraremos la base de datos eliminando todos los casos con valores perdidos (NA)<a href="#fn26" class="footnote-ref" id="fnref26"><sup>26</sup></a>. Aquí, por motivos prácticos, sólo consideraremos aquellos casos (país-año) que estén completos en todas las variables de nuestro modelo, eliminando los valores perdidos.<a href="#fn27" class="footnote-ref" id="fnref27"><sup>27</sup></a>:</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="linear.html#cb166-1"></a>bienestar_no_na &lt;-<span class="st"> </span>bienestar <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb166-2"><a href="linear.html#cb166-2"></a><span class="st">  </span><span class="kw">drop_na</span>(gini, gasto_educ , inversion_extranjera , gasto_salud , gasto_segsocial , poblacion, </span>
<span id="cb166-3"><a href="linear.html#cb166-3"></a>          dualismo_sectorial, diversidad_etnica, pib, tipo_regimen, bal_legislativo)</span></code></pre></div>
<p>Ahora podemos estimar el modelo 2:</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="linear.html#cb167-1"></a>model_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">lm</span>(gini <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>gasto_educ <span class="op">+</span><span class="st"> </span>inversion_extranjera <span class="op">+</span><span class="st"> </span>gasto_salud <span class="op">+</span><span class="st"> </span>gasto_segsocial <span class="op">+</span><span class="st"> </span></span>
<span id="cb167-2"><a href="linear.html#cb167-2"></a><span class="st">                </span>poblacion <span class="op">+</span><span class="st"> </span>dualismo_sectorial <span class="op">+</span><span class="st"> </span>diversidad_etnica <span class="op">+</span><span class="st"> </span>pib <span class="op">+</span><span class="st"> </span></span>
<span id="cb167-3"><a href="linear.html#cb167-3"></a><span class="st">                </span><span class="kw">factor</span>(tipo_regimen) <span class="op">+</span><span class="st"> </span>bal_legislativo,</span>
<span id="cb167-4"><a href="linear.html#cb167-4"></a>              <span class="dt">data =</span> bienestar_no_na)</span></code></pre></div>
<blockquote>
<p>Nota: Hemos indicado que la variable <code>tipo_regimen</code> es categórica a través de <code>as.factor</code>. Al hacer esto, cada categoría de régimen se mide por un coeficiente <code>dummy</code>.</p>
</blockquote>
<blockquote>
<p><strong>Ejercicio 5C.</strong> Recuerda: incluir el 1 no es necesario para estimar el modelo (lo colocamos ahí sólo para recordarte que también estamos estimando la intercepción). Intente probar el modelo sin él, y verá que los resultados no cambian.</p>
</blockquote>
<p>Como en el modelo simple, podemos mostrar y graficar los resultados de la estimación con <code>summary()</code> o <code>screenreg()</code>.</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="linear.html#cb168-1"></a><span class="kw">screenreg</span>(model_<span class="dv">2</span>)</span>
<span id="cb168-2"><a href="linear.html#cb168-2"></a><span class="co">## </span></span>
<span id="cb168-3"><a href="linear.html#cb168-3"></a><span class="co">## =================================</span></span>
<span id="cb168-4"><a href="linear.html#cb168-4"></a><span class="co">##                        Model 1   </span></span>
<span id="cb168-5"><a href="linear.html#cb168-5"></a><span class="co">## ---------------------------------</span></span>
<span id="cb168-6"><a href="linear.html#cb168-6"></a><span class="co">## (Intercept)             85.94 ***</span></span>
<span id="cb168-7"><a href="linear.html#cb168-7"></a><span class="co">##                         (8.73)   </span></span>
<span id="cb168-8"><a href="linear.html#cb168-8"></a><span class="co">## gasto_educ               1.59 ***</span></span>
<span id="cb168-9"><a href="linear.html#cb168-9"></a><span class="co">##                         (0.45)   </span></span>
<span id="cb168-10"><a href="linear.html#cb168-10"></a><span class="co">## inversion_extranjera     0.24    </span></span>
<span id="cb168-11"><a href="linear.html#cb168-11"></a><span class="co">##                         (0.18)   </span></span>
<span id="cb168-12"><a href="linear.html#cb168-12"></a><span class="co">## gasto_salud             -0.83 ** </span></span>
<span id="cb168-13"><a href="linear.html#cb168-13"></a><span class="co">##                         (0.26)   </span></span>
<span id="cb168-14"><a href="linear.html#cb168-14"></a><span class="co">## gasto_segsocial         -0.83 ***</span></span>
<span id="cb168-15"><a href="linear.html#cb168-15"></a><span class="co">##                         (0.20)   </span></span>
<span id="cb168-16"><a href="linear.html#cb168-16"></a><span class="co">## poblacion               -0.93 ***</span></span>
<span id="cb168-17"><a href="linear.html#cb168-17"></a><span class="co">##                         (0.17)   </span></span>
<span id="cb168-18"><a href="linear.html#cb168-18"></a><span class="co">## dualismo_sectorial      -0.17 ***</span></span>
<span id="cb168-19"><a href="linear.html#cb168-19"></a><span class="co">##                         (0.03)   </span></span>
<span id="cb168-20"><a href="linear.html#cb168-20"></a><span class="co">## diversidad_etnica        3.68 ***</span></span>
<span id="cb168-21"><a href="linear.html#cb168-21"></a><span class="co">##                         (1.04)   </span></span>
<span id="cb168-22"><a href="linear.html#cb168-22"></a><span class="co">## pib                     -0.00 ** </span></span>
<span id="cb168-23"><a href="linear.html#cb168-23"></a><span class="co">##                         (0.00)   </span></span>
<span id="cb168-24"><a href="linear.html#cb168-24"></a><span class="co">## factor(tipo_regimen)2   -2.29    </span></span>
<span id="cb168-25"><a href="linear.html#cb168-25"></a><span class="co">##                         (4.75)   </span></span>
<span id="cb168-26"><a href="linear.html#cb168-26"></a><span class="co">## factor(tipo_regimen)3   -2.90    </span></span>
<span id="cb168-27"><a href="linear.html#cb168-27"></a><span class="co">##                         (4.70)   </span></span>
<span id="cb168-28"><a href="linear.html#cb168-28"></a><span class="co">## factor(tipo_regimen)4   -5.14    </span></span>
<span id="cb168-29"><a href="linear.html#cb168-29"></a><span class="co">##                         (4.62)   </span></span>
<span id="cb168-30"><a href="linear.html#cb168-30"></a><span class="co">## bal_legislativo        -10.40 ***</span></span>
<span id="cb168-31"><a href="linear.html#cb168-31"></a><span class="co">##                         (2.22)   </span></span>
<span id="cb168-32"><a href="linear.html#cb168-32"></a><span class="co">## ---------------------------------</span></span>
<span id="cb168-33"><a href="linear.html#cb168-33"></a><span class="co">## R^2                      0.59    </span></span>
<span id="cb168-34"><a href="linear.html#cb168-34"></a><span class="co">## Adj. R^2                 0.56    </span></span>
<span id="cb168-35"><a href="linear.html#cb168-35"></a><span class="co">## Num. obs.              167       </span></span>
<span id="cb168-36"><a href="linear.html#cb168-36"></a><span class="co">## =================================</span></span>
<span id="cb168-37"><a href="linear.html#cb168-37"></a><span class="co">## *** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</span></span></code></pre></div>
<p>Estas funciones también nos permiten comparar dos o más modelos. Cuando se presentan las conclusiones de una investigación, a menudo se recomienda mostrar cómo cambian (o no) los resultados bajo diferentes especificaciones. Primero, guardamos los modelos en una lista. Al comando <code>screenreg</code> añadimos los nombres de las variables, como hemos aprendido anteriormente. En este caso, la comparación de los modelos es la siguiente:</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="linear.html#cb169-1"></a>models &lt;-<span class="st"> </span><span class="kw">list</span>(model_<span class="dv">1</span>, model_<span class="dv">2</span>)</span>
<span id="cb169-2"><a href="linear.html#cb169-2"></a></span>
<span id="cb169-3"><a href="linear.html#cb169-3"></a><span class="kw">screenreg</span>(models,</span>
<span id="cb169-4"><a href="linear.html#cb169-4"></a>          <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;Modelo 1&quot;</span>, <span class="st">&quot;Modelo 2&quot;</span>),  </span>
<span id="cb169-5"><a href="linear.html#cb169-5"></a>           <span class="dt">custom.coef.names =</span> <span class="kw">c</span>(</span>
<span id="cb169-6"><a href="linear.html#cb169-6"></a>             <span class="st">&quot;Constante&quot;</span>, <span class="st">&quot;Gasto en educación&quot;, &quot;</span>IED<span class="st">&quot;, </span></span>
<span id="cb169-7"><a href="linear.html#cb169-7"></a><span class="st">             &quot;</span>Gasto en salud<span class="st">&quot;, &quot;</span>Gasto en seg. social<span class="st">&quot;, </span></span>
<span id="cb169-8"><a href="linear.html#cb169-8"></a><span class="st">             &quot;</span>Población jóven&quot;, <span class="st">&quot;Dualismo en economía&quot;</span>,</span>
<span id="cb169-9"><a href="linear.html#cb169-9"></a>             <span class="st">&quot;División étnica&quot;</span>, <span class="st">&quot;PBI pc&quot;</span>, <span class="st">&quot;Reg. democrático&quot;</span>, <span class="st">&quot;Reg. mixto&quot;</span>,</span>
<span id="cb169-10"><a href="linear.html#cb169-10"></a>             <span class="st">&quot;Reg. autoritario&quot;</span>, <span class="st">&quot;Balance entre poderes&quot;</span>)</span>
<span id="cb169-11"><a href="linear.html#cb169-11"></a>          )</span>
<span id="cb169-12"><a href="linear.html#cb169-12"></a><span class="co">## </span></span>
<span id="cb169-13"><a href="linear.html#cb169-13"></a><span class="co">## =============================================</span></span>
<span id="cb169-14"><a href="linear.html#cb169-14"></a><span class="co">##                        Modelo 1    Modelo 2  </span></span>
<span id="cb169-15"><a href="linear.html#cb169-15"></a><span class="co">## ---------------------------------------------</span></span>
<span id="cb169-16"><a href="linear.html#cb169-16"></a><span class="co">## Constante               44.81 ***   85.94 ***</span></span>
<span id="cb169-17"><a href="linear.html#cb169-17"></a><span class="co">##                         (1.02)      (8.73)   </span></span>
<span id="cb169-18"><a href="linear.html#cb169-18"></a><span class="co">## Gasto en educación       1.23 ***    1.59 ***</span></span>
<span id="cb169-19"><a href="linear.html#cb169-19"></a><span class="co">##                         (0.25)      (0.45)   </span></span>
<span id="cb169-20"><a href="linear.html#cb169-20"></a><span class="co">## IED                                  0.24    </span></span>
<span id="cb169-21"><a href="linear.html#cb169-21"></a><span class="co">##                                     (0.18)   </span></span>
<span id="cb169-22"><a href="linear.html#cb169-22"></a><span class="co">## Gasto en salud                      -0.83 ** </span></span>
<span id="cb169-23"><a href="linear.html#cb169-23"></a><span class="co">##                                     (0.26)   </span></span>
<span id="cb169-24"><a href="linear.html#cb169-24"></a><span class="co">## Gasto en seg. social                -0.83 ***</span></span>
<span id="cb169-25"><a href="linear.html#cb169-25"></a><span class="co">##                                     (0.20)   </span></span>
<span id="cb169-26"><a href="linear.html#cb169-26"></a><span class="co">## Población jóven                     -0.93 ***</span></span>
<span id="cb169-27"><a href="linear.html#cb169-27"></a><span class="co">##                                     (0.17)   </span></span>
<span id="cb169-28"><a href="linear.html#cb169-28"></a><span class="co">## Dualismo en economía                -0.17 ***</span></span>
<span id="cb169-29"><a href="linear.html#cb169-29"></a><span class="co">##                                     (0.03)   </span></span>
<span id="cb169-30"><a href="linear.html#cb169-30"></a><span class="co">## División étnica                      3.68 ***</span></span>
<span id="cb169-31"><a href="linear.html#cb169-31"></a><span class="co">##                                     (1.04)   </span></span>
<span id="cb169-32"><a href="linear.html#cb169-32"></a><span class="co">## PBI pc                              -0.00 ** </span></span>
<span id="cb169-33"><a href="linear.html#cb169-33"></a><span class="co">##                                     (0.00)   </span></span>
<span id="cb169-34"><a href="linear.html#cb169-34"></a><span class="co">## Reg. democrático                    -2.29    </span></span>
<span id="cb169-35"><a href="linear.html#cb169-35"></a><span class="co">##                                     (4.75)   </span></span>
<span id="cb169-36"><a href="linear.html#cb169-36"></a><span class="co">## Reg. mixto                          -2.90    </span></span>
<span id="cb169-37"><a href="linear.html#cb169-37"></a><span class="co">##                                     (4.70)   </span></span>
<span id="cb169-38"><a href="linear.html#cb169-38"></a><span class="co">## Reg. autoritario                    -5.14    </span></span>
<span id="cb169-39"><a href="linear.html#cb169-39"></a><span class="co">##                                     (4.62)   </span></span>
<span id="cb169-40"><a href="linear.html#cb169-40"></a><span class="co">## Balance entre poderes              -10.40 ***</span></span>
<span id="cb169-41"><a href="linear.html#cb169-41"></a><span class="co">##                                     (2.22)   </span></span>
<span id="cb169-42"><a href="linear.html#cb169-42"></a><span class="co">## ---------------------------------------------</span></span>
<span id="cb169-43"><a href="linear.html#cb169-43"></a><span class="co">## R^2                      0.06        0.59    </span></span>
<span id="cb169-44"><a href="linear.html#cb169-44"></a><span class="co">## Adj. R^2                 0.06        0.56    </span></span>
<span id="cb169-45"><a href="linear.html#cb169-45"></a><span class="co">## Num. obs.              356         167       </span></span>
<span id="cb169-46"><a href="linear.html#cb169-46"></a><span class="co">## =============================================</span></span>
<span id="cb169-47"><a href="linear.html#cb169-47"></a><span class="co">## *** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</span></span></code></pre></div>
<p>Como puedes ver, la estimación del efecto del gasto en educación cambió ligeramente. Mientras que en el modelo simple el efecto es de 1,23, en el modelo múltiple este efecto crece a 1,59. En este caso, la interpretación es que cuando el gasto en educación aumenta en una unidad, la desigualdad aumenta en un promedio de 1,59 puntos porcentuales, <em>manteniendo constantes todos los demás factores</em>. Al igual que en el modelo 1, la variable sigue siendo significativa con una confianza del 99,9%, por lo que decimos que el efecto del gasto en educación es <em>robusto</em> en diferentes especificaciones. Cuando los investigadores incluyen nuevos controles al modelo y la principal variable de interés sigue siendo significativa y con magnitudes relativamente estables, ganamos evidencia a favor del efecto de esta última. En otras palabras, es cada vez más improbable que el efecto observado en primera instancia fuera espurio.</p>
<p>Otra contribución del modelo 2 es la adición de variables nominales. Las variables dicotómicas y categóricas plantean un ligero desafío de interpretación. Observa la variable de diversidad étnica, que es dicotómica, es decir, el valor 1 implica que más del 20% de la población pertenece a una minoría étnica y el 0 que no existe una minoría tan relevante. El coeficiente de <code>diversidad_etnica</code> es 3,7, significativo en el 99,9%. ¿Cómo interpretamos este coeficiente? Simplemente, el valor predicho de la desigualdad es 3,7 puntos superior cuando existe una minoría étnica, para cualquier valor de los otros <span class="math inline">\(x&#39;s\)</span>. Para interpretar estos coeficientes, siempre necesitamos saber la categoría base. Como <code>diversidad_etnica</code> es igual a 0 cuando no hay minorías étnicas, el coeficiente se interpreta como el efecto de tener una minoría étnica.</p>
<p>En el caso de la variable <code>dualismo_sectorial</code>, dado que la categoría base es 0 para “no dualismo”, el coeficiente se interpreta como el efecto de tener una economía dual <em>disminuye</em> (coeficiente negativo) la desigualdad en aproximadamente 0,17 puntos.</p>
<blockquote>
<p><strong>Ejercicio 5D.</strong> Exporta la tabla con ambos modelos (con y sin controles) a un archivo .doc, te esperamos.</p>
</blockquote>
<p>El siguiente gráfico muestra la diferencia en el efecto del gasto en educación sobre la desigualdad según la presencia o ausencia de minorías étnicas en el país. Con fines didácticos, estimamos un nuevo modelo restringido a dos variables de interés: el gasto en educación y las minorías étnicas.</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="linear.html#cb170-1"></a>model_<span class="dv">2</span>_restricted&lt;-<span class="st"> </span><span class="kw">lm</span>(gini<span class="op">~</span><span class="dv">1</span><span class="op">+</span>gasto_educ <span class="op">+</span><span class="st"> </span>diversidad_etnica, </span>
<span id="cb170-2"><a href="linear.html#cb170-2"></a>                        <span class="dt">data =</span> bienestar_no_na)</span>
<span id="cb170-3"><a href="linear.html#cb170-3"></a></span>
<span id="cb170-4"><a href="linear.html#cb170-4"></a></span>
<span id="cb170-5"><a href="linear.html#cb170-5"></a><span class="kw">screenreg</span>(model_<span class="dv">2</span>_restricted) <span class="co"># observamos nuevos coeficientes</span></span>
<span id="cb170-6"><a href="linear.html#cb170-6"></a><span class="co">## </span></span>
<span id="cb170-7"><a href="linear.html#cb170-7"></a><span class="co">## =============================</span></span>
<span id="cb170-8"><a href="linear.html#cb170-8"></a><span class="co">##                    Model 1   </span></span>
<span id="cb170-9"><a href="linear.html#cb170-9"></a><span class="co">## -----------------------------</span></span>
<span id="cb170-10"><a href="linear.html#cb170-10"></a><span class="co">## (Intercept)         45.40 ***</span></span>
<span id="cb170-11"><a href="linear.html#cb170-11"></a><span class="co">##                     (1.83)   </span></span>
<span id="cb170-12"><a href="linear.html#cb170-12"></a><span class="co">## gasto_educ           0.67    </span></span>
<span id="cb170-13"><a href="linear.html#cb170-13"></a><span class="co">##                     (0.44)   </span></span>
<span id="cb170-14"><a href="linear.html#cb170-14"></a><span class="co">## diversidad_etnica    6.82 ***</span></span>
<span id="cb170-15"><a href="linear.html#cb170-15"></a><span class="co">##                     (0.99)   </span></span>
<span id="cb170-16"><a href="linear.html#cb170-16"></a><span class="co">## -----------------------------</span></span>
<span id="cb170-17"><a href="linear.html#cb170-17"></a><span class="co">## R^2                  0.24    </span></span>
<span id="cb170-18"><a href="linear.html#cb170-18"></a><span class="co">## Adj. R^2             0.23    </span></span>
<span id="cb170-19"><a href="linear.html#cb170-19"></a><span class="co">## Num. obs.          167       </span></span>
<span id="cb170-20"><a href="linear.html#cb170-20"></a><span class="co">## =============================</span></span>
<span id="cb170-21"><a href="linear.html#cb170-21"></a><span class="co">## *** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</span></span></code></pre></div>
<p>Para hacer el gráfico, necesitamos cargar el paquete de <code>prediction</code> que calcula los valores predichos de un modelo y que será usado para dibujar la línea predicha por el modelo.</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="linear.html#cb171-1"></a><span class="kw">library</span>(prediction)</span></code></pre></div>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="linear.html#cb172-1"></a>pred_model_<span class="dv">2</span>_restricted &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(<span class="kw">prediction</span>(model_<span class="dv">2</span>_restricted)) </span>
<span id="cb172-2"><a href="linear.html#cb172-2"></a></span>
<span id="cb172-3"><a href="linear.html#cb172-3"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> pred_model_<span class="dv">2</span>_restricted) <span class="op">+</span><span class="st"> </span><span class="co"># los nuevos valores predichos</span></span>
<span id="cb172-4"><a href="linear.html#cb172-4"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> gasto_educ, <span class="dt">y =</span> gini,</span>
<span id="cb172-5"><a href="linear.html#cb172-5"></a>                           <span class="dt">color =</span> <span class="kw">factor</span>(diversidad_etnica))) <span class="op">+</span></span>
<span id="cb172-6"><a href="linear.html#cb172-6"></a><span class="st">  </span><span class="co"># se dibujan las líneas de regresión (diferenciadas por color):</span></span>
<span id="cb172-7"><a href="linear.html#cb172-7"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> gasto_educ, <span class="dt">y =</span> fitted, </span>
<span id="cb172-8"><a href="linear.html#cb172-8"></a>                          <span class="dt">color =</span> <span class="kw">factor</span>(diversidad_etnica), </span>
<span id="cb172-9"><a href="linear.html#cb172-9"></a>                          <span class="dt">group =</span> <span class="kw">factor</span>(diversidad_etnica))) <span class="op">+</span></span>
<span id="cb172-10"><a href="linear.html#cb172-10"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Gasto en educación&quot;, y = &quot;</span>Desigualdad<span class="st">&quot;)</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:pred-model-2"></span>
<img src="05-linear_es_files/figure-html/pred-model-2-1.png" alt=" Valores predichos por división étnica" width="80%" />
<p class="caption">
Figura 5.7:  Valores predichos por división étnica
</p>
</div>
<p>Como vemos claramente en el gráfico, el efecto del gasto en educación sobre la desigualdad es positivo porque, a medida que el gasto aumenta, el valor esperado del coeficiente de Gini también aumenta. Sin embargo, los países con minorías étnicas (valor de 1 en <code>diversidad_etnica</code>) tienen casi 7 puntos porcentuales más en su coeficiente de Gini en cualquier valor del gasto en educación. También se puede afirmar que el efecto medio de tener minorías étnicas en la desigualdad es de 6,82. Los modelos con más regresores (como el modelo 2 estimado anteriormente) son más complejos de graficar porque el valor predicho no sólo depende de dos variables (como en este gráfico), sino de todas las variables presentes en el modelo. En cualquier caso, como vimos anteriormente, la interpretación es la misma.</p>
</div>
<div id="ajuste-del-modelo" class="section level2">
<h2><span class="header-section-number">5.4</span> Ajuste del modelo</h2>
<p>La bondad del ajuste se define como la capacidad explicativa del modelo. Intuitivamente, se refiere a la porción de la variación de la variable dependiente <span class="math inline">\(y\)</span> se explica por el modelo especificado. La medida de la bondad del ajuste es <span class="math inline">\(R^2\)</span> y se define como 1- RSS/TSS, donde RSS es la Suma Residual de Cuadrados y TSS la Suma Total de Cuadrados. En términos sencillos, RSS es una medida de todo lo que <em>no</em> es explicado por el modelo, mientras que TSS es la variabilidad de <span class="math inline">\(y\)</span>.
Un modelo que explica <em>toda</em> la variación de <span class="math inline">\(y\)</span> tendrá un <span class="math inline">\(R^2\)</span> de 1. Un modelo que no explica nada de la variabilidad de la variable dependiente tendrá un valor de 0.</p>
<p>Como regla general, a medida que el número de variables independientes aumenta, la <span class="math inline">\(R^2\)</span> nunca disminuye, por lo que la <span class="math inline">\(R^2\)</span> ajustada se utiliza a menudo como una medida que penaliza la inclusión de variables sin fundamento. Como podemos observar en la comparación de los modelos previamente estimados, el modelo lineal simple tiene un <span class="math inline">\(R^2\)</span> de 0,06. Esto puede leerse como el modelo 1 que explica el 6% de la variabilidad de la desigualdad. El modelo múltiple 2 aumenta su capacidad explicativa al 59%.</p>
<p>Algunas investigaciones tratan de aumentar la bondad de ajuste del modelo. Sin embargo, para estimar el efecto de una sola variable no es necesario aumentar la bondad de ajuste sino simplemente cumplir con los supuestos del Modelo Lineal Clásico, tales como la media condicional cero, la linealidad en los parámetros y el resto de los supuestos que se describen en la sección correspondiente.</p>
</div>
<div id="inferencia-en-los-modelos-lineales-múltiples" class="section level2">
<h2><span class="header-section-number">5.5</span> Inferencia en los modelos lineales múltiples</h2>
<p>Como en la regresión lineal simple, los estimadores de cada parámetro <span class="math inline">\(\beta_j\)</span> tiene una distribución t-Student, por lo que es posible hacer inferencias sobre las estimaciones puntuales de cada <span class="math inline">\(\hat{\beta_j}\)</span> a través de un tes-t. Sin embargo, a menudo queremos imponer múltiples restricciones lineales al modelo del tipo <span class="math inline">\(H_0= \beta_1= \beta_2 = 0\)</span>. Aquí estamos afirmando que el efecto de las dos variables <span class="math inline">\(x_1\)</span> y <span class="math inline">\(x_2\)</span> es igual a cero. Un caso típico que requiere este tipo de hipótesis nula es el de las variables categóricas que entran en el modelo como variables dicotómicas ficticias.La variable dicotómica “educación secundaria” y la variable dicotómica “educación superior” son, en realidad, categorías de la variable nominal única “nivel de educación”, que sólo pueden entrar en el análisis de regresión en un formato <em>dummy</em> .</p>
<p>La prueba que nos permite hacer inferencias para múltiples restricciones lineales es la prueba F. Esto significa que el <span class="math inline">\(H_0\)</span> de una restricción múltiple se distribuye como la F de Fisher. Supongamos que queremos probar la hipótesis nula <span class="math inline">\(H_0= \beta_1= \beta_2 = \beta_3 =0\)</span>. De acuerdo con esta hipótesis, las variables <span class="math inline">\(x_1\)</span>, <span class="math inline">\(x_2\)</span> y <span class="math inline">\(x_3\)</span> no afectan a <span class="math inline">\(Y\)</span> cuando se consideran juntas. La hipótesis alternativa es que al menos una de las betas es diferente de 0. Si <span class="math inline">\(H_0\)</span> es cierto, entonces un modelo que excluye estas variables debería explicar lo mismo que un modelo que las incluye, es decir, estas variables son redundantes.</p>
<p>La forma de probar esta hipótesis es a través de una test-F, en la que se compara la suma de los residuos al cuadrado de los modelos completo y restringido. En términos sencillos, si las variables no explican la variabilidad de <span class="math inline">\(Y\)</span>, la suma de los residuos al cuadrado de ambos modelos (otra forma es considerar el <span class="math inline">\(R^2\)</span>) no debería cambiar significativamente. En este caso, no tiene sentido mantener la variable en el modelo.</p>
<p>Utiliza el hecho de que la comparación de los residuos al cuadrado distribuye F
<span class="math display">\[F= \frac{(RSS_r-RSS_c)/q}{RSS_c/(n-k-1)}\]</span></p>
<p>Donde <span class="math inline">\(RSS_r\)</span> es la Suma Residual de Cuadrados del modelo restringido, <span class="math inline">\(RSS_c\)</span> es la Suma Residual de Cuadrados del modelo completo, <span class="math inline">\(q\)</span> es la cantidad de variables excluidas y <span class="math inline">\(n-k-\)</span> son los grados de libertad del modelo completo. En R, podemos usar la función <code>anova</code> para comparar los modelos.</p>
<p>Por ejemplo, supongamos que un colega afirma que el equilibrio legislativo (<code>bal_legislativo</code>), el tipo de régimen (<code>tipo_regimen</code>) y la diversidad étnica (<code>diversidad_etnica</code>) deben ser excluidos del modelo. Entonces, necesitamos estimar un modelo restringido de manera que</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="linear.html#cb173-1"></a>model_<span class="dv">2</span>_restrained &lt;-<span class="st"> </span><span class="kw">lm</span>(gini <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>gasto_educ <span class="op">+</span><span class="st"> </span>inversion_extranjera <span class="op">+</span><span class="st"> </span>gasto_salud <span class="op">+</span><span class="st"> </span>gasto_segsocial <span class="op">+</span></span>
<span id="cb173-2"><a href="linear.html#cb173-2"></a><span class="st">                           </span>poblacion<span class="op">+</span><span class="st"> </span>dualismo_sectorial  <span class="op">+</span><span class="st"> </span>pib,</span>
<span id="cb173-3"><a href="linear.html#cb173-3"></a>                         <span class="dt">data =</span> bienestar_no_na)</span></code></pre></div>
<p>Como podemos ver, las variables listadas fueron excluidas de la sintaxis. Ahora necesitamos comparar la capacidad explicativa de cada modelo</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="linear.html#cb174-1"></a><span class="kw">anova</span>(model_<span class="dv">2</span>, model_<span class="dv">2</span>_restrained)</span>
<span id="cb174-2"><a href="linear.html#cb174-2"></a><span class="co">## Analysis of Variance Table</span></span>
<span id="cb174-3"><a href="linear.html#cb174-3"></a><span class="co">## </span></span>
<span id="cb174-4"><a href="linear.html#cb174-4"></a><span class="co">## Model 1: gini ~ 1 + gasto_educ + inversion_extranjera + gasto_salud + </span></span>
<span id="cb174-5"><a href="linear.html#cb174-5"></a><span class="co">##     gasto_segsocial + poblacion + dualismo_sectorial + diversidad_etnica + </span></span>
<span id="cb174-6"><a href="linear.html#cb174-6"></a><span class="co">##     pib + factor(tipo_regimen) + bal_legislativo</span></span>
<span id="cb174-7"><a href="linear.html#cb174-7"></a><span class="co">## Model 2: gini ~ 1 + gasto_educ + inversion_extranjera + gasto_salud + </span></span>
<span id="cb174-8"><a href="linear.html#cb174-8"></a><span class="co">##     gasto_segsocial + poblacion + dualismo_sectorial + pib</span></span>
<span id="cb174-9"><a href="linear.html#cb174-9"></a><span class="co">##   Res.Df  RSS Df Sum of Sq    F  Pr(&gt;F)    </span></span>
<span id="cb174-10"><a href="linear.html#cb174-10"></a><span class="co">## 1    154 3148                              </span></span>
<span id="cb174-11"><a href="linear.html#cb174-11"></a><span class="co">## 2    159 4737 -5     -1588 15.5 2.3e-12 ***</span></span>
<span id="cb174-12"><a href="linear.html#cb174-12"></a><span class="co">## ---</span></span>
<span id="cb174-13"><a href="linear.html#cb174-13"></a><span class="co">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>La importancia de la última columna de la prueba (Pr(&gt;F)) muestra claramente que la hipótesis nula se rechaza ya que el valor p es inferior al umbral de 0,05, por lo que estas variables <em>no</em> deben ser excluidas del modelo.</p>
<blockquote>
<p><strong>Ejercicio 5E.</strong> Estime un modelo en el que excluya el gasto en salud (<code>gasto_salud</code>) y el gasto en seguridad social (<code>gasto_segsocial</code>), y compare su capacidad explicativa con el modelo completo. De acuerdo con los resultados, ¿deberíamos excluir estas variables del modelo?</p>
</blockquote>
</div>
<div id="testeando-los-supuestos-de-mco" class="section level2">
<h2><span class="header-section-number">5.6</span> Testeando los supuestos de MCO</h2>
<p>Como habrás visto en tus manuales de econometría, el estimador MCO será útil (estimará sin sesgo el parámetro de población) si se cumplen los supuestos de Gauss-Markov. Esto permite que sea el mejor parámetro lineal sin sesgo (BLUE, por sus siglas en inglés). Para una discusión más profunda de las suposiciones, mira <span class="citation">Wooldridge (<a href="referencias.html#ref-wooldridgeIntroductoryEconometricsModern2016" role="doc-biblioref">2016</a>)</span> y <span class="citation">Stock and Watson (<a href="referencias.html#ref-stockIntroductionEconometrics2019" role="doc-biblioref">2019</a>)</span>. Es importante evaluar que estos supuestos se cumplen en nuestra estimación. Como veremos, esta evaluación es teórica y, en algunos casos, podría ser abordada empíricamente. Todas estas evaluaciones suelen añadirse a los artículos como apéndices o en los archivos de replicación de datos, y no necesariamente en el cuerpo del texto, pero puedes hacerlas en R.</p>
<div id="cero-condicionalidad-de-la-media" class="section level4">
<h4><span class="header-section-number">5.6.0.1</span> Cero condicionalidad de la media</h4>
<p>Esta es la principal suposición para utilizar el estimador de mínimos cuadrados ordinarios. La premisa central es la independencia entre las variables independientes y el término de error. Esto nos permite aislar el efecto del <span class="math inline">\(x\)</span> de los factores no observables (contenidos en el término de error <span class="math inline">\(u\)</span>).
Esta suposición no puede evaluarse empíricamente porque, por definición, no conocemos los factores contenidos en el término de error. Por lo tanto, la defensa de esta suposición siempre será <em>teórica</em>.</p>
</div>
<div id="muestra-aleatoria" class="section level4">
<h4><span class="header-section-number">5.6.0.2</span> Muestra aleatoria</h4>
<p>Esta es una suposición sobre la generación de datos. Se supone una muestra aleatoria de tamaño <span class="math inline">\(n\)</span>, lo que implica que la muestra se tomó de tal manera que todas las unidades de la población tuvieron la misma probabilidad de ser seleccionadas. Es decir, no hay ningún sesgo de muestreo.</p>
</div>
<div id="linealidad-en-los-parámetros" class="section level4">
<h4><span class="header-section-number">5.6.0.3</span> Linealidad en los parámetros</h4>
<p>MCO asume que la variable dependiente (<span class="math inline">\(y\)</span>) tiene una relación lineal con la(s) variable(s) independiente(s) y el término de error (<span class="math inline">\(u\)</span>). Es decir, un aumento de una unidad de <span class="math inline">\(x\)</span> resulta en un efecto constante sobre la variable dependiente <span class="math inline">\(y\)</span>. De ahí la forma funcional de la ecuación de regresión:</p>
<p><span class="math display">\[Y = \beta_0 + \beta_1x + u\]</span></p>
<p>Si la relación no es lineal, entonces nos enfrentamos a un problema de especificación del modelo. Es decir, los valores predichos por nuestro modelo no encajan en la realidad de nuestros datos y, en consecuencia, las estimaciones estarán sesgadas. Por lo tanto, es fundamental evaluar si la relación que queremos estimar es lineal o si la forma funcional que caracteriza esa relación es otra (por ejemplo, podría ser cuadrática, cúbica, logarítmica, etc.).</p>
<p>La buena noticia es que si tenemos razones teóricas y empíricas para creer que la relación no es lineal, es posible hacer transformaciones en nuestras variables para lograr una mejor especificación del modelo. Un ejemplo clásico es el de la relación parabólica entre edad e ingresos: a medida que aumenta la edad, los ingresos aumentan hasta que se alcanza un punto de inflexión en el que un aumento de la edad se relaciona con niveles de ingresos más bajos, como una U invertida.</p>
<p>Para evaluar la linealidad, hacemos un gráfico de dispersión de los valores predichos contra los residuos de <span class="math inline">\(u\)</span>. El objetivo es evaluar si el promedio de los residuos tiende a situarse aleatoriamente por encima y por debajo de cero. Si los residuos presentan un patrón creciente o decreciente - o cualquier otro tipo - entonces la forma funcional de una de las variables en cuestión es no lineal. Para ello utilizamos <code>ggplot2</code>:</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="linear.html#cb175-1"></a><span class="kw">ggplot</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> model_<span class="dv">1</span><span class="op">$</span>fitted.values, <span class="dt">y =</span> model_<span class="dv">1</span><span class="op">$</span>residuals)) <span class="op">+</span></span>
<span id="cb175-2"><a href="linear.html#cb175-2"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Valores predichos&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Residuos&quot;</span>) <span class="op">+</span></span>
<span id="cb175-3"><a href="linear.html#cb175-3"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb175-4"><a href="linear.html#cb175-4"></a><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>), <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:abline"></span>
<img src="05-linear_es_files/figure-html/abline-1.png" alt=" Prueba de linealidad en valores predichos " width="672" />
<p class="caption">
Figura 5.8:  Prueba de linealidad en valores predichos
</p>
</div>
<p>También podemos hacer un gráfico de residuos parciales donde cada variable independiente del modelo se grafica contra los residuos. El objetivo es obtener un gráfico “parcial” para observar la relación entre la(s) variable(s) independiente(s) y la variable dependiente teniendo en cuenta (controlando) todas las demás variables del modelo. Una línea de puntos nos muestra la predicción del MCO, y otra línea (roja) nos muestra la relación “real”. Si observamos que una de nuestras variables <strong>no tiene una relación lineal</strong> podemos hacer transformaciones (¡a las variables!) para que la forma funcional se aproxime a la empírica. Hay que señalar que, además de la justificación empírica, esta transformación lineal debe <strong>siempre</strong> estar apoyada por un argumento teórico de por qué la relación entre las dos variables toma tal forma.</p>
<p>Una transformación común que se verá regularmente en los trabajos es la de las transformaciones logarítmicas de las variables. Éstas están presentes tanto en las variables dependientes como en las independientes. Por esta razón, le ofrecemos una tabla que le será útil. Esto le permitirá saber cómo cambia la interpretación de los resultados cuando una de las variables (o ambas) se transforma.</p>
<p>La tabla resume la interpretación de los coeficientes en presencia de transformaciones logarítmicas".</p>

<p>Por ejemplo, decidimos transformar nuestra variable dependiente de tal manera que</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="linear.html#cb176-1"></a>model_<span class="dv">1</span>_log &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(gini) <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>gasto_educ, <span class="dt">data =</span> bienestar)</span>
<span id="cb176-2"><a href="linear.html#cb176-2"></a></span>
<span id="cb176-3"><a href="linear.html#cb176-3"></a><span class="kw">screenreg</span>(model_<span class="dv">1</span>_log)</span>
<span id="cb176-4"><a href="linear.html#cb176-4"></a><span class="co">## </span></span>
<span id="cb176-5"><a href="linear.html#cb176-5"></a><span class="co">## =======================</span></span>
<span id="cb176-6"><a href="linear.html#cb176-6"></a><span class="co">##              Model 1   </span></span>
<span id="cb176-7"><a href="linear.html#cb176-7"></a><span class="co">## -----------------------</span></span>
<span id="cb176-8"><a href="linear.html#cb176-8"></a><span class="co">## (Intercept)    3.78 ***</span></span>
<span id="cb176-9"><a href="linear.html#cb176-9"></a><span class="co">##               (0.02)   </span></span>
<span id="cb176-10"><a href="linear.html#cb176-10"></a><span class="co">## gasto_educ     0.03 ***</span></span>
<span id="cb176-11"><a href="linear.html#cb176-11"></a><span class="co">##               (0.01)   </span></span>
<span id="cb176-12"><a href="linear.html#cb176-12"></a><span class="co">## -----------------------</span></span>
<span id="cb176-13"><a href="linear.html#cb176-13"></a><span class="co">## R^2            0.07    </span></span>
<span id="cb176-14"><a href="linear.html#cb176-14"></a><span class="co">## Adj. R^2       0.07    </span></span>
<span id="cb176-15"><a href="linear.html#cb176-15"></a><span class="co">## Num. obs.    356       </span></span>
<span id="cb176-16"><a href="linear.html#cb176-16"></a><span class="co">## =======================</span></span>
<span id="cb176-17"><a href="linear.html#cb176-17"></a><span class="co">## *** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</span></span></code></pre></div>
<p>La interpretación sería la siguiente: si aumentamos el gasto en salud en una unidad, esperaríamos que el Gini aumente un 3%, <em>ceteris paribus</em>. Para saber cuándo transformar nuestras variables, veremos con un ejemplo cómo podemos diagnosticar un problema de medición en nuestras variables.</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="linear.html#cb177-1"></a><span class="kw">library</span>(car)</span>
<span id="cb177-2"><a href="linear.html#cb177-2"></a><span class="kw">crPlots</span>(model_<span class="dv">1</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-23"></span>
<img src="05-linear_es_files/figure-html/unnamed-chunk-23-1.png" alt="Test de linearidad" width="480" />
<p class="caption">
Figura 3.21: Test de linearidad
</p>
</div>
<p>La relación de nuestra variable de interés con las variables dependientes parece ser cada vez más cuadrática. Entonces, es razonable hacer una transformación cuadrática a la variable. Evaluemos esto gráficamente:</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="linear.html#cb178-1"></a>bienestar_no_na &lt;-<span class="st"> </span>bienestar_no_na <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">cseduc2 =</span> gasto_educ<span class="op">*</span>gasto_educ)</span>
<span id="cb178-2"><a href="linear.html#cb178-2"></a></span>
<span id="cb178-3"><a href="linear.html#cb178-3"></a>model_<span class="dv">1</span>_quadratic &lt;-<span class="st"> </span><span class="kw">lm</span>(gini <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>cseduc2 <span class="op">+</span><span class="st"> </span>gasto_educ, </span>
<span id="cb178-4"><a href="linear.html#cb178-4"></a>                        <span class="dt">data =</span> bienestar_no_na)</span>
<span id="cb178-5"><a href="linear.html#cb178-5"></a></span>
<span id="cb178-6"><a href="linear.html#cb178-6"></a></span>
<span id="cb178-7"><a href="linear.html#cb178-7"></a><span class="kw">crPlots</span>(model_<span class="dv">1</span>_quadratic)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-24"></span>
<img src="05-linear_es_files/figure-html/unnamed-chunk-24-1.png" alt=" Prueba de linealidad alternativa" width="672" />
<p class="caption">
Figura 3.22:  Prueba de linealidad alternativa
</p>
</div>
<p>Basándonos en un diagnóstico visual, observamos una tendencia creciente en los residuos a medida que avanza en los valores predichos. También detectamos una relación no lineal entre el gasto en educación y los niveles de desigualdad. Sospechamos que esta relación podría ser cuadrática (parábola cuadrática creciente) y, según la gráfica de residuos parciales, parece que la variable transformada está mucho más cerca de la relación lineal estimada por MCO (marcada por la línea punteada). Observa que la escala de la figura de la izquierda es de 0 a 15, mientras que la de la derecha es de 0 a 20, lo que denota una pendiente más pronunciada.</p>
<p>Para confirmar las observaciones visuales, a menudo se utiliza una prueba estadística para diagnosticar una especificación funcional deficiente del modelo: El test RESET de Ramsey. La idea es, precisamente, evaluar si hay un error de especificación en la ecuación de regresión. Lo que esta prueba hace es estimar de nuevo el modelo pero añadiendo los valores predichos del modelo original con algunas transformaciones no lineales de las variables. Luego, a partir de un test-F, el modelo se evalúa con las especificaciones no lineales para comprobar si tiene un mejor ajuste que el modelo original sin la transformación no lineal. La hipótesis nula establece que las nuevas variables (en este caso, <code>csdeuc</code>^2) no son significativas para explicar la variación de la variable dependiente; es decir, que su coeficiente es igual a cero (<span class="math inline">\(beta=0\)</span>)</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="linear.html#cb179-1"></a><span class="kw">library</span>(lmtest)</span>
<span id="cb179-2"><a href="linear.html#cb179-2"></a><span class="kw">resettest</span>(model_<span class="dv">1</span>, <span class="dt">power =</span> <span class="dv">2</span>, <span class="dt">type =</span> <span class="st">&quot;fitted&quot;</span>, <span class="dt">data =</span> bienestar_no_na)</span>
<span id="cb179-3"><a href="linear.html#cb179-3"></a><span class="co">## </span></span>
<span id="cb179-4"><a href="linear.html#cb179-4"></a><span class="co">##  RESET test</span></span>
<span id="cb179-5"><a href="linear.html#cb179-5"></a><span class="co">## </span></span>
<span id="cb179-6"><a href="linear.html#cb179-6"></a><span class="co">## data:  model_1</span></span>
<span id="cb179-7"><a href="linear.html#cb179-7"></a><span class="co">## RESET = 9, df1 = 1, df2 = 353, p-value = 0.004</span></span></code></pre></div>
<p>Según el resultado del test-F, confirmamos lo que observamos gráficamente: añadir un término cuadrático al gasto en educación mejora el ajuste de nuestra estimación. Llegamos a esta conclusión observando el <em>valor p</em> del test RESET de Ramsey: a un nivel de significancia estadística del 5%, se rechaza la hipótesis nula de que la incorporación del término cuadrático no mejora el ajuste del modelo.</p>
<blockquote>
<p><em>Nota</em>: Esta evaluación se hizo para un modelo de regresión simple (bivariante), pero el mismo procedimiento puede hacerse para modelos multivariantes.</p>
</blockquote>
</div>
<div id="variación-en-variables-independientes-y-colinealidad-no-perfecta" class="section level4">
<h4><span class="header-section-number">5.6.0.4</span> Variación en variables independientes y colinealidad no-perfecta</h4>
<p>Declaramos que es necesario que haya variación en la(s) variable(s) independiente(s). Una variable que no varía, ¡no es una variable! Si no tenemos variación, la estimación de los coeficientes será indeterminada. Además, una mayor variación en las variables independientes nos permitirá hacer estimaciones más precisas.
Por otra parte, la ausencia de colinealidad perfecta implica que las variables independientes no están perfectamente correlacionadas <em>linealmente</em>. Es decir, aunque las variables independientes tienden a tener algún tipo de relación entre ellas, ¡no queremos que midan lo mismo! Esto se evaluará con pruebas de multicolinealidad.</p>
<div id="problemas-de-multicolinealidad" class="section level5">
<h5><span class="header-section-number">5.6.0.4.1</span> Problemas de multicolinealidad</h5>
<p>A. <em>Pérdida de eficiencia</em>, porque sus errores estándar serán infinitos. Incluso cuando la multicolinealidad es menos que perfecta, los coeficientes de regresión tienen mayores errores estándar, lo que significa que no pueden ser estimados con gran precisión.</p>
<p>Revisemos la fórmula del error estándar de los coeficientes
<span class="math display">\[\hat{\sigma}_{\hat{\beta}_1} = \frac{\hat{\sigma}}{\sqrt{\sum(X_j – \bar{X})^2(1 - R^2_j)}}\]</span></p>
<ul>
<li><p><span class="math inline">\(\hat{\sigma}\)</span> Es la varianza del término del error: <span class="math inline">\(\frac{\sum\hat{u}}{n-k-1}\)</span></p></li>
<li><p><span class="math inline">\(\sum(X_j – \bar{X})^2\)</span> es la varianza de of <span class="math inline">\(x_j\)</span> (<span class="math inline">\(STCx_j\)</span>)</p></li>
<li><p><span class="math inline">\(1 - R^2_j\)</span> Es la porción de <span class="math inline">\(x_j\)</span> que no es explicada por el resto de <em>x</em> en el modelo (<span class="math inline">\(R^2_j\)</span> indica que la varianza de <span class="math inline">\(x_j\)</span> que se explica por el resto de las “x” del modelo). Es por este término que la colinearidad no perfecta es tan importante!
B. <em>Las estimaciones de los coeficientes pueden variar ampliamente</em> dependiendo de qué otras variables independientes hay en el modelo. En una estimación MCO, la idea es que podemos cambiar el valor de una variable independiente y no el de las otras (esto es lo que significa <em>ceteris paribus</em>, para mantener constantes las otras co-variables). Sin embargo, cuando las variables independientes están correlacionadas, los cambios en una variable están vinculados a los cambios en otra variable. Cuanto más fuerte es la correlación, más difícil es cambiar una variable sin cambiar otra. Se hace difícil para el modelo estimar la relación entre cada variable independiente y la variable dependiente mientras se mantiene constante el resto, porque las variables independientes tienden a cambiar simultáneamente. Repasemos la fórmula para estimar el coeficiente en una regresión múltiple:
<span class="math display">\[\hat{\beta_1} = \frac{\sum(\hat{r_{i1}}\hat{y_i})}{\sum(\hat{r^2_{i1}})}\]</span></p></li>
</ul>
<p>donde:</p>
<ul>
<li><span class="math inline">\(\hat{r_{i1}}\)</span> son los residuos de una regresión de <span class="math inline">\(x_1\)</span> sobre el resto de los <span class="math inline">\(x\)</span> en el modelo (es decir, la parte de <span class="math inline">\(x_1\)</span> que no puede ser explicada - o que no está correlacionada - con el resto de los <span class="math inline">\(x\)</span>)</li>
</ul>
<p>Así, <span class="math inline">\(\hat{\beta_1}\)</span> mide la relación de la muestra entre <span class="math inline">\(y\)</span> y <span class="math inline">\(x_1\)</span> después de eliminar los efectos parciales de <span class="math inline">\(x_2\)</span>, <span class="math inline">\(x_3\)</span>…<span class="math inline">\(x_k\)</span>. Para evaluar la multicolinealidad, el primer paso es observar la matriz de correlación de las variables de nuestro modelo (tal como hicimos en la etapa de análisis estadístico descriptivo)</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="linear.html#cb180-1"></a><span class="kw">library</span>(ggcorrplot)</span>
<span id="cb180-2"><a href="linear.html#cb180-2"></a></span>
<span id="cb180-3"><a href="linear.html#cb180-3"></a>corr_selected &lt;-<span class="st"> </span>bienestar <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb180-4"><a href="linear.html#cb180-4"></a><span class="st">  </span><span class="kw">select</span>(gini, gasto_educ, dualismo_sectorial, inversion_extranjera, pib, </span>
<span id="cb180-5"><a href="linear.html#cb180-5"></a>         diversidad_etnica, tipo_regimen, gasto_salud, gasto_segsocial,</span>
<span id="cb180-6"><a href="linear.html#cb180-6"></a>         bal_legislativo, poblacion) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb180-7"><a href="linear.html#cb180-7"></a><span class="st">  </span><span class="co"># calcular la matriz de correlaciones y redondear a un decimal</span></span>
<span id="cb180-8"><a href="linear.html#cb180-8"></a><span class="st">  </span><span class="kw">cor</span>(<span class="dt">use =</span> <span class="st">&quot;pairwise&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb180-9"><a href="linear.html#cb180-9"></a><span class="st">  </span><span class="kw">round</span>(<span class="dv">1</span>)</span>
<span id="cb180-10"><a href="linear.html#cb180-10"></a></span>
<span id="cb180-11"><a href="linear.html#cb180-11"></a><span class="kw">ggcorrplot</span>(corr_selected, <span class="dt">type =</span> <span class="st">&quot;lower&quot;</span>, <span class="dt">lab =</span> T, <span class="dt">show.legend =</span> F)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-26"></span>
<img src="05-linear_es_files/figure-html/unnamed-chunk-26-1.png" alt="Matriz de correlación, donde diagnosticaremos los problemas de multicolinealidad" width="1728" />
<p class="caption">
Figura 3.24: Matriz de correlación, donde diagnosticaremos los problemas de multicolinealidad
</p>
</div>
<p>Vemos que algunas de nuestras variables tienen fuertes correlaciones, como el gasto en seguridad social <code>gasto_segsocial</code> y la población (<code>poblacion</code>), que tiene una correlación negativa de 0,7. En cualquier caso, para detectar si la multicolinealidad es un problema, es necesario realizar un test de VIF (<em>variance inflation factor</em>), porque mirar los pares de correlaciones no nos ayuda a establecer si más de dos variables tienen una correlación lineal. Lo que el test VIF revela es cuánto “crecen” los errores de los coeficientes cuando el resto de las variables están presentes (cuánto aumenta la varianza del error).</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="linear.html#cb181-1"></a><span class="kw">vif</span>(model_<span class="dv">2</span>)</span>
<span id="cb181-2"><a href="linear.html#cb181-2"></a><span class="co">##                      GVIF Df GVIF^(1/(2*Df))</span></span>
<span id="cb181-3"><a href="linear.html#cb181-3"></a><span class="co">## gasto_educ            1.8  1             1.4</span></span>
<span id="cb181-4"><a href="linear.html#cb181-4"></a><span class="co">## inversion_extranjera  1.5  1             1.2</span></span>
<span id="cb181-5"><a href="linear.html#cb181-5"></a><span class="co">## gasto_salud           1.8  1             1.3</span></span>
<span id="cb181-6"><a href="linear.html#cb181-6"></a><span class="co">## gasto_segsocial       4.8  1             2.2</span></span>
<span id="cb181-7"><a href="linear.html#cb181-7"></a><span class="co">## poblacion             5.0  1             2.2</span></span>
<span id="cb181-8"><a href="linear.html#cb181-8"></a><span class="co">## dualismo_sectorial    1.2  1             1.1</span></span>
<span id="cb181-9"><a href="linear.html#cb181-9"></a><span class="co">##  [ reached getOption(&quot;max.print&quot;) -- omitted 4 rows ]</span></span></code></pre></div>
<p>A continuación, hacemos una consulta sobre si la raíz cuadrada de VIF para cada variable es inferior a 2 (la raíz cuadrada porque nos interesa el error estándar y no la varianza). Como regla general, la puntuación debe ser inferior a 2. Si es superior a 2, significa que la varianza es alta. Por lo tanto, hay problemas de multicolinealidad.</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="linear.html#cb182-1"></a><span class="kw">sqrt</span>(<span class="kw">vif</span>(model_<span class="dv">2</span>)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">2</span></span>
<span id="cb182-2"><a href="linear.html#cb182-2"></a><span class="co">##                       GVIF    Df GVIF^(1/(2*Df))</span></span>
<span id="cb182-3"><a href="linear.html#cb182-3"></a><span class="co">## gasto_educ           FALSE FALSE           FALSE</span></span>
<span id="cb182-4"><a href="linear.html#cb182-4"></a><span class="co">## inversion_extranjera FALSE FALSE           FALSE</span></span>
<span id="cb182-5"><a href="linear.html#cb182-5"></a><span class="co">## gasto_salud          FALSE FALSE           FALSE</span></span>
<span id="cb182-6"><a href="linear.html#cb182-6"></a><span class="co">## gasto_segsocial       TRUE FALSE           FALSE</span></span>
<span id="cb182-7"><a href="linear.html#cb182-7"></a><span class="co">## poblacion             TRUE FALSE           FALSE</span></span>
<span id="cb182-8"><a href="linear.html#cb182-8"></a><span class="co">## dualismo_sectorial   FALSE FALSE           FALSE</span></span>
<span id="cb182-9"><a href="linear.html#cb182-9"></a><span class="co">##  [ reached getOption(&quot;max.print&quot;) -- omitted 4 rows ]</span></span></code></pre></div>
<p>Según la consulta, parece que no tenemos problemas de multicolinealidad. Sin embargo, si los tenemos, ¿deberíamos corregirlos? En general, los manuales de econometría coinciden en la necesidad de reducir la multicolinealidad en función de su gravedad y de cuál es el objetivo principal del modelo de regresión. Debemos considerar los tres puntos siguientes:</p>
<ol style="list-style-type: decimal">
<li><p>La seriedad de las cuestiones aumenta el grado de multicolinealidad. Por lo tanto, si tenemos una multicolinealidad moderada, es plausible no resolverla.</p></li>
<li><p>La multicolinealidad sólo afecta a las variables específicas independientes que están correlacionadas. Por lo tanto, si la multicolinealidad no está presente en las variables independientes de interés, es plausible no resolverla.</p></li>
<li><p>La multicolinealidad sólo afecta a los coeficientes y a los errores estándar, pero no influye directamente en los valores predichos del modelo, ni en la precisión de estas predicciones y en la bondad de las estadísticas de ajuste. Si nuestro principal objetivo es hacer predicciones, y no necesitamos entender el papel de cada variable independiente, no necesitamos reducir la multicolinealidad.</p></li>
</ol>
</div>
<div id="soluciones-a-la-multicolinealidad" class="section level5">
<h5><span class="header-section-number">5.6.0.4.2</span> Soluciones a la multicolinealidad</h5>
<ol style="list-style-type: decimal">
<li><p>Eliminando una de las variables independientes que está fuertemente correlacionada. Esto constituye una compensación, y es necesario que haya una justificación teórica que explique por qué se mantuvieron algunas variables y otras no, además de hacer evidente el alto grado de correlación.</p></li>
<li><p>Combinando las variables que están fuertemente correlacionadas, por ejemplo, haciendo un índice (como mostramos en el Capítulo <a href="indexes.html#indexes">15</a>.</p></li>
</ol>
<ul>
<li>Hasta ahora, hemos revisado cuatro supuestos que nos permiten afirmar que nuestros estimadores de MCO no están sesgados. Es decir, nos permite confiar en que la expectativa de la estimación hecha a través de MCO será igual al promedio de la población: <span class="math inline">\(E(\hat\beta)=\beta\)</span></li>
</ul>
</div>
</div>
<div id="homoscedasticidad" class="section level4">
<h4><span class="header-section-number">5.6.0.5</span> Homoscedasticidad</h4>
<p>El quinto supuesto está relacionado con la eficiencia. Es decir, con la variación del término de error de nuestra estimación. El término de error varianza es una constante. Es decir, dado cualquier valor de las variables explicativas, el error tiene la misma varianza.</p>
<p><span class="math inline">\(Var(u\mid{x})=\sigma^2\)</span>, that is <span class="math inline">\(Var(u)=\sigma^2\)</span></p>
<p>Así, la varianza del error inobservable, <span class="math inline">\(u\)</span>, condicionada a las variables explicativas, es constante. Como dijimos anteriormente, este supuesto <strong>no afecta al sesgo</strong> del estimador (es decir, que la distribución muestral de nuestra estimación <span class="math inline">\(\hat{\beta_1}\)</span> está centrada en <span class="math inline">\(\beta_1\)</span>), sino a su <em>eficiencia</em> (cuánta dispersión hay alrededor de la estimación <span class="math inline">\(\hat{\beta_1}\)</span> del parámetro <span class="math inline">\(\beta_1\)</span>)</p>
<p>Este supuesto es crucial para calcular la varianza de los estimadores MCO, y es el que permite que sea el estimador de menor varianza entre los estimadores lineales no sesgados. Si evaluamos la fórmula de error estándar de los coeficientes, la necesidad de este supuesto se hace evidente:
<span class="math display">\[\hat{\sigma}_{\hat{\beta}{_1}} = \frac{\hat{\sigma}} {\sqrt{\sum(X_j – \bar{X})^2(1 - R^2_j)}}\]</span></p>
<ul>
<li><span class="math inline">\(\hat{\sigma}\)</span> Es la varianza del término del error: <span class="math inline">\(\frac{\sum\hat{u}}{n-k-1}\)</span></li>
</ul>
<p>Para implementar esta fórmula, <strong>necesitamos</strong> que <span class="math inline">\({\sigma^2}\)</span> sea constante. Cuando esta suposición no se cumple, es decir, el término de error no permanece constante para diferentes valores de <span class="math inline">\(x\)</span>, nos enfrentamos a un escenario de <strong>heteroscedasticidad</strong>. Es bastante común tener heteroscedasticidad. La buena noticia es que esto no dificulta el uso del estimador MCO: ¡hay una solución!</p>
<div id="evaluando-el-supuesto" class="section level5">
<h5><span class="header-section-number">5.6.0.5.1</span> Evaluando el supuesto</h5>
<p>Para evaluar este supuesto, se suelen seguir dos pasos:</p>
<ol style="list-style-type: decimal">
<li>Diagnóstico visual: Queremos observar si los residuos (la distancia entre los puntos y la línea de regresión) son constantes para diferentes valores de x. Primero, hacemos un simple gráfico de dispersión de las variables independientes que nos interesan y la variable dependiente:</li>
</ol>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="linear.html#cb183-1"></a><span class="kw">ggplot</span>(bienestar_no_na, <span class="kw">aes</span>(gasto_educ, gini)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb183-2"><a href="linear.html#cb183-2"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb183-3"><a href="linear.html#cb183-3"></a><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span><span class="st"> </span></span>
<span id="cb183-4"><a href="linear.html#cb183-4"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-29"></span>
<img src="05-linear_es_files/figure-html/unnamed-chunk-29-1.png" alt=" Evaluación visual de la suposición de homoscedasticidad" width="672" />
<p class="caption">
Figura 3.26:  Evaluación visual de la suposición de homoscedasticidad
</p>
</div>
<p>Al parecer, en los niveles bajos de gasto en educación, la variabilidad de los niveles de desigualdad es significativamente mayor que en los niveles más altos de gasto en educación. Podemos hacer un mejor diagnóstico visual si utilizamos el modelo estimado (y no sólo la relación entre las dos variables) y graficamos los residuos. En primer lugar, lo hacemos para el modelo bivariante, simplemente usando <code>plot()</code> con el argumento <code>which = 1</code> (hay algunos otros diagnósticos disponibles, que no discutiremos aquí):</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="linear.html#cb184-1"></a><span class="kw">plot</span>(model_<span class="dv">1</span>, <span class="dt">which =</span> <span class="dv">1</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-30"></span>
<img src="05-linear_es_files/figure-html/unnamed-chunk-30-1.png" alt=" Evaluación de la homoscedasticidad para el modelo bivariado." width="60%" />
<p class="caption">
Figura 3.27:  Evaluación de la homoscedasticidad para el modelo bivariado.
</p>
</div>
<p>Despues, lo hacemos para el modelo mutivariado:</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="linear.html#cb185-1"></a><span class="kw">plot</span>(model_<span class="dv">1</span>, <span class="dt">which =</span> <span class="dv">1</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-31"></span>
<img src="05-linear_es_files/figure-html/unnamed-chunk-31-1.png" alt=" Evaluación de la homoscedasticidad para el modelo multivariado." width="60%" />
<p class="caption">
Figura 5.9:  Evaluación de la homoscedasticidad para el modelo multivariado.
</p>
</div>
<p>Estos gráficos marcan los valores ajustados contra los residuos que se grafican. Recordemos que bajo el supuesto de homocedasticidad, ya que <span class="math inline">\(Var(u\mid{x})=\sigma^2\)</span>, entonces <span class="math inline">\(Var(Y\mid{x})=\sigma^2\)</span>. En otras palabras, la varianza de los residuales de los valores predichos basados en x’s <strong>debería ser constante</strong>. Por lo tanto, si no hay absolutamente ninguna heteroscedasticidad (es decir, estamos ante un escenario de homocedasticidad), debemos observar una distribución completamente aleatoria e igual de puntos a lo largo del rango del eje X y una línea roja constante. Sin embargo, observamos claramente que los residuos no son constantes para los diferentes valores de la variable gasto en educación. Estamos ante un caso de <strong>heteroscedasticidad</strong>.</p>
<ul>
<li>También podemos evaluar cada variable del modelo y así identificar en qué variables específicas está presente la heteroscedasticidad. De nuevo, lo que esperamos es que la línea roja coincida con la línea punteada (en cero). Usaremos la función <code>residualPlots</code> en el paquete <code>car</code>. Una forma de usar una función sin subir toda la librería es con <code>::</code> como puedes ver aquí:</li>
</ul>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="linear.html#cb186-1"></a>car<span class="op">::</span><span class="kw">residualPlots</span>(model_<span class="dv">2</span>)</span>
<span id="cb186-2"><a href="linear.html#cb186-2"></a><span class="co">##                      Test stat Pr(&gt;|Test stat|)    </span></span>
<span id="cb186-3"><a href="linear.html#cb186-3"></a><span class="co">## gasto_educ               -1.80            0.074 .  </span></span>
<span id="cb186-4"><a href="linear.html#cb186-4"></a><span class="co">## inversion_extranjera     -0.09            0.928    </span></span>
<span id="cb186-5"><a href="linear.html#cb186-5"></a><span class="co">## gasto_salud              -0.85            0.395    </span></span>
<span id="cb186-6"><a href="linear.html#cb186-6"></a><span class="co">## gasto_segsocial           0.99            0.325    </span></span>
<span id="cb186-7"><a href="linear.html#cb186-7"></a><span class="co">## poblacion                -2.30            0.023 *  </span></span>
<span id="cb186-8"><a href="linear.html#cb186-8"></a><span class="co">## dualismo_sectorial       -0.19            0.849    </span></span>
<span id="cb186-9"><a href="linear.html#cb186-9"></a><span class="co">##  [ reached getOption(&quot;max.print&quot;) -- omitted 5 rows ]</span></span>
<span id="cb186-10"><a href="linear.html#cb186-10"></a><span class="co">## ---</span></span>
<span id="cb186-11"><a href="linear.html#cb186-11"></a><span class="co">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-32"></span>
<img src="05-linear_es_files/figure-html/unnamed-chunk-32-1.png" alt=" Análisis de residuos para cada covariable" width="1344" /><img src="05-linear_es_files/figure-html/unnamed-chunk-32-2.png" alt=" Análisis de residuos para cada covariable" width="1344" />
<p class="caption">
Figura 3.28:  Análisis de residuos para cada covariable
</p>
</div>
</div>
<div id="diagnóstico-estadístico" class="section level5">
<h5><span class="header-section-number">5.6.0.5.2</span> Diagnóstico estadístico</h5>
<p>En el segundo paso hacemos un diagnóstico estadístico. Hay diferentes maneras de evaluar la homoscedasticidad, pero el test de <em>Breusch-Pagan</em> es la más utilizada. La lógica de este test es la siguiente: se hace una regresión, donde la variable dependiente consiste en los residuos cuadrados para evaluar si las variables independientes del modelo tienen alguna relación con <span class="math inline">\(u\)</span> o no. Lo que esperamos es que el efecto sea 0, porque si la varianza del error es constante, el error (residuos) no debería variar en relación con los valores de <span class="math inline">\(x&#39;s\)</span>. En resumen, ¡no queremos rechazar la hipótesis nula!</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="linear.html#cb187-1"></a><span class="kw">bptest</span>(model_<span class="dv">2</span>, <span class="dt">studentize =</span> T)</span>
<span id="cb187-2"><a href="linear.html#cb187-2"></a><span class="co">## </span></span>
<span id="cb187-3"><a href="linear.html#cb187-3"></a><span class="co">##  studentized Breusch-Pagan test</span></span>
<span id="cb187-4"><a href="linear.html#cb187-4"></a><span class="co">## </span></span>
<span id="cb187-5"><a href="linear.html#cb187-5"></a><span class="co">## data:  model_2</span></span>
<span id="cb187-6"><a href="linear.html#cb187-6"></a><span class="co">## BP = 32, df = 12, p-value = 0.001</span></span></code></pre></div>
<p>Como el valor p es menor de 0,05, la hipótesis nula es rechazada. Por lo tanto, estamos en un escenario de heteroscedasticidad.</p>
</div>
<div id="soluciones-a-la-heteroscedasticidad" class="section level5">
<h5><span class="header-section-number">5.6.0.5.3</span> Soluciones a la heteroscedasticidad</h5>
<p>Una vez que identificamos que tenemos heteroscedasticidad, es necesario resolverla. La primera alternativa es corregir la <em>forma funcional</em>. Puede estar frente a un caso en el que la no constancia del término de error es el resultado de una relación no lineal entre las variables, un problema que ya hemos aprendido a resolver, por ejemplo, exponiendo las variables. La segunda alternativa se produce a menudo cuando la naturaleza empírica de la relación hace que el error no sea constante. Sabemos que no podemos calcular los errores estándar de los estimadores como siempre lo hacemos en MCO: como la varianza del error es <strong>no constante</strong>, es necesario modificar la forma en que calculamos los errores.</p>
<p>Así, para hacer una inferencia, necesitamos ajustar la estimación del error de tal manera que podamos hacer una estimación válida en presencia de <strong>heteroscedasticidad de la forma desconocida</strong>. Esto es, aunque no sepamos el tipo de heteroscedasticidad que tenemos, podemos mejorar nuestra precisión y hacer una inferencia estadística válida. La fórmula habitual del error estándar del estimador es:
<span class="math display">\[
\hat\sigma_{\hat\beta_1} = \frac{\sum_{i=1}^{n}(x_{i}-\overline{x})^2\hat{\sigma}} {\sqrt{\sum(X_j – \bar{X})^2(1 - R^2_j)}}
\]</span></p>
<p>Lo que pasa es que cuando se tiene <strong>homoscedasticidad</strong>, lo que hay en el nominador: <span class="math inline">\(\sum_{i=1}^{n}(x_{i}-\overline{x})^2\hat{\sigma}=\hat\sigma\)</span>. Dado que el significado ya no es constante, ¡la igualdad ya no está presente! Esto se debe a que el valor asumido por el signo depende de los diferentes valores de <span class="math inline">\(x\)</span>. Además, recuerda que al estimar una regresión <strong>múltiple</strong>, es necesario restar la variación de <span class="math inline">\(x_1\)</span> en la estimación del error estándar, que se explica por el resto de los <span class="math inline">\(x_k\)</span> del modelo.</p>
<p>Así, en una regresión múltiple, un estimador válido de <span class="math inline">\(\hat{\sigma}_{\hat{\beta}{_1}}\)</span> bajo heteroscedasticidad será:
<span class="math display">\[\hat{\sigma}_{\hat{\beta}{_1}} = \frac{\sum_{i=1}^{n}r_{ij}^2\hat{u}^2}{\sqrt{\sum(X_j–\bar{X})^2(1 - R^2_j)}}\]</span></p>
<p>donde:</p>
<p><em><span class="math inline">\(r_{ij}^2\)</span> Representa los residuos cuadrados de la regresión del resto de las variables independientes en la variable independiente <span class="math inline">\(j\)</span>.
</em><span class="math inline">\(\sqrt{\sum(X_j–\bar{X})^2(1 - R^2_j)}\)</span> Representa la Varianza Total de x después de restar el efecto del resto de las x.</p>
<p>Esta forma de estimar los errores estándar se llama <strong>errores estándar robustos</strong>, también conocidos como <strong>refuerzo</strong> del error, que no es otra cosa que abordar y permitir la heterocedasticidad haciendo que los errores sean más exigentes.</p>
<div id="errores-estándar-robustos" class="section level6">
<h6><span class="header-section-number">5.6.0.5.3.1</span> Errores Estándar Robustos</h6>
<p>Mientras que hay varias maneras de reforzar los errores (incluso podemos hacerlo a mano), R nos permite calcularlos fácilmente con el comando <code>coeftest</code> del paquete <code>lmtest</code>. Además, el paquete <code>sandwich</code>, con su función <code>vcovHC</code>, nos permite incorporar las especificaciones de la robusta matriz de varianza-covarianza.</p>
<ul>
<li>HC0 = es el original de White <span class="citation">(Wooldridge <a href="referencias.html#ref-wooldridgeIntroductoryEconometricsModern2016" role="doc-biblioref">2016</a>)</span></li>
<li>HC1= Es el que usa el software de Stata</li>
<li>HC3 =Es el más conservador, por lo tanto, es muy recomendable</li>
</ul>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="linear.html#cb188-1"></a><span class="kw">library</span>(lmtest)</span>
<span id="cb188-2"><a href="linear.html#cb188-2"></a><span class="kw">library</span>(sandwich)</span>
<span id="cb188-3"><a href="linear.html#cb188-3"></a>model_<span class="dv">2</span>_robust_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">coeftest</span>(model_<span class="dv">2</span>, <span class="dt">vcov =</span> <span class="kw">vcovHC</span>(model_<span class="dv">2</span>, <span class="st">&quot;HC3&quot;</span>))</span>
<span id="cb188-4"><a href="linear.html#cb188-4"></a>model_<span class="dv">2</span>_robust_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">coeftest</span>(model_<span class="dv">2</span>, <span class="dt">vcov =</span> <span class="kw">vcovHC</span>(model_<span class="dv">2</span>, <span class="st">&quot;HC1&quot;</span>))</span>
<span id="cb188-5"><a href="linear.html#cb188-5"></a>model_<span class="dv">2</span>_robust_<span class="dv">0</span> &lt;-<span class="st"> </span><span class="kw">coeftest</span>(model_<span class="dv">2</span>, <span class="dt">vcov =</span> <span class="kw">vcovHC</span>(model_<span class="dv">2</span>, <span class="st">&quot;HC0&quot;</span>))</span>
<span id="cb188-6"><a href="linear.html#cb188-6"></a></span>
<span id="cb188-7"><a href="linear.html#cb188-7"></a>models_robust &lt;-<span class="st"> </span><span class="kw">list</span>(model_<span class="dv">2</span>, model_<span class="dv">2</span>_robust_<span class="dv">0</span>, </span>
<span id="cb188-8"><a href="linear.html#cb188-8"></a>                      model_<span class="dv">2</span>_robust_<span class="dv">1</span>, model_<span class="dv">2</span>_robust_<span class="dv">3</span>)</span>
<span id="cb188-9"><a href="linear.html#cb188-9"></a></span>
<span id="cb188-10"><a href="linear.html#cb188-10"></a><span class="kw">screenreg</span>(models_robust,</span>
<span id="cb188-11"><a href="linear.html#cb188-11"></a>          <span class="dt">custom.model.names =</span> <span class="kw">c</span>(<span class="st">&quot;sin ES robustos&quot;</span>, </span>
<span id="cb188-12"><a href="linear.html#cb188-12"></a>                                 <span class="st">&quot;robustos HC0&quot;</span>, <span class="st">&quot;robustos HC1&quot;</span>, <span class="st">&quot;robustos HC3&quot;</span>))</span>
<span id="cb188-13"><a href="linear.html#cb188-13"></a><span class="co">## </span></span>
<span id="cb188-14"><a href="linear.html#cb188-14"></a><span class="co">## ================================================================================</span></span>
<span id="cb188-15"><a href="linear.html#cb188-15"></a><span class="co">##                        sin ES robustos  robustos HC0  robustos HC1  robustos HC3</span></span>
<span id="cb188-16"><a href="linear.html#cb188-16"></a><span class="co">## --------------------------------------------------------------------------------</span></span>
<span id="cb188-17"><a href="linear.html#cb188-17"></a><span class="co">## (Intercept)             85.94 ***        85.94 ***     85.94 ***     85.94      </span></span>
<span id="cb188-18"><a href="linear.html#cb188-18"></a><span class="co">##                         (8.73)           (8.77)        (9.14)                   </span></span>
<span id="cb188-19"><a href="linear.html#cb188-19"></a><span class="co">## gasto_educ               1.59 ***         1.59 **       1.59 **       1.59      </span></span>
<span id="cb188-20"><a href="linear.html#cb188-20"></a><span class="co">##                         (0.45)           (0.50)        (0.52)                   </span></span>
<span id="cb188-21"><a href="linear.html#cb188-21"></a><span class="co">## inversion_extranjera     0.24             0.24          0.24          0.24      </span></span>
<span id="cb188-22"><a href="linear.html#cb188-22"></a><span class="co">##                         (0.18)           (0.14)        (0.14)                   </span></span>
<span id="cb188-23"><a href="linear.html#cb188-23"></a><span class="co">## gasto_salud             -0.83 **         -0.83 ***     -0.83 ***     -0.83      </span></span>
<span id="cb188-24"><a href="linear.html#cb188-24"></a><span class="co">##                         (0.26)           (0.22)        (0.23)                   </span></span>
<span id="cb188-25"><a href="linear.html#cb188-25"></a><span class="co">## gasto_segsocial         -0.83 ***        -0.83 **      -0.83 **      -0.83      </span></span>
<span id="cb188-26"><a href="linear.html#cb188-26"></a><span class="co">##                         (0.20)           (0.25)        (0.26)                   </span></span>
<span id="cb188-27"><a href="linear.html#cb188-27"></a><span class="co">## poblacion               -0.93 ***        -0.93 ***     -0.93 ***     -0.93      </span></span>
<span id="cb188-28"><a href="linear.html#cb188-28"></a><span class="co">##                         (0.17)           (0.20)        (0.21)                   </span></span>
<span id="cb188-29"><a href="linear.html#cb188-29"></a><span class="co">## dualismo_sectorial      -0.17 ***        -0.17 ***     -0.17 ***     -0.17      </span></span>
<span id="cb188-30"><a href="linear.html#cb188-30"></a><span class="co">##                         (0.03)           (0.03)        (0.03)                   </span></span>
<span id="cb188-31"><a href="linear.html#cb188-31"></a><span class="co">## diversidad_etnica        3.68 ***         3.68 ***      3.68 ***      3.68      </span></span>
<span id="cb188-32"><a href="linear.html#cb188-32"></a><span class="co">##                         (1.04)           (0.92)        (0.96)                   </span></span>
<span id="cb188-33"><a href="linear.html#cb188-33"></a><span class="co">## pib                     -0.00 **         -0.00 *       -0.00 *       -0.00      </span></span>
<span id="cb188-34"><a href="linear.html#cb188-34"></a><span class="co">##                         (0.00)           (0.00)        (0.00)                   </span></span>
<span id="cb188-35"><a href="linear.html#cb188-35"></a><span class="co">## factor(tipo_regimen)2   -2.29            -2.29         -2.29         -2.29      </span></span>
<span id="cb188-36"><a href="linear.html#cb188-36"></a><span class="co">##                         (4.75)           (1.36)        (1.41)                   </span></span>
<span id="cb188-37"><a href="linear.html#cb188-37"></a><span class="co">## factor(tipo_regimen)3   -2.90            -2.90 *       -2.90 *       -2.90      </span></span>
<span id="cb188-38"><a href="linear.html#cb188-38"></a><span class="co">##                         (4.70)           (1.16)        (1.20)                   </span></span>
<span id="cb188-39"><a href="linear.html#cb188-39"></a><span class="co">## factor(tipo_regimen)4   -5.14            -5.14 ***     -5.14 ***     -5.14      </span></span>
<span id="cb188-40"><a href="linear.html#cb188-40"></a><span class="co">##                         (4.62)           (0.84)        (0.88)                   </span></span>
<span id="cb188-41"><a href="linear.html#cb188-41"></a><span class="co">## bal_legislativo        -10.40 ***       -10.40 ***    -10.40 ***    -10.40      </span></span>
<span id="cb188-42"><a href="linear.html#cb188-42"></a><span class="co">##                         (2.22)           (2.29)        (2.38)                   </span></span>
<span id="cb188-43"><a href="linear.html#cb188-43"></a><span class="co">## --------------------------------------------------------------------------------</span></span>
<span id="cb188-44"><a href="linear.html#cb188-44"></a><span class="co">## R^2                      0.59                                                   </span></span>
<span id="cb188-45"><a href="linear.html#cb188-45"></a><span class="co">## Adj. R^2                 0.56                                                   </span></span>
<span id="cb188-46"><a href="linear.html#cb188-46"></a><span class="co">## Num. obs.              167                                                      </span></span>
<span id="cb188-47"><a href="linear.html#cb188-47"></a><span class="co">## ================================================================================</span></span>
<span id="cb188-48"><a href="linear.html#cb188-48"></a><span class="co">## *** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</span></span></code></pre></div>
<p>Todas las alternativas dan lugar a errores sólidos similares. La diferencia viene dada por las diferentes especificaciones sobre la matriz robusta de varianza-covarianza (HC).</p>
<blockquote>
<p><em>Consejo</em>: Para reproducir el comportamiento por defecto de Stata de usar la opción robusta en una llamada de regresión, necesitas solicitar a vcovHC usar la matriz de varianza-covarianza robusta HC1.</p>
</blockquote>
</div>
</div>
<div id="un-caso-especial-de-heteroscedasticidad-varianza-de-error-asociada-a-los-clusters" class="section level5">
<h5><span class="header-section-number">5.6.0.5.4</span> Un caso especial de Heteroscedasticidad: varianza de error asociada a los clusters</h5>
<p>Sabemos que hay observaciones que pueden relacionarse entre sí dentro de grupos (o clusters) específicos. Por ejemplo, los países de América Latina podrían relacionarse por pertenecer a regiones similares (América del Sur frente a América Central o el Caribe, regiones andinas frente a no andinas, etc.). Así pues, sus errores estándar podrían correlacionarse en función de la región a la que pertenecen. Entonces, tenemos que la varianza del error condicionada por la región no es constante.</p>
<p>Mientras se trabaja con datos de panel, como es nuestro caso, esto es mucho más claro. Al tener el gasto en educación por país durante varios años, <em>autocorrelación del error</em> existe entre observaciones de un mismo país. Es decir, los errores se correlacionan entre las observaciones del mismo país para cada año (lo que se gasta en un año determinado está probablemente relacionado con lo que se gastó en el año anterior). Entonces, cuando nuestras observaciones pertenecen a clusters, la corrección será para <strong>clusters de los errores estándar</strong>.</p>
<p>Lo que hacemos cuando agrupamos los errores estándar es permitir la existencia de una correlación de errores dentro del cluster (se afloja el supuesto de homoscedasticidad). Así, permitimos que la variación del error no sea constante, sino que sea diferente según los clusters. La selección de los clusters pertinentes se definirá teóricamente. En este caso, tiene sentido pensar que los clusters son los países. Recordemos que nuestro objetivo es estimar el efecto del gasto en educación en el Gini de los países latinoamericanos. Observemos esta relación en la región para evaluar si, a primera vista, existen clusters:</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="linear.html#cb189-1"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb189-2"><a href="linear.html#cb189-2"></a></span>
<span id="cb189-3"><a href="linear.html#cb189-3"></a><span class="kw">ggplot</span>(bienestar_no_na, <span class="kw">aes</span>(gasto_educ, gini)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb189-4"><a href="linear.html#cb189-4"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb189-5"><a href="linear.html#cb189-5"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>pais) </span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-35"></span>
<img src="05-linear_es_files/figure-html/unnamed-chunk-35-1.png" alt=" Relación entre la educación y el Gini por país" width="576" />
<p class="caption">
Figura 5.10:  Relación entre la educación y el Gini por país
</p>
</div>
<p>Parece que hay clusters por países. Es decir, el gasto en educación por país suele mantenerse dentro de un rango que varía ligeramente. Cuando lo observamos así no es obvio, ya que hay muchos países. Sin embargo, parece que todavía hay ciertos clusters por país (las observaciones se agrupan por país; no parecen ser independientes).</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="linear.html#cb190-1"></a><span class="kw">ggplot</span>(bienestar_no_na, <span class="kw">aes</span>(gasto_educ, gini, <span class="dt">color =</span> pais)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb190-2"><a href="linear.html#cb190-2"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb190-3"><a href="linear.html#cb190-3"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-36"></span>
<img src="05-linear_es_files/figure-html/unnamed-chunk-36-1.png" alt=" Concretamos la figura anterior en una sola faceta" width="672" />
<p class="caption">
Figura 5.11:  Concretamos la figura anterior en una sola faceta
</p>
</div>
<p>Para hacer la estimación de MCO con el error de cluster, usaremos el comando <code>lm.cluser</code> del paquete <code>miceadds</code>. Este comando agrupa los errores estándar según la variable de agrupación indicada. En resumen, lo que estamos haciendo es permitir la presencia de una correlación de errores dentro de los clusters, en este caso, países (aflojando la suposición de homoscedasticidad).</p>
<p>Los errores estándar robustos por clusters pueden aumentar o disminuir los errores estándar. Es decir, los errores estándar por conglomerados pueden ser mayores o menores que los errores estándar convencionales. La dirección en la que cambian los errores estándar depende del signo de la correlación de los errores intragrupo. Para este paso, es necesario instalar los paquetes <code>miceadds</code> y <code>multiwayvcoc</code>. Con la opción “cluster”, indicamos qué variable agrupará los errores:</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="linear.html#cb191-1"></a><span class="co"># install.packages(&quot;miceadds&quot;)</span></span>
<span id="cb191-2"><a href="linear.html#cb191-2"></a><span class="kw">library</span>(miceadds)</span>
<span id="cb191-3"><a href="linear.html#cb191-3"></a>model_<span class="dv">2</span>_cluster &lt;-<span class="st"> </span>miceadds<span class="op">::</span><span class="kw">lm.cluster</span>(</span>
<span id="cb191-4"><a href="linear.html#cb191-4"></a>  <span class="dt">data =</span> bienestar_no_na, </span>
<span id="cb191-5"><a href="linear.html#cb191-5"></a>  <span class="dt">formula =</span> gini <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>gasto_educ <span class="op">+</span><span class="st"> </span>dualismo_sectorial <span class="op">+</span><span class="st"> </span>inversion_extranjera <span class="op">+</span><span class="st"> </span>pib <span class="op">+</span><span class="st"> </span></span>
<span id="cb191-6"><a href="linear.html#cb191-6"></a><span class="st">    </span>diversidad_etnica <span class="op">+</span><span class="st"> </span>tipo_regimen <span class="op">+</span><span class="st"> </span>gasto_salud <span class="op">+</span><span class="st"> </span>gasto_segsocial <span class="op">+</span><span class="st"> </span>bal_legislativo, </span>
<span id="cb191-7"><a href="linear.html#cb191-7"></a>  <span class="dt">cluster =</span> <span class="st">&quot;pais&quot;</span></span>
<span id="cb191-8"><a href="linear.html#cb191-8"></a>)</span>
<span id="cb191-9"><a href="linear.html#cb191-9"></a></span>
<span id="cb191-10"><a href="linear.html#cb191-10"></a><span class="kw">summary</span>(model_<span class="dv">2</span>_cluster)</span>
<span id="cb191-11"><a href="linear.html#cb191-11"></a><span class="co">## R^2= 0.51 </span></span>
<span id="cb191-12"><a href="linear.html#cb191-12"></a><span class="co">## </span></span>
<span id="cb191-13"><a href="linear.html#cb191-13"></a><span class="co">##                      Estimate Std. Error t value Pr(&gt;|t|)</span></span>
<span id="cb191-14"><a href="linear.html#cb191-14"></a><span class="co">## (Intercept)           4.9e+01    3.56936 13.7775  3.5e-43</span></span>
<span id="cb191-15"><a href="linear.html#cb191-15"></a><span class="co">## gasto_educ            1.1e+00    0.62151  1.8321  6.7e-02</span></span>
<span id="cb191-16"><a href="linear.html#cb191-16"></a><span class="co">## dualismo_sectorial   -1.5e-01    0.05207 -2.8472  4.4e-03</span></span>
<span id="cb191-17"><a href="linear.html#cb191-17"></a><span class="co">## inversion_extranjera  6.1e-01    0.11008  5.5403  3.0e-08</span></span>
<span id="cb191-18"><a href="linear.html#cb191-18"></a><span class="co">## pib                   6.8e-05    0.00015  0.4576  6.5e-01</span></span>
<span id="cb191-19"><a href="linear.html#cb191-19"></a><span class="co">##  [ reached getOption(&quot;max.print&quot;) -- omitted 5 rows ]</span></span></code></pre></div>
<p>Al utilizar los clusters, el coeficiente de nuestra variable independiente <code>gasto_educ</code> disminuyó de 1,56 a 1,19, pero mantuvo una alta significancia estadística (valor t de &gt;12).</p>
</div>
</div>
<div id="la-normalidad-en-la-distribución-del-error" class="section level4">
<h4><span class="header-section-number">5.6.0.6</span> La normalidad en la distribución del error</h4>
<p>Hasta ahora, hemos revisado y evaluado empíricamente - cuando ha sido posible - los cinco supuestos del teorema de Gauss-Markov que aseguran que el estimador MCO es el mejor parámetro lineal imparcial (BLUE, por sus siglas en inglés). Sin embargo, estos no son suficientes para hacer inferencias estadísticas. Para ello, necesitamos una suposición adicional:</p>
<p>Como hemos aprendido previamente, para probar una hipótesis de significancia individual de un coeficiente estimado por MCO, utilizamos la estadística <span class="math inline">\(t\)</span> que nos permite contrastar el valor empírico <span class="math inline">\(t\)</span> contra un valor teórico <span class="math inline">\(t\)</span> (llamado “valor crítico”) dado un cierto nivel de significación (<span class="math inline">\(\alpha\)</span>). Se suele utilizar un alfa del 5% (por eso hablamos de significancia estadística con un nivel de confianza del 95%), Sin embargo, para realizar esta prueba de hipótesis, y así hacer una inferencia estadística, es necesario asumir que el coeficiente (<span class="math inline">\(\beta\)</span>) sigue una distribución T-Student. Sólo entonces podemos realizar la prueba de hipótesis utilizando la estadística <span class="math inline">\(t\)</span>.</p>
<p>La suposición que permite esto es la de la <em>normalidad en la distribución del error</em>. Dado que el estimador MCO (<span class="math inline">\(\beta\)</span>) es una combinación lineal de los errores (<span class="math inline">\(Y = \beta_0 + \beta_1x + u\)</span>), al asumir una distribución normal del error (<span class="math inline">\(u\)</span>), podemos asumir una distribución normal del estimador MCO. Sin embargo, como se desconoce el error y su varianza, se estiman utilizando los residuos de la regresión (<span class="math inline">\(\hat{u}\)</span>), obteniendo así el error estándar de la estimación. No obstante, las estimaciones implican una pérdida de grados de libertad (por cada parámetro estimado perdemos un grado de libertad: n-k-1, n=tamaño de la muestra, k=número de parámetros estimados -variables del modelo-, 1=la estimación de interceptación, <span class="math inline">\(\beta_0\)</span>) y, por lo tanto, la distribución del error estándar y, por ende, del coeficiente, que ya no se distribuye normalmente sino como T-Student (<span class="math inline">\(\hat\beta t_{n-k-1}\)</span>). Los dos comandos siguientes nos permiten comprobar que los residuos del modelo estimado a través del MCO siguen una distribución T-Student (aproximadamente normal).</p>
<ul>
<li>El comando <code>qqPlot</code> viene por defecto en R, y genera una gráfica de probabilidad normal que muestra la distribución de los datos frente a una distribución normal esperada teórica. Por lo tanto, lo que necesitamos examinar en el gráfico es que las observaciones (que son los residuos) no deben salir de las líneas punteadas (que delimitan la distribución normal):</li>
</ul>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="linear.html#cb192-1"></a><span class="kw">qqPlot</span>(model_<span class="dv">2</span><span class="op">$</span>residuals)</span>
<span id="cb192-2"><a href="linear.html#cb192-2"></a><span class="co">## [1] 160 118</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-38"></span>
<img src="05-linear_es_files/figure-html/unnamed-chunk-38-1.png" alt=" La normalidad de los residuos. Obsérvese que los países 160 y 118 son valores extremos" width="480" />
<p class="caption">
Figura 5.12:  La normalidad de los residuos. Obsérvese que los países 160 y 118 son valores extremos
</p>
</div>
<ul>
<li>El comando <code>ggdensity</code> del paquete <code>ggpubr</code> nos permite construir diagramas de densidad. Así, podemos trazar los residuos para evaluar visualmente si siguen una distribución aproximadamente normal.</li>
</ul>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="linear.html#cb193-1"></a><span class="kw">library</span>(ggpubr)</span>
<span id="cb193-2"><a href="linear.html#cb193-2"></a><span class="kw">ggdensity</span>(model_<span class="dv">2</span><span class="op">$</span>residuals, <span class="dt">main =</span> <span class="st">&quot; Gráfica de densidad de los residuos&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-39"></span>
<img src="05-linear_es_files/figure-html/unnamed-chunk-39-1.png" alt=" Normalidad de la prueba de residuos" width="672" />
<p class="caption">
Figura 5.13:  Normalidad de la prueba de residuos
</p>
</div>
<p>Después de evaluar los supuestos y encontrar las soluciones (cuando sea necesario), podemos tener una mayor certeza en nuestra estimación y, como resultado, en la relación encontrada entre las variables. No obstante, una explicación completa de nuestro descubrimiento debe profundizar en el por qué y cómo se relacionan las dos variables entre sí. Todo lo que hemos aprendido será útil en el capítulo de selección de casos de estudio <a href="case-sel.html#case-sel">6</a>. En el próximo capítulo, estimaremos modelos con variables dependientes binarias mediante la Estimación de Máxima Verosimilitud (EMV, por sus siglas en inglés).</p>
<blockquote>
<p><strong>Ejercicio 5F.</strong>
- Antes de pasar al siguiente capítulo, haz un gráfico de dispersión de la relación entre la variable <code>gini</code> y la variable <code>inversion_extranjera</code>. Añade el nombre del país a cada observación.
- Para el modelo 1, añade la variable <code>inversion_extranjera</code> como control e interpreta su coeficiente.
- Haz las pruebas correspondientes para comprobar que no se violan las suposiciones del MCO.
- Usando <code>htmlreg</code>, exporta la tabla de regresión a Word.</p>
</blockquote>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="23">
<li id="fn23"><p>E-mail: <a href="mailto:ifynn@uc.cl" class="email">ifynn@uc.cl</a><a href="linear.html#fnref23" class="footnote-back">↩︎</a></p></li>
<li id="fn24"><p>E-mail: <a href="mailto:lnocetto@uc.cl" class="email">lnocetto@uc.cl</a><a href="linear.html#fnref24" class="footnote-back">↩︎</a></p></li>
<li id="fn25"><p>En realidad, la estructura es de datos de panel: el mismo país tiene diferentes observaciones a través del tiempo. Sin embargo, actualmente no somos capaces de acercarnos a estos datos. Lo trataremos en el capítulo de los datos de panel<a href="linear.html#fnref25" class="footnote-back">↩︎</a></p></li>
<li id="fn26"><p>para ello, puedes consultar el capítulo <a href="adv-data.html#adv-data">11</a> sobre imputación de valores perdidos<a href="linear.html#fnref26" class="footnote-back">↩︎</a></p></li>
<li id="fn27"><p>Hacemos esto para facilitar el ejemplo, con tus datos no debes hacerlo ya que podrías crear sesgos no deseados<a href="linear.html#fnref27" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="load.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="case-sel.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "night",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/arcruz0/libroadp/edit/master/05-linear_es.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
