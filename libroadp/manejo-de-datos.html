<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 3 Manejo de datos | AnalizaR Datos Políticos</title>
  <meta name="description" content="Manual aplicado para politólogos y relacionistas internacionales en R" />
  <meta name="generator" content="bookdown 0.12.2 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 3 Manejo de datos | AnalizaR Datos Políticos" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Manual aplicado para politólogos y relacionistas internacionales en R" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 3 Manejo de datos | AnalizaR Datos Políticos" />
  
  <meta name="twitter:description" content="Manual aplicado para politólogos y relacionistas internacionales en R" />
  

<meta name="author" content="Francisco Urdinez y Andrés Cruz Labrín (editores)" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link rel="prev" href="rbas.html"/>
<link rel="next" href="dataviz.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<link href="libs/wordcloud2-0.0.1/wordcloud.css" rel="stylesheet" />
<script src="libs/wordcloud2-0.0.1/wordcloud2-all.js"></script>
<script src="libs/wordcloud2-0.0.1/hover.js"></script>
<script src="libs/wordcloud2-binding-0.2.2/wordcloud2.js"></script>
<script>
% https://stackoverflow.com/a/4425214/8242291
var links = document.links;

for (var i = 0, linksLength = links.length; i < linksLength; i++) {

    if (links[i].hostname != window.location.hostname) {
        links[i].target = '_blank';
    }

}
</script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #2a211c;
    color: #bdae9d;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #bdae9d;  padding-left: 4px; }
div.sourceCode
  { color: #bdae9d; background-color: #2a211c; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ffff00; } /* Alert */
code span.an { color: #0066ff; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #44aa43; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #43a8ed; font-weight: bold; } /* ControlFlow */
code span.ch { color: #049b0a; } /* Char */
code span.cn { } /* Constant */
code span.co { color: #0066ff; font-weight: bold; font-style: italic; } /* Comment */
code span.do { color: #0066ff; font-style: italic; } /* Documentation */
code span.dt { text-decoration: underline; } /* DataType */
code span.dv { color: #44aa43; } /* DecVal */
code span.er { color: #ffff00; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #44aa43; } /* Float */
code span.fu { color: #ff9358; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #0066ff; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #43a8ed; font-weight: bold; } /* Keyword */
code span.op { } /* Operator */
code span.pp { font-weight: bold; } /* Preprocessor */
code span.sc { color: #049b0a; } /* SpecialChar */
code span.ss { color: #049b0a; } /* SpecialString */
code span.st { color: #049b0a; } /* String */
code span.va { } /* Variable */
code span.vs { color: #049b0a; } /* VerbatimString */
code span.wa { color: #ffff00; font-weight: bold; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><b><a href="./index.html"><img style="float: left; margin-right: 5px;" src="favicon.ico"></img>AnalizaR datos políticos</a></b></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introducción</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#inicio"><i class="fa fa-check"></i><b>1.1</b> Inicio</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#como-contribuir"><i class="fa fa-check"></i><b>1.2</b> ¿Cómo contribuir?</a><ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#sobre-los-autores-y-autoras"><i class="fa fa-check"></i><b>1.2.1</b> Sobre los autores y autoras</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#prefacio"><i class="fa fa-check"></i><b>1.3</b> Prefacio</a><ul>
<li class="chapter" data-level="1.3.1" data-path="index.html"><a href="index.html#agradecimientos"><i class="fa fa-check"></i><b>1.3.1</b> Agradecimientos</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#que-esperar-del-libro"><i class="fa fa-check"></i><b>1.4</b> Qué esperar del libro</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#estructura-del-libro"><i class="fa fa-check"></i><b>1.5</b> Estructura del libro</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#prerrequisitos"><i class="fa fa-check"></i><b>1.6</b> Prerrequisitos</a></li>
</ul></li>
<li class="part"><span><b>I Introducción a R</b></span></li>
<li class="chapter" data-level="2" data-path="rbas.html"><a href="rbas.html"><i class="fa fa-check"></i><b>2</b> R básico</a><ul>
<li class="chapter" data-level="2.1" data-path="rbas.html"><a href="rbas.html#instalacion"><i class="fa fa-check"></i><b>2.1</b> Instalación</a><ul>
<li class="chapter" data-level="2.1.1" data-path="rbas.html"><a href="rbas.html#r"><i class="fa fa-check"></i><b>2.1.1</b> R</a></li>
<li class="chapter" data-level="2.1.2" data-path="rbas.html"><a href="rbas.html#rstudio"><i class="fa fa-check"></i><b>2.1.2</b> RStudio</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="rbas.html"><a href="rbas.html#partes-de-rstudio"><i class="fa fa-check"></i><b>2.2</b> Partes de RStudio</a><ul>
<li class="chapter" data-level="2.2.1" data-path="rbas.html"><a href="rbas.html#consola"><i class="fa fa-check"></i><b>2.2.1</b> Consola</a></li>
<li class="chapter" data-level="2.2.2" data-path="rbas.html"><a href="rbas.html#script"><i class="fa fa-check"></i><b>2.2.2</b> Script</a></li>
<li class="chapter" data-level="2.2.3" data-path="rbas.html"><a href="rbas.html#objetos"><i class="fa fa-check"></i><b>2.2.3</b> Objetos</a></li>
<li class="chapter" data-level="2.2.4" data-path="rbas.html"><a href="rbas.html#archivos-graficos-paquetes-ayuda"><i class="fa fa-check"></i><b>2.2.4</b> Archivos / gráficos / paquetes / ayuda</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="manejo-de-datos.html"><a href="manejo-de-datos.html"><i class="fa fa-check"></i><b>3</b> Manejo de datos</a><ul>
<li class="chapter" data-level="3.1" data-path="manejo-de-datos.html"><a href="manejo-de-datos.html#introduccion-1"><i class="fa fa-check"></i><b>3.1</b> Introducción</a><ul>
<li class="chapter" data-level="3.1.1" data-path="manejo-de-datos.html"><a href="manejo-de-datos.html#nuestra-base-de-datos"><i class="fa fa-check"></i><b>3.1.1</b> Nuestra base de datos</a></li>
<li class="chapter" data-level="3.1.2" data-path="manejo-de-datos.html"><a href="manejo-de-datos.html#describir-la-base"><i class="fa fa-check"></i><b>3.1.2</b> Describir la base</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="manejo-de-datos.html"><a href="manejo-de-datos.html#operaciones-basicas"><i class="fa fa-check"></i><b>3.2</b> Operaciones básicas</a><ul>
<li class="chapter" data-level="3.2.1" data-path="manejo-de-datos.html"><a href="manejo-de-datos.html#seleccionar-columnas"><i class="fa fa-check"></i><b>3.2.1</b> Seleccionar columnas</a></li>
<li class="chapter" data-level="3.2.2" data-path="manejo-de-datos.html"><a href="manejo-de-datos.html#renombrar-columnas"><i class="fa fa-check"></i><b>3.2.2</b> Renombrar columnas</a></li>
<li class="chapter" data-level="3.2.3" data-path="manejo-de-datos.html"><a href="manejo-de-datos.html#filtrar-observaciones"><i class="fa fa-check"></i><b>3.2.3</b> Filtrar observaciones</a></li>
<li class="chapter" data-level="3.2.4" data-path="manejo-de-datos.html"><a href="manejo-de-datos.html#ejercicio-a"><i class="fa fa-check"></i><b>3.2.4</b> (Ejercicio A)</a></li>
<li class="chapter" data-level="3.2.5" data-path="manejo-de-datos.html"><a href="manejo-de-datos.html#ordenar-una-base"><i class="fa fa-check"></i><b>3.2.5</b> Ordenar una base</a></li>
<li class="chapter" data-level="3.2.6" data-path="manejo-de-datos.html"><a href="manejo-de-datos.html#transformar-y-crear-variables"><i class="fa fa-check"></i><b>3.2.6</b> Transformar y crear variables</a></li>
<li class="chapter" data-level="3.2.7" data-path="manejo-de-datos.html"><a href="manejo-de-datos.html#ejercicio-b"><i class="fa fa-check"></i><b>3.2.7</b> (Ejercicio B)</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="manejo-de-datos.html"><a href="manejo-de-datos.html#resumenes"><i class="fa fa-check"></i><b>3.3</b> Resúmenes</a><ul>
<li class="chapter" data-level="3.3.1" data-path="manejo-de-datos.html"><a href="manejo-de-datos.html#resumenes-agrupados"><i class="fa fa-check"></i><b>3.3.1</b> Resúmenes agrupados</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="manejo-de-datos.html"><a href="manejo-de-datos.html#comandos-en-cadena"><i class="fa fa-check"></i><b>3.4</b> Comandos en cadena</a><ul>
<li class="chapter" data-level="3.4.1" data-path="manejo-de-datos.html"><a href="manejo-de-datos.html#ejercicio-c"><i class="fa fa-check"></i><b>3.4.1</b> (Ejercicio C)</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="manejo-de-datos.html"><a href="manejo-de-datos.html#manejo-de-datos-recodificar"><i class="fa fa-check"></i><b>3.5</b> Recodificar valores</a><ul>
<li class="chapter" data-level="3.5.1" data-path="manejo-de-datos.html"><a href="manejo-de-datos.html#ejercicio-d"><i class="fa fa-check"></i><b>3.5.1</b> (Ejercicio D)</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="manejo-de-datos.html"><a href="manejo-de-datos.html#manejo-de-datos-pivoteo"><i class="fa fa-check"></i><b>3.6</b> Pivoteo de bases</a><ul>
<li class="chapter" data-level="3.6.1" data-path="manejo-de-datos.html"><a href="manejo-de-datos.html#ejercicio-e"><i class="fa fa-check"></i><b>3.6.1</b> (Ejercicio E)</a></li>
<li class="chapter" data-level="3.6.2" data-path="manejo-de-datos.html"><a href="manejo-de-datos.html#bases-en-formato-wide-con-mas-de-una-variable-de-interes"><i class="fa fa-check"></i><b>3.6.2</b> Bases en formato <em>wide</em> con más de una variable de interés</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="dataviz.html"><a href="dataviz.html"><i class="fa fa-check"></i><b>4</b> Visualización de datos</a><ul>
<li class="chapter" data-level="4.1" data-path="dataviz.html"><a href="dataviz.html#por-que-quiero-visualizar-mis-datos"><i class="fa fa-check"></i><b>4.1</b> ¿Por qué quiero visualizar mis datos?</a></li>
<li class="chapter" data-level="4.2" data-path="dataviz.html"><a href="dataviz.html#primeros-pasos"><i class="fa fa-check"></i><b>4.2</b> Primeros pasos</a><ul>
<li class="chapter" data-level="4.2.1" data-path="dataviz.html"><a href="dataviz.html#las-capas-del-multiverso-ggplotidiano"><i class="fa fa-check"></i><b>4.2.1</b> Las capas del multiverso ggplotidiano</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="dataviz.html"><a href="dataviz.html#elecciones-locales-y-visualizacion-de-datos"><i class="fa fa-check"></i><b>4.3</b> Elecciones locales y visualización de datos</a><ul>
<li class="chapter" data-level="4.3.1" data-path="dataviz.html"><a href="dataviz.html#grafico-de-barras"><i class="fa fa-check"></i><b>4.3.1</b> Gráfico de barras</a></li>
<li class="chapter" data-level="4.3.2" data-path="dataviz.html"><a href="dataviz.html#grafico-de-linea"><i class="fa fa-check"></i><b>4.3.2</b> Gráfico de Línea</a></li>
<li class="chapter" data-level="4.3.3" data-path="dataviz.html"><a href="dataviz.html#boxplot"><i class="fa fa-check"></i><b>4.3.3</b> Boxplot</a></li>
<li class="chapter" data-level="4.3.4" data-path="dataviz.html"><a href="dataviz.html#histograma"><i class="fa fa-check"></i><b>4.3.4</b> Histograma</a></li>
<li class="chapter" data-level="4.3.5" data-path="dataviz.html"><a href="dataviz.html#relacion-entre-variables"><i class="fa fa-check"></i><b>4.3.5</b> Relación entre variables</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="dataviz.html"><a href="dataviz.html#para-seguir-aprendiendo"><i class="fa fa-check"></i><b>4.4</b> Para seguir aprendiendo</a><ul>
<li class="chapter" data-level="4.4.1" data-path="dataviz.html"><a href="dataviz.html#otros-paquetes"><i class="fa fa-check"></i><b>4.4.1</b> Otros paquetes:</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="carga.html"><a href="carga.html"><i class="fa fa-check"></i><b>5</b> Carga de bases</a><ul>
<li class="chapter" data-level="5.1" data-path="carga.html"><a href="carga.html#carga-intro"><i class="fa fa-check"></i><b>5.1</b> Introducción</a></li>
<li class="chapter" data-level="5.2" data-path="carga.html"><a href="carga.html#carga-formatos"><i class="fa fa-check"></i><b>5.2</b> Distintos formatos de bases</a><ul>
<li class="chapter" data-level="5.2.1" data-path="carga.html"><a href="carga.html#archivos-separados-por-delimitadores-.csv-y-.tsv"><i class="fa fa-check"></i><b>5.2.1</b> Archivos separados por delimitadores (.csv y .tsv)</a></li>
<li class="chapter" data-level="5.2.2" data-path="carga.html"><a href="carga.html#carga-r"><i class="fa fa-check"></i><b>5.2.2</b> Archivos creados con R (.Rdata y .rds)</a></li>
<li class="chapter" data-level="5.2.3" data-path="carga.html"><a href="carga.html#carga-etiquetas"><i class="fa fa-check"></i><b>5.2.3</b> Datos con etiquetas (Stata o SPSS)</a></li>
<li class="chapter" data-level="5.2.4" data-path="carga.html"><a href="carga.html#carga-excel"><i class="fa fa-check"></i><b>5.2.4</b> Archivos de Excel</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="carga.html"><a href="carga.html#multiples-bases-de-datos-a-la-vez"><i class="fa fa-check"></i><b>5.3</b> Múltiples bases de datos a la vez</a></li>
<li class="chapter" data-level="5.4" data-path="carga.html"><a href="carga.html#carga-grandes"><i class="fa fa-check"></i><b>5.4</b> Bases de datos tabulares grandes</a></li>
</ul></li>
<li class="part"><span><b>II Modelos</b></span></li>
<li class="chapter" data-level="6" data-path="lineal.html"><a href="lineal.html"><i class="fa fa-check"></i><b>6</b> Modelos lineales</a><ul>
<li class="chapter" data-level="6.1" data-path="lineal.html"><a href="lineal.html#introduccion-2"><i class="fa fa-check"></i><b>6.1</b> Introducción</a></li>
<li class="chapter" data-level="6.2" data-path="lineal.html"><a href="lineal.html#aplicacion-en-r"><i class="fa fa-check"></i><b>6.2</b> Aplicación en <code>R</code></a><ul>
<li class="chapter" data-level="6.2.1" data-path="lineal.html"><a href="lineal.html#estadisticos-descriptivos"><i class="fa fa-check"></i><b>6.2.1</b> Estadísticos Descriptivos</a></li>
<li class="chapter" data-level="6.2.2" data-path="lineal.html"><a href="lineal.html#estadisticos-descriptivos-y-distribucion-de-las-variables-del-modelo"><i class="fa fa-check"></i><b>6.2.2</b> Estadísticos descriptivos y distribución de las variables del modelo</a></li>
<li class="chapter" data-level="6.2.3" data-path="lineal.html"><a href="lineal.html#matriz-de-correlacion-de-variables-independientes"><i class="fa fa-check"></i><b>6.2.3</b> Matriz de correlación de variables independientes</a></li>
<li class="chapter" data-level="6.2.4" data-path="lineal.html"><a href="lineal.html#distribucion-de-las-variables-de-interes"><i class="fa fa-check"></i><b>6.2.4</b> Distribución de las variables de interés</a></li>
<li class="chapter" data-level="6.2.5" data-path="lineal.html"><a href="lineal.html#relacion-entre-la-variable-dependiente-e-independiente"><i class="fa fa-check"></i><b>6.2.5</b> Relación entre la variable dependiente e independiente</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="lineal.html"><a href="lineal.html#modelo-bivariado-regresion-lineal-simple"><i class="fa fa-check"></i><b>6.3</b> Modelo bivariado: regresión lineal simple</a><ul>
<li class="chapter" data-level="6.3.1" data-path="lineal.html"><a href="lineal.html#estimando-un-modelo-lineal-en-r"><i class="fa fa-check"></i><b>6.3.1</b> Estimando un modelo lineal en <code>R</code></a></li>
<li class="chapter" data-level="6.3.2" data-path="lineal.html"><a href="lineal.html#representacion-grafica"><i class="fa fa-check"></i><b>6.3.2</b> Representación gráfica</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="lineal.html"><a href="lineal.html#modelo-multivariado-regresion-multiple"><i class="fa fa-check"></i><b>6.4</b> Modelo multivariado: regresión múltiple</a><ul>
<li class="chapter" data-level="6.4.1" data-path="lineal.html"><a href="lineal.html#ajuste-del-modelo"><i class="fa fa-check"></i><b>6.4.1</b> Ajuste del modelo</a></li>
<li class="chapter" data-level="6.4.2" data-path="lineal.html"><a href="lineal.html#inferencia-en-modelos-lineales-multiples"><i class="fa fa-check"></i><b>6.4.2</b> Inferencia en modelos lineales múltiples</a></li>
<li class="chapter" data-level="6.4.3" data-path="lineal.html"><a href="lineal.html#supuestos-de-ols"><i class="fa fa-check"></i><b>6.4.3</b> Supuestos de OLS</a></li>
<li class="chapter" data-level="6.4.4" data-path="lineal.html"><a href="lineal.html#errores-estandares-robustos"><i class="fa fa-check"></i><b>6.4.4</b> Errores estándares robustos</a></li>
<li class="chapter" data-level="6.4.5" data-path="lineal.html"><a href="lineal.html#un-caso-especial-de-heterocedasticidad-la-varianza-del-error-asociada-a-clusters"><i class="fa fa-check"></i><b>6.4.5</b> Un caso especial de Heterocedasticidad: la varianza del error asociada a clusters</a></li>
<li class="chapter" data-level="6.4.6" data-path="lineal.html"><a href="lineal.html#un-supuesto-adicional-para-poder-realizar-inferencia"><i class="fa fa-check"></i><b>6.4.6</b> Un supuesto adicional para poder realizar <strong>inferencia</strong></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="logit.html"><a href="logit.html"><i class="fa fa-check"></i><b>7</b> Modelos logísticos</a><ul>
<li class="chapter" data-level="7.1" data-path="logit.html"><a href="logit.html#nociones-basicas"><i class="fa fa-check"></i><b>7.1</b> Nociones básicas</a></li>
<li class="chapter" data-level="7.2" data-path="logit.html"><a href="logit.html#aplicacion-en-r-1"><i class="fa fa-check"></i><b>7.2</b> Aplicación en <code>R</code></a><ul>
<li class="chapter" data-level="7.2.1" data-path="logit.html"><a href="logit.html#estimar-los-modelos"><i class="fa fa-check"></i><b>7.2.1</b> Estimar los modelos</a></li>
<li class="chapter" data-level="7.2.2" data-path="logit.html"><a href="logit.html#crear-tablas"><i class="fa fa-check"></i><b>7.2.2</b> Crear tablas</a></li>
<li class="chapter" data-level="7.2.3" data-path="logit.html"><a href="logit.html#visualizacion-de-resultados"><i class="fa fa-check"></i><b>7.2.3</b> Visualización de resultados</a></li>
<li class="chapter" data-level="7.2.4" data-path="logit.html"><a href="logit.html#ajuste-de-los-modelos"><i class="fa fa-check"></i><b>7.2.4</b> Ajuste de los modelos</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="surv.html"><a href="surv.html"><i class="fa fa-check"></i><b>8</b> Modelos de supervivencia</a><ul>
<li class="chapter" data-level="8.1" data-path="surv.html"><a href="surv.html#nociones-basicas-1"><i class="fa fa-check"></i><b>8.1</b> Nociones básicas</a></li>
<li class="chapter" data-level="8.2" data-path="surv.html"><a href="surv.html#el-modelo-cox-de-riesgos-proporcionales"><i class="fa fa-check"></i><b>8.2</b> El modelo Cox de riesgos proporcionales</a></li>
<li class="chapter" data-level="8.3" data-path="surv.html"><a href="surv.html#aplicacion-en-r-2"><i class="fa fa-check"></i><b>8.3</b> Aplicación en <code>R</code></a><ul>
<li class="chapter" data-level="8.3.1" data-path="surv.html"><a href="surv.html#modelos-de-supervivencia-e-interpretacion-sus-coeficientes-como-hazard-ratios."><i class="fa fa-check"></i><b>8.3.1</b> Modelos de supervivencia e interpretación sus coeficientes como Hazard Ratios.</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Aplicaciones</b></span></li>
<li class="chapter" data-level="9" data-path="manejo-av.html"><a href="manejo-av.html"><i class="fa fa-check"></i><b>9</b> Manejo avanzado de datos políticos</a><ul>
<li class="chapter" data-level="9.1" data-path="manejo-av.html"><a href="manejo-av.html#introduccion-3"><i class="fa fa-check"></i><b>9.1</b> Introducción</a></li>
<li class="chapter" data-level="9.2" data-path="manejo-av.html"><a href="manejo-av.html#como-aprovechar-countrycode"><i class="fa fa-check"></i><b>9.2</b> ¿Cómo aprovechar <code>countrycode</code>?</a></li>
<li class="chapter" data-level="9.3" data-path="manejo-av.html"><a href="manejo-av.html#como-imputar-datos-faltantes"><i class="fa fa-check"></i><b>9.3</b> ¿Cómo imputar datos faltantes?</a></li>
<li class="chapter" data-level="9.4" data-path="manejo-av.html"><a href="manejo-av.html#imputar-datos-usando-amelia"><i class="fa fa-check"></i><b>9.4</b> Imputar datos usando Amelia</a><ul>
<li class="chapter" data-level="9.4.1" data-path="manejo-av.html"><a href="manejo-av.html#diagnosticos"><i class="fa fa-check"></i><b>9.4.1</b> Diagnosticos</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="manejo-av.html"><a href="manejo-av.html#regresiones-luego-de-imputar-datos"><i class="fa fa-check"></i><b>9.5</b> Regresiones luego de imputar datos</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="pca.html"><a href="pca.html"><i class="fa fa-check"></i><b>10</b> Creación de índices con PCA</a><ul>
<li class="chapter" data-level="10.1" data-path="pca.html"><a href="pca.html#aplicacion-en-r-3"><i class="fa fa-check"></i><b>10.1</b> Aplicación en <code>R</code></a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="casos.html"><a href="casos.html"><i class="fa fa-check"></i><b>11</b> Selección de casos a partir de regresiones</a><ul>
<li class="chapter" data-level="11.1" data-path="casos.html"><a href="casos.html#que-casos-de-estudio-debo-seleccionar-para-testear-mi-hipotesis"><i class="fa fa-check"></i><b>11.1</b> ¿Qué casos de estudio debo seleccionar para testear mi hipótesis?</a><ul>
<li class="chapter" data-level="11.1.1" data-path="casos.html"><a href="casos.html#casos-tipicos"><i class="fa fa-check"></i><b>11.1.1</b> Casos Típicos</a></li>
<li class="chapter" data-level="11.1.2" data-path="casos.html"><a href="casos.html#casos-desviados"><i class="fa fa-check"></i><b>11.1.2</b> Casos desviados</a></li>
<li class="chapter" data-level="11.1.3" data-path="casos.html"><a href="casos.html#casos-influyentes"><i class="fa fa-check"></i><b>11.1.3</b> Casos Influyentes</a></li>
<li class="chapter" data-level="11.1.4" data-path="casos.html"><a href="casos.html#casos-extremos"><i class="fa fa-check"></i><b>11.1.4</b> Casos extremos</a></li>
<li class="chapter" data-level="11.1.5" data-path="casos.html"><a href="casos.html#casos-mas-similares"><i class="fa fa-check"></i><b>11.1.5</b> Casos más similares</a></li>
<li class="chapter" data-level="11.1.6" data-path="casos.html"><a href="casos.html#casos-mas-diferentes"><i class="fa fa-check"></i><b>11.1.6</b> Casos más diferentes</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="casos.html"><a href="casos.html#la-relevancia-de-combinar-metodos"><i class="fa fa-check"></i><b>11.2</b> La relevancia de combinar métodos</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="web-mining.html"><a href="web-mining.html"><i class="fa fa-check"></i><b>12</b> Mínería de datos</a></li>
<li class="chapter" data-level="13" data-path="redes.html"><a href="redes.html"><i class="fa fa-check"></i><b>13</b> Análisis de redes</a><ul>
<li class="chapter" data-level="13.1" data-path="redes.html"><a href="redes.html#introduccion-4"><i class="fa fa-check"></i><b>13.1</b> Introducción</a></li>
<li class="chapter" data-level="13.2" data-path="redes.html"><a href="redes.html#conceptos-iniciales"><i class="fa fa-check"></i><b>13.2</b> Conceptos iniciales</a><ul>
<li class="chapter" data-level="13.2.1" data-path="redes.html"><a href="redes.html#nodos-y-enlaces"><i class="fa fa-check"></i><b>13.2.1</b> Nodos y enlaces</a></li>
<li class="chapter" data-level="13.2.2" data-path="redes.html"><a href="redes.html#matriz-de-adyacencia"><i class="fa fa-check"></i><b>13.2.2</b> Matriz de adyacencia</a></li>
<li class="chapter" data-level="13.2.3" data-path="redes.html"><a href="redes.html#pesos-y-direccion"><i class="fa fa-check"></i><b>13.2.3</b> Pesos y dirección</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="redes.html"><a href="redes.html#bases-de-datos-de-redes"><i class="fa fa-check"></i><b>13.3</b> Bases de datos de redes</a></li>
<li class="chapter" data-level="13.4" data-path="redes.html"><a href="redes.html#disposicion-grafica"><i class="fa fa-check"></i><b>13.4</b> Disposición gráfica</a><ul>
<li class="chapter" data-level="13.4.1" data-path="redes.html"><a href="redes.html#color-y-forma-en-la-representacion-visual"><i class="fa fa-check"></i><b>13.4.1</b> Color y forma en la representación visual</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="redes.html"><a href="redes.html#analisis-basico-de-redes"><i class="fa fa-check"></i><b>13.5</b> Análisis básico de redes</a><ul>
<li class="chapter" data-level="13.5.1" data-path="redes.html"><a href="redes.html#medidas-de-centralidad"><i class="fa fa-check"></i><b>13.5.1</b> Medidas de centralidad</a></li>
<li class="chapter" data-level="13.5.2" data-path="redes.html"><a href="redes.html#comunidades-en-las-redes"><i class="fa fa-check"></i><b>13.5.2</b> Comunidades en las redes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="qta.html"><a href="qta.html"><i class="fa fa-check"></i><b>14</b> Análisis cuantitativo de texto</a><ul>
<li class="chapter" data-level="14.1" data-path="qta.html"><a href="qta.html#introduccion-5"><i class="fa fa-check"></i><b>14.1</b> Introducción</a></li>
<li class="chapter" data-level="14.2" data-path="qta.html"><a href="qta.html#exploracion-de-la-bases-de-datos"><i class="fa fa-check"></i><b>14.2</b> Exploración de la bases de datos</a></li>
<li class="chapter" data-level="14.3" data-path="qta.html"><a href="qta.html#calculo-de-frecuencias"><i class="fa fa-check"></i><b>14.3</b> Cálculo de frecuencias</a><ul>
<li class="chapter" data-level="14.3.1" data-path="qta.html"><a href="qta.html#cuales-son-los-diez-hashtags-mas-usados-de-las-cuentas-de-los-diputados"><i class="fa fa-check"></i><b>14.3.1</b> ¿Cuáles son los diez hashtags más usados de las cuentas de los diputados?</a></li>
<li class="chapter" data-level="14.3.2" data-path="qta.html"><a href="qta.html#frecuencias-por-genero-cantidad-de-hashtags-usados-por-los-diputados-en-total"><i class="fa fa-check"></i><b>14.3.2</b> Frecuencias por género: cantidad de hashtags usados por los diputados en total</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="qta.html"><a href="qta.html#wordcloud-de-hashtags"><i class="fa fa-check"></i><b>14.4</b> Wordcloud de hashtags</a></li>
<li class="chapter" data-level="14.5" data-path="qta.html"><a href="qta.html#graficar-los-hashtags-mas-utilizados-por-grupos-de-interes"><i class="fa fa-check"></i><b>14.5</b> Graficar los hashtags más utilizados por grupos de interés</a><ul>
<li class="chapter" data-level="14.5.1" data-path="qta.html"><a href="qta.html#hashtags-mas-usados-entre-las-diputadas"><i class="fa fa-check"></i><b>14.5.1</b> Hashtags más usados entre las diputadas</a></li>
<li class="chapter" data-level="14.5.2" data-path="qta.html"><a href="qta.html#hashtags-mas-usados-entre-los-diputados"><i class="fa fa-check"></i><b>14.5.2</b> Hashtags más usados entre los diputados</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="qta.html"><a href="qta.html#hashtags-de-genero-por-caracteristicas-del-diputado"><i class="fa fa-check"></i><b>14.6</b> Hashtags de género por características del diputado</a><ul>
<li class="chapter" data-level="14.6.1" data-path="qta.html"><a href="qta.html#por-el-genero-del-diputado"><i class="fa fa-check"></i><b>14.6.1</b> Por el género del diputado</a></li>
<li class="chapter" data-level="14.6.2" data-path="qta.html"><a href="qta.html#por-la-coalicion-de-los-diputados"><i class="fa fa-check"></i><b>14.6.2</b> Por la coalición de los diputados</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="qta.html"><a href="qta.html#variacion-temporal-del-uso-de-estos-hashtags"><i class="fa fa-check"></i><b>14.7</b> Variación temporal del uso de estos hashtags</a><ul>
<li class="chapter" data-level="14.7.1" data-path="qta.html"><a href="qta.html#frecuencia-semanal-de-olafeminista"><i class="fa fa-check"></i><b>14.7.1</b> Frecuencia semanal de #olafeminista</a></li>
<li class="chapter" data-level="14.7.2" data-path="qta.html"><a href="qta.html#frecuencia-semanal-de-tres-hashtags-de-genero"><i class="fa fa-check"></i><b>14.7.2</b> Frecuencia semanal de tres hashtags de género</a></li>
<li class="chapter" data-level="14.7.3" data-path="qta.html"><a href="qta.html#grafiquemos-los-hashtags-de-genero-por-semana"><i class="fa fa-check"></i><b>14.7.3</b> Grafiquemos los hashtags de género por semana</a></li>
<li class="chapter" data-level="14.7.4" data-path="qta.html"><a href="qta.html#ponderamos-en-relacion-al-total-de-hashtags-por-semana"><i class="fa fa-check"></i><b>14.7.4</b> Ponderamos en relación al total de hashtags por semana</a></li>
<li class="chapter" data-level="14.7.5" data-path="qta.html"><a href="qta.html#grafiquemos-los-hashtags-interesantes-ponderados-por-el-total-semanal"><i class="fa fa-check"></i><b>14.7.5</b> Grafiquemos los hashtags interesantes ponderados por el total semanal</a></li>
<li class="chapter" data-level="14.7.6" data-path="qta.html"><a href="qta.html#diputadas"><i class="fa fa-check"></i><b>14.7.6</b> Diputadas</a></li>
</ul></li>
<li class="chapter" data-level="14.8" data-path="qta.html"><a href="qta.html#hashtags-de-genero-por-semana-a-nivel-de-diputados-ponderados-por-semana"><i class="fa fa-check"></i><b>14.8</b> Hashtags de género por semana a nivel de diputados (ponderados por semana)</a></li>
<li class="chapter" data-level="14.9" data-path="qta.html"><a href="qta.html#comentarios-finales"><i class="fa fa-check"></i><b>14.9</b> Comentarios finales</a></li>
<li class="chapter" data-level="14.10" data-path="qta.html"><a href="qta.html#anexo-problemas-que-se-presentan-cuando-analizas-discursos-debates-o-leyes"><i class="fa fa-check"></i><b>14.10</b> Anexo: Problemas que se presentan cuando analizas discursos, debates o leyes</a></li>
<li class="chapter" data-level="14.11" data-path="qta.html"><a href="qta.html#tidy-text"><i class="fa fa-check"></i><b>14.11</b> <code>Tidy text</code></a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="mapas.html"><a href="mapas.html"><i class="fa fa-check"></i><b>15</b> Generación de mapas</a><ul>
<li class="chapter" data-level="15.1" data-path="mapas.html"><a href="mapas.html#datos-espaciales"><i class="fa fa-check"></i><b>15.1</b> Datos Espaciales</a><ul>
<li class="chapter" data-level="15.1.1" data-path="mapas.html"><a href="mapas.html#que-son"><i class="fa fa-check"></i><b>15.1.1</b> ¿Qué son?</a></li>
<li class="chapter" data-level="15.1.2" data-path="mapas.html"><a href="mapas.html#estructura-de-los-datos-espaciales"><i class="fa fa-check"></i><b>15.1.2</b> Estructura de los Datos Espaciales</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="mapas.html"><a href="mapas.html#datos-espaciales-en-r"><i class="fa fa-check"></i><b>15.2</b> Datos Espaciales en R</a></li>
<li class="chapter" data-level="15.3" data-path="mapas.html"><a href="mapas.html#special-features-en-r"><i class="fa fa-check"></i><b>15.3</b> Special Features en R</a><ul>
<li class="chapter" data-level="15.3.1" data-path="mapas.html"><a href="mapas.html#estructura"><i class="fa fa-check"></i><b>15.3.1</b> Estructura</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="mapas.html"><a href="mapas.html#manejo-de-datos-espaciales"><i class="fa fa-check"></i><b>15.4</b> Manejo de Datos Espaciales</a><ul>
<li class="chapter" data-level="15.4.1" data-path="mapas.html"><a href="mapas.html#modificaciones"><i class="fa fa-check"></i><b>15.4.1</b> Modificaciones</a></li>
<li class="chapter" data-level="15.4.2" data-path="mapas.html"><a href="mapas.html#crear-nuevos-shapefiles-con-st_write"><i class="fa fa-check"></i><b>15.4.2</b> Crear nuevos shapefiles con <code>st_write</code></a></li>
<li class="chapter" data-level="15.4.3" data-path="mapas.html"><a href="mapas.html#incorporar-datos-de-otras-bases-con-merge"><i class="fa fa-check"></i><b>15.4.3</b> Incorporar datos de otras bases con <code>merge</code></a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="mapas.html"><a href="mapas.html#mapear-en-r"><i class="fa fa-check"></i><b>15.5</b> Mapear en R</a></li>
<li class="chapter" data-level="15.6" data-path="mapas.html"><a href="mapas.html#mapeando-variables"><i class="fa fa-check"></i><b>15.6</b> Mapeando variables</a><ul>
<li class="chapter" data-level="15.6.1" data-path="mapas.html"><a href="mapas.html#mapas-animados-con-gganimate"><i class="fa fa-check"></i><b>15.6.1</b> Mapas animados con <code>gganimate</code></a></li>
</ul></li>
<li class="chapter" data-level="15.7" data-path="mapas.html"><a href="mapas.html#inferencia-a-partir-de-datos-espaciales"><i class="fa fa-check"></i><b>15.7</b> Inferencia a partir de Datos Espaciales</a><ul>
<li class="chapter" data-level="15.7.1" data-path="mapas.html"><a href="mapas.html#indicadores-locales-de-asociacion-espacial-lisa"><i class="fa fa-check"></i><b>15.7.1</b> Indicadores locales de asociación espacial (LISA)</a></li>
<li class="chapter" data-level="15.7.2" data-path="mapas.html"><a href="mapas.html#matriz-de-pesos-espaciales"><i class="fa fa-check"></i><b>15.7.2</b> Matriz de Pesos Espaciales</a></li>
<li class="chapter" data-level="15.7.3" data-path="mapas.html"><a href="mapas.html#morans-i"><i class="fa fa-check"></i><b>15.7.3</b> Moran’s I</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">AnalizaR Datos Políticos</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="manejo-de-datos" class="section level1">
<h1><span class="header-section-number">Capítulo 3</span> Manejo de datos</h1>
<p><em>Por Andrés Cruz</em></p>
<div id="introduccion-1" class="section level2">
<h2><span class="header-section-number">3.1</span> Introducción</h2>
<p>La bases de datos tabulares son la forma por excelencia de guardar información en ciencias sociales. Su poder radica en que podemos registrar múltiples dimensiones de información para cada observación que nos interese. Por ejemplo, para cada diputado de un Congreso podemos saber su género, edad, porcentaje de asistencia a sala, número de proyectos de ley que ha presentado, etcétera:</p>
<table>
<thead>
<tr>
<th style="text-align:left;">
diputado
</th>
<th style="text-align:left;">
genero
</th>
<th style="text-align:right;">
edad
</th>
<th style="text-align:right;">
asistencia
</th>
<th style="text-align:right;">
num_proyectos_presentados
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Ana C.
</td>
<td style="text-align:left;">
F
</td>
<td style="text-align:right;">
48
</td>
<td style="text-align:right;">
68
</td>
<td style="text-align:right;">
8
</td>
</tr>
<tr>
<td style="text-align:left;">
José T.
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
74
</td>
<td style="text-align:right;">
3
</td>
</tr>
</tbody>
</table>
<p>Seguramente ya tendrás algún grado de familiaridad con este tipo de bases, gracias a Microsoft Excel o alguna de sus alternativas. La primera fila es el <strong>encabezado</strong>, que indica qué datos registran las celdas de esa columna. La primera columna en este caso es nuestra <strong>columna identificadora</strong>: consultando “diputado” podemos saber a qué observación refiere cada fila. Así, sobre esta pequeña base de datos podemos decir que la <strong>unidad observacional</strong> es el diputado, sobre la que tenemos información en cuatro variables: género, edad, asistencia a las sesiones y núnmero de proyectos presentados.</p>
<p>En el presente capítulo veremos cómo modificar bases de datos tabulares como la del ejemplo. Aprenderás a ordenar las bases, filtrar sus observaciones, crear nuevas variables, generar resúmenes, cambiar nombres, recodificar valores y modificar la estructura de las bases. Todas estas operaciones son un paso inicial para cualquier análisis o visualización: a menudo se estima que el 80% del análisis de datos se invierte en modificar y limpiar nuestros datos para llevarlos a la forma óptima para el análisis (Dasu &amp; Johnson, 2003 en <a href="https://www.jstatsoft.org/index.php/jss/article/view/v059i10/v59i10.pdf">Wickham, 2014</a>).</p>
<div id="nuestra-base-de-datos" class="section level3">
<h3><span class="header-section-number">3.1.1</span> Nuestra base de datos</h3>
<p>Para este capítulo usaremos datos de <a href="https://reyes-housholder.weebly.com/uploads/8/1/0/9/81091026/10._prq_manuscript_feb_2019.pdf">Reyes-Housholder (2019)</a>, con algunas adiciones de los World Development Indicators del Banco Mundial, recopiladas por <a href="https://qog.pol.gu.se/data">Quality of Government (2018)</a>. La autora argumenta que, ante escándalos de corrupción similares, las presidentas latinoamericanas sufren caídas mucho más importantes en aprobación que sus pares masculinos.</p>
<p>Para comenzar a trabajar carguemos el paquete <code>tidyverse</code>, uno de los centrales del libro, que nos dará funciones útiles para trabajar con nuestra base datos.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(tidyverse)</a></code></pre></div>
<p>Ahora carguemos la base a nuestra sesión de R. Podemos hacer esto con con facilidad desde el paquete del libro, por medio de la función <code>data()</code>. La base se llama “aprob_presidencial”:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># library(paqueteadp)</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co"># data(aprob_presidencial)</span></a></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">aprob_presidencial &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;00-datos/aprob_presidencial_esp.csv&quot;</span>)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="co">## Parsed with column specification:</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="co">## cols(</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="co">##   pais = col_character(),</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="co">##   anio = col_double(),</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="co">##   trimestre = col_double(),</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="co">##   presidente = col_character(),</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="co">##   pres_sexo = col_character(),</span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="co">##   aprob_neta = col_double(),</span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="co">##   corr_ejec = col_double(),</span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="co">##   pib = col_double(),</span></a>
<a class="sourceLine" id="cb3-12" data-line-number="12"><span class="co">##   poblacion = col_double(),</span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13"><span class="co">##   desempleo = col_double(),</span></a>
<a class="sourceLine" id="cb3-14" data-line-number="14"><span class="co">##   crec_pib = col_double()</span></a>
<a class="sourceLine" id="cb3-15" data-line-number="15"><span class="co">## )</span></a></code></pre></div>
<p>Con esto podemos comenzar a trabajar con los datos. Puedes chequear que la base se cargó correctamente utilizando el comando <code>ls()</code> (o viendo la pestaña de Environment en RStudio):</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">ls</span>()</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="co">## [1] &quot;aprob_presidencial&quot;</span></a></code></pre></div>
<p>Las siguientes son las variables de la base:</p>
<table>
<colgroup>
<col width="12%" />
<col width="87%" />
</colgroup>
<thead>
<tr class="header">
<th>Variable</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>pais</td>
<td>País.</td>
</tr>
<tr class="even">
<td>anio</td>
<td>Año.</td>
</tr>
<tr class="odd">
<td>trimestre</td>
<td>Trimestre.</td>
</tr>
<tr class="even">
<td>presidente</td>
<td>Presidente/a.</td>
</tr>
<tr class="odd">
<td>pres_sexoo</td>
<td>Sexo del presidente/a.</td>
</tr>
<tr class="even">
<td>aprob_neta</td>
<td>Aprobación neta del presidente/a (% aprobación - % rechazo).</td>
</tr>
<tr class="odd">
<td>pib</td>
<td>Producto interno bruto del país, ajustado por paridad de cambio (PPP) y constante en dólares del 2011, según los World Development Indicators del Banco Mundial.</td>
</tr>
<tr class="even">
<td>poblacion</td>
<td>Población según los World Development Indicators del Banco Mundial.</td>
</tr>
<tr class="odd">
<td>corr_ejec</td>
<td>Corrupción en el Ejecutivo, según V-Dem. De 0 a 100 (mayor es más corrupción).</td>
</tr>
<tr class="even">
<td>desempleo</td>
<td>Porcentaje de desempleo.</td>
</tr>
<tr class="odd">
<td>crec_pib</td>
<td>Crecimiento del PIB.</td>
</tr>
</tbody>
</table>
</div>
<div id="describir-la-base" class="section level3">
<h3><span class="header-section-number">3.1.2</span> Describir la base</h3>
<p>Para aproximarnos a nuestra base recién cargada tenemos varias opciones. Podemos, como antes, simplemente usar su nombre como un comando para un resumen rápido:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">aprob_presidencial</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co">## # A tibble: 1,020 x 11</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co">##    pais   anio trimestre presidente pres_sexo aprob_neta corr_ejec     pib</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co">##    &lt;chr&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">##  1 Arge…  2000         1 Fernando … Masculino      40.1       14.0 5.52e11</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">##  2 Arge…  2000         2 Fernando … Masculino      16.4       14.0 5.52e11</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">##  3 Arge…  2000         3 Fernando … Masculino      24.0       14.0 5.52e11</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co">##  4 Arge…  2000         4 Fernando … Masculino     -18.3       14.0 5.52e11</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="co">##  5 Arge…  2001         1 Fernando … Masculino      -6.97      14.0 5.28e11</span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="co">##  6 Arge…  2001         2 Fernando … Masculino     -20.1       14.0 5.28e11</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="co">##  7 Arge…  2001         3 Fernando … Masculino     -19.4       14.0 5.28e11</span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="co">##  8 Arge…  2001         4 Fernando … Masculino     -23.2       14.0 5.28e11</span></a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="co">##  9 Arge…  2002         1 Eduardo A… Masculino      -2.01      25.0 4.70e11</span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="co">## 10 Arge…  2002         2 Eduardo A… Masculino     -20.1       25.0 4.70e11</span></a>
<a class="sourceLine" id="cb5-15" data-line-number="15"><span class="co">## # … with 1,010 more rows, and 3 more variables: poblacion &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb5-16" data-line-number="16"><span class="co">## #   desempleo &lt;dbl&gt;, crec_pib &lt;dbl&gt;</span></a></code></pre></div>
<p>También podemos utilizar la función <code>glimpse()</code> para tener un resumen desde otra perspectiva, viendo rápidamente las primeras observaciones en cada variable:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw">glimpse</span>(aprob_presidencial)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="co">## Observations: 1,020</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="co">## Variables: 11</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="co">## $ pais       &lt;chr&gt; &quot;Argentina&quot;, &quot;Argentina&quot;, &quot;Argentina&quot;, &quot;Argentina&quot;, &quot;…</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="co">## $ anio       &lt;dbl&gt; 2000, 2000, 2000, 2000, 2001, 2001, 2001, 2001, 2002,…</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="co">## $ trimestre  &lt;dbl&gt; 1, 2, 3, 4, 1, 2, 3, 4, 1, 2, 3, 4, 1, 2, 3, 4, 1, 2,…</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co">## $ presidente &lt;chr&gt; &quot;Fernando de la Rúa&quot;, &quot;Fernando de la Rúa&quot;, &quot;Fernando…</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co">## $ pres_sexo  &lt;chr&gt; &quot;Masculino&quot;, &quot;Masculino&quot;, &quot;Masculino&quot;, &quot;Masculino&quot;, &quot;…</span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co">## $ aprob_neta &lt;dbl&gt; 40.1, 16.4, 24.0, -18.3, -7.0, -20.1, -19.4, -23.2, -…</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co">## $ corr_ejec  &lt;dbl&gt; 14, 14, 14, 14, 14, 14, 14, 14, 25, 25, 25, 25, 50, 5…</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="co">## $ pib        &lt;dbl&gt; 5.5e+11, 5.5e+11, 5.5e+11, 5.5e+11, 5.3e+11, 5.3e+11,…</span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="co">## $ poblacion  &lt;dbl&gt; 3.7e+07, 3.7e+07, 3.7e+07, 3.7e+07, 3.7e+07, 3.7e+07,…</span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="co">## $ desempleo  &lt;dbl&gt; 15, 15, 15, 15, 18, 18, 18, 18, 18, 18, 18, 18, 20, 1…</span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14"><span class="co">## $ crec_pib   &lt;dbl&gt; -0.8, -0.8, -0.8, -0.8, -4.4, -4.4, -4.4, -4.4, -10.9…</span></a></code></pre></div>
<p>Una alternativa que nos permite ver la base completa es la función <code>View()</code>, análoga a clickear nuestro objeto en la pestaña “Environment” de Rstudio:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw">View</span>(aprob_presidencial)</a></code></pre></div>
<p>Podemos obtener un resumen rápido de las variables de nuestra base usando la función <code>skim()</code> del paquete <code>skimr</code>:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="co"># install.packages(&quot;skimr&quot;)</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="kw">library</span>(skimr)</a></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw">skim</span>(aprob_presidencial)</a></code></pre></div>
<pre><code>## Skim summary statistics
##  n obs: 1020 
##  n variables: 11 
## 
## ── Variable type:character ──────────────────────────
##    variable missing complete    n min max empty n_unique
##        pais       0     1020 1020   4  11     0       17
##   pres_sexo       0     1020 1020   8   9     0        2
##  presidente       0     1020 1020  11  38     0       70
## 
## ── Variable type:numeric ────────────────────────────
##    variable missing complete    n       mean       sd          p0        p25        p50      p75        p100     hist
##        anio       0     1020 1020 2007        4.32     2000          2003    2007        2011     2014       ▇▇▇▇▃▇▇▇
##  aprob_neta       0     1020 1020   15.28    27.82      -65.79         -6.57   16          37.59    86.92    ▁▂▆▇▇▇▃▁
##   corr_ejec       0     1020 1020   43.35    26.9         2.13         19.57   39.98       66.62    94.42    ▇▂▅▆▃▃▅▃
##    crec_pib       0     1020 1020    3.77     3.54      -10.9           2.31    4.06        5.63    18.29    ▁▁▁▆▇▂▁▁
##   desempleo       0     1020 1020    7.04     3.61        1.3           4.38    6.41        8.9     20.52    ▅▇▇▃▂▁▁▁
##         pib       0     1020 1020    4.1e+11  6.9e+11     1.7e+10   4e+10       9.2e+10 4e+11        3.1e+12 ▇▁▁▁▁▁▁▁
##   poblacion       0     1020 1020    3.1e+07  4.8e+07 3e+06       5867626       1.3e+07 3e+07    2e+08       ▇▂▁▁▁▁▁▁
##   trimestre       0     1020 1020    2.5      1.12        1             1.75    2.5         3.25     4       ▇▁▇▁▁▇▁▇</code></pre>
<p>Obtener la tabulación de una de las columnas de nuestra base, una operación común para variables categóricas, es sencillo gracias a la función <code>count()</code>. Por ejemplo, podemos comprobar que los países-años-trimestres con mujeres como presidentas son una minoría en la región:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw">count</span>(aprob_presidencial, pres_sexo, </a>
<a class="sourceLine" id="cb11-2" data-line-number="2">      <span class="dt">sort =</span> T) <span class="co"># ordenar de mayor a menor según n</span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="co">## # A tibble: 2 x 2</span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="co">##   pres_sexo     n</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="co">##   &lt;chr&gt;     &lt;int&gt;</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="co">## 1 Masculino   922</span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="co">## 2 Femenino     98</span></a></code></pre></div>
</div>
</div>
<div id="operaciones-basicas" class="section level2">
<h2><span class="header-section-number">3.2</span> Operaciones básicas</h2>
<p>A continuación veremos algunas operaciones básicas para nuestra base de datos, que en su conjunto nos permitirán editar dramáticamente su estructura y contenidos <a href="https://r4ds.had.co.nz/transform.html">(Wickham &amp; Grolemund, 2017)</a>. Esta subsección utiliza las herramientas del paquete <code>dplyr</code> (Wickham et al., 2019), que esta disponible al cargar el <code>tidyvese</code>, lo que ya hicimos.</p>
<div id="seleccionar-columnas" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Seleccionar columnas</h3>
<p>A veces queremos trabajar con solo un extracto de las variables de una base. Para esto existe la función <code>select()</code>. Seleccionemos solo la columna de países:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw">select</span>(aprob_presidencial, pais)</a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="co">## # A tibble: 1,020 x 1</span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="co">##    pais     </span></a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="co">##    &lt;chr&gt;    </span></a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="co">##  1 Argentina</span></a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="co">##  2 Argentina</span></a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="co">##  3 Argentina</span></a>
<a class="sourceLine" id="cb12-8" data-line-number="8"><span class="co">##  4 Argentina</span></a>
<a class="sourceLine" id="cb12-9" data-line-number="9"><span class="co">##  5 Argentina</span></a>
<a class="sourceLine" id="cb12-10" data-line-number="10"><span class="co">##  6 Argentina</span></a>
<a class="sourceLine" id="cb12-11" data-line-number="11"><span class="co">##  7 Argentina</span></a>
<a class="sourceLine" id="cb12-12" data-line-number="12"><span class="co">##  8 Argentina</span></a>
<a class="sourceLine" id="cb12-13" data-line-number="13"><span class="co">##  9 Argentina</span></a>
<a class="sourceLine" id="cb12-14" data-line-number="14"><span class="co">## 10 Argentina</span></a>
<a class="sourceLine" id="cb12-15" data-line-number="15"><span class="co">## # … with 1,010 more rows</span></a></code></pre></div>
<p>El primer argumento de la función anterior (“aprob_presidencial”) es la base en la que queremos realizar la operación. El siguiente argumento, en tanto, indica qué columnas seleccionar (“pais”). Todas las funciones de operaciones básicas que veremos en esta subsección siguen esta lógica: el primer argumento es siempre la base en la que operaremos, mientras que los demás designan cómo queremos realizar la operación.</p>
<p>Recuerda que el código anterior no creó ningún objeto nuevo, es solo un comando que estamos ejecutando en la consola. Si quisiéramos crear un objeto nuevo, tendríamos que asignarlo:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">aprob_presidencial_reducida &lt;-<span class="st"> </span><span class="kw">select</span>(aprob_presidencial, pais)</a>
<a class="sourceLine" id="cb13-2" data-line-number="2">aprob_presidencial_reducida</a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="co">## # A tibble: 1,020 x 1</span></a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="co">##    pais     </span></a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="co">##    &lt;chr&gt;    </span></a>
<a class="sourceLine" id="cb13-6" data-line-number="6"><span class="co">##  1 Argentina</span></a>
<a class="sourceLine" id="cb13-7" data-line-number="7"><span class="co">##  2 Argentina</span></a>
<a class="sourceLine" id="cb13-8" data-line-number="8"><span class="co">##  3 Argentina</span></a>
<a class="sourceLine" id="cb13-9" data-line-number="9"><span class="co">##  4 Argentina</span></a>
<a class="sourceLine" id="cb13-10" data-line-number="10"><span class="co">##  5 Argentina</span></a>
<a class="sourceLine" id="cb13-11" data-line-number="11"><span class="co">##  6 Argentina</span></a>
<a class="sourceLine" id="cb13-12" data-line-number="12"><span class="co">##  7 Argentina</span></a>
<a class="sourceLine" id="cb13-13" data-line-number="13"><span class="co">##  8 Argentina</span></a>
<a class="sourceLine" id="cb13-14" data-line-number="14"><span class="co">##  9 Argentina</span></a>
<a class="sourceLine" id="cb13-15" data-line-number="15"><span class="co">## 10 Argentina</span></a>
<a class="sourceLine" id="cb13-16" data-line-number="16"><span class="co">## # … with 1,010 more rows</span></a></code></pre></div>
<p>Podemos seleccionar múltiples columnas a la vez, separadas por comas:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw">select</span>(aprob_presidencial, pais, anio, desempleo)</a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="co">## # A tibble: 1,020 x 3</span></a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="co">##    pais       anio desempleo</span></a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="co">##    &lt;chr&gt;     &lt;dbl&gt;     &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb14-5" data-line-number="5"><span class="co">##  1 Argentina  2000      15  </span></a>
<a class="sourceLine" id="cb14-6" data-line-number="6"><span class="co">##  2 Argentina  2000      15  </span></a>
<a class="sourceLine" id="cb14-7" data-line-number="7"><span class="co">##  3 Argentina  2000      15  </span></a>
<a class="sourceLine" id="cb14-8" data-line-number="8"><span class="co">##  4 Argentina  2000      15  </span></a>
<a class="sourceLine" id="cb14-9" data-line-number="9"><span class="co">##  5 Argentina  2001      18.3</span></a>
<a class="sourceLine" id="cb14-10" data-line-number="10"><span class="co">##  6 Argentina  2001      18.3</span></a>
<a class="sourceLine" id="cb14-11" data-line-number="11"><span class="co">##  7 Argentina  2001      18.3</span></a>
<a class="sourceLine" id="cb14-12" data-line-number="12"><span class="co">##  8 Argentina  2001      18.3</span></a>
<a class="sourceLine" id="cb14-13" data-line-number="13"><span class="co">##  9 Argentina  2002      17.9</span></a>
<a class="sourceLine" id="cb14-14" data-line-number="14"><span class="co">## 10 Argentina  2002      17.9</span></a>
<a class="sourceLine" id="cb14-15" data-line-number="15"><span class="co">## # … with 1,010 more rows</span></a></code></pre></div>
<p>Supongamos que queremos las primeras cinco variables de la base de datos. Las siguientes tres formas obtienen el mismo resultado, aunque la segunda es la que recomendamos, pues es sucinta pero explícita:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw">select</span>(aprob_presidencial, pais, anio, trimestre, presidente, aprob_neta)</a>
<a class="sourceLine" id="cb15-2" data-line-number="2"><span class="kw">select</span>(aprob_presidencial, pais<span class="op">:</span>aprob_neta) <span class="co"># forma recomendada</span></a>
<a class="sourceLine" id="cb15-3" data-line-number="3"><span class="kw">select</span>(aprob_presidencial, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)</a></code></pre></div>
<pre><code>## # A tibble: 1,020 x 6
##    pais       anio trimestre presidente              pres_sexo aprob_neta
##    &lt;chr&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;                   &lt;chr&gt;          &lt;dbl&gt;
##  1 Argentina  2000         1 Fernando de la Rúa      Masculino      40.1 
##  2 Argentina  2000         2 Fernando de la Rúa      Masculino      16.4 
##  3 Argentina  2000         3 Fernando de la Rúa      Masculino      24.0 
##  4 Argentina  2000         4 Fernando de la Rúa      Masculino     -18.3 
##  5 Argentina  2001         1 Fernando de la Rúa      Masculino      -6.97
##  6 Argentina  2001         2 Fernando de la Rúa      Masculino     -20.1 
##  7 Argentina  2001         3 Fernando de la Rúa      Masculino     -19.4 
##  8 Argentina  2001         4 Fernando de la Rúa      Masculino     -23.2 
##  9 Argentina  2002         1 Eduardo Alberto Duhalde Masculino      -2.01
## 10 Argentina  2002         2 Eduardo Alberto Duhalde Masculino     -20.1 
## # … with 1,010 more rows</code></pre>
<p>El comando <code>select()</code> también nos sirve para reordenar las columnas. Supongamos que queremos que la variable <code>presidente</code> sea la primera. Podemos hacer algo como esto, obteniendo la misma base pero con un nuevo orden de columnas:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="kw">select</span>(aprob_presidencial, presidente, pais<span class="op">:</span>anio, aprob_neta<span class="op">:</span>desempleo)</a>
<a class="sourceLine" id="cb17-2" data-line-number="2"><span class="co">## # A tibble: 1,020 x 8</span></a>
<a class="sourceLine" id="cb17-3" data-line-number="3"><span class="co">##    presidente     pais    anio aprob_neta corr_ejec      pib poblacion desempleo</span></a>
<a class="sourceLine" id="cb17-4" data-line-number="4"><span class="co">##    &lt;chr&gt;          &lt;chr&gt;  &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb17-5" data-line-number="5"><span class="co">##  1 Fernando de l… Argen…  2000      40.1       14.0  5.52e11  37057452      15  </span></a>
<a class="sourceLine" id="cb17-6" data-line-number="6"><span class="co">##  2 Fernando de l… Argen…  2000      16.4       14.0  5.52e11  37057452      15  </span></a>
<a class="sourceLine" id="cb17-7" data-line-number="7"><span class="co">##  3 Fernando de l… Argen…  2000      24.0       14.0  5.52e11  37057452      15  </span></a>
<a class="sourceLine" id="cb17-8" data-line-number="8"><span class="co">##  4 Fernando de l… Argen…  2000     -18.3       14.0  5.52e11  37057452      15  </span></a>
<a class="sourceLine" id="cb17-9" data-line-number="9"><span class="co">##  5 Fernando de l… Argen…  2001      -6.97      14.0  5.28e11  37471509      18.3</span></a>
<a class="sourceLine" id="cb17-10" data-line-number="10"><span class="co">##  6 Fernando de l… Argen…  2001     -20.1       14.0  5.28e11  37471509      18.3</span></a>
<a class="sourceLine" id="cb17-11" data-line-number="11"><span class="co">##  7 Fernando de l… Argen…  2001     -19.4       14.0  5.28e11  37471509      18.3</span></a>
<a class="sourceLine" id="cb17-12" data-line-number="12"><span class="co">##  8 Fernando de l… Argen…  2001     -23.2       14.0  5.28e11  37471509      18.3</span></a>
<a class="sourceLine" id="cb17-13" data-line-number="13"><span class="co">##  9 Eduardo Alber… Argen…  2002      -2.01      25.0  4.70e11  37889370      17.9</span></a>
<a class="sourceLine" id="cb17-14" data-line-number="14"><span class="co">## 10 Eduardo Alber… Argen…  2002     -20.1       25.0  4.70e11  37889370      17.9</span></a>
<a class="sourceLine" id="cb17-15" data-line-number="15"><span class="co">## # … with 1,010 more rows</span></a></code></pre></div>
<p>Esta forma es tediosa, en especial para bases con múltiples variables. Hay una función de ayuda que nos será útil en este caso, llamada <code>everything()</code>. En este caso seleccionará la columna “president” y <em>todo lo demás</em>:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="kw">select</span>(aprob_presidencial, presidente, <span class="kw">everything</span>()) </a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="co">## # A tibble: 1,020 x 11</span></a>
<a class="sourceLine" id="cb18-3" data-line-number="3"><span class="co">##    presidente pais   anio trimestre pres_sexo aprob_neta corr_ejec     pib</span></a>
<a class="sourceLine" id="cb18-4" data-line-number="4"><span class="co">##    &lt;chr&gt;      &lt;chr&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb18-5" data-line-number="5"><span class="co">##  1 Fernando … Arge…  2000         1 Masculino      40.1       14.0 5.52e11</span></a>
<a class="sourceLine" id="cb18-6" data-line-number="6"><span class="co">##  2 Fernando … Arge…  2000         2 Masculino      16.4       14.0 5.52e11</span></a>
<a class="sourceLine" id="cb18-7" data-line-number="7"><span class="co">##  3 Fernando … Arge…  2000         3 Masculino      24.0       14.0 5.52e11</span></a>
<a class="sourceLine" id="cb18-8" data-line-number="8"><span class="co">##  4 Fernando … Arge…  2000         4 Masculino     -18.3       14.0 5.52e11</span></a>
<a class="sourceLine" id="cb18-9" data-line-number="9"><span class="co">##  5 Fernando … Arge…  2001         1 Masculino      -6.97      14.0 5.28e11</span></a>
<a class="sourceLine" id="cb18-10" data-line-number="10"><span class="co">##  6 Fernando … Arge…  2001         2 Masculino     -20.1       14.0 5.28e11</span></a>
<a class="sourceLine" id="cb18-11" data-line-number="11"><span class="co">##  7 Fernando … Arge…  2001         3 Masculino     -19.4       14.0 5.28e11</span></a>
<a class="sourceLine" id="cb18-12" data-line-number="12"><span class="co">##  8 Fernando … Arge…  2001         4 Masculino     -23.2       14.0 5.28e11</span></a>
<a class="sourceLine" id="cb18-13" data-line-number="13"><span class="co">##  9 Eduardo A… Arge…  2002         1 Masculino      -2.01      25.0 4.70e11</span></a>
<a class="sourceLine" id="cb18-14" data-line-number="14"><span class="co">## 10 Eduardo A… Arge…  2002         2 Masculino     -20.1       25.0 4.70e11</span></a>
<a class="sourceLine" id="cb18-15" data-line-number="15"><span class="co">## # … with 1,010 more rows, and 3 more variables: poblacion &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb18-16" data-line-number="16"><span class="co">## #   desempleo &lt;dbl&gt;, crec_pib &lt;dbl&gt;</span></a></code></pre></div>
<p>Otra función de ayuda para select es <code>starts_with()</code>, que nos permite seleccionar columnas según patrones en sus nombres. Por ejemplo, lo siguiente seleccionará todas las columnas que comiencen con el prefijo “wdi_”, que indica como fuente los World Development Indicators del Banco Mundial.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="kw">select</span>(aprob_presidencial, <span class="kw">starts_with</span>(<span class="st">&quot;wdi_&quot;</span>))</a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="co">## # A tibble: 1,020 x 0</span></a></code></pre></div>
</div>
<div id="renombrar-columnas" class="section level3">
<h3><span class="header-section-number">3.2.2</span> Renombrar columnas</h3>
<p>Podemos cambiar el nombre columnas en la base con el comando <code>rename()</code>. Por ejemplo, hagamos el nombre de la variable de PIB más explícito:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="kw">rename</span>(aprob_presidencial, <span class="dt">pib_ppp_c2011 =</span> pib)</a>
<a class="sourceLine" id="cb20-2" data-line-number="2"><span class="co">## # A tibble: 1,020 x 11</span></a>
<a class="sourceLine" id="cb20-3" data-line-number="3"><span class="co">##    pais   anio trimestre presidente pres_sexo aprob_neta corr_ejec pib_ppp_c2011</span></a>
<a class="sourceLine" id="cb20-4" data-line-number="4"><span class="co">##    &lt;chr&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;         &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb20-5" data-line-number="5"><span class="co">##  1 Arge…  2000         1 Fernando … Masculino      40.1       14.0 552151219031.</span></a>
<a class="sourceLine" id="cb20-6" data-line-number="6"><span class="co">##  2 Arge…  2000         2 Fernando … Masculino      16.4       14.0 552151219031.</span></a>
<a class="sourceLine" id="cb20-7" data-line-number="7"><span class="co">##  3 Arge…  2000         3 Fernando … Masculino      24.0       14.0 552151219031.</span></a>
<a class="sourceLine" id="cb20-8" data-line-number="8"><span class="co">##  4 Arge…  2000         4 Fernando … Masculino     -18.3       14.0 552151219031.</span></a>
<a class="sourceLine" id="cb20-9" data-line-number="9"><span class="co">##  5 Arge…  2001         1 Fernando … Masculino      -6.97      14.0 527807756979.</span></a>
<a class="sourceLine" id="cb20-10" data-line-number="10"><span class="co">##  6 Arge…  2001         2 Fernando … Masculino     -20.1       14.0 527807756979.</span></a>
<a class="sourceLine" id="cb20-11" data-line-number="11"><span class="co">##  7 Arge…  2001         3 Fernando … Masculino     -19.4       14.0 527807756979.</span></a>
<a class="sourceLine" id="cb20-12" data-line-number="12"><span class="co">##  8 Arge…  2001         4 Fernando … Masculino     -23.2       14.0 527807756979.</span></a>
<a class="sourceLine" id="cb20-13" data-line-number="13"><span class="co">##  9 Arge…  2002         1 Eduardo A… Masculino      -2.01      25.0 470305820970.</span></a>
<a class="sourceLine" id="cb20-14" data-line-number="14"><span class="co">## 10 Arge…  2002         2 Eduardo A… Masculino     -20.1       25.0 470305820970.</span></a>
<a class="sourceLine" id="cb20-15" data-line-number="15"><span class="co">## # … with 1,010 more rows, and 3 more variables: poblacion &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb20-16" data-line-number="16"><span class="co">## #   desempleo &lt;dbl&gt;, crec_pib &lt;dbl&gt;</span></a></code></pre></div>
<p>También podemos hacer varios cambios de nombre a la vez. Nota cómo modificamos tres nombres en un solo comando:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="kw">rename</span>(aprob_presidencial, </a>
<a class="sourceLine" id="cb21-2" data-line-number="2">       <span class="dt">pib_ppp_c2011 =</span> pib, </a>
<a class="sourceLine" id="cb21-3" data-line-number="3">       <span class="dt">porc_desempleo =</span> desempleo, </a>
<a class="sourceLine" id="cb21-4" data-line-number="4">       <span class="dt">porc_crecimiento_pib =</span> crec_pib)</a>
<a class="sourceLine" id="cb21-5" data-line-number="5"><span class="co">## # A tibble: 1,020 x 11</span></a>
<a class="sourceLine" id="cb21-6" data-line-number="6"><span class="co">##    pais   anio trimestre presidente pres_sexo aprob_neta corr_ejec pib_ppp_c2011</span></a>
<a class="sourceLine" id="cb21-7" data-line-number="7"><span class="co">##    &lt;chr&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;         &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb21-8" data-line-number="8"><span class="co">##  1 Arge…  2000         1 Fernando … Masculino      40.1       14.0 552151219031.</span></a>
<a class="sourceLine" id="cb21-9" data-line-number="9"><span class="co">##  2 Arge…  2000         2 Fernando … Masculino      16.4       14.0 552151219031.</span></a>
<a class="sourceLine" id="cb21-10" data-line-number="10"><span class="co">##  3 Arge…  2000         3 Fernando … Masculino      24.0       14.0 552151219031.</span></a>
<a class="sourceLine" id="cb21-11" data-line-number="11"><span class="co">##  4 Arge…  2000         4 Fernando … Masculino     -18.3       14.0 552151219031.</span></a>
<a class="sourceLine" id="cb21-12" data-line-number="12"><span class="co">##  5 Arge…  2001         1 Fernando … Masculino      -6.97      14.0 527807756979.</span></a>
<a class="sourceLine" id="cb21-13" data-line-number="13"><span class="co">##  6 Arge…  2001         2 Fernando … Masculino     -20.1       14.0 527807756979.</span></a>
<a class="sourceLine" id="cb21-14" data-line-number="14"><span class="co">##  7 Arge…  2001         3 Fernando … Masculino     -19.4       14.0 527807756979.</span></a>
<a class="sourceLine" id="cb21-15" data-line-number="15"><span class="co">##  8 Arge…  2001         4 Fernando … Masculino     -23.2       14.0 527807756979.</span></a>
<a class="sourceLine" id="cb21-16" data-line-number="16"><span class="co">##  9 Arge…  2002         1 Eduardo A… Masculino      -2.01      25.0 470305820970.</span></a>
<a class="sourceLine" id="cb21-17" data-line-number="17"><span class="co">## 10 Arge…  2002         2 Eduardo A… Masculino     -20.1       25.0 470305820970.</span></a>
<a class="sourceLine" id="cb21-18" data-line-number="18"><span class="co">## # … with 1,010 more rows, and 3 more variables: poblacion &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb21-19" data-line-number="19"><span class="co">## #   porc_desempleo &lt;dbl&gt;, porc_crecimiento_pib &lt;dbl&gt;</span></a></code></pre></div>
</div>
<div id="filtrar-observaciones" class="section level3">
<h3><span class="header-section-number">3.2.3</span> Filtrar observaciones</h3>
<p>A menudo queremos quedarnos solo con algunas observaciones de nuestra base de datos, filtrando de acuerdo a características específicas. Podemos hacer esto gracias a la función <code>filter()</code> y operadores lógicos. Para comenzar, quedémonos solo con las observaciones de Chile:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="kw">filter</span>(aprob_presidencial, pais <span class="op">==</span><span class="st"> &quot;Chile&quot;</span>)</a>
<a class="sourceLine" id="cb22-2" data-line-number="2"><span class="co">## # A tibble: 60 x 11</span></a>
<a class="sourceLine" id="cb22-3" data-line-number="3"><span class="co">##    pais   anio trimestre presidente pres_sexo aprob_neta corr_ejec     pib</span></a>
<a class="sourceLine" id="cb22-4" data-line-number="4"><span class="co">##    &lt;chr&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb22-5" data-line-number="5"><span class="co">##  1 Chile  2000         1 Eduardo F… Masculino       6.22      3.63 2.18e11</span></a>
<a class="sourceLine" id="cb22-6" data-line-number="6"><span class="co">##  2 Chile  2000         2 Ricardo L… Masculino      19.8       3.63 2.18e11</span></a>
<a class="sourceLine" id="cb22-7" data-line-number="7"><span class="co">##  3 Chile  2000         3 Ricardo L… Masculino      19.5       3.63 2.18e11</span></a>
<a class="sourceLine" id="cb22-8" data-line-number="8"><span class="co">##  4 Chile  2000         4 Ricardo L… Masculino      14.8       3.63 2.18e11</span></a>
<a class="sourceLine" id="cb22-9" data-line-number="9"><span class="co">##  5 Chile  2001         1 Ricardo L… Masculino       7.99      3.63 2.26e11</span></a>
<a class="sourceLine" id="cb22-10" data-line-number="10"><span class="co">##  6 Chile  2001         2 Ricardo L… Masculino       1.81      3.63 2.26e11</span></a>
<a class="sourceLine" id="cb22-11" data-line-number="11"><span class="co">##  7 Chile  2001         3 Ricardo L… Masculino      -1.40      3.63 2.26e11</span></a>
<a class="sourceLine" id="cb22-12" data-line-number="12"><span class="co">##  8 Chile  2001         4 Ricardo L… Masculino       6.90      3.63 2.26e11</span></a>
<a class="sourceLine" id="cb22-13" data-line-number="13"><span class="co">##  9 Chile  2002         1 Ricardo L… Masculino       6.60      3.63 2.33e11</span></a>
<a class="sourceLine" id="cb22-14" data-line-number="14"><span class="co">## 10 Chile  2002         2 Ricardo L… Masculino       3.65      3.63 2.33e11</span></a>
<a class="sourceLine" id="cb22-15" data-line-number="15"><span class="co">## # … with 50 more rows, and 3 more variables: poblacion &lt;dbl&gt;, desempleo &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb22-16" data-line-number="16"><span class="co">## #   crec_pib &lt;dbl&gt;</span></a></code></pre></div>
<p>Le estamos diciendo a <code>filter()</code>, por medio del segundo argumento, que solo conserve observaciones en las que la variable pais <em>es igual a </em> Chile. Este “es igual a” es un operador lógico, que se escribe como “==” en R. Aquí hay una lista de operadores lógicos comunes:</p>
<table>
<thead>
<tr class="header">
<th align="center">operador</th>
<th>descripción</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><code>==</code></td>
<td>es igual a</td>
</tr>
<tr class="even">
<td align="center"><code>!=</code></td>
<td>es distinto a</td>
</tr>
<tr class="odd">
<td align="center"><code>&gt;</code></td>
<td>es mayor a</td>
</tr>
<tr class="even">
<td align="center"><code>&lt;</code></td>
<td>es menor a</td>
</tr>
<tr class="odd">
<td align="center"><code>&gt;=</code></td>
<td>es mayor o igual a</td>
</tr>
<tr class="even">
<td align="center"><code>&lt;=</code></td>
<td>es menor o igual a</td>
</tr>
<tr class="odd">
<td align="center"><code>&amp;</code></td>
<td>intersección</td>
</tr>
<tr class="even">
<td align="center"><code>|</code></td>
<td>unión</td>
</tr>
<tr class="odd">
<td align="center"><code>%in%</code></td>
<td>está contenido en</td>
</tr>
</tbody>
</table>
<p>Por ejemplo, podemos obtener todas las observaciones (país-año-trimestre) en las que la aprobación presidencial neta es positiva:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="kw">filter</span>(aprob_presidencial, aprob_neta <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb23-2" data-line-number="2"><span class="co">## # A tibble: 709 x 11</span></a>
<a class="sourceLine" id="cb23-3" data-line-number="3"><span class="co">##    pais   anio trimestre presidente pres_sexo aprob_neta corr_ejec     pib</span></a>
<a class="sourceLine" id="cb23-4" data-line-number="4"><span class="co">##    &lt;chr&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb23-5" data-line-number="5"><span class="co">##  1 Arge…  2000         1 Fernando … Masculino       40.1      14.0 5.52e11</span></a>
<a class="sourceLine" id="cb23-6" data-line-number="6"><span class="co">##  2 Arge…  2000         2 Fernando … Masculino       16.4      14.0 5.52e11</span></a>
<a class="sourceLine" id="cb23-7" data-line-number="7"><span class="co">##  3 Arge…  2000         3 Fernando … Masculino       24.0      14.0 5.52e11</span></a>
<a class="sourceLine" id="cb23-8" data-line-number="8"><span class="co">##  4 Arge…  2003         2 Eduardo A… Masculino       26.5      50.1 5.12e11</span></a>
<a class="sourceLine" id="cb23-9" data-line-number="9"><span class="co">##  5 Arge…  2003         3 Néstor Ca… Masculino       53.7      50.1 5.12e11</span></a>
<a class="sourceLine" id="cb23-10" data-line-number="10"><span class="co">##  6 Arge…  2003         4 Néstor Ca… Masculino       53.0      50.1 5.12e11</span></a>
<a class="sourceLine" id="cb23-11" data-line-number="11"><span class="co">##  7 Arge…  2004         1 Néstor Ca… Masculino       57.1      50.1 5.58e11</span></a>
<a class="sourceLine" id="cb23-12" data-line-number="12"><span class="co">##  8 Arge…  2004         2 Néstor Ca… Masculino       52.8      50.1 5.58e11</span></a>
<a class="sourceLine" id="cb23-13" data-line-number="13"><span class="co">##  9 Arge…  2004         3 Néstor Ca… Masculino       39.1      50.1 5.58e11</span></a>
<a class="sourceLine" id="cb23-14" data-line-number="14"><span class="co">## 10 Arge…  2004         4 Néstor Ca… Masculino       44.9      50.1 5.58e11</span></a>
<a class="sourceLine" id="cb23-15" data-line-number="15"><span class="co">## # … with 699 more rows, and 3 more variables: poblacion &lt;dbl&gt;, desempleo &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb23-16" data-line-number="16"><span class="co">## #   crec_pib &lt;dbl&gt;</span></a></code></pre></div>
<p>Podemos también realizar filtros más complejos. Obtengamos solo las observaciones del Cono Sur:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="kw">filter</span>(aprob_presidencial, pais <span class="op">==</span><span class="st"> &quot;Argentina&quot;</span> <span class="op">|</span><span class="st"> </span>pais <span class="op">==</span><span class="st"> &quot;Chile&quot;</span> <span class="op">|</span><span class="st"> </span>pais <span class="op">==</span><span class="st"> &quot;Uruguay&quot;</span>)</a>
<a class="sourceLine" id="cb24-2" data-line-number="2"><span class="co">## # A tibble: 180 x 11</span></a>
<a class="sourceLine" id="cb24-3" data-line-number="3"><span class="co">##    pais   anio trimestre presidente pres_sexo aprob_neta corr_ejec     pib</span></a>
<a class="sourceLine" id="cb24-4" data-line-number="4"><span class="co">##    &lt;chr&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb24-5" data-line-number="5"><span class="co">##  1 Arge…  2000         1 Fernando … Masculino      40.1       14.0 5.52e11</span></a>
<a class="sourceLine" id="cb24-6" data-line-number="6"><span class="co">##  2 Arge…  2000         2 Fernando … Masculino      16.4       14.0 5.52e11</span></a>
<a class="sourceLine" id="cb24-7" data-line-number="7"><span class="co">##  3 Arge…  2000         3 Fernando … Masculino      24.0       14.0 5.52e11</span></a>
<a class="sourceLine" id="cb24-8" data-line-number="8"><span class="co">##  4 Arge…  2000         4 Fernando … Masculino     -18.3       14.0 5.52e11</span></a>
<a class="sourceLine" id="cb24-9" data-line-number="9"><span class="co">##  5 Arge…  2001         1 Fernando … Masculino      -6.97      14.0 5.28e11</span></a>
<a class="sourceLine" id="cb24-10" data-line-number="10"><span class="co">##  6 Arge…  2001         2 Fernando … Masculino     -20.1       14.0 5.28e11</span></a>
<a class="sourceLine" id="cb24-11" data-line-number="11"><span class="co">##  7 Arge…  2001         3 Fernando … Masculino     -19.4       14.0 5.28e11</span></a>
<a class="sourceLine" id="cb24-12" data-line-number="12"><span class="co">##  8 Arge…  2001         4 Fernando … Masculino     -23.2       14.0 5.28e11</span></a>
<a class="sourceLine" id="cb24-13" data-line-number="13"><span class="co">##  9 Arge…  2002         1 Eduardo A… Masculino      -2.01      25.0 4.70e11</span></a>
<a class="sourceLine" id="cb24-14" data-line-number="14"><span class="co">## 10 Arge…  2002         2 Eduardo A… Masculino     -20.1       25.0 4.70e11</span></a>
<a class="sourceLine" id="cb24-15" data-line-number="15"><span class="co">## # … with 170 more rows, and 3 more variables: poblacion &lt;dbl&gt;, desempleo &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb24-16" data-line-number="16"><span class="co">## #   crec_pib &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb24-17" data-line-number="17"><span class="co"># Lo mismo, con otro operador lógico:</span></a>
<a class="sourceLine" id="cb24-18" data-line-number="18"><span class="kw">filter</span>(aprob_presidencial, pais <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Argentina&quot;</span>, <span class="st">&quot;Chile&quot;</span>, <span class="st">&quot;Uruguay&quot;</span>)) </a>
<a class="sourceLine" id="cb24-19" data-line-number="19"><span class="co">## # A tibble: 180 x 11</span></a>
<a class="sourceLine" id="cb24-20" data-line-number="20"><span class="co">##    pais   anio trimestre presidente pres_sexo aprob_neta corr_ejec     pib</span></a>
<a class="sourceLine" id="cb24-21" data-line-number="21"><span class="co">##    &lt;chr&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb24-22" data-line-number="22"><span class="co">##  1 Arge…  2000         1 Fernando … Masculino      40.1       14.0 5.52e11</span></a>
<a class="sourceLine" id="cb24-23" data-line-number="23"><span class="co">##  2 Arge…  2000         2 Fernando … Masculino      16.4       14.0 5.52e11</span></a>
<a class="sourceLine" id="cb24-24" data-line-number="24"><span class="co">##  3 Arge…  2000         3 Fernando … Masculino      24.0       14.0 5.52e11</span></a>
<a class="sourceLine" id="cb24-25" data-line-number="25"><span class="co">##  4 Arge…  2000         4 Fernando … Masculino     -18.3       14.0 5.52e11</span></a>
<a class="sourceLine" id="cb24-26" data-line-number="26"><span class="co">##  5 Arge…  2001         1 Fernando … Masculino      -6.97      14.0 5.28e11</span></a>
<a class="sourceLine" id="cb24-27" data-line-number="27"><span class="co">##  6 Arge…  2001         2 Fernando … Masculino     -20.1       14.0 5.28e11</span></a>
<a class="sourceLine" id="cb24-28" data-line-number="28"><span class="co">##  7 Arge…  2001         3 Fernando … Masculino     -19.4       14.0 5.28e11</span></a>
<a class="sourceLine" id="cb24-29" data-line-number="29"><span class="co">##  8 Arge…  2001         4 Fernando … Masculino     -23.2       14.0 5.28e11</span></a>
<a class="sourceLine" id="cb24-30" data-line-number="30"><span class="co">##  9 Arge…  2002         1 Eduardo A… Masculino      -2.01      25.0 4.70e11</span></a>
<a class="sourceLine" id="cb24-31" data-line-number="31"><span class="co">## 10 Arge…  2002         2 Eduardo A… Masculino     -20.1       25.0 4.70e11</span></a>
<a class="sourceLine" id="cb24-32" data-line-number="32"><span class="co">## # … with 170 more rows, and 3 more variables: poblacion &lt;dbl&gt;, desempleo &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb24-33" data-line-number="33"><span class="co">## #   crec_pib &lt;dbl&gt;</span></a></code></pre></div>
<p>Podemos también incluir pequeñas operaciones en nuestros filtros. Obtengamos todas las observaciones en las que la corrupción ejecutiva es mayor a la del promedio de toda la base:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1"><span class="kw">filter</span>(aprob_presidencial, corr_ejec <span class="op">&gt;</span><span class="st"> </span><span class="kw">mean</span>(corr_ejec))</a>
<a class="sourceLine" id="cb25-2" data-line-number="2"><span class="co">## # A tibble: 456 x 11</span></a>
<a class="sourceLine" id="cb25-3" data-line-number="3"><span class="co">##    pais   anio trimestre presidente pres_sexo aprob_neta corr_ejec     pib</span></a>
<a class="sourceLine" id="cb25-4" data-line-number="4"><span class="co">##    &lt;chr&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb25-5" data-line-number="5"><span class="co">##  1 Arge…  2003         1 Eduardo A… Masculino      -2.78      50.1 5.12e11</span></a>
<a class="sourceLine" id="cb25-6" data-line-number="6"><span class="co">##  2 Arge…  2003         2 Eduardo A… Masculino      26.5       50.1 5.12e11</span></a>
<a class="sourceLine" id="cb25-7" data-line-number="7"><span class="co">##  3 Arge…  2003         3 Néstor Ca… Masculino      53.7       50.1 5.12e11</span></a>
<a class="sourceLine" id="cb25-8" data-line-number="8"><span class="co">##  4 Arge…  2003         4 Néstor Ca… Masculino      53.0       50.1 5.12e11</span></a>
<a class="sourceLine" id="cb25-9" data-line-number="9"><span class="co">##  5 Arge…  2004         1 Néstor Ca… Masculino      57.1       50.1 5.58e11</span></a>
<a class="sourceLine" id="cb25-10" data-line-number="10"><span class="co">##  6 Arge…  2004         2 Néstor Ca… Masculino      52.8       50.1 5.58e11</span></a>
<a class="sourceLine" id="cb25-11" data-line-number="11"><span class="co">##  7 Arge…  2004         3 Néstor Ca… Masculino      39.1       50.1 5.58e11</span></a>
<a class="sourceLine" id="cb25-12" data-line-number="12"><span class="co">##  8 Arge…  2004         4 Néstor Ca… Masculino      44.9       50.1 5.58e11</span></a>
<a class="sourceLine" id="cb25-13" data-line-number="13"><span class="co">##  9 Arge…  2005         1 Néstor Ca… Masculino      45.7       50.1 6.07e11</span></a>
<a class="sourceLine" id="cb25-14" data-line-number="14"><span class="co">## 10 Arge…  2005         2 Néstor Ca… Masculino      45.4       50.1 6.07e11</span></a>
<a class="sourceLine" id="cb25-15" data-line-number="15"><span class="co">## # … with 446 more rows, and 3 more variables: poblacion &lt;dbl&gt;, desempleo &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb25-16" data-line-number="16"><span class="co">## #   crec_pib &lt;dbl&gt;</span></a></code></pre></div>
</div>
<div id="ejercicio-a" class="section level3">
<h3><span class="header-section-number">3.2.4</span> (Ejercicio A)</h3>
<ul>
<li><p>Selecciona solo las dos columnas que registran el sexo del presidente/a en la base de datos.</p></li>
<li><p>Filtra la base de datos para que solo tenga las observaciones del año 2000.</p></li>
<li><p>Filtra la base de datos para que solo incluya observaciones de crisis económica, definida de la siguiente forma: cuando el crecimiento del PIB sea negativo y/o el desempleo sea mayor al 20%.</p></li>
</ul>
</div>
<div id="ordenar-una-base" class="section level3">
<h3><span class="header-section-number">3.2.5</span> Ordenar una base</h3>
<p>Una de las operaciones más comunes con bases de datos es ordenarlas de acuerdo a alguna de las variables. Esto nos puede dar indicios inmediatos sobre nuestras observaciones. Podemos hacer esto gracias a la función <code>arrange()</code>. Por ejemplo, ordenemos las observaciones desde el país-año-trimestre menos corrupto al más corrupto:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="kw">arrange</span>(aprob_presidencial, corr_ejec)</a>
<a class="sourceLine" id="cb26-2" data-line-number="2"><span class="co">## # A tibble: 1,020 x 11</span></a>
<a class="sourceLine" id="cb26-3" data-line-number="3"><span class="co">##    pais   anio trimestre presidente pres_sexo aprob_neta corr_ejec     pib</span></a>
<a class="sourceLine" id="cb26-4" data-line-number="4"><span class="co">##    &lt;chr&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb26-5" data-line-number="5"><span class="co">##  1 Urug…  2000         1 Julio San… Masculino      41.2       2.13 4.28e10</span></a>
<a class="sourceLine" id="cb26-6" data-line-number="6"><span class="co">##  2 Urug…  2000         2 Jorge Bat… Masculino      45.4       2.13 4.28e10</span></a>
<a class="sourceLine" id="cb26-7" data-line-number="7"><span class="co">##  3 Urug…  2000         3 Jorge Bat… Masculino      31.4       2.13 4.28e10</span></a>
<a class="sourceLine" id="cb26-8" data-line-number="8"><span class="co">##  4 Urug…  2000         4 Jorge Bat… Masculino      18.1       2.13 4.28e10</span></a>
<a class="sourceLine" id="cb26-9" data-line-number="9"><span class="co">##  5 Urug…  2001         1 Jorge Bat… Masculino      18.5       2.13 4.11e10</span></a>
<a class="sourceLine" id="cb26-10" data-line-number="10"><span class="co">##  6 Urug…  2001         2 Jorge Bat… Masculino      17.8       2.13 4.11e10</span></a>
<a class="sourceLine" id="cb26-11" data-line-number="11"><span class="co">##  7 Urug…  2001         3 Jorge Bat… Masculino      15.9       2.13 4.11e10</span></a>
<a class="sourceLine" id="cb26-12" data-line-number="12"><span class="co">##  8 Urug…  2001         4 Jorge Bat… Masculino      14.5       2.13 4.11e10</span></a>
<a class="sourceLine" id="cb26-13" data-line-number="13"><span class="co">##  9 Urug…  2002         1 Jorge Bat… Masculino       6.36      2.13 3.79e10</span></a>
<a class="sourceLine" id="cb26-14" data-line-number="14"><span class="co">## 10 Urug…  2002         2 Jorge Bat… Masculino      -6.37      2.13 3.79e10</span></a>
<a class="sourceLine" id="cb26-15" data-line-number="15"><span class="co">## # … with 1,010 more rows, and 3 more variables: poblacion &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb26-16" data-line-number="16"><span class="co">## #   desempleo &lt;dbl&gt;, crec_pib &lt;dbl&gt;</span></a></code></pre></div>
<p>Si quisiéramos ordenarlo inversamente, tendríamos que añadir un - (signo menos) antes de la variable:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1"><span class="kw">arrange</span>(aprob_presidencial, <span class="op">-</span>corr_ejec)</a>
<a class="sourceLine" id="cb27-2" data-line-number="2"><span class="co">## # A tibble: 1,020 x 11</span></a>
<a class="sourceLine" id="cb27-3" data-line-number="3"><span class="co">##    pais   anio trimestre presidente pres_sexo aprob_neta corr_ejec     pib</span></a>
<a class="sourceLine" id="cb27-4" data-line-number="4"><span class="co">##    &lt;chr&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb27-5" data-line-number="5"><span class="co">##  1 Vene…  2013         1 Hugo Cháv… Masculino      -12.6      94.4 5.36e11</span></a>
<a class="sourceLine" id="cb27-6" data-line-number="6"><span class="co">##  2 Vene…  2013         2 Nicolás M… Masculino      -13.7      94.4 5.36e11</span></a>
<a class="sourceLine" id="cb27-7" data-line-number="7"><span class="co">##  3 Vene…  2013         3 Nicolás M… Masculino      -16.8      94.4 5.36e11</span></a>
<a class="sourceLine" id="cb27-8" data-line-number="8"><span class="co">##  4 Vene…  2013         4 Nicolás M… Masculino      -16.6      94.4 5.36e11</span></a>
<a class="sourceLine" id="cb27-9" data-line-number="9"><span class="co">##  5 Vene…  2014         1 Nicolás M… Masculino      -18.1      94.4 5.15e11</span></a>
<a class="sourceLine" id="cb27-10" data-line-number="10"><span class="co">##  6 Vene…  2014         2 Nicolás M… Masculino      -19.4      94.4 5.15e11</span></a>
<a class="sourceLine" id="cb27-11" data-line-number="11"><span class="co">##  7 Vene…  2014         3 Nicolás M… Masculino      -22.1      94.4 5.15e11</span></a>
<a class="sourceLine" id="cb27-12" data-line-number="12"><span class="co">##  8 Vene…  2014         4 Nicolás M… Masculino      -24.9      94.4 5.15e11</span></a>
<a class="sourceLine" id="cb27-13" data-line-number="13"><span class="co">##  9 Vene…  2007         1 Hugo Cháv… Masculino      -10.2      93.5 4.78e11</span></a>
<a class="sourceLine" id="cb27-14" data-line-number="14"><span class="co">## 10 Vene…  2007         2 Hugo Cháv… Masculino      -11.0      93.5 4.78e11</span></a>
<a class="sourceLine" id="cb27-15" data-line-number="15"><span class="co">## # … with 1,010 more rows, and 3 more variables: poblacion &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb27-16" data-line-number="16"><span class="co">## #   desempleo &lt;dbl&gt;, crec_pib &lt;dbl&gt;</span></a></code></pre></div>
<p>En el caso de utilizar una variable categórica, el orden se realizará en forma alfabética:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1"><span class="kw">arrange</span>(aprob_presidencial, presidente)</a>
<a class="sourceLine" id="cb28-2" data-line-number="2"><span class="co">## # A tibble: 1,020 x 11</span></a>
<a class="sourceLine" id="cb28-3" data-line-number="3"><span class="co">##    pais   anio trimestre presidente pres_sexo aprob_neta corr_ejec     pib</span></a>
<a class="sourceLine" id="cb28-4" data-line-number="4"><span class="co">##    &lt;chr&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb28-5" data-line-number="5"><span class="co">##  1 Cost…  2002         3 Abel Pach… Masculino      43.6       11.5 4.15e10</span></a>
<a class="sourceLine" id="cb28-6" data-line-number="6"><span class="co">##  2 Cost…  2002         4 Abel Pach… Masculino      49.0       11.5 4.15e10</span></a>
<a class="sourceLine" id="cb28-7" data-line-number="7"><span class="co">##  3 Cost…  2003         1 Abel Pach… Masculino      32.2       11.5 4.32e10</span></a>
<a class="sourceLine" id="cb28-8" data-line-number="8"><span class="co">##  4 Cost…  2003         2 Abel Pach… Masculino      20.9       11.5 4.32e10</span></a>
<a class="sourceLine" id="cb28-9" data-line-number="9"><span class="co">##  5 Cost…  2003         3 Abel Pach… Masculino       4.59      11.5 4.32e10</span></a>
<a class="sourceLine" id="cb28-10" data-line-number="10"><span class="co">##  6 Cost…  2003         4 Abel Pach… Masculino       6.76      11.5 4.32e10</span></a>
<a class="sourceLine" id="cb28-11" data-line-number="11"><span class="co">##  7 Cost…  2004         1 Abel Pach… Masculino      15.2       11.5 4.51e10</span></a>
<a class="sourceLine" id="cb28-12" data-line-number="12"><span class="co">##  8 Cost…  2004         2 Abel Pach… Masculino      17.3       11.5 4.51e10</span></a>
<a class="sourceLine" id="cb28-13" data-line-number="13"><span class="co">##  9 Cost…  2004         3 Abel Pach… Masculino      16.8       11.5 4.51e10</span></a>
<a class="sourceLine" id="cb28-14" data-line-number="14"><span class="co">## 10 Cost…  2004         4 Abel Pach… Masculino      27.0       11.5 4.51e10</span></a>
<a class="sourceLine" id="cb28-15" data-line-number="15"><span class="co">## # … with 1,010 more rows, and 3 more variables: poblacion &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb28-16" data-line-number="16"><span class="co">## #   desempleo &lt;dbl&gt;, crec_pib &lt;dbl&gt;</span></a></code></pre></div>
<p>Para utilizar un orden alfabético inverso (desde la Z hasta la A), debemos utilizar la función de ayuda <code>desc()</code>.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1"><span class="kw">arrange</span>(aprob_presidencial, <span class="kw">desc</span>(presidente))</a>
<a class="sourceLine" id="cb29-2" data-line-number="2"><span class="co">## # A tibble: 1,020 x 11</span></a>
<a class="sourceLine" id="cb29-3" data-line-number="3"><span class="co">##    pais   anio trimestre presidente pres_sexo aprob_neta corr_ejec     pib</span></a>
<a class="sourceLine" id="cb29-4" data-line-number="4"><span class="co">##    &lt;chr&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb29-5" data-line-number="5"><span class="co">##  1 Méxi…  2001         1 Vicente F… Masculino       53.8      37.6 1.59e12</span></a>
<a class="sourceLine" id="cb29-6" data-line-number="6"><span class="co">##  2 Méxi…  2001         2 Vicente F… Masculino       40.7      37.6 1.59e12</span></a>
<a class="sourceLine" id="cb29-7" data-line-number="7"><span class="co">##  3 Méxi…  2001         3 Vicente F… Masculino       40.1      37.6 1.59e12</span></a>
<a class="sourceLine" id="cb29-8" data-line-number="8"><span class="co">##  4 Méxi…  2001         4 Vicente F… Masculino       30.5      37.6 1.59e12</span></a>
<a class="sourceLine" id="cb29-9" data-line-number="9"><span class="co">##  5 Méxi…  2002         1 Vicente F… Masculino       15.0      37.6 1.59e12</span></a>
<a class="sourceLine" id="cb29-10" data-line-number="10"><span class="co">##  6 Méxi…  2002         2 Vicente F… Masculino       22.0      37.6 1.59e12</span></a>
<a class="sourceLine" id="cb29-11" data-line-number="11"><span class="co">##  7 Méxi…  2002         3 Vicente F… Masculino       28.2      37.6 1.59e12</span></a>
<a class="sourceLine" id="cb29-12" data-line-number="12"><span class="co">##  8 Méxi…  2002         4 Vicente F… Masculino       27.5      37.6 1.59e12</span></a>
<a class="sourceLine" id="cb29-13" data-line-number="13"><span class="co">##  9 Méxi…  2003         1 Vicente F… Masculino       26.8      37.6 1.61e12</span></a>
<a class="sourceLine" id="cb29-14" data-line-number="14"><span class="co">## 10 Méxi…  2003         2 Vicente F… Masculino       33.2      37.6 1.61e12</span></a>
<a class="sourceLine" id="cb29-15" data-line-number="15"><span class="co">## # … with 1,010 more rows, and 3 more variables: poblacion &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb29-16" data-line-number="16"><span class="co">## #   desempleo &lt;dbl&gt;, crec_pib &lt;dbl&gt;</span></a></code></pre></div>
<p>Por último, podemos ordenar por más de una variable. Esto es, ordenar a partir de una primera variable y luego ordenar los empates a partir de otra segunda variable. Veamos el siguiente ejemplo:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1"><span class="kw">arrange</span>(aprob_presidencial, pres_sexo, <span class="op">-</span>aprob_neta)</a>
<a class="sourceLine" id="cb30-2" data-line-number="2"><span class="co">## # A tibble: 1,020 x 11</span></a>
<a class="sourceLine" id="cb30-3" data-line-number="3"><span class="co">##    pais   anio trimestre presidente pres_sexo aprob_neta corr_ejec     pib</span></a>
<a class="sourceLine" id="cb30-4" data-line-number="4"><span class="co">##    &lt;chr&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb30-5" data-line-number="5"><span class="co">##  1 Bras…  2013         1 Dilma Van… Femenino        62.5      27.3 3.12e12</span></a>
<a class="sourceLine" id="cb30-6" data-line-number="6"><span class="co">##  2 Bras…  2012         4 Dilma Van… Femenino        60.9      33.4 3.03e12</span></a>
<a class="sourceLine" id="cb30-7" data-line-number="7"><span class="co">##  3 Bras…  2012         2 Dilma Van… Femenino        60.5      33.4 3.03e12</span></a>
<a class="sourceLine" id="cb30-8" data-line-number="8"><span class="co">##  4 Bras…  2012         3 Dilma Van… Femenino        58.7      33.4 3.03e12</span></a>
<a class="sourceLine" id="cb30-9" data-line-number="9"><span class="co">##  5 Bras…  2012         1 Dilma Van… Femenino        57.2      33.4 3.03e12</span></a>
<a class="sourceLine" id="cb30-10" data-line-number="10"><span class="co">##  6 Bras…  2011         4 Dilma Van… Femenino        54.3      33.4 2.97e12</span></a>
<a class="sourceLine" id="cb30-11" data-line-number="11"><span class="co">##  7 Bras…  2011         1 Dilma Van… Femenino        47.7      33.4 2.97e12</span></a>
<a class="sourceLine" id="cb30-12" data-line-number="12"><span class="co">##  8 Bras…  2011         3 Dilma Van… Femenino        45.6      33.4 2.97e12</span></a>
<a class="sourceLine" id="cb30-13" data-line-number="13"><span class="co">##  9 Bras…  2013         2 Dilma Van… Femenino        44.4      27.3 3.12e12</span></a>
<a class="sourceLine" id="cb30-14" data-line-number="14"><span class="co">## 10 Arge…  2011         4 Cristina … Femenino        44.3      52.4 8.18e11</span></a>
<a class="sourceLine" id="cb30-15" data-line-number="15"><span class="co">## # … with 1,010 more rows, and 3 more variables: poblacion &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb30-16" data-line-number="16"><span class="co">## #   desempleo &lt;dbl&gt;, crec_pib &lt;dbl&gt;</span></a></code></pre></div>
</div>
<div id="transformar-y-crear-variables" class="section level3">
<h3><span class="header-section-number">3.2.6</span> Transformar y crear variables</h3>
<p>Muchas veces queremos crear nuevas variables, a partir de las que ya tenemos. Supongamos que queremos transformar la escala de <code>poblacion</code> a millones:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1"><span class="kw">mutate</span>(aprob_presidencial, <span class="dt">poblacion_mill =</span> poblacion <span class="op">/</span><span class="st"> </span><span class="dv">1000000</span>)</a>
<a class="sourceLine" id="cb31-2" data-line-number="2"><span class="co">## # A tibble: 1,020 x 12</span></a>
<a class="sourceLine" id="cb31-3" data-line-number="3"><span class="co">##    pais   anio trimestre presidente pres_sexo aprob_neta corr_ejec     pib</span></a>
<a class="sourceLine" id="cb31-4" data-line-number="4"><span class="co">##    &lt;chr&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb31-5" data-line-number="5"><span class="co">##  1 Arge…  2000         1 Fernando … Masculino      40.1       14.0 5.52e11</span></a>
<a class="sourceLine" id="cb31-6" data-line-number="6"><span class="co">##  2 Arge…  2000         2 Fernando … Masculino      16.4       14.0 5.52e11</span></a>
<a class="sourceLine" id="cb31-7" data-line-number="7"><span class="co">##  3 Arge…  2000         3 Fernando … Masculino      24.0       14.0 5.52e11</span></a>
<a class="sourceLine" id="cb31-8" data-line-number="8"><span class="co">##  4 Arge…  2000         4 Fernando … Masculino     -18.3       14.0 5.52e11</span></a>
<a class="sourceLine" id="cb31-9" data-line-number="9"><span class="co">##  5 Arge…  2001         1 Fernando … Masculino      -6.97      14.0 5.28e11</span></a>
<a class="sourceLine" id="cb31-10" data-line-number="10"><span class="co">##  6 Arge…  2001         2 Fernando … Masculino     -20.1       14.0 5.28e11</span></a>
<a class="sourceLine" id="cb31-11" data-line-number="11"><span class="co">##  7 Arge…  2001         3 Fernando … Masculino     -19.4       14.0 5.28e11</span></a>
<a class="sourceLine" id="cb31-12" data-line-number="12"><span class="co">##  8 Arge…  2001         4 Fernando … Masculino     -23.2       14.0 5.28e11</span></a>
<a class="sourceLine" id="cb31-13" data-line-number="13"><span class="co">##  9 Arge…  2002         1 Eduardo A… Masculino      -2.01      25.0 4.70e11</span></a>
<a class="sourceLine" id="cb31-14" data-line-number="14"><span class="co">## 10 Arge…  2002         2 Eduardo A… Masculino     -20.1       25.0 4.70e11</span></a>
<a class="sourceLine" id="cb31-15" data-line-number="15"><span class="co">## # … with 1,010 more rows, and 4 more variables: poblacion &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb31-16" data-line-number="16"><span class="co">## #   desempleo &lt;dbl&gt;, crec_pib &lt;dbl&gt;, poblacion_mill &lt;dbl&gt;</span></a></code></pre></div>
<p>El comando anterior genera una nueva variable en la base, “poblacion_mill”, que es “poblacion” pero en la escala de los millones. Podemos realizar cualquier tipo de operación en nuestras columnas, como crear una variable con el PIB en versión logarítmica:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1"><span class="kw">mutate</span>(aprob_presidencial, <span class="dt">pib_log =</span> <span class="kw">log</span>(pib))</a>
<a class="sourceLine" id="cb32-2" data-line-number="2"><span class="co">## # A tibble: 1,020 x 12</span></a>
<a class="sourceLine" id="cb32-3" data-line-number="3"><span class="co">##    pais   anio trimestre presidente pres_sexo aprob_neta corr_ejec     pib</span></a>
<a class="sourceLine" id="cb32-4" data-line-number="4"><span class="co">##    &lt;chr&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb32-5" data-line-number="5"><span class="co">##  1 Arge…  2000         1 Fernando … Masculino      40.1       14.0 5.52e11</span></a>
<a class="sourceLine" id="cb32-6" data-line-number="6"><span class="co">##  2 Arge…  2000         2 Fernando … Masculino      16.4       14.0 5.52e11</span></a>
<a class="sourceLine" id="cb32-7" data-line-number="7"><span class="co">##  3 Arge…  2000         3 Fernando … Masculino      24.0       14.0 5.52e11</span></a>
<a class="sourceLine" id="cb32-8" data-line-number="8"><span class="co">##  4 Arge…  2000         4 Fernando … Masculino     -18.3       14.0 5.52e11</span></a>
<a class="sourceLine" id="cb32-9" data-line-number="9"><span class="co">##  5 Arge…  2001         1 Fernando … Masculino      -6.97      14.0 5.28e11</span></a>
<a class="sourceLine" id="cb32-10" data-line-number="10"><span class="co">##  6 Arge…  2001         2 Fernando … Masculino     -20.1       14.0 5.28e11</span></a>
<a class="sourceLine" id="cb32-11" data-line-number="11"><span class="co">##  7 Arge…  2001         3 Fernando … Masculino     -19.4       14.0 5.28e11</span></a>
<a class="sourceLine" id="cb32-12" data-line-number="12"><span class="co">##  8 Arge…  2001         4 Fernando … Masculino     -23.2       14.0 5.28e11</span></a>
<a class="sourceLine" id="cb32-13" data-line-number="13"><span class="co">##  9 Arge…  2002         1 Eduardo A… Masculino      -2.01      25.0 4.70e11</span></a>
<a class="sourceLine" id="cb32-14" data-line-number="14"><span class="co">## 10 Arge…  2002         2 Eduardo A… Masculino     -20.1       25.0 4.70e11</span></a>
<a class="sourceLine" id="cb32-15" data-line-number="15"><span class="co">## # … with 1,010 more rows, and 4 more variables: poblacion &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb32-16" data-line-number="16"><span class="co">## #   desempleo &lt;dbl&gt;, crec_pib &lt;dbl&gt;, pib_log &lt;dbl&gt;</span></a></code></pre></div>
<p>Crucialmente, también podemos generar operaciones entre las variables. Por ejemplo, calculemos el PIB <em>per capita</em>, lo que nos permitirá comparar de mejor forma entre países con distintas poblaciones:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1"><span class="kw">mutate</span>(aprob_presidencial, <span class="dt">pib_pc =</span> pib <span class="op">/</span><span class="st"> </span>poblacion)</a>
<a class="sourceLine" id="cb33-2" data-line-number="2"><span class="co">## # A tibble: 1,020 x 12</span></a>
<a class="sourceLine" id="cb33-3" data-line-number="3"><span class="co">##    pais   anio trimestre presidente pres_sexo aprob_neta corr_ejec     pib</span></a>
<a class="sourceLine" id="cb33-4" data-line-number="4"><span class="co">##    &lt;chr&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb33-5" data-line-number="5"><span class="co">##  1 Arge…  2000         1 Fernando … Masculino      40.1       14.0 5.52e11</span></a>
<a class="sourceLine" id="cb33-6" data-line-number="6"><span class="co">##  2 Arge…  2000         2 Fernando … Masculino      16.4       14.0 5.52e11</span></a>
<a class="sourceLine" id="cb33-7" data-line-number="7"><span class="co">##  3 Arge…  2000         3 Fernando … Masculino      24.0       14.0 5.52e11</span></a>
<a class="sourceLine" id="cb33-8" data-line-number="8"><span class="co">##  4 Arge…  2000         4 Fernando … Masculino     -18.3       14.0 5.52e11</span></a>
<a class="sourceLine" id="cb33-9" data-line-number="9"><span class="co">##  5 Arge…  2001         1 Fernando … Masculino      -6.97      14.0 5.28e11</span></a>
<a class="sourceLine" id="cb33-10" data-line-number="10"><span class="co">##  6 Arge…  2001         2 Fernando … Masculino     -20.1       14.0 5.28e11</span></a>
<a class="sourceLine" id="cb33-11" data-line-number="11"><span class="co">##  7 Arge…  2001         3 Fernando … Masculino     -19.4       14.0 5.28e11</span></a>
<a class="sourceLine" id="cb33-12" data-line-number="12"><span class="co">##  8 Arge…  2001         4 Fernando … Masculino     -23.2       14.0 5.28e11</span></a>
<a class="sourceLine" id="cb33-13" data-line-number="13"><span class="co">##  9 Arge…  2002         1 Eduardo A… Masculino      -2.01      25.0 4.70e11</span></a>
<a class="sourceLine" id="cb33-14" data-line-number="14"><span class="co">## 10 Arge…  2002         2 Eduardo A… Masculino     -20.1       25.0 4.70e11</span></a>
<a class="sourceLine" id="cb33-15" data-line-number="15"><span class="co">## # … with 1,010 more rows, and 4 more variables: poblacion &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb33-16" data-line-number="16"><span class="co">## #   desempleo &lt;dbl&gt;, crec_pib &lt;dbl&gt;, pib_pc &lt;dbl&gt;</span></a></code></pre></div>
<p>Para terminar, podemos también generar más de una transfomación a la vez por medio de <code>mutate()</code>, utilizando múltiples argumentos:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1"><span class="kw">mutate</span>(aprob_presidencial, </a>
<a class="sourceLine" id="cb34-2" data-line-number="2">       <span class="dt">poblacion_mill =</span> poblacion <span class="op">/</span><span class="st"> </span><span class="dv">1000000</span>,</a>
<a class="sourceLine" id="cb34-3" data-line-number="3">       <span class="dt">pib_pc   =</span> pib <span class="op">/</span><span class="st"> </span>poblacion)</a>
<a class="sourceLine" id="cb34-4" data-line-number="4"><span class="co">## # A tibble: 1,020 x 13</span></a>
<a class="sourceLine" id="cb34-5" data-line-number="5"><span class="co">##    pais   anio trimestre presidente pres_sexo aprob_neta corr_ejec     pib</span></a>
<a class="sourceLine" id="cb34-6" data-line-number="6"><span class="co">##    &lt;chr&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb34-7" data-line-number="7"><span class="co">##  1 Arge…  2000         1 Fernando … Masculino      40.1       14.0 5.52e11</span></a>
<a class="sourceLine" id="cb34-8" data-line-number="8"><span class="co">##  2 Arge…  2000         2 Fernando … Masculino      16.4       14.0 5.52e11</span></a>
<a class="sourceLine" id="cb34-9" data-line-number="9"><span class="co">##  3 Arge…  2000         3 Fernando … Masculino      24.0       14.0 5.52e11</span></a>
<a class="sourceLine" id="cb34-10" data-line-number="10"><span class="co">##  4 Arge…  2000         4 Fernando … Masculino     -18.3       14.0 5.52e11</span></a>
<a class="sourceLine" id="cb34-11" data-line-number="11"><span class="co">##  5 Arge…  2001         1 Fernando … Masculino      -6.97      14.0 5.28e11</span></a>
<a class="sourceLine" id="cb34-12" data-line-number="12"><span class="co">##  6 Arge…  2001         2 Fernando … Masculino     -20.1       14.0 5.28e11</span></a>
<a class="sourceLine" id="cb34-13" data-line-number="13"><span class="co">##  7 Arge…  2001         3 Fernando … Masculino     -19.4       14.0 5.28e11</span></a>
<a class="sourceLine" id="cb34-14" data-line-number="14"><span class="co">##  8 Arge…  2001         4 Fernando … Masculino     -23.2       14.0 5.28e11</span></a>
<a class="sourceLine" id="cb34-15" data-line-number="15"><span class="co">##  9 Arge…  2002         1 Eduardo A… Masculino      -2.01      25.0 4.70e11</span></a>
<a class="sourceLine" id="cb34-16" data-line-number="16"><span class="co">## 10 Arge…  2002         2 Eduardo A… Masculino     -20.1       25.0 4.70e11</span></a>
<a class="sourceLine" id="cb34-17" data-line-number="17"><span class="co">## # … with 1,010 more rows, and 5 more variables: poblacion &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb34-18" data-line-number="18"><span class="co">## #   desempleo &lt;dbl&gt;, crec_pib &lt;dbl&gt;, poblacion_mill &lt;dbl&gt;, pib_pc &lt;dbl&gt;</span></a></code></pre></div>
</div>
<div id="ejercicio-b" class="section level3">
<h3><span class="header-section-number">3.2.7</span> (Ejercicio B)</h3>
<ul>
<li>Crea un nuevo <em>data frame</em>, que esté ordenado desde el país-año-trimeste con menor aprobación presidencial al con mayor aprobación presidencial (recuerda <em>crear</em> el nuevo objeto y darle un nombre descriptivo).</li>
<li>En tu nuevo objeto, obtén solo con las observaciones que tengan presidentas.</li>
<li>Crea una nueva variable, que registre el desempleo como proporción en vez de porcentaje.</li>
</ul>
</div>
</div>
<div id="resumenes" class="section level2">
<h2><span class="header-section-number">3.3</span> Resúmenes</h2>
<p>Podemos hacer resúmenes para nuestra base de datos con <code>summarize</code>:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1"><span class="kw">summarize</span>(aprob_presidencial, <span class="dt">prom_desemp =</span> <span class="kw">mean</span>(desempleo))</a>
<a class="sourceLine" id="cb35-2" data-line-number="2"><span class="co">## # A tibble: 1 x 1</span></a>
<a class="sourceLine" id="cb35-3" data-line-number="3"><span class="co">##   prom_desemp</span></a>
<a class="sourceLine" id="cb35-4" data-line-number="4"><span class="co">##         &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb35-5" data-line-number="5"><span class="co">## 1        7.04</span></a></code></pre></div>
<p>A menudo este procedimiento se denomina <strong>colapsar una base de datos</strong>: estamos comprimiendo la información de las filas para generar una única fila de resumen. En este caso, la función de resumen <code>mean()</code> opera en el vector “desempleo” para obtener su media.</p>
<p>Como con las otras operaciones, podemos hacer varios resúmenes a la vez:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1"><span class="kw">summarize</span>(aprob_presidencial, </a>
<a class="sourceLine" id="cb36-2" data-line-number="2">          <span class="dt">prom_desemp   =</span> <span class="kw">mean</span>(desempleo),</a>
<a class="sourceLine" id="cb36-3" data-line-number="3">          <span class="dt">prom_crec     =</span> <span class="kw">mean</span>(crec_pib),</a>
<a class="sourceLine" id="cb36-4" data-line-number="4">          <span class="dt">prom_aprob    =</span> <span class="kw">mean</span>(aprob_neta))</a>
<a class="sourceLine" id="cb36-5" data-line-number="5"><span class="co">## # A tibble: 1 x 3</span></a>
<a class="sourceLine" id="cb36-6" data-line-number="6"><span class="co">##   prom_desemp prom_crec prom_aprob</span></a>
<a class="sourceLine" id="cb36-7" data-line-number="7"><span class="co">##         &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb36-8" data-line-number="8"><span class="co">## 1        7.04      3.77       15.3</span></a></code></pre></div>
<div id="resumenes-agrupados" class="section level3">
<h3><span class="header-section-number">3.3.1</span> Resúmenes agrupados</h3>
<p>Lo realmente interesante es hacer resúmenes por grupos. Esto implicará colapsar las filas no hasta tener una sola, sino que hasta obtener filas que resuman la información de distintos grupos en la base de datos.</p>
<p>Para realizar esto, primero debemos tener una versión “agrupada” de la base de datos. Esta es igual que nuestra base original, pero R sabe que las siguientes operaciones que realicemos en ella deberán ser agrupadas.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1">aprob_presidencial_por_pais &lt;-<span class="st"> </span><span class="kw">group_by</span>(aprob_presidencial, pais)</a></code></pre></div>
<p>Hagamos una operación de resumen en esta nueva base:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1"><span class="kw">summarize</span>(aprob_presidencial_por_pais, </a>
<a class="sourceLine" id="cb38-2" data-line-number="2">          <span class="dt">prom_desemp   =</span> <span class="kw">mean</span>(desempleo),</a>
<a class="sourceLine" id="cb38-3" data-line-number="3">          <span class="dt">prom_crec_pib =</span> <span class="kw">mean</span>(crec_pib),</a>
<a class="sourceLine" id="cb38-4" data-line-number="4">          <span class="dt">prom_aprob    =</span> <span class="kw">mean</span>(aprob_neta))</a>
<a class="sourceLine" id="cb38-5" data-line-number="5"><span class="co">## # A tibble: 17 x 4</span></a>
<a class="sourceLine" id="cb38-6" data-line-number="6"><span class="co">##    pais        prom_desemp prom_crec_pib prom_aprob</span></a>
<a class="sourceLine" id="cb38-7" data-line-number="7"><span class="co">##    &lt;chr&gt;             &lt;dbl&gt;         &lt;dbl&gt;      &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb38-8" data-line-number="8"><span class="co">##  1 Argentina         11.0           2.72      16.7 </span></a>
<a class="sourceLine" id="cb38-9" data-line-number="9"><span class="co">##  2 Bolivia            3.70          4.24      11.3 </span></a>
<a class="sourceLine" id="cb38-10" data-line-number="10"><span class="co">##  3 Brasil             8.35          3.4       34.2 </span></a>
<a class="sourceLine" id="cb38-11" data-line-number="11"><span class="co">##  4 Chile              8.18          4.33       5.71</span></a>
<a class="sourceLine" id="cb38-12" data-line-number="12"><span class="co">##  5 Colombia          12.5           4.35      27.1 </span></a>
<a class="sourceLine" id="cb38-13" data-line-number="13"><span class="co">##  6 Costa Rica         6.73          4.15      14.5 </span></a>
<a class="sourceLine" id="cb38-14" data-line-number="14"><span class="co">##  7 Ecuador            6.76          4.31      37.1 </span></a>
<a class="sourceLine" id="cb38-15" data-line-number="15"><span class="co">##  8 El Salvador        5.75          1.87      39.1 </span></a>
<a class="sourceLine" id="cb38-16" data-line-number="16"><span class="co">##  9 Guatemala          2.80          3.47       5.44</span></a>
<a class="sourceLine" id="cb38-17" data-line-number="17"><span class="co">## 10 Honduras           4.22          4.08      12.7 </span></a>
<a class="sourceLine" id="cb38-18" data-line-number="18"><span class="co">## 11 México             3.99          2.10      28.9 </span></a>
<a class="sourceLine" id="cb38-19" data-line-number="19"><span class="co">## 12 Nicaragua          6.78          3.73      16.2 </span></a>
<a class="sourceLine" id="cb38-20" data-line-number="20"><span class="co">## 13 Panamá             8.45          6.31      14.2 </span></a>
<a class="sourceLine" id="cb38-21" data-line-number="21"><span class="co">## 14 Paraguay           5.69          3.66      10.9 </span></a>
<a class="sourceLine" id="cb38-22" data-line-number="22"><span class="co">## 15 Perú               4.32          5.30     -26.2 </span></a>
<a class="sourceLine" id="cb38-23" data-line-number="23"><span class="co">## 16 Uruguay           10.3           3.08      26.9 </span></a>
<a class="sourceLine" id="cb38-24" data-line-number="24"><span class="co">## 17 Venezuela         10.3           3.04     -14.8</span></a></code></pre></div>
<p>Los grupos pueden también ser de combinaciones de variables. Por ejemplo, nuestra base a nivel país-año-trimestre puede ser agrupada en países-años, para luego obtener los mismos cálculos anteriores:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1">aprob_presidencial_por_pais_anio &lt;-<span class="st"> </span><span class="kw">group_by</span>(aprob_presidencial, pais, anio)</a>
<a class="sourceLine" id="cb39-2" data-line-number="2"></a>
<a class="sourceLine" id="cb39-3" data-line-number="3"><span class="kw">summarize</span>(aprob_presidencial_por_pais_anio, </a>
<a class="sourceLine" id="cb39-4" data-line-number="4">          <span class="dt">prom_desemp   =</span> <span class="kw">mean</span>(desempleo),</a>
<a class="sourceLine" id="cb39-5" data-line-number="5">          <span class="dt">prom_crec_pib =</span> <span class="kw">mean</span>(crec_pib),</a>
<a class="sourceLine" id="cb39-6" data-line-number="6">          <span class="dt">prom_aprob    =</span> <span class="kw">mean</span>(aprob_neta))</a>
<a class="sourceLine" id="cb39-7" data-line-number="7"><span class="co">## # A tibble: 255 x 5</span></a>
<a class="sourceLine" id="cb39-8" data-line-number="8"><span class="co">## # Groups:   pais [17]</span></a>
<a class="sourceLine" id="cb39-9" data-line-number="9"><span class="co">##    pais       anio prom_desemp prom_crec_pib prom_aprob</span></a>
<a class="sourceLine" id="cb39-10" data-line-number="10"><span class="co">##    &lt;chr&gt;     &lt;dbl&gt;       &lt;dbl&gt;         &lt;dbl&gt;      &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb39-11" data-line-number="11"><span class="co">##  1 Argentina  2000       15             -0.8      15.6 </span></a>
<a class="sourceLine" id="cb39-12" data-line-number="12"><span class="co">##  2 Argentina  2001       18.3           -4.4     -17.4 </span></a>
<a class="sourceLine" id="cb39-13" data-line-number="13"><span class="co">##  3 Argentina  2002       17.9          -10.9     -16.0 </span></a>
<a class="sourceLine" id="cb39-14" data-line-number="14"><span class="co">##  4 Argentina  2003       17.0            8.8      32.6 </span></a>
<a class="sourceLine" id="cb39-15" data-line-number="15"><span class="co">##  5 Argentina  2004       13.5            9        48.5 </span></a>
<a class="sourceLine" id="cb39-16" data-line-number="16"><span class="co">##  6 Argentina  2005       11.5            8.9      43.8 </span></a>
<a class="sourceLine" id="cb39-17" data-line-number="17"><span class="co">##  7 Argentina  2006       10.1            8        45.9 </span></a>
<a class="sourceLine" id="cb39-18" data-line-number="18"><span class="co">##  8 Argentina  2007        8.39           9        34.3 </span></a>
<a class="sourceLine" id="cb39-19" data-line-number="19"><span class="co">##  9 Argentina  2008        7.84           4.1       9.52</span></a>
<a class="sourceLine" id="cb39-20" data-line-number="20"><span class="co">## 10 Argentina  2009        8.65          -5.9      -9.99</span></a>
<a class="sourceLine" id="cb39-21" data-line-number="21"><span class="co">## # … with 245 more rows</span></a></code></pre></div>
<p>Por cierto, podemos desagrupar una base con <code>ungroup()</code>. Esto es una buena idea si es que ya no queremos correr operaciones agrupadas, ahorrándonos errores:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1">aprob_presidencial_por_pais_anio <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb40-2" data-line-number="2"><span class="st">  </span><span class="kw">ungroup</span>() <span class="co"># nota cómo ya no hay &quot;groups&quot; en el resumen de los datos</span></a>
<a class="sourceLine" id="cb40-3" data-line-number="3"><span class="co">## # A tibble: 1,020 x 11</span></a>
<a class="sourceLine" id="cb40-4" data-line-number="4"><span class="co">##    pais   anio trimestre presidente pres_sexo aprob_neta corr_ejec     pib</span></a>
<a class="sourceLine" id="cb40-5" data-line-number="5"><span class="co">##    &lt;chr&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb40-6" data-line-number="6"><span class="co">##  1 Arge…  2000         1 Fernando … Masculino      40.1       14.0 5.52e11</span></a>
<a class="sourceLine" id="cb40-7" data-line-number="7"><span class="co">##  2 Arge…  2000         2 Fernando … Masculino      16.4       14.0 5.52e11</span></a>
<a class="sourceLine" id="cb40-8" data-line-number="8"><span class="co">##  3 Arge…  2000         3 Fernando … Masculino      24.0       14.0 5.52e11</span></a>
<a class="sourceLine" id="cb40-9" data-line-number="9"><span class="co">##  4 Arge…  2000         4 Fernando … Masculino     -18.3       14.0 5.52e11</span></a>
<a class="sourceLine" id="cb40-10" data-line-number="10"><span class="co">##  5 Arge…  2001         1 Fernando … Masculino      -6.97      14.0 5.28e11</span></a>
<a class="sourceLine" id="cb40-11" data-line-number="11"><span class="co">##  6 Arge…  2001         2 Fernando … Masculino     -20.1       14.0 5.28e11</span></a>
<a class="sourceLine" id="cb40-12" data-line-number="12"><span class="co">##  7 Arge…  2001         3 Fernando … Masculino     -19.4       14.0 5.28e11</span></a>
<a class="sourceLine" id="cb40-13" data-line-number="13"><span class="co">##  8 Arge…  2001         4 Fernando … Masculino     -23.2       14.0 5.28e11</span></a>
<a class="sourceLine" id="cb40-14" data-line-number="14"><span class="co">##  9 Arge…  2002         1 Eduardo A… Masculino      -2.01      25.0 4.70e11</span></a>
<a class="sourceLine" id="cb40-15" data-line-number="15"><span class="co">## 10 Arge…  2002         2 Eduardo A… Masculino     -20.1       25.0 4.70e11</span></a>
<a class="sourceLine" id="cb40-16" data-line-number="16"><span class="co">## # … with 1,010 more rows, and 3 more variables: poblacion &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb40-17" data-line-number="17"><span class="co">## #   desempleo &lt;dbl&gt;, crec_pib &lt;dbl&gt;</span></a></code></pre></div>
</div>
</div>
<div id="comandos-en-cadena" class="section level2">
<h2><span class="header-section-number">3.4</span> Comandos en cadena</h2>
<p>La mayor parte del tiempo queremos hacer <strong>más de una operación</strong> en una base de datos. Por ejemplo, podríamos querer (1) crear una nueva variable con PIB per capita, y luego (2) filtrar las observaciones con valores iguales o mayores a la media de PIB per capita en toda la base:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1">aprob_presidencial_con_pib_pc &lt;-<span class="st"> </span><span class="kw">mutate</span>(aprob_presidencial, <span class="dt">pib_pc =</span> pib <span class="op">/</span><span class="st"> </span>poblacion)</a>
<a class="sourceLine" id="cb41-2" data-line-number="2"></a>
<a class="sourceLine" id="cb41-3" data-line-number="3"><span class="kw">filter</span>(aprob_presidencial_con_pib_pc, pib_pc <span class="op">&gt;</span><span class="st"> </span><span class="kw">mean</span>(pib_pc))</a>
<a class="sourceLine" id="cb41-4" data-line-number="4"><span class="co">## # A tibble: 492 x 12</span></a>
<a class="sourceLine" id="cb41-5" data-line-number="5"><span class="co">##    pais   anio trimestre presidente pres_sexo aprob_neta corr_ejec     pib</span></a>
<a class="sourceLine" id="cb41-6" data-line-number="6"><span class="co">##    &lt;chr&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb41-7" data-line-number="7"><span class="co">##  1 Arge…  2000         1 Fernando … Masculino      40.1       14.0 5.52e11</span></a>
<a class="sourceLine" id="cb41-8" data-line-number="8"><span class="co">##  2 Arge…  2000         2 Fernando … Masculino      16.4       14.0 5.52e11</span></a>
<a class="sourceLine" id="cb41-9" data-line-number="9"><span class="co">##  3 Arge…  2000         3 Fernando … Masculino      24.0       14.0 5.52e11</span></a>
<a class="sourceLine" id="cb41-10" data-line-number="10"><span class="co">##  4 Arge…  2000         4 Fernando … Masculino     -18.3       14.0 5.52e11</span></a>
<a class="sourceLine" id="cb41-11" data-line-number="11"><span class="co">##  5 Arge…  2001         1 Fernando … Masculino      -6.97      14.0 5.28e11</span></a>
<a class="sourceLine" id="cb41-12" data-line-number="12"><span class="co">##  6 Arge…  2001         2 Fernando … Masculino     -20.1       14.0 5.28e11</span></a>
<a class="sourceLine" id="cb41-13" data-line-number="13"><span class="co">##  7 Arge…  2001         3 Fernando … Masculino     -19.4       14.0 5.28e11</span></a>
<a class="sourceLine" id="cb41-14" data-line-number="14"><span class="co">##  8 Arge…  2001         4 Fernando … Masculino     -23.2       14.0 5.28e11</span></a>
<a class="sourceLine" id="cb41-15" data-line-number="15"><span class="co">##  9 Arge…  2002         1 Eduardo A… Masculino      -2.01      25.0 4.70e11</span></a>
<a class="sourceLine" id="cb41-16" data-line-number="16"><span class="co">## 10 Arge…  2002         2 Eduardo A… Masculino     -20.1       25.0 4.70e11</span></a>
<a class="sourceLine" id="cb41-17" data-line-number="17"><span class="co">## # … with 482 more rows, and 4 more variables: poblacion &lt;dbl&gt;, desempleo &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb41-18" data-line-number="18"><span class="co">## #   crec_pib &lt;dbl&gt;, pib_pc &lt;dbl&gt;</span></a></code></pre></div>
<p>Esta misma cadena de operaciones se puede escribir de la siguiente forma:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1">aprob_presidencial <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb42-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">pib_pc =</span> pib <span class="op">/</span><span class="st"> </span>poblacion) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb42-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(pib_pc <span class="op">&gt;</span><span class="st"> </span><span class="kw">mean</span>(pib_pc))</a>
<a class="sourceLine" id="cb42-4" data-line-number="4"><span class="co">## # A tibble: 492 x 12</span></a>
<a class="sourceLine" id="cb42-5" data-line-number="5"><span class="co">##    pais   anio trimestre presidente pres_sexo aprob_neta corr_ejec     pib</span></a>
<a class="sourceLine" id="cb42-6" data-line-number="6"><span class="co">##    &lt;chr&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb42-7" data-line-number="7"><span class="co">##  1 Arge…  2000         1 Fernando … Masculino      40.1       14.0 5.52e11</span></a>
<a class="sourceLine" id="cb42-8" data-line-number="8"><span class="co">##  2 Arge…  2000         2 Fernando … Masculino      16.4       14.0 5.52e11</span></a>
<a class="sourceLine" id="cb42-9" data-line-number="9"><span class="co">##  3 Arge…  2000         3 Fernando … Masculino      24.0       14.0 5.52e11</span></a>
<a class="sourceLine" id="cb42-10" data-line-number="10"><span class="co">##  4 Arge…  2000         4 Fernando … Masculino     -18.3       14.0 5.52e11</span></a>
<a class="sourceLine" id="cb42-11" data-line-number="11"><span class="co">##  5 Arge…  2001         1 Fernando … Masculino      -6.97      14.0 5.28e11</span></a>
<a class="sourceLine" id="cb42-12" data-line-number="12"><span class="co">##  6 Arge…  2001         2 Fernando … Masculino     -20.1       14.0 5.28e11</span></a>
<a class="sourceLine" id="cb42-13" data-line-number="13"><span class="co">##  7 Arge…  2001         3 Fernando … Masculino     -19.4       14.0 5.28e11</span></a>
<a class="sourceLine" id="cb42-14" data-line-number="14"><span class="co">##  8 Arge…  2001         4 Fernando … Masculino     -23.2       14.0 5.28e11</span></a>
<a class="sourceLine" id="cb42-15" data-line-number="15"><span class="co">##  9 Arge…  2002         1 Eduardo A… Masculino      -2.01      25.0 4.70e11</span></a>
<a class="sourceLine" id="cb42-16" data-line-number="16"><span class="co">## 10 Arge…  2002         2 Eduardo A… Masculino     -20.1       25.0 4.70e11</span></a>
<a class="sourceLine" id="cb42-17" data-line-number="17"><span class="co">## # … with 482 more rows, and 4 more variables: poblacion &lt;dbl&gt;, desempleo &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb42-18" data-line-number="18"><span class="co">## #   crec_pib &lt;dbl&gt;, pib_pc &lt;dbl&gt;</span></a></code></pre></div>
<p>¡Este código es sorprendemente legible! Las pipes (<code>%&gt;%</code>) se leen como “luego” (o “pero luego”) y se insertan con Ctrl/Cmd + Shift + M en RStudio<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>. Entonces, el siguiente bloque de código puede leerse de la siguiente forma:</p>
<blockquote>
<p>Toma la base “aprob_presidencial”, <em>luego</em> genera una variable llamada pib_pc (la división entre “pib” y “poblacion”), <em>luego</em> filtra las observaciones para dejar solo aquellas en las que “pib_pc” es mayor a su valor promedio.</p>
</blockquote>
<p>Uno de los usos más comunes de las pipes es el combo <code>group_by()</code> + <code>summarize()</code>. Repitamos nuestras operaciones de antes para hacer un resumen agrupado:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1">aprob_presidencial <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb43-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(pais) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb43-3" data-line-number="3"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">prom_desemp   =</span> <span class="kw">mean</span>(desempleo),</a>
<a class="sourceLine" id="cb43-4" data-line-number="4">            <span class="dt">prom_crec     =</span> <span class="kw">mean</span>(crec_pib),</a>
<a class="sourceLine" id="cb43-5" data-line-number="5">            <span class="dt">prom_aprob    =</span> <span class="kw">mean</span>(aprob_neta))</a>
<a class="sourceLine" id="cb43-6" data-line-number="6"><span class="co">## # A tibble: 17 x 4</span></a>
<a class="sourceLine" id="cb43-7" data-line-number="7"><span class="co">##    pais        prom_desemp prom_crec prom_aprob</span></a>
<a class="sourceLine" id="cb43-8" data-line-number="8"><span class="co">##    &lt;chr&gt;             &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb43-9" data-line-number="9"><span class="co">##  1 Argentina         11.0       2.72      16.7 </span></a>
<a class="sourceLine" id="cb43-10" data-line-number="10"><span class="co">##  2 Bolivia            3.70      4.24      11.3 </span></a>
<a class="sourceLine" id="cb43-11" data-line-number="11"><span class="co">##  3 Brasil             8.35      3.4       34.2 </span></a>
<a class="sourceLine" id="cb43-12" data-line-number="12"><span class="co">##  4 Chile              8.18      4.33       5.71</span></a>
<a class="sourceLine" id="cb43-13" data-line-number="13"><span class="co">##  5 Colombia          12.5       4.35      27.1 </span></a>
<a class="sourceLine" id="cb43-14" data-line-number="14"><span class="co">##  6 Costa Rica         6.73      4.15      14.5 </span></a>
<a class="sourceLine" id="cb43-15" data-line-number="15"><span class="co">##  7 Ecuador            6.76      4.31      37.1 </span></a>
<a class="sourceLine" id="cb43-16" data-line-number="16"><span class="co">##  8 El Salvador        5.75      1.87      39.1 </span></a>
<a class="sourceLine" id="cb43-17" data-line-number="17"><span class="co">##  9 Guatemala          2.80      3.47       5.44</span></a>
<a class="sourceLine" id="cb43-18" data-line-number="18"><span class="co">## 10 Honduras           4.22      4.08      12.7 </span></a>
<a class="sourceLine" id="cb43-19" data-line-number="19"><span class="co">## 11 México             3.99      2.10      28.9 </span></a>
<a class="sourceLine" id="cb43-20" data-line-number="20"><span class="co">## 12 Nicaragua          6.78      3.73      16.2 </span></a>
<a class="sourceLine" id="cb43-21" data-line-number="21"><span class="co">## 13 Panamá             8.45      6.31      14.2 </span></a>
<a class="sourceLine" id="cb43-22" data-line-number="22"><span class="co">## 14 Paraguay           5.69      3.66      10.9 </span></a>
<a class="sourceLine" id="cb43-23" data-line-number="23"><span class="co">## 15 Perú               4.32      5.30     -26.2 </span></a>
<a class="sourceLine" id="cb43-24" data-line-number="24"><span class="co">## 16 Uruguay           10.3       3.08      26.9 </span></a>
<a class="sourceLine" id="cb43-25" data-line-number="25"><span class="co">## 17 Venezuela         10.3       3.04     -14.8</span></a></code></pre></div>
<div id="ejercicio-c" class="section level3">
<h3><span class="header-section-number">3.4.1</span> (Ejercicio C)</h3>
<ul>
<li>Calcula, ayudándote de las pipes, la mediana por país de corrupción ejecutiva y PIB. Recuerda que puedes insertar pipes con Ctrl/Cmd + Shift + M.</li>
<li>De nuevo usando pipes, ordena los países en la base desde el que tuvo el mayor PIB per cápita promedio en el período 2010-2014 hasta el que tuvo el menor.</li>
<li>¿Qué país-año-trimestre, entre los gobernados por mujeres, tuvo la corrupción ejecutiva más alta? ¿Y la aprobación neta más alta?</li>
</ul>
</div>
</div>
<div id="manejo-de-datos-recodificar" class="section level2">
<h2><span class="header-section-number">3.5</span> Recodificar valores</h2>
<p>Un ejercicio común en manejo de datos es generar variables (o editar las existentes) en base a ciertas condiciones lógicas. Ya construimos condiciones lógicas para <code>filter()</code> antes, por lo que la sintaxis general debería ser familiar. Por ejemplo, podríamos querer registrar los valores de una variable categórica binaria como ceros y unos, creando una variable <em>dummy</em>. Esto es sencillo gracias al comando <code>if_else()</code>. Podemos especificar una condición lógica (<code>pres_sexo == female</code>) y luego los valores que se asignarán cuando esta se cumple (<code>1</code>) o no (<code>0</code>):</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" data-line-number="1">aprob_presidencial <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb44-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">d_pres_mujer =</span> <span class="kw">if_else</span>(<span class="dt">condition =</span> pres_sexo <span class="op">==</span><span class="st"> &quot;female&quot;</span>,</a>
<a class="sourceLine" id="cb44-3" data-line-number="3">                                <span class="dt">true      =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb44-4" data-line-number="4">                                <span class="dt">false     =</span> <span class="dv">0</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb44-5" data-line-number="5"><span class="st">  </span><span class="kw">select</span>(pais<span class="op">:</span>presidente, pres_sexo, d_pres_mujer) <span class="co"># seleccionamos solo para legibilidad</span></a>
<a class="sourceLine" id="cb44-6" data-line-number="6"><span class="co">## # A tibble: 1,020 x 6</span></a>
<a class="sourceLine" id="cb44-7" data-line-number="7"><span class="co">##    pais       anio trimestre presidente              pres_sexo d_pres_mujer</span></a>
<a class="sourceLine" id="cb44-8" data-line-number="8"><span class="co">##    &lt;chr&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;                   &lt;chr&gt;            &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb44-9" data-line-number="9"><span class="co">##  1 Argentina  2000         1 Fernando de la Rúa      Masculino            0</span></a>
<a class="sourceLine" id="cb44-10" data-line-number="10"><span class="co">##  2 Argentina  2000         2 Fernando de la Rúa      Masculino            0</span></a>
<a class="sourceLine" id="cb44-11" data-line-number="11"><span class="co">##  3 Argentina  2000         3 Fernando de la Rúa      Masculino            0</span></a>
<a class="sourceLine" id="cb44-12" data-line-number="12"><span class="co">##  4 Argentina  2000         4 Fernando de la Rúa      Masculino            0</span></a>
<a class="sourceLine" id="cb44-13" data-line-number="13"><span class="co">##  5 Argentina  2001         1 Fernando de la Rúa      Masculino            0</span></a>
<a class="sourceLine" id="cb44-14" data-line-number="14"><span class="co">##  6 Argentina  2001         2 Fernando de la Rúa      Masculino            0</span></a>
<a class="sourceLine" id="cb44-15" data-line-number="15"><span class="co">##  7 Argentina  2001         3 Fernando de la Rúa      Masculino            0</span></a>
<a class="sourceLine" id="cb44-16" data-line-number="16"><span class="co">##  8 Argentina  2001         4 Fernando de la Rúa      Masculino            0</span></a>
<a class="sourceLine" id="cb44-17" data-line-number="17"><span class="co">##  9 Argentina  2002         1 Eduardo Alberto Duhalde Masculino            0</span></a>
<a class="sourceLine" id="cb44-18" data-line-number="18"><span class="co">## 10 Argentina  2002         2 Eduardo Alberto Duhalde Masculino            0</span></a>
<a class="sourceLine" id="cb44-19" data-line-number="19"><span class="co">## # … with 1,010 more rows</span></a></code></pre></div>
<p>Es posible especificar condiciones lógicas más complejas, tal como en <code>filter()</code>. Por ejemplo, generemos una variable <em>dummy</em> para los países-años-trimestres en crisis económica, definida como en el Ejercicio A: cuando el crecimiento del PIB sea negativo y/o el desempleo sea mayor al 20%. Bajo esta clasificación sencilla, Argentina estaría en crisis en el año 2001, mas no en el 2013:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" data-line-number="1">aprob_presidencial <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb45-2" data-line-number="2"><span class="st">  </span><span class="co"># no explicitamos los argumentos para hacer el código más sucinto:</span></a>
<a class="sourceLine" id="cb45-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">d_crisis_ec =</span> <span class="kw">if_else</span>(crec_pib <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">|</span><span class="st"> </span>desempleo <span class="op">&gt;</span><span class="st"> </span><span class="dv">20</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb45-4" data-line-number="4"><span class="st">  </span><span class="co"># lo siguiente es solo para mostrar más claramente los resultados:</span></a>
<a class="sourceLine" id="cb45-5" data-line-number="5"><span class="st">  </span><span class="kw">select</span>(pais<span class="op">:</span>trimestre, crec_pib, desempleo, d_crisis_ec) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb45-6" data-line-number="6"><span class="st">  </span><span class="kw">filter</span>(pais <span class="op">==</span><span class="st"> &quot;Argentina&quot;</span> <span class="op">&amp;</span><span class="st"> </span>anio <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">2001</span>, <span class="dv">2013</span>))</a>
<a class="sourceLine" id="cb45-7" data-line-number="7"><span class="co">## # A tibble: 8 x 6</span></a>
<a class="sourceLine" id="cb45-8" data-line-number="8"><span class="co">##   pais       anio trimestre crec_pib desempleo d_crisis_ec</span></a>
<a class="sourceLine" id="cb45-9" data-line-number="9"><span class="co">##   &lt;chr&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb45-10" data-line-number="10"><span class="co">## 1 Argentina  2001         1     -4.4     18.3            1</span></a>
<a class="sourceLine" id="cb45-11" data-line-number="11"><span class="co">## 2 Argentina  2001         2     -4.4     18.3            1</span></a>
<a class="sourceLine" id="cb45-12" data-line-number="12"><span class="co">## 3 Argentina  2001         3     -4.4     18.3            1</span></a>
<a class="sourceLine" id="cb45-13" data-line-number="13"><span class="co">## 4 Argentina  2001         4     -4.4     18.3            1</span></a>
<a class="sourceLine" id="cb45-14" data-line-number="14"><span class="co">## 5 Argentina  2013         1      2.4      7.93           0</span></a>
<a class="sourceLine" id="cb45-15" data-line-number="15"><span class="co">## 6 Argentina  2013         2      2.4      7.25           0</span></a>
<a class="sourceLine" id="cb45-16" data-line-number="16"><span class="co">## 7 Argentina  2013         3      2.4      6.83           0</span></a>
<a class="sourceLine" id="cb45-17" data-line-number="17"><span class="co">## 8 Argentina  2013         4      2.4      6.40           0</span></a></code></pre></div>
<p>Sin embargo, a menudo <code>if_else()</code> no es lo suficientemente flexible, pues solo no permite asignar dos valores en base a una condición lógica. ¿Qué pasa si la variable que queremos crear toma más de dos valores? Por ejemplo, podríamos querer una variable que divida nuestras observaciones en tres categorías, según el país: “Cono Sur” (Argentina, Chile, Uruguay), “Centroamérica” y “Resto de AL”. Para comenzar, miremos los valores que toma la variable “país”:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1"><span class="kw">unique</span>(aprob_presidencial<span class="op">$</span>pais)</a>
<a class="sourceLine" id="cb46-2" data-line-number="2"><span class="co">##  [1] &quot;Argentina&quot;   &quot;Bolivia&quot;     &quot;Brasil&quot;      &quot;Chile&quot;       &quot;Colombia&quot;   </span></a>
<a class="sourceLine" id="cb46-3" data-line-number="3"><span class="co">##  [6] &quot;Costa Rica&quot;  &quot;Ecuador&quot;     &quot;El Salvador&quot; &quot;Guatemala&quot;   &quot;Honduras&quot;   </span></a>
<a class="sourceLine" id="cb46-4" data-line-number="4"><span class="co">## [11] &quot;México&quot;      &quot;Nicaragua&quot;   &quot;Panamá&quot;      &quot;Paraguay&quot;    &quot;Perú&quot;       </span></a>
<a class="sourceLine" id="cb46-5" data-line-number="5"><span class="co">## [16] &quot;Uruguay&quot;     &quot;Venezuela&quot;</span></a></code></pre></div>
<p><code>if_else()</code> no nos permitirá generar esta nueva variable, pero su primo <code>case_when()</code> sí. Veamos primero el código y su resultado:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" data-line-number="1">aprob_presidencial <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb47-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">grupo_pais =</span> <span class="kw">case_when</span>(</a>
<a class="sourceLine" id="cb47-3" data-line-number="3">    pais <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Argentina&quot;</span>, <span class="st">&quot;Chile&quot;</span>, <span class="st">&quot;Uruguay&quot;</span>) <span class="op">~</span><span class="st"> &quot;Cono Sur&quot;</span>,</a>
<a class="sourceLine" id="cb47-4" data-line-number="4">    pais <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Costa Rica&quot;</span>, <span class="st">&quot;El Salvador&quot;</span>, <span class="st">&quot;Guatemala&quot;</span>, <span class="st">&quot;Honduras&quot;</span>,</a>
<a class="sourceLine" id="cb47-5" data-line-number="5">                   <span class="st">&quot;Nicaragua&quot;</span>, <span class="st">&quot;Panama&quot;</span>) <span class="op">~</span><span class="st"> &quot;Centroamérica&quot;</span>,</a>
<a class="sourceLine" id="cb47-6" data-line-number="6">    <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;Resto de AL&quot;</span></a>
<a class="sourceLine" id="cb47-7" data-line-number="7">  )) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb47-8" data-line-number="8"><span class="st">  </span><span class="co"># para ver mejor los resultados, achicaremos la base:</span></a>
<a class="sourceLine" id="cb47-9" data-line-number="9"><span class="st">  </span><span class="kw">filter</span>(anio <span class="op">==</span><span class="st"> </span><span class="dv">2000</span> <span class="op">&amp;</span><span class="st"> </span>trimestre <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb47-10" data-line-number="10"><span class="st">  </span><span class="kw">select</span>(pais, grupo_pais)</a>
<a class="sourceLine" id="cb47-11" data-line-number="11"><span class="co">## # A tibble: 17 x 2</span></a>
<a class="sourceLine" id="cb47-12" data-line-number="12"><span class="co">##    pais        grupo_pais   </span></a>
<a class="sourceLine" id="cb47-13" data-line-number="13"><span class="co">##    &lt;chr&gt;       &lt;chr&gt;        </span></a>
<a class="sourceLine" id="cb47-14" data-line-number="14"><span class="co">##  1 Argentina   Cono Sur     </span></a>
<a class="sourceLine" id="cb47-15" data-line-number="15"><span class="co">##  2 Bolivia     Resto de AL  </span></a>
<a class="sourceLine" id="cb47-16" data-line-number="16"><span class="co">##  3 Brasil      Resto de AL  </span></a>
<a class="sourceLine" id="cb47-17" data-line-number="17"><span class="co">##  4 Chile       Cono Sur     </span></a>
<a class="sourceLine" id="cb47-18" data-line-number="18"><span class="co">##  5 Colombia    Resto de AL  </span></a>
<a class="sourceLine" id="cb47-19" data-line-number="19"><span class="co">##  6 Costa Rica  Centroamérica</span></a>
<a class="sourceLine" id="cb47-20" data-line-number="20"><span class="co">##  7 Ecuador     Resto de AL  </span></a>
<a class="sourceLine" id="cb47-21" data-line-number="21"><span class="co">##  8 El Salvador Centroamérica</span></a>
<a class="sourceLine" id="cb47-22" data-line-number="22"><span class="co">##  9 Guatemala   Centroamérica</span></a>
<a class="sourceLine" id="cb47-23" data-line-number="23"><span class="co">## 10 Honduras    Centroamérica</span></a>
<a class="sourceLine" id="cb47-24" data-line-number="24"><span class="co">## 11 México      Resto de AL  </span></a>
<a class="sourceLine" id="cb47-25" data-line-number="25"><span class="co">## 12 Nicaragua   Centroamérica</span></a>
<a class="sourceLine" id="cb47-26" data-line-number="26"><span class="co">## 13 Panamá      Resto de AL  </span></a>
<a class="sourceLine" id="cb47-27" data-line-number="27"><span class="co">## 14 Paraguay    Resto de AL  </span></a>
<a class="sourceLine" id="cb47-28" data-line-number="28"><span class="co">## 15 Perú        Resto de AL  </span></a>
<a class="sourceLine" id="cb47-29" data-line-number="29"><span class="co">## 16 Uruguay     Cono Sur     </span></a>
<a class="sourceLine" id="cb47-30" data-line-number="30"><span class="co">## 17 Venezuela   Resto de AL</span></a></code></pre></div>
<p>La nueva variable (“grupo país”) esta construida en base a varias condiciones lógicas, que se evalúan en orden. Si la primera se cumple (<code>pais %in% c(&quot;Argentina&quot;, &quot;Chile&quot;, &quot;Uruguay&quot;)</code>), entonces se asigna el valor “Cono Sur” en la nueva variable. La condición lógica y el valor asignado están separados por un “~”<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>, que se puede leer como “entonces”. Lo mismo sucederá con la siguiente condición, que si se cumple asigna “Centroamérica”. Nuestro último argumento para <code>case_when()</code> tiene una condición lógica con mucho alcance: <em>en todos los demás casos</em> se aplicará el valor “Resto de AL”.</p>
<div id="ejercicio-d" class="section level3">
<h3><span class="header-section-number">3.5.1</span> (Ejercicio D)</h3>
<ul>
<li><p><code>if_else()</code> puede pensarse como una versión reducida de <code>case_when()</code>: todo lo que hagamos con la primera función podríamos convertirlo a la sintaxis de la segunda. Traduce uno de los ejemplos anteriores con <code>if_else()</code> a la sintaxis de <code>case_when()</code>.</p></li>
<li><p>Genera una variable que separe a los países en tres grupos: “Norteamérica”, “Centroamérica” y “Sudamérica”.</p></li>
</ul>
</div>
</div>
<div id="manejo-de-datos-pivoteo" class="section level2">
<h2><span class="header-section-number">3.6</span> Pivoteo de bases</h2>
<p>La estructura de la base anterior, donde las filas son las observaciones, las variables son columnas y nuestra base tiene solo una unidad observacional es la <strong>estructura tidy</strong> de representar datos (Wickham, 2010). En general, R y el <code>tidyverse</code> funcionan muy bien bajo esta forma, por lo que queremos utilizarla cuando sea posible.</p>
<p>Sin embargo, no siempre los datos con los que trabajamos en el mundo real siguen esta estructura. A menudo otros formatos resultan más convenientes en contextos distintos al análisis de datos, por ejemplo, el registro manual de la administración pública. Para comenzar, generemos una base de datos al nivel país-año con los niveles de aprobación promedio:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" data-line-number="1">aprob_presidencial_por_anio_pais &lt;-<span class="st"> </span>aprob_presidencial <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb48-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(pais, anio) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb48-3" data-line-number="3"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">aprob_neta =</span> <span class="kw">mean</span>(aprob_neta)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb48-4" data-line-number="4"><span class="st">  </span><span class="kw">ungroup</span>()</a>
<a class="sourceLine" id="cb48-5" data-line-number="5"></a>
<a class="sourceLine" id="cb48-6" data-line-number="6">aprob_presidencial_por_anio_pais</a>
<a class="sourceLine" id="cb48-7" data-line-number="7"><span class="co">## # A tibble: 255 x 3</span></a>
<a class="sourceLine" id="cb48-8" data-line-number="8"><span class="co">##    pais       anio aprob_neta</span></a>
<a class="sourceLine" id="cb48-9" data-line-number="9"><span class="co">##    &lt;chr&gt;     &lt;dbl&gt;      &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb48-10" data-line-number="10"><span class="co">##  1 Argentina  2000      15.6 </span></a>
<a class="sourceLine" id="cb48-11" data-line-number="11"><span class="co">##  2 Argentina  2001     -17.4 </span></a>
<a class="sourceLine" id="cb48-12" data-line-number="12"><span class="co">##  3 Argentina  2002     -16.0 </span></a>
<a class="sourceLine" id="cb48-13" data-line-number="13"><span class="co">##  4 Argentina  2003      32.6 </span></a>
<a class="sourceLine" id="cb48-14" data-line-number="14"><span class="co">##  5 Argentina  2004      48.5 </span></a>
<a class="sourceLine" id="cb48-15" data-line-number="15"><span class="co">##  6 Argentina  2005      43.8 </span></a>
<a class="sourceLine" id="cb48-16" data-line-number="16"><span class="co">##  7 Argentina  2006      45.9 </span></a>
<a class="sourceLine" id="cb48-17" data-line-number="17"><span class="co">##  8 Argentina  2007      34.3 </span></a>
<a class="sourceLine" id="cb48-18" data-line-number="18"><span class="co">##  9 Argentina  2008       9.52</span></a>
<a class="sourceLine" id="cb48-19" data-line-number="19"><span class="co">## 10 Argentina  2009      -9.99</span></a>
<a class="sourceLine" id="cb48-20" data-line-number="20"><span class="co">## # … with 245 more rows</span></a></code></pre></div>
<p>Estos mismos datos <em>tidy</em> pueden presentarse en distintos formatos. El más común es <em>wide</em>, en el que una de las variables de identificación se distribuye en las columnas<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a> (en este caso, “anio”). Carguemos la base en este formato desde el paquete del libro:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" data-line-number="1"><span class="co"># library(paqueteadp)</span></a>
<a class="sourceLine" id="cb49-2" data-line-number="2"><span class="co"># data(aprob_presidencial_anual_wide)</span></a></code></pre></div>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" data-line-number="1">aprob_presidencial_anual_wide &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;00-datos/aprob_presidencial_esp_wide.csv&quot;</span>)</a>
<a class="sourceLine" id="cb50-2" data-line-number="2"><span class="co">## Parsed with column specification:</span></a>
<a class="sourceLine" id="cb50-3" data-line-number="3"><span class="co">## cols(</span></a>
<a class="sourceLine" id="cb50-4" data-line-number="4"><span class="co">##   pais = col_character(),</span></a>
<a class="sourceLine" id="cb50-5" data-line-number="5"><span class="co">##   `2000` = col_double(),</span></a>
<a class="sourceLine" id="cb50-6" data-line-number="6"><span class="co">##   `2001` = col_double(),</span></a>
<a class="sourceLine" id="cb50-7" data-line-number="7"><span class="co">##   `2002` = col_double(),</span></a>
<a class="sourceLine" id="cb50-8" data-line-number="8"><span class="co">##   `2003` = col_double(),</span></a>
<a class="sourceLine" id="cb50-9" data-line-number="9"><span class="co">##   `2004` = col_double(),</span></a>
<a class="sourceLine" id="cb50-10" data-line-number="10"><span class="co">##   `2005` = col_double(),</span></a>
<a class="sourceLine" id="cb50-11" data-line-number="11"><span class="co">##   `2006` = col_double(),</span></a>
<a class="sourceLine" id="cb50-12" data-line-number="12"><span class="co">##   `2007` = col_double(),</span></a>
<a class="sourceLine" id="cb50-13" data-line-number="13"><span class="co">##   `2008` = col_double(),</span></a>
<a class="sourceLine" id="cb50-14" data-line-number="14"><span class="co">##   `2009` = col_double(),</span></a>
<a class="sourceLine" id="cb50-15" data-line-number="15"><span class="co">##   `2010` = col_double(),</span></a>
<a class="sourceLine" id="cb50-16" data-line-number="16"><span class="co">##   `2011` = col_double(),</span></a>
<a class="sourceLine" id="cb50-17" data-line-number="17"><span class="co">##   `2012` = col_double(),</span></a>
<a class="sourceLine" id="cb50-18" data-line-number="18"><span class="co">##   `2013` = col_double(),</span></a>
<a class="sourceLine" id="cb50-19" data-line-number="19"><span class="co">##   `2014` = col_double()</span></a>
<a class="sourceLine" id="cb50-20" data-line-number="20"><span class="co">## )</span></a></code></pre></div>
<p>Estos datos son exactamente los mismos a los que creamos manualmente, solo cambia su forma de presentación. Esta estructura <em>wide</em> tiene algunos beneficios, el más destacado de los cuales es su brevedad: no se repiten los años en múltiples celdas, como sí sucede en la base <em>tidy</em>. Para un codificador manual, este ahorro de espacio (y tiempo) resulta atractivo. No obstante, el formato <em>wide</em> tiene una gran desventaja al compararlo con <em>tidy</em>: en su forma tradicional, solo es posible registrar información de una variable por base. En el caso del ejemplo, no hay forma de añadir fácilmente, por ejemplo, información sobre la corrupción de los países-años. Como vimos antes, este ejercicio es trivial en una base <em>tidy</em>, en la que se pueden añadir las variables como columnas. Tener múltiples variables en nuestras bases es justamente lo que necesitamos para generar análisis de datos sociales, en los que buscamos explorar distintas dimensiones de nuestros fenómenos de estudio.</p>
<p>Por suerte, el paquete <code>tidyr</code> (Wickham &amp; Henry, 2019), que se carga automáticamente junto al <code>tidyverse</code>, provee funciones para convertir rápidamente nuestros datos desde <em>wide</em> a otro más amigable para los análisis. Este tipo de conversiones de estructura se suele llamar <em>pivoteo</em>. La función clave aquí es <code>pivot_longer()</code>, que nos permite pivotear la base a un formato “más largo”. La base que obtendremos es igual a los datos <em>tidy</em> que creamos antes:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" data-line-number="1">aprob_presidencial_anual_wide <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb51-2" data-line-number="2"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="op">-</span>pais, <span class="dt">names_to =</span> <span class="st">&quot;anio&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;aprob_neta&quot;</span>)</a>
<a class="sourceLine" id="cb51-3" data-line-number="3"><span class="co">## # A tibble: 255 x 3</span></a>
<a class="sourceLine" id="cb51-4" data-line-number="4"><span class="co">##    pais      anio  aprob_neta</span></a>
<a class="sourceLine" id="cb51-5" data-line-number="5"><span class="co">##    &lt;chr&gt;     &lt;chr&gt;      &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb51-6" data-line-number="6"><span class="co">##  1 Argentina 2000       15.6 </span></a>
<a class="sourceLine" id="cb51-7" data-line-number="7"><span class="co">##  2 Argentina 2001      -17.4 </span></a>
<a class="sourceLine" id="cb51-8" data-line-number="8"><span class="co">##  3 Argentina 2002      -16.0 </span></a>
<a class="sourceLine" id="cb51-9" data-line-number="9"><span class="co">##  4 Argentina 2003       32.6 </span></a>
<a class="sourceLine" id="cb51-10" data-line-number="10"><span class="co">##  5 Argentina 2004       48.5 </span></a>
<a class="sourceLine" id="cb51-11" data-line-number="11"><span class="co">##  6 Argentina 2005       43.8 </span></a>
<a class="sourceLine" id="cb51-12" data-line-number="12"><span class="co">##  7 Argentina 2006       45.9 </span></a>
<a class="sourceLine" id="cb51-13" data-line-number="13"><span class="co">##  8 Argentina 2007       34.3 </span></a>
<a class="sourceLine" id="cb51-14" data-line-number="14"><span class="co">##  9 Argentina 2008        9.52</span></a>
<a class="sourceLine" id="cb51-15" data-line-number="15"><span class="co">## 10 Argentina 2009       -9.99</span></a>
<a class="sourceLine" id="cb51-16" data-line-number="16"><span class="co">## # … with 245 more rows</span></a></code></pre></div>
<p>El primer argumento de <code>pivot_longer()</code>, <code>cols =</code>, nos solicita seleccionar las columnas que transformar en una variable de identificación, utilizando la sintaxis de <code>select()</code> que vimos antes en el capítulo. En este caso, le estamos indicando a <code>pivot_longer()</code> que transforme todas las variables, excepto “pais”, una variable de identificación. Luego, el argumento <code>names_to =</code> nos pregunta cómo queremos llamar a la nueva variable de identificación, que nace de transformar la base. Por último, <code>values_to =</code> requiere el nombre de la nueva variable de interés que crearemos, a partir de los valores de las celdas de la base original.</p>
<p>En algunos casos nos resulta útil también hacer la operación inversa, transformar una base <em>tidy</em> al formato <em>wide</em>. Para esto podemos utilizar la otra función estrella de <code>tidyr</code>, llamada <code>pivot_wider()</code>. Veamos un ejemplo, partiendo de los datos en formato <em>tidy</em>:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" data-line-number="1">aprob_presidencial_por_anio_pais <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb52-2" data-line-number="2"><span class="st">  </span><span class="kw">pivot_wider</span>(<span class="dt">names_from =</span> <span class="st">&quot;anio&quot;</span>, <span class="dt">values_from =</span> <span class="st">&quot;aprob_neta&quot;</span>)</a>
<a class="sourceLine" id="cb52-3" data-line-number="3"><span class="co">## # A tibble: 17 x 16</span></a>
<a class="sourceLine" id="cb52-4" data-line-number="4"><span class="co">##    pais  `2000` `2001` `2002` `2003`  `2004`  `2005` `2006`  `2007` `2008`</span></a>
<a class="sourceLine" id="cb52-5" data-line-number="5"><span class="co">##    &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb52-6" data-line-number="6"><span class="co">##  1 Arge…  15.6  -17.4  -16.0   32.6   48.5    43.8    45.9   34.3     9.52</span></a>
<a class="sourceLine" id="cb52-7" data-line-number="7"><span class="co">##  2 Boli… -18.8  -14.1   -5.77 -16.8   -0.301  24.5    34.7   28.1    16.9 </span></a>
<a class="sourceLine" id="cb52-8" data-line-number="8"><span class="co">##  3 Bras…  -8.72  -2.87   3.51  45.8   26.3    21.3    30.8   40.1    58.3 </span></a>
<a class="sourceLine" id="cb52-9" data-line-number="9"><span class="co">##  4 Chile  15.1    3.82   6.34   8.85  20.8    29.0    23.1   -0.790  -1.37</span></a>
<a class="sourceLine" id="cb52-10" data-line-number="10"><span class="co">##  5 Colo… -22.3  -22.0    2.33  45.5   49.9    46.4    45.9   46.9    55.2 </span></a>
<a class="sourceLine" id="cb52-11" data-line-number="11"><span class="co">##  6 Cost…   1.04  16.8   40.4   16.1   19.0     8.29   13.8   32.6    23.3 </span></a>
<a class="sourceLine" id="cb52-12" data-line-number="12"><span class="co">##  7 Ecua…  28.5   20.4   26.5   18.7   -6.86   12.9    14.3   63.4    51.7 </span></a>
<a class="sourceLine" id="cb52-13" data-line-number="13"><span class="co">##  8 El S…  14.8   35.5   36.6   27.5   55.3    57.4    28.2   24.5    17.9 </span></a>
<a class="sourceLine" id="cb52-14" data-line-number="14"><span class="co">##  9 Guat…  11.6  -19.6  -37.7  -34.9    7.37   -2.87   -1.84   8.73    7.15</span></a>
<a class="sourceLine" id="cb52-15" data-line-number="15"><span class="co">## 10 Hond…  40.7   48.8   32.2    8.65   7.71   -0.248  13.1   41.1     1.19</span></a>
<a class="sourceLine" id="cb52-16" data-line-number="16"><span class="co">## 11 Méxi…  40.5   41.3   23.2   28.5   22.1    26.2    36.0   44.0    37.3 </span></a>
<a class="sourceLine" id="cb52-17" data-line-number="17"><span class="co">## 12 Nica…   5.02  -2.43  36.1   11.9    8.87   -0.355  -5.93  14.5    -3.22</span></a>
<a class="sourceLine" id="cb52-18" data-line-number="18"><span class="co">## 13 Pana…  -3.35  -3.37  -5.61 -17.3   -8.23   -5.09   30.6   26.8     1.16</span></a>
<a class="sourceLine" id="cb52-19" data-line-number="19"><span class="co">## 14 Para… -20.0  -19.9  -19.2   -6.54  30.1    10.2   -10.9   -0.224  34.4 </span></a>
<a class="sourceLine" id="cb52-20" data-line-number="20"><span class="co">## 15 Perú  -22.2   -3.02 -42.9  -53.4  -63.7   -61.0   -11.3   -3.70  -32.6 </span></a>
<a class="sourceLine" id="cb52-21" data-line-number="21"><span class="co">## 16 Urug…  34.0   16.7   -7.98 -25.2  -18.8    54.8    38.7   35.3    38.6 </span></a>
<a class="sourceLine" id="cb52-22" data-line-number="22"><span class="co">## 17 Vene… -10.0  -14.0  -21.2  -21.6  -17.1   -10.3    -8.89 -11.4   -14.0 </span></a>
<a class="sourceLine" id="cb52-23" data-line-number="23"><span class="co">## # … with 6 more variables: `2009` &lt;dbl&gt;, `2010` &lt;dbl&gt;, `2011` &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb52-24" data-line-number="24"><span class="co">## #   `2012` &lt;dbl&gt;, `2013` &lt;dbl&gt;, `2014` &lt;dbl&gt;</span></a></code></pre></div>
<p>Los argumentos esta vez son prácticamente un espejo de los anteriores. Aquí los queremos es que la nueva base tome desde “anio” sus nombres de columnas a lo ancho (<code>names_from = &quot;anio&quot;</code>), mientras que los valores los recoja desde nuestra variable de interés “aprob_neta” (<code>values_from = &quot;aprob_neta&quot;</code>).</p>
<p>Así, estos comandos son perfectamente simétricos. Por ejemplo, los siguiente cadena de comandos será inocua, pues <code>pivot_wider()</code> revertirá la transformación aplicada por <code>pivot_longer()</code>:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" data-line-number="1">aprob_presidencial_anual_wide <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb53-2" data-line-number="2"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="op">-</span>pais, <span class="dt">names_to =</span> <span class="st">&quot;anio&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;aprob_neta&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb53-3" data-line-number="3"><span class="st">  </span><span class="kw">pivot_wider</span>(<span class="dt">names_from =</span> <span class="st">&quot;anio&quot;</span>, <span class="dt">values_from =</span> <span class="st">&quot;aprob_neta&quot;</span>)</a>
<a class="sourceLine" id="cb53-4" data-line-number="4"><span class="co">## # A tibble: 17 x 16</span></a>
<a class="sourceLine" id="cb53-5" data-line-number="5"><span class="co">##    pais  `2000` `2001` `2002` `2003`  `2004`  `2005` `2006`  `2007` `2008`</span></a>
<a class="sourceLine" id="cb53-6" data-line-number="6"><span class="co">##    &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb53-7" data-line-number="7"><span class="co">##  1 Arge…  15.6  -17.4  -16.0   32.6   48.5    43.8    45.9   34.3     9.52</span></a>
<a class="sourceLine" id="cb53-8" data-line-number="8"><span class="co">##  2 Boli… -18.8  -14.1   -5.77 -16.8   -0.301  24.5    34.7   28.1    16.9 </span></a>
<a class="sourceLine" id="cb53-9" data-line-number="9"><span class="co">##  3 Bras…  -8.72  -2.87   3.51  45.8   26.3    21.3    30.8   40.1    58.3 </span></a>
<a class="sourceLine" id="cb53-10" data-line-number="10"><span class="co">##  4 Chile  15.1    3.82   6.34   8.85  20.8    29.0    23.1   -0.790  -1.37</span></a>
<a class="sourceLine" id="cb53-11" data-line-number="11"><span class="co">##  5 Colo… -22.3  -22.0    2.33  45.5   49.9    46.4    45.9   46.9    55.2 </span></a>
<a class="sourceLine" id="cb53-12" data-line-number="12"><span class="co">##  6 Cost…   1.04  16.8   40.4   16.1   19.0     8.29   13.8   32.6    23.3 </span></a>
<a class="sourceLine" id="cb53-13" data-line-number="13"><span class="co">##  7 Ecua…  28.5   20.4   26.5   18.7   -6.86   12.9    14.3   63.4    51.7 </span></a>
<a class="sourceLine" id="cb53-14" data-line-number="14"><span class="co">##  8 El S…  14.8   35.5   36.6   27.5   55.3    57.4    28.2   24.5    17.9 </span></a>
<a class="sourceLine" id="cb53-15" data-line-number="15"><span class="co">##  9 Guat…  11.6  -19.6  -37.7  -34.9    7.37   -2.87   -1.84   8.73    7.15</span></a>
<a class="sourceLine" id="cb53-16" data-line-number="16"><span class="co">## 10 Hond…  40.7   48.8   32.2    8.65   7.71   -0.248  13.1   41.1     1.19</span></a>
<a class="sourceLine" id="cb53-17" data-line-number="17"><span class="co">## 11 Méxi…  40.5   41.3   23.2   28.5   22.1    26.2    36.0   44.0    37.3 </span></a>
<a class="sourceLine" id="cb53-18" data-line-number="18"><span class="co">## 12 Nica…   5.02  -2.43  36.1   11.9    8.87   -0.355  -5.93  14.5    -3.22</span></a>
<a class="sourceLine" id="cb53-19" data-line-number="19"><span class="co">## 13 Pana…  -3.35  -3.37  -5.61 -17.3   -8.23   -5.09   30.6   26.8     1.16</span></a>
<a class="sourceLine" id="cb53-20" data-line-number="20"><span class="co">## 14 Para… -20.0  -19.9  -19.2   -6.54  30.1    10.2   -10.9   -0.224  34.4 </span></a>
<a class="sourceLine" id="cb53-21" data-line-number="21"><span class="co">## 15 Perú  -22.2   -3.02 -42.9  -53.4  -63.7   -61.0   -11.3   -3.70  -32.6 </span></a>
<a class="sourceLine" id="cb53-22" data-line-number="22"><span class="co">## 16 Urug…  34.0   16.7   -7.98 -25.2  -18.8    54.8    38.7   35.3    38.6 </span></a>
<a class="sourceLine" id="cb53-23" data-line-number="23"><span class="co">## 17 Vene… -10.0  -14.0  -21.2  -21.6  -17.1   -10.3    -8.89 -11.4   -14.0 </span></a>
<a class="sourceLine" id="cb53-24" data-line-number="24"><span class="co">## # … with 6 more variables: `2009` &lt;dbl&gt;, `2010` &lt;dbl&gt;, `2011` &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb53-25" data-line-number="25"><span class="co">## #   `2012` &lt;dbl&gt;, `2013` &lt;dbl&gt;, `2014` &lt;dbl&gt;</span></a></code></pre></div>
<div id="ejercicio-e" class="section level3">
<h3><span class="header-section-number">3.6.1</span> (Ejercicio E)</h3>
<ul>
<li><p>Genera una base <em>tidy</em> con el promedio de crecimiento del PIB por país-año.</p></li>
<li><p>Convierte esta base a formato <em>wide</em>, moviendo los años a las columnas.</p></li>
<li><p>Por último, vuelve a pivotear estos datos al formato <em>tidy</em>.</p></li>
</ul>
</div>
<div id="bases-en-formato-wide-con-mas-de-una-variable-de-interes" class="section level3">
<h3><span class="header-section-number">3.6.2</span> Bases en formato <em>wide</em> con más de una variable de interés</h3>
<p>Anteriormente mencionamos que no es posible registrar, de forma simple, información para más de una variable de interés en la estructura <em>wide</em>. Pero nuestras fuentes de datos a menudo tienen sorpresas poco amables para nosotros, como la siguiente:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" data-line-number="1"><span class="co"># library(paqueteadp)</span></a>
<a class="sourceLine" id="cb54-2" data-line-number="2"><span class="co"># data(aprob_presidencial_anual_wide2)</span></a></code></pre></div>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" data-line-number="1">aprob_presidencial_anual_wide2 &lt;-<span class="st"> </span><span class="kw">read_csv</span>(</a>
<a class="sourceLine" id="cb55-2" data-line-number="2">  <span class="st">&quot;00-datos/aprob_presidencial_esp_wide2.csv&quot;</span></a>
<a class="sourceLine" id="cb55-3" data-line-number="3">  )</a>
<a class="sourceLine" id="cb55-4" data-line-number="4"><span class="co">## Parsed with column specification:</span></a>
<a class="sourceLine" id="cb55-5" data-line-number="5"><span class="co">## cols(</span></a>
<a class="sourceLine" id="cb55-6" data-line-number="6"><span class="co">##   .default = col_double(),</span></a>
<a class="sourceLine" id="cb55-7" data-line-number="7"><span class="co">##   pais = col_character()</span></a>
<a class="sourceLine" id="cb55-8" data-line-number="8"><span class="co">## )</span></a>
<a class="sourceLine" id="cb55-9" data-line-number="9"><span class="co">## See spec(...) for full column specifications.</span></a></code></pre></div>
<p>Nota que en estos datos las columnas registran información en el tiempo para dos variables, “pib” y “poblacion”. Lo que queremos es <em>alargar</em> esta información hacia las filas, reconstruyendo nuestros pares países-año y las dos variables de interés. Primero podemos pivotear los datos para dejarlos en el nivel país-año-variable. En <code>pivot_longer()</code> podemos indicar que los nombres de las columnas contienen información de más de una variable. Primero, el argumento <code>names_to = c(&quot;variable&quot;, &quot;anio&quot;)</code> toma dos valores en esta ocasión, los nombres de las nuevas variables tras nuestro pivoteo. Segundo, <code>names_sep = &quot;_&quot;</code> indica que en las columnas de la base original la información de las dos variables está separada por un guión bajo (esto podría ser otro caracter, como un guión o una barra<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a>).</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" data-line-number="1">aprob_presidencial_anual_wide2 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb56-2" data-line-number="2"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="op">-</span>pais, </a>
<a class="sourceLine" id="cb56-3" data-line-number="3">               <span class="dt">names_to =</span> <span class="kw">c</span>(<span class="st">&quot;variable&quot;</span>, <span class="st">&quot;anio&quot;</span>), <span class="dt">names_sep =</span> <span class="st">&quot;_&quot;</span>)</a>
<a class="sourceLine" id="cb56-4" data-line-number="4"><span class="co">## # A tibble: 510 x 4</span></a>
<a class="sourceLine" id="cb56-5" data-line-number="5"><span class="co">##    pais      variable anio          value</span></a>
<a class="sourceLine" id="cb56-6" data-line-number="6"><span class="co">##    &lt;chr&gt;     &lt;chr&gt;    &lt;chr&gt;         &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb56-7" data-line-number="7"><span class="co">##  1 Argentina pib      2000  552151219031.</span></a>
<a class="sourceLine" id="cb56-8" data-line-number="8"><span class="co">##  2 Argentina pib      2001  527807756979.</span></a>
<a class="sourceLine" id="cb56-9" data-line-number="9"><span class="co">##  3 Argentina pib      2002  470305820970.</span></a>
<a class="sourceLine" id="cb56-10" data-line-number="10"><span class="co">##  4 Argentina pib      2003  511866938234.</span></a>
<a class="sourceLine" id="cb56-11" data-line-number="11"><span class="co">##  5 Argentina pib      2004  558086338624.</span></a>
<a class="sourceLine" id="cb56-12" data-line-number="12"><span class="co">##  6 Argentina pib      2005  607486243380.</span></a>
<a class="sourceLine" id="cb56-13" data-line-number="13"><span class="co">##  7 Argentina pib      2006  656371581729.</span></a>
<a class="sourceLine" id="cb56-14" data-line-number="14"><span class="co">##  8 Argentina pib      2007  715495242254.</span></a>
<a class="sourceLine" id="cb56-15" data-line-number="15"><span class="co">##  9 Argentina pib      2008  744524552077.</span></a>
<a class="sourceLine" id="cb56-16" data-line-number="16"><span class="co">## 10 Argentina pib      2009  700459679763.</span></a>
<a class="sourceLine" id="cb56-17" data-line-number="17"><span class="co">## # … with 500 more rows</span></a></code></pre></div>
<p>Luego podemos pivotear las variables a lo ancho para obtener nuestra base objetivo, tal como hicimos antes, con <code>pivot_wider()</code>. Hagamos todo en una cadena:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" data-line-number="1">aprob_presidencial_anual_wide2 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb57-2" data-line-number="2"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="op">-</span>pais, </a>
<a class="sourceLine" id="cb57-3" data-line-number="3">               <span class="dt">names_to =</span> <span class="kw">c</span>(<span class="st">&quot;variable&quot;</span>, <span class="st">&quot;anio&quot;</span>), <span class="dt">names_sep =</span> <span class="st">&quot;_&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb57-4" data-line-number="4"><span class="st">  </span><span class="kw">pivot_wider</span>(<span class="dt">names_from =</span> <span class="st">&quot;variable&quot;</span>, <span class="dt">values_from =</span> <span class="st">&quot;value&quot;</span>)</a>
<a class="sourceLine" id="cb57-5" data-line-number="5"><span class="co">## # A tibble: 255 x 4</span></a>
<a class="sourceLine" id="cb57-6" data-line-number="6"><span class="co">##    pais      anio            pib poblacion</span></a>
<a class="sourceLine" id="cb57-7" data-line-number="7"><span class="co">##    &lt;chr&gt;     &lt;chr&gt;         &lt;dbl&gt;     &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb57-8" data-line-number="8"><span class="co">##  1 Argentina 2000  552151219031.  37057452</span></a>
<a class="sourceLine" id="cb57-9" data-line-number="9"><span class="co">##  2 Argentina 2001  527807756979.  37471509</span></a>
<a class="sourceLine" id="cb57-10" data-line-number="10"><span class="co">##  3 Argentina 2002  470305820970.  37889370</span></a>
<a class="sourceLine" id="cb57-11" data-line-number="11"><span class="co">##  4 Argentina 2003  511866938234.  38309379</span></a>
<a class="sourceLine" id="cb57-12" data-line-number="12"><span class="co">##  5 Argentina 2004  558086338624.  38728696</span></a>
<a class="sourceLine" id="cb57-13" data-line-number="13"><span class="co">##  6 Argentina 2005  607486243380.  39145488</span></a>
<a class="sourceLine" id="cb57-14" data-line-number="14"><span class="co">##  7 Argentina 2006  656371581729.  39558890</span></a>
<a class="sourceLine" id="cb57-15" data-line-number="15"><span class="co">##  8 Argentina 2007  715495242254.  39970224</span></a>
<a class="sourceLine" id="cb57-16" data-line-number="16"><span class="co">##  9 Argentina 2008  744524552077.  40382389</span></a>
<a class="sourceLine" id="cb57-17" data-line-number="17"><span class="co">## 10 Argentina 2009  700459679763.  40799407</span></a>
<a class="sourceLine" id="cb57-18" data-line-number="18"><span class="co">## # … with 245 more rows</span></a></code></pre></div>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>Puedes ver todos los atajos de teclado de RStudio en Help &gt; Keyboard Shortcuts Help<a href="manejo-de-datos.html#fnref1" class="footnote-back">↩</a></p></li>
<li id="fn2"><p>Aprendí a decirle “colita de chancho” a este símbolo<a href="manejo-de-datos.html#fnref2" class="footnote-back">↩</a></p></li>
<li id="fn3"><p>A veces se utiliza la nomenclatura <em>long</em> (polo opuesto de <em>wide</em>) para denominar a bases que aquí referimos como <em>tidy</em>.<a href="manejo-de-datos.html#fnref3" class="footnote-back">↩</a></p></li>
<li id="fn4"><p>Si la separación entre tus variables es menos clara, pues ocupar el argumento <code>names_pattern =</code> en vez de <code>names_sep =</code>. Para esto deberás utilizar expresiones regulares, un tema tratado en el Capítulo <a href="qta.html#qta">14</a>, de análisis de texto. Por ejemplo, podríamos escribir la misma operación aquí realizada con el siguiente argumento: <code>names_pattern = &quot;(\\D+)_(\\d+)&quot;</code><a href="manejo-de-datos.html#fnref4" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="rbas.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="dataviz.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "night",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/arcruz0/libroadp/edit/master/manejo-de-datos.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
