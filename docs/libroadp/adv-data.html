<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 11 Manejo avanzado de datos políticos | AnalizaR Datos Políticos</title>
  <meta name="description" content="Capítulo 11 Manejo avanzado de datos políticos | AnalizaR Datos Políticos" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 11 Manejo avanzado de datos políticos | AnalizaR Datos Políticos" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 11 Manejo avanzado de datos políticos | AnalizaR Datos Políticos" />
  
  
  

<meta name="author" content="Francisco Urdinez y Andrés Cruz Labrín (Editores)" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link rel="prev" href="causal-inf.html"/>
<link rel="next" href="web-mining.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script>
% https://stackoverflow.com/a/4425214/8242291
var links = document.links;

for (var i = 0, linksLength = links.length; i < linksLength; i++) {

    if (links[i].hostname != window.location.hostname) {
        links[i].target = '_blank';
    }

}
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #2a211c;
    color: #bdae9d;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #bdae9d;  padding-left: 4px; }
div.sourceCode
  { color: #bdae9d; background-color: #2a211c; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ffff00; } /* Alert */
code span.an { color: #0066ff; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #44aa43; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #43a8ed; font-weight: bold; } /* ControlFlow */
code span.ch { color: #049b0a; } /* Char */
code span.cn { } /* Constant */
code span.co { color: #0066ff; font-weight: bold; font-style: italic; } /* Comment */
code span.do { color: #0066ff; font-style: italic; } /* Documentation */
code span.dt { text-decoration: underline; } /* DataType */
code span.dv { color: #44aa43; } /* DecVal */
code span.er { color: #ffff00; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #44aa43; } /* Float */
code span.fu { color: #ff9358; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #0066ff; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #43a8ed; font-weight: bold; } /* Keyword */
code span.op { } /* Operator */
code span.pp { font-weight: bold; } /* Preprocessor */
code span.sc { color: #049b0a; } /* SpecialChar */
code span.ss { color: #049b0a; } /* SpecialString */
code span.st { color: #049b0a; } /* String */
code span.va { } /* Variable */
code span.vs { color: #049b0a; } /* VerbatimString */
code span.wa { color: #ffff00; font-weight: bold; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><b><a href="./index.html"><img style="float: left; margin-right: 5px;" src="favicon.ico"></img>AnalizaR datos políticos</a></b></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introducción</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#inicio"><i class="fa fa-check"></i>Inicio</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#cómo-contribuir"><i class="fa fa-check"></i>¿Cómo contribuir?</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#sobre-los-autores-y-autoras"><i class="fa fa-check"></i>Sobre los autores y autoras</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#prefacio"><i class="fa fa-check"></i>Prefacio</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#agradecimientos"><i class="fa fa-check"></i>Agradecimientos</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#qué-esperar-del-libro"><i class="fa fa-check"></i>Qué esperar del libro</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#estructura-del-libro"><i class="fa fa-check"></i>Estructura del libro</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#cómo-utilizar-el-libro-en-un-curso-de-métodos"><i class="fa fa-check"></i>¿Cómo utilizar el libro en un curso de métodos?</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#primera-opción-curso-semestral-de-análisis-de-datos-políticos"><i class="fa fa-check"></i>Primera opción: Curso semestral de análisis de datos políticos</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#segunda-opción-curso-semestral-de-introducción-a-métodos-cuantitativos"><i class="fa fa-check"></i>Segunda opción: Curso semestral de introducción a métodos cuantitativos</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#prerrequisitos"><i class="fa fa-check"></i>Prerrequisitos</a></li>
</ul></li>
<li class="part"><span><b>I Introducción a R</b></span></li>
<li class="chapter" data-level="1" data-path="basic-r.html"><a href="basic-r.html"><i class="fa fa-check"></i><b>1</b> R Básico</a>
<ul>
<li class="chapter" data-level="1.1" data-path="basic-r.html"><a href="basic-r.html#instalación"><i class="fa fa-check"></i><b>1.1</b> Instalación</a>
<ul>
<li class="chapter" data-level="" data-path="basic-r.html"><a href="basic-r.html#r"><i class="fa fa-check"></i>R</a></li>
<li class="chapter" data-level="" data-path="basic-r.html"><a href="basic-r.html#rstudio"><i class="fa fa-check"></i>RStudio</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="basic-r.html"><a href="basic-r.html#consola"><i class="fa fa-check"></i><b>1.2</b> Consola</a></li>
<li class="chapter" data-level="1.3" data-path="basic-r.html"><a href="basic-r.html#script"><i class="fa fa-check"></i><b>1.3</b> Script</a></li>
<li class="chapter" data-level="1.4" data-path="basic-r.html"><a href="basic-r.html#objetos-y-funciones"><i class="fa fa-check"></i><b>1.4</b> Objetos (y funciones)</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="basic-r.html"><a href="basic-r.html#vectores"><i class="fa fa-check"></i><b>1.4.1</b> Vectores</a></li>
<li class="chapter" data-level="1.4.2" data-path="basic-r.html"><a href="basic-r.html#basic-r-functions"><i class="fa fa-check"></i><b>1.4.2</b> Functions</a></li>
<li class="chapter" data-level="1.4.3" data-path="basic-r.html"><a href="basic-r.html#archivos-gráficos-paquetes-ayuda"><i class="fa fa-check"></i><b>1.4.3</b> Archivos / gráficos / paquetes / ayuda</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>2</b> Manejo de datos</a>
<ul>
<li class="chapter" data-level="" data-path="data.html"><a href="data.html#los-paquetes-que-necesitas-instalar"><i class="fa fa-check"></i>Los paquetes que necesitas instalar</a></li>
<li class="chapter" data-level="2.1" data-path="data.html"><a href="data.html#introducción-al-manejo-de-datos"><i class="fa fa-check"></i><b>2.1</b> Introducción al manejo de datos</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="data.html"><a href="data.html#nuestra-base-de-datos"><i class="fa fa-check"></i><b>2.1.1</b> Nuestra base de datos</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="data.html"><a href="data.html#describiendo-una-base-de-datos"><i class="fa fa-check"></i><b>2.2</b> Describiendo una base de datos</a></li>
<li class="chapter" data-level="2.3" data-path="data.html"><a href="data.html#operaciones-básicas"><i class="fa fa-check"></i><b>2.3</b> Operaciones básicas</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="data.html"><a href="data.html#seleccionar-columnas"><i class="fa fa-check"></i><b>2.3.1</b> Seleccionar columnas</a></li>
<li class="chapter" data-level="2.3.2" data-path="data.html"><a href="data.html#renombra-las-columnas"><i class="fa fa-check"></i><b>2.3.2</b> Renombra las columnas</a></li>
<li class="chapter" data-level="2.3.3" data-path="data.html"><a href="data.html#filtrar-las-observaciones"><i class="fa fa-check"></i><b>2.3.3</b> Filtrar las observaciones</a></li>
<li class="chapter" data-level="2.3.4" data-path="data.html"><a href="data.html#cambiar-el-orden-de-una-base-de-datos"><i class="fa fa-check"></i><b>2.3.4</b> Cambiar el orden de una base de datos</a></li>
<li class="chapter" data-level="2.3.5" data-path="data.html"><a href="data.html#transformar-y-crear-variables"><i class="fa fa-check"></i><b>2.3.5</b> Transformar y crear variables</a></li>
<li class="chapter" data-level="2.3.6" data-path="data.html"><a href="data.html#resúmenes"><i class="fa fa-check"></i><b>2.3.6</b> Resúmenes</a></li>
<li class="chapter" data-level="2.3.7" data-path="data.html"><a href="data.html#resúmenes-por-grupo"><i class="fa fa-check"></i><b>2.3.7</b> Resúmenes por grupo</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="data.html"><a href="data.html#comandos-en-cadena"><i class="fa fa-check"></i><b>2.4</b> Comandos en cadena</a></li>
<li class="chapter" data-level="2.5" data-path="data.html"><a href="data.html#data-recodificar"><i class="fa fa-check"></i><b>2.5</b> Recodificar valores</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="data.html"><a href="data.html#data-pivot"><i class="fa fa-check"></i><b>2.5.1</b> Pivoteo de datos</a></li>
<li class="chapter" data-level="2.5.2" data-path="data.html"><a href="data.html#bases-de-datos-anchas-con-más-de-una-variable-de-interés"><i class="fa fa-check"></i><b>2.5.2</b> Bases de datos anchas con más de una variable de interés</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="dataviz.html"><a href="dataviz.html"><i class="fa fa-check"></i><b>3</b> Visualización de datos</a>
<ul>
<li class="chapter" data-level="" data-path="dataviz.html"><a href="dataviz.html#lecturas-sugeridas"><i class="fa fa-check"></i>Lecturas sugeridas</a></li>
<li class="chapter" data-level="" data-path="dataviz.html"><a href="dataviz.html#los-paquetes-que-necesitas-instalar-1"><i class="fa fa-check"></i>Los paquetes que necesitas instalar</a></li>
<li class="chapter" data-level="3.1" data-path="dataviz.html"><a href="dataviz.html#por-qué-visualizar-mis-datos"><i class="fa fa-check"></i><b>3.1</b> ¿Por qué visualizar mis datos?</a></li>
<li class="chapter" data-level="3.2" data-path="dataviz.html"><a href="dataviz.html#primeros-pasos"><i class="fa fa-check"></i><b>3.2</b> Primeros pasos</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="dataviz.html"><a href="dataviz.html#las-capas-del-universo-ggplotiano"><i class="fa fa-check"></i><b>3.2.1</b> Las capas del “universo ggplotiano”</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="dataviz.html"><a href="dataviz.html#ejemplo-aplicado-elecciones-locales-y-visualización-de-datos"><i class="fa fa-check"></i><b>3.3</b> Ejemplo aplicado: Elecciones locales y visualización de datos</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="dataviz.html"><a href="dataviz.html#gráfico-de-barras"><i class="fa fa-check"></i><b>3.3.1</b> Gráfico de barras</a></li>
<li class="chapter" data-level="3.3.2" data-path="dataviz.html"><a href="dataviz.html#gráfico-de-líneas"><i class="fa fa-check"></i><b>3.3.2</b> Gráfico de líneas</a></li>
<li class="chapter" data-level="3.3.3" data-path="dataviz.html"><a href="dataviz.html#gráfico-de-caja"><i class="fa fa-check"></i><b>3.3.3</b> Gráfico de caja</a></li>
<li class="chapter" data-level="3.3.4" data-path="dataviz.html"><a href="dataviz.html#histograma"><i class="fa fa-check"></i><b>3.3.4</b> Histograma</a></li>
<li class="chapter" data-level="3.3.5" data-path="dataviz.html"><a href="dataviz.html#relación-entre-las-variables"><i class="fa fa-check"></i><b>3.3.5</b> Relación entre las variables</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="dataviz.html"><a href="dataviz.html#para-continuar-aprendiendo"><i class="fa fa-check"></i><b>3.4</b> Para continuar aprendiendo</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="load.html"><a href="load.html"><i class="fa fa-check"></i><b>4</b> Carga de bases</a>
<ul>
<li class="chapter" data-level="" data-path="load.html"><a href="load.html#los-paquetes-que-necesitas-instalar-2"><i class="fa fa-check"></i>Los paquetes que necesitas instalar</a></li>
<li class="chapter" data-level="4.1" data-path="load.html"><a href="load.html#load-intro"><i class="fa fa-check"></i><b>4.1</b> Introducción</a></li>
<li class="chapter" data-level="4.2" data-path="load.html"><a href="load.html#carga-formatos"><i class="fa fa-check"></i><b>4.2</b> Diferentes formatos de bases de datos</a></li>
<li class="chapter" data-level="4.3" data-path="load.html"><a href="load.html#los-archivos-separados-por-delimitadores-.csv-y-.tsv"><i class="fa fa-check"></i><b>4.3</b> Los archivos separados por delimitadores (.csv y .tsv)</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="load.html"><a href="load.html#r-básico-utils"><i class="fa fa-check"></i><b>4.3.1</b> R básico: <code>utils</code></a></li>
<li class="chapter" data-level="4.3.2" data-path="load.html"><a href="load.html#load-r"><i class="fa fa-check"></i><b>4.3.2</b> Archivos creados con R (.Rdata y .rds)</a></li>
<li class="chapter" data-level="4.3.3" data-path="load.html"><a href="load.html#load-labels"><i class="fa fa-check"></i><b>4.3.3</b> Bases de datos con etiquetas (de Stata or SPSS)</a></li>
<li class="chapter" data-level="4.3.4" data-path="load.html"><a href="load.html#load-excel"><i class="fa fa-check"></i><b>4.3.4</b> Archivos de Excel</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="load.html"><a href="load.html#load-large"><i class="fa fa-check"></i><b>4.4</b> Grandes bases de datos tabulares</a></li>
</ul></li>
<li class="part"><span><b>II Modelos</b></span></li>
<li class="chapter" data-level="5" data-path="linear.html"><a href="linear.html"><i class="fa fa-check"></i><b>5</b> Modelos lineales</a>
<ul>
<li class="chapter" data-level="" data-path="linear.html"><a href="linear.html#lecturas-sugeridas-1"><i class="fa fa-check"></i>Lecturas sugeridas</a></li>
<li class="chapter" data-level="" data-path="linear.html"><a href="linear.html#los-paquetes-que-necesitas-instalar-3"><i class="fa fa-check"></i>Los paquetes que necesitas instalar</a></li>
<li class="chapter" data-level="" data-path="linear.html"><a href="linear.html#introducción-1"><i class="fa fa-check"></i>Introducción</a></li>
<li class="chapter" data-level="5.1" data-path="linear.html"><a href="linear.html#mínimos-cuadrados-ordinarios-en-r"><i class="fa fa-check"></i><b>5.1</b> Mínimos cuadrados ordinarios en R</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="linear.html"><a href="linear.html#cómo-obtener-estadísticas-descriptivas"><i class="fa fa-check"></i><b>5.1.1</b> Cómo obtener estadísticas descriptivas</a></li>
<li class="chapter" data-level="5.1.2" data-path="linear.html"><a href="linear.html#estadísticas-descriptivas-y-distribución-de-las-variables-en-el-modelo"><i class="fa fa-check"></i><b>5.1.2</b> Estadísticas descriptivas y distribución de las variables en el modelo</a></li>
<li class="chapter" data-level="5.1.3" data-path="linear.html"><a href="linear.html#matriz-de-correlación-de-variables-independientes"><i class="fa fa-check"></i><b>5.1.3</b> Matriz de correlación de variables independientes</a></li>
<li class="chapter" data-level="5.1.4" data-path="linear.html"><a href="linear.html#distribución-de-las-variables-de-interés"><i class="fa fa-check"></i><b>5.1.4</b> Distribución de las variables de interés</a></li>
<li class="chapter" data-level="5.1.5" data-path="linear.html"><a href="linear.html#relación-entre-la-variable-dependiente-e-independiente"><i class="fa fa-check"></i><b>5.1.5</b> Relación entre la variable dependiente e independiente</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="linear.html"><a href="linear.html#modelo-bivariado-regresión-lineal-simple"><i class="fa fa-check"></i><b>5.2</b> Modelo bivariado: regresión lineal simple</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="linear.html"><a href="linear.html#la-función-lm"><i class="fa fa-check"></i><b>5.2.1</b> La función <code>lm</code></a></li>
<li class="chapter" data-level="5.2.2" data-path="linear.html"><a href="linear.html#representación-gráfica"><i class="fa fa-check"></i><b>5.2.2</b> Representación gráfica</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="linear.html"><a href="linear.html#modelo-multivariado-regresión-múltiple"><i class="fa fa-check"></i><b>5.3</b> Modelo multivariado: regresión múltiple</a></li>
<li class="chapter" data-level="5.4" data-path="linear.html"><a href="linear.html#ajuste-del-modelo"><i class="fa fa-check"></i><b>5.4</b> Ajuste del modelo</a></li>
<li class="chapter" data-level="5.5" data-path="linear.html"><a href="linear.html#inferencia-en-los-modelos-lineales-múltiples"><i class="fa fa-check"></i><b>5.5</b> Inferencia en los modelos lineales múltiples</a></li>
<li class="chapter" data-level="5.6" data-path="linear.html"><a href="linear.html#testeando-los-supuestos-de-mco"><i class="fa fa-check"></i><b>5.6</b> Testeando los supuestos de MCO</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="case-sel.html"><a href="case-sel.html"><i class="fa fa-check"></i><b>6</b> Selección de casos basada en regresiones</a>
<ul>
<li class="chapter" data-level="" data-path="case-sel.html"><a href="case-sel.html#lecturas-sugeridas-2"><i class="fa fa-check"></i>Lecturas sugeridas</a></li>
<li class="chapter" data-level="" data-path="case-sel.html"><a href="case-sel.html#los-paquetes-que-necesitas-instalar-4"><i class="fa fa-check"></i>Los paquetes que necesitas instalar</a></li>
<li class="chapter" data-level="6.1" data-path="case-sel.html"><a href="case-sel.html#selección-de-estudios-de-casos"><i class="fa fa-check"></i><b>6.1</b> Selección de estudios de casos</a></li>
<li class="chapter" data-level="6.2" data-path="case-sel.html"><a href="case-sel.html#qué-estudio-de-caso-debería-seleccionar-para-la-investigación-cualitativa"><i class="fa fa-check"></i><b>6.2</b> ¿Qué estudio de caso debería seleccionar para la investigación cualitativa?</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="case-sel.html"><a href="case-sel.html#casos-típicos"><i class="fa fa-check"></i><b>6.2.1</b> Casos típicos</a></li>
<li class="chapter" data-level="6.2.2" data-path="case-sel.html"><a href="case-sel.html#los-valores-atípicos"><i class="fa fa-check"></i><b>6.2.2</b> Los valores atípicos</a></li>
<li class="chapter" data-level="6.2.3" data-path="case-sel.html"><a href="case-sel.html#casos-influyentes"><i class="fa fa-check"></i><b>6.2.3</b> Casos influyentes</a></li>
<li class="chapter" data-level="6.2.4" data-path="case-sel.html"><a href="case-sel.html#casos-extremos"><i class="fa fa-check"></i><b>6.2.4</b> Casos extremos</a></li>
<li class="chapter" data-level="6.2.5" data-path="case-sel.html"><a href="case-sel.html#casos-más-similares"><i class="fa fa-check"></i><b>6.2.5</b> Casos más similares</a></li>
<li class="chapter" data-level="6.2.6" data-path="case-sel.html"><a href="case-sel.html#casos-mas-diferentes"><i class="fa fa-check"></i><b>6.2.6</b> Casos mas diferentes</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="case-sel.html"><a href="case-sel.html#la-importancia-de-la-combinación-de-métodos"><i class="fa fa-check"></i><b>6.3</b> La importancia de la combinación de métodos</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="panel.html"><a href="panel.html"><i class="fa fa-check"></i><b>7</b> Modelos de panel</a>
<ul>
<li class="chapter" data-level="" data-path="panel.html"><a href="panel.html#lecturas-sugeridas-3"><i class="fa fa-check"></i>Lecturas sugeridas</a></li>
<li class="chapter" data-level="" data-path="panel.html"><a href="panel.html#los-paquetes-que-necesitas-instalar-5"><i class="fa fa-check"></i>Los paquetes que necesitas instalar</a></li>
<li class="chapter" data-level="7.1" data-path="panel.html"><a href="panel.html#introducción-2"><i class="fa fa-check"></i><b>7.1</b> Introducción</a></li>
<li class="chapter" data-level="7.2" data-path="panel.html"><a href="panel.html#describiendo-la-base-de-datos-en-panel"><i class="fa fa-check"></i><b>7.2</b> Describiendo la base de datos en panel</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="panel.html"><a href="panel.html#opción-a.-gráfico-de-líneas"><i class="fa fa-check"></i><b>7.2.1</b> Opción A. Gráfico de líneas</a></li>
<li class="chapter" data-level="7.2.2" data-path="panel.html"><a href="panel.html#option-b.-gráfico-de-cajas"><i class="fa fa-check"></i><b>7.2.2</b> Option B. Gráfico de cajas</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="panel.html"><a href="panel.html#modelización-de-la-variación-a-nivel-de-grupo"><i class="fa fa-check"></i><b>7.3</b> Modelización de la variación a nivel de grupo</a></li>
<li class="chapter" data-level="7.4" data-path="panel.html"><a href="panel.html#efectos-fijos-vs.-efectos-aleatorios"><i class="fa fa-check"></i><b>7.4</b> Efectos fijos vs. efectos aleatorios</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="panel.html"><a href="panel.html#test-de-hausman"><i class="fa fa-check"></i><b>7.4.1</b> Test de Hausman</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="panel.html"><a href="panel.html#testeando-raíces-unitarias"><i class="fa fa-check"></i><b>7.5</b> Testeando raíces unitarias</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="panel.html"><a href="panel.html#creación-de-variables-rezagadas-lags-y-variables-prospectivas-leads"><i class="fa fa-check"></i><b>7.5.1</b> Creación de variables rezagadas (<em>lags</em>) y variables prospectivas (<em>leads</em>)</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="panel.html"><a href="panel.html#errores-estándar-robustos-corregidos-para-panel"><i class="fa fa-check"></i><b>7.6</b> Errores estándar robustos corregidos para panel</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="panel.html"><a href="panel.html#errores-estándar-robustos-1"><i class="fa fa-check"></i><b>7.6.1</b> Errores estándar robustos</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="logit.html"><a href="logit.html"><i class="fa fa-check"></i><b>8</b> Modelos logísticos</a>
<ul>
<li class="chapter" data-level="" data-path="logit.html"><a href="logit.html#lecturas-sugeridas-4"><i class="fa fa-check"></i>Lecturas sugeridas</a></li>
<li class="chapter" data-level="" data-path="logit.html"><a href="logit.html#los-paquetes-que-necesitas-instalar-6"><i class="fa fa-check"></i>Los paquetes que necesitas instalar</a></li>
<li class="chapter" data-level="8.1" data-path="logit.html"><a href="logit.html#introducción-3"><i class="fa fa-check"></i><b>8.1</b> Introducción</a></li>
<li class="chapter" data-level="8.2" data-path="logit.html"><a href="logit.html#uso-de-los-modelos-logísticos"><i class="fa fa-check"></i><b>8.2</b> Uso de los modelos logísticos</a></li>
<li class="chapter" data-level="8.3" data-path="logit.html"><a href="logit.html#cómo-se-estiman-las-probabilidades"><i class="fa fa-check"></i><b>8.3</b> ¿Cómo se estiman las probabilidades?</a></li>
<li class="chapter" data-level="8.4" data-path="logit.html"><a href="logit.html#estimación-de-los-modelos"><i class="fa fa-check"></i><b>8.4</b> Estimación de los modelos</a></li>
<li class="chapter" data-level="8.5" data-path="logit.html"><a href="logit.html#creando-tablas"><i class="fa fa-check"></i><b>8.5</b> Creando tablas</a></li>
<li class="chapter" data-level="8.6" data-path="logit.html"><a href="logit.html#representación-visual-de-los-resultados"><i class="fa fa-check"></i><b>8.6</b> Representación visual de los resultados</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="logit.html"><a href="logit.html#visualización-de-las-interacciones-entre-las-variables"><i class="fa fa-check"></i><b>8.6.1</b> Visualización de las interacciones entre las variables</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="logit.html"><a href="logit.html#medidas-para-evaluar-el-ajuste-de-los-modelos"><i class="fa fa-check"></i><b>8.7</b> Medidas para evaluar el ajuste de los modelos</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="surv.html"><a href="surv.html"><i class="fa fa-check"></i><b>9</b> Modelos de supervivencia</a>
<ul>
<li class="chapter" data-level="" data-path="surv.html"><a href="surv.html#lecturas-sugeridas-5"><i class="fa fa-check"></i>Lecturas sugeridas</a></li>
<li class="chapter" data-level="" data-path="surv.html"><a href="surv.html#los-paquetes-que-necesitas-instalar-7"><i class="fa fa-check"></i>Los paquetes que necesitas instalar</a></li>
<li class="chapter" data-level="9.1" data-path="surv.html"><a href="surv.html#introducción-4"><i class="fa fa-check"></i><b>9.1</b> Introducción</a></li>
<li class="chapter" data-level="9.2" data-path="surv.html"><a href="surv.html#cómo-interpretamos-las-tasas-de-riesgo"><i class="fa fa-check"></i><b>9.2</b> ¿Cómo interpretamos las tasas de riesgo?</a></li>
<li class="chapter" data-level="9.3" data-path="surv.html"><a href="surv.html#el-modelo-cox-de-riesgos-proporcionales"><i class="fa fa-check"></i><b>9.3</b> El modelo Cox de riesgos proporcionales</a></li>
<li class="chapter" data-level="9.4" data-path="surv.html"><a href="surv.html#estimación-de-los-modelos-de-cox-en-r"><i class="fa fa-check"></i><b>9.4</b> Estimación de los modelos de Cox en R</a></li>
<li class="chapter" data-level="9.5" data-path="surv.html"><a href="surv.html#modelos-de-supervivencia-e-interpretación-sus-coeficientes-como-hazard-ratios."><i class="fa fa-check"></i><b>9.5</b> Modelos de supervivencia e interpretación sus coeficientes como Hazard Ratios.</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="causal-inf.html"><a href="causal-inf.html"><i class="fa fa-check"></i><b>10</b> Inferencia causal</a>
<ul>
<li class="chapter" data-level="" data-path="causal-inf.html"><a href="causal-inf.html#lecturas-sugeridas-6"><i class="fa fa-check"></i>Lecturas sugeridas</a></li>
<li class="chapter" data-level="" data-path="causal-inf.html"><a href="causal-inf.html#los-paquetes-que-necesitas-instalar-8"><i class="fa fa-check"></i>Los paquetes que necesitas instalar</a></li>
<li class="chapter" data-level="10.1" data-path="causal-inf.html"><a href="causal-inf.html#introducción-5"><i class="fa fa-check"></i><b>10.1</b> Introducción</a></li>
<li class="chapter" data-level="10.2" data-path="causal-inf.html"><a href="causal-inf.html#causalidad-y-gráficos-causales"><i class="fa fa-check"></i><b>10.2</b> Causalidad y gráficos causales</a></li>
<li class="chapter" data-level="10.3" data-path="causal-inf.html"><a href="causal-inf.html#midiendo-efectos-causales"><i class="fa fa-check"></i><b>10.3</b> Midiendo efectos causales</a></li>
<li class="chapter" data-level="10.4" data-path="causal-inf.html"><a href="causal-inf.html#dags-y-asociaciones-estadísticas"><i class="fa fa-check"></i><b>10.4</b> DAGs y asociaciones estadísticas</a></li>
<li class="chapter" data-level="10.5" data-path="causal-inf.html"><a href="causal-inf.html#puertas-traseras-y-cálculos-hacer"><i class="fa fa-check"></i><b>10.5</b> Puertas traseras y cálculos “<em>hacer</em>”</a></li>
<li class="chapter" data-level="10.6" data-path="causal-inf.html"><a href="causal-inf.html#dibujar-y-analizar-dags"><i class="fa fa-check"></i><b>10.6</b> Dibujar y analizar DAGs</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="causal-inf.html"><a href="causal-inf.html#dibujar-un-dag-con-dagitty"><i class="fa fa-check"></i><b>10.6.1</b> Dibujar un DAG con DAGitty</a></li>
<li class="chapter" data-level="10.6.2" data-path="causal-inf.html"><a href="causal-inf.html#encontrar-sets-de-ajuste-con-dagitty"><i class="fa fa-check"></i><b>10.6.2</b> Encontrar sets de ajuste con DAGitty</a></li>
<li class="chapter" data-level="10.6.3" data-path="causal-inf.html"><a href="causal-inf.html#diseñar-dags-en-r"><i class="fa fa-check"></i><b>10.6.3</b> Diseñar DAGs en R</a></li>
<li class="chapter" data-level="10.6.4" data-path="causal-inf.html"><a href="causal-inf.html#encontrar-caminos-y-sets-de-ajustes-con-r"><i class="fa fa-check"></i><b>10.6.4</b> Encontrar caminos y sets de ajustes con R</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="causal-inf.html"><a href="causal-inf.html#haciendo-ajustes-causales"><i class="fa fa-check"></i><b>10.7</b> Haciendo ajustes causales</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="causal-inf.html"><a href="causal-inf.html#datos-de-redes-para-mosquitos"><i class="fa fa-check"></i><b>10.7.1</b> Datos de redes para mosquitos</a></li>
<li class="chapter" data-level="10.7.2" data-path="causal-inf.html"><a href="causal-inf.html#verificar-las-independencias-condicionales"><i class="fa fa-check"></i><b>10.7.2</b> Verificar las independencias condicionales</a></li>
<li class="chapter" data-level="10.7.3" data-path="causal-inf.html"><a href="causal-inf.html#encuentra-el-set-de-ajuste"><i class="fa fa-check"></i><b>10.7.3</b> Encuentra el set de ajuste</a></li>
<li class="chapter" data-level="10.7.4" data-path="causal-inf.html"><a href="causal-inf.html#estimación-ingenua-no-ajustada"><i class="fa fa-check"></i><b>10.7.4</b> Estimación ingenua no ajustada</a></li>
<li class="chapter" data-level="10.7.5" data-path="causal-inf.html"><a href="causal-inf.html#regresiones"><i class="fa fa-check"></i><b>10.7.5</b> Regresiones</a></li>
<li class="chapter" data-level="10.7.6" data-path="causal-inf.html"><a href="causal-inf.html#matching"><i class="fa fa-check"></i><b>10.7.6</b> Matching</a></li>
<li class="chapter" data-level="10.7.7" data-path="causal-inf.html"><a href="causal-inf.html#ponderación-de-probabilidad-inversa"><i class="fa fa-check"></i><b>10.7.7</b> Ponderación de probabilidad inversa</a></li>
<li class="chapter" data-level="10.7.8" data-path="causal-inf.html"><a href="causal-inf.html#comparando-todos-los-métodos"><i class="fa fa-check"></i><b>10.7.8</b> Comparando todos los métodos</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="causal-inf.html"><a href="causal-inf.html#consejos-finales"><i class="fa fa-check"></i><b>10.8</b> Consejos finales</a></li>
</ul></li>
<li class="part"><span><b>III Aplicaciones</b></span></li>
<li class="chapter" data-level="11" data-path="adv-data.html"><a href="adv-data.html"><i class="fa fa-check"></i><b>11</b> Manejo avanzado de datos políticos</a>
<ul>
<li class="chapter" data-level="" data-path="adv-data.html"><a href="adv-data.html#lecturas-sugeridas-7"><i class="fa fa-check"></i>Lecturas sugeridas</a></li>
<li class="chapter" data-level="" data-path="adv-data.html"><a href="adv-data.html#los-paquetes-que-necesitas-instalar-9"><i class="fa fa-check"></i>Los paquetes que necesitas instalar</a></li>
<li class="chapter" data-level="11.1" data-path="adv-data.html"><a href="adv-data.html#introducción-6"><i class="fa fa-check"></i><b>11.1</b> Introducción</a></li>
<li class="chapter" data-level="11.2" data-path="adv-data.html"><a href="adv-data.html#uniendo-bases-de-datos"><i class="fa fa-check"></i><b>11.2</b> Uniendo bases de datos</a></li>
<li class="chapter" data-level="11.3" data-path="adv-data.html"><a href="adv-data.html#estandarizando-los-códigos-de-país"><i class="fa fa-check"></i><b>11.3</b> Estandarizando los códigos de país</a></li>
<li class="chapter" data-level="11.4" data-path="adv-data.html"><a href="adv-data.html#la-unión-borrosa-o-inexacta-de-los-datos"><i class="fa fa-check"></i><b>11.4</b> La unión borrosa o inexacta de los datos</a></li>
<li class="chapter" data-level="11.5" data-path="adv-data.html"><a href="adv-data.html#gestión-de-valores-perdidos"><i class="fa fa-check"></i><b>11.5</b> Gestión de valores perdidos</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="adv-data.html"><a href="adv-data.html#tipos-de-valores-perdidos"><i class="fa fa-check"></i><b>11.5.1</b> Tipos de valores perdidos</a></li>
<li class="chapter" data-level="11.5.2" data-path="adv-data.html"><a href="adv-data.html#descripción-de-los-valores-que-faltan-en-la-base-de-datos"><i class="fa fa-check"></i><b>11.5.2</b> Descripción de los valores que faltan en la base de datos</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="adv-data.html"><a href="adv-data.html#imputación-de-valores-perdidos"><i class="fa fa-check"></i><b>11.6</b> Imputación de valores perdidos</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="adv-data.html"><a href="adv-data.html#regresiones-luego-de-imputar-datos"><i class="fa fa-check"></i><b>11.6.1</b> Regresiones luego de imputar datos</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="web-mining.html"><a href="web-mining.html"><i class="fa fa-check"></i><b>12</b> Minería de datos web</a>
<ul>
<li class="chapter" data-level="" data-path="web-mining.html"><a href="web-mining.html#lecturas-sugeridas-8"><i class="fa fa-check"></i>Lecturas sugeridas</a></li>
<li class="chapter" data-level="" data-path="web-mining.html"><a href="web-mining.html#los-paquetes-que-necesitas-instalar-10"><i class="fa fa-check"></i>Los paquetes que necesitas instalar</a></li>
<li class="chapter" data-level="12.1" data-path="web-mining.html"><a href="web-mining.html#introducción-7"><i class="fa fa-check"></i><b>12.1</b> Introducción</a></li>
<li class="chapter" data-level="12.2" data-path="web-mining.html"><a href="web-mining.html#formas-de-hacer-web-scraping"><i class="fa fa-check"></i><b>12.2</b> Formas de hacer web scraping</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="web-mining.html"><a href="web-mining.html#estándar-de-exclusión-de-robot"><i class="fa fa-check"></i><b>12.2.1</b> Estándar de exclusión de robot</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="web-mining.html"><a href="web-mining.html#web-scraping-en-r"><i class="fa fa-check"></i><b>12.3</b> Web scraping en R</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="web-mining.html"><a href="web-mining.html#ejemplo-aplicado-los-comunicados-de-prensa-de-la-organización-de-estados-americanos-oea"><i class="fa fa-check"></i><b>12.3.1</b> Ejemplo aplicado: los comunicados de prensa de la Organización de Estados Americanos (OEA)</a></li>
<li class="chapter" data-level="12.3.2" data-path="web-mining.html"><a href="web-mining.html#caraga-el-html-para-trabajar-con-r"><i class="fa fa-check"></i><b>12.3.2</b> Caraga el html para trabajar con R</a></li>
<li class="chapter" data-level="12.3.3" data-path="web-mining.html"><a href="web-mining.html#extraer-la-información-con-html_nodes-html_text"><i class="fa fa-check"></i><b>12.3.3</b> Extraer la información con <code>html_nodes()</code> + <code>html_text()</code></a></li>
<li class="chapter" data-level="12.3.4" data-path="web-mining.html"><a href="web-mining.html#iteraciones"><i class="fa fa-check"></i><b>12.3.4</b> Iteraciones</a></li>
<li class="chapter" data-level="12.3.5" data-path="web-mining.html"><a href="web-mining.html#funciones-personalizadas-recetas"><i class="fa fa-check"></i><b>12.3.5</b> Funciones personalizadas (recetas)</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="web-mining.html"><a href="web-mining.html#usando-apis-y-extrayendo-datos-de-twitter"><i class="fa fa-check"></i><b>12.4</b> Usando APIs y extrayendo datos de Twitter</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="web-mining.html"><a href="web-mining.html#algunos-antecedentes-en-apis"><i class="fa fa-check"></i><b>12.4.1</b> Algunos antecedentes en APIs</a></li>
<li class="chapter" data-level="12.4.2" data-path="web-mining.html"><a href="web-mining.html#extraer-los-datos"><i class="fa fa-check"></i><b>12.4.2</b> Extraer los datos</a></li>
<li class="chapter" data-level="12.4.3" data-path="web-mining.html"><a href="web-mining.html#buscar-una-palabra-clave"><i class="fa fa-check"></i><b>12.4.3</b> Buscar una palabra clave</a></li>
<li class="chapter" data-level="12.4.4" data-path="web-mining.html"><a href="web-mining.html#buscar-una-frase"><i class="fa fa-check"></i><b>12.4.4</b> Buscar una frase</a></li>
<li class="chapter" data-level="12.4.5" data-path="web-mining.html"><a href="web-mining.html#descargando-características-relacionadas-con-los-usuarios-de-twitter"><i class="fa fa-check"></i><b>12.4.5</b> Descargando características relacionadas con los usuarios de Twitter</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="qta.html"><a href="qta.html"><i class="fa fa-check"></i><b>13</b> Análisis cuantitativo de textos políticos</a>
<ul>
<li class="chapter" data-level="" data-path="qta.html"><a href="qta.html#lecturas-recomendadas"><i class="fa fa-check"></i>Lecturas recomendadas</a></li>
<li class="chapter" data-level="" data-path="qta.html"><a href="qta.html#paquetes-que-necesitas-instalar"><i class="fa fa-check"></i>Paquetes que necesitas instalar</a></li>
<li class="chapter" data-level="13.1" data-path="qta.html"><a href="qta.html#sqta1"><i class="fa fa-check"></i><b>13.1</b> Análisis de hashtags políticos</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="qta.html"><a href="qta.html#exploración-de-datos-de-twitter"><i class="fa fa-check"></i><b>13.1.1</b> Exploración de datos de Twitter</a></li>
<li class="chapter" data-level="13.1.2" data-path="qta.html"><a href="qta.html#diagnóstico-visual"><i class="fa fa-check"></i><b>13.1.2</b> Diagnóstico visual</a></li>
<li class="chapter" data-level="13.1.3" data-path="qta.html"><a href="qta.html#hashtags-más-utilizados"><i class="fa fa-check"></i><b>13.1.3</b> Hashtags más utilizados</a></li>
<li class="chapter" data-level="13.1.4" data-path="qta.html"><a href="qta.html#wordclouds-nubes-de-palabras"><i class="fa fa-check"></i><b>13.1.4</b> Wordclouds (Nubes de palabras)</a></li>
<li class="chapter" data-level="13.1.5" data-path="qta.html"><a href="qta.html#nubes-de-palabras-por-grupos"><i class="fa fa-check"></i><b>13.1.5</b> Nubes de palabras por grupos</a></li>
<li class="chapter" data-level="13.1.6" data-path="qta.html"><a href="qta.html#gráficos-de-barras"><i class="fa fa-check"></i><b>13.1.6</b> Gráficos de barras</a></li>
<li class="chapter" data-level="13.1.7" data-path="qta.html"><a href="qta.html#variación-temporal-en-el-uso-de-hashtags"><i class="fa fa-check"></i><b>13.1.7</b> Variación temporal en el uso de hashtags</a></li>
<li class="chapter" data-level="13.1.8" data-path="qta.html"><a href="qta.html#para-resumir"><i class="fa fa-check"></i><b>13.1.8</b> Para resumir</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="qta.html"><a href="qta.html#wordfish"><i class="fa fa-check"></i><b>13.2</b> Wordfish</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="qta.html"><a href="qta.html#inspección-y-limpieza-de-datos"><i class="fa fa-check"></i><b>13.2.1</b> Inspección y limpieza de datos</a></li>
<li class="chapter" data-level="13.2.2" data-path="qta.html"><a href="qta.html#pre-procesamiento"><i class="fa fa-check"></i><b>13.2.2</b> Pre-procesamiento</a></li>
<li class="chapter" data-level="13.2.3" data-path="qta.html"><a href="qta.html#sqta2"><i class="fa fa-check"></i><b>13.2.3</b> Wordfish</a></li>
<li class="chapter" data-level="13.2.4" data-path="qta.html"><a href="qta.html#qué-aprendimos-de-wordfish"><i class="fa fa-check"></i><b>13.2.4</b> ¿Qué aprendimos de Wordfish?</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="qta.html"><a href="qta.html#sqta3"><i class="fa fa-check"></i><b>13.3</b> Structural Topic Modeling (STM)</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="qta.html"><a href="qta.html#pre-procesamiento-1"><i class="fa fa-check"></i><b>13.3.1</b> Pre-procesamiento</a></li>
<li class="chapter" data-level="13.3.2" data-path="qta.html"><a href="qta.html#diagnósticos"><i class="fa fa-check"></i><b>13.3.2</b> Diagnósticos</a></li>
<li class="chapter" data-level="13.3.3" data-path="qta.html"><a href="qta.html#análisis"><i class="fa fa-check"></i><b>13.3.3</b> Análisis</a></li>
<li class="chapter" data-level="13.3.4" data-path="qta.html"><a href="qta.html#observaciones-finales"><i class="fa fa-check"></i><b>13.3.4</b> Observaciones finales</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="networks.html"><a href="networks.html"><i class="fa fa-check"></i><b>14</b> Análisis de redes</a>
<ul>
<li class="chapter" data-level="" data-path="networks.html"><a href="networks.html#lecturas-sugeridas-9"><i class="fa fa-check"></i>Lecturas sugeridas</a></li>
<li class="chapter" data-level="" data-path="networks.html"><a href="networks.html#los-paquetes-que-necesitas-instalar-11"><i class="fa fa-check"></i>Los paquetes que necesitas instalar</a></li>
<li class="chapter" data-level="14.1" data-path="networks.html"><a href="networks.html#introducción-8"><i class="fa fa-check"></i><b>14.1</b> Introducción</a></li>
<li class="chapter" data-level="14.2" data-path="networks.html"><a href="networks.html#conceptos-básicos-en-una-red"><i class="fa fa-check"></i><b>14.2</b> Conceptos básicos en una red</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="networks.html"><a href="networks.html#nodos-y-enlaces"><i class="fa fa-check"></i><b>14.2.1</b> Nodos y enlaces</a></li>
<li class="chapter" data-level="14.2.2" data-path="networks.html"><a href="networks.html#matriz-de-adyacencia"><i class="fa fa-check"></i><b>14.2.2</b> Matriz de adyacencia</a></li>
<li class="chapter" data-level="14.2.3" data-path="networks.html"><a href="networks.html#pesos-y-direcciones"><i class="fa fa-check"></i><b>14.2.3</b> Pesos y direcciones</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="networks.html"><a href="networks.html#bases-de-datos-de-la-red"><i class="fa fa-check"></i><b>14.3</b> Bases de datos de la red</a></li>
<li class="chapter" data-level="14.4" data-path="networks.html"><a href="networks.html#presentación-gráfica-de-una-red"><i class="fa fa-check"></i><b>14.4</b> Presentación gráfica de una red</a></li>
<li class="chapter" data-level="14.5" data-path="networks.html"><a href="networks.html#medidas-de-centralidad"><i class="fa fa-check"></i><b>14.5</b> Medidas de centralidad</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="networks.html"><a href="networks.html#grado"><i class="fa fa-check"></i><b>14.5.1</b> Grado</a></li>
<li class="chapter" data-level="14.5.2" data-path="networks.html"><a href="networks.html#centralidad-del-eigenvector"><i class="fa fa-check"></i><b>14.5.2</b> Centralidad del eigenvector</a></li>
<li class="chapter" data-level="14.5.3" data-path="networks.html"><a href="networks.html#centralidad-de-intermediación-betweenness"><i class="fa fa-check"></i><b>14.5.3</b> Centralidad de intermediación (<em>betweenness</em>)</a></li>
<li class="chapter" data-level="14.5.4" data-path="networks.html"><a href="networks.html#cercanía"><i class="fa fa-check"></i><b>14.5.4</b> Cercanía</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="networks.html"><a href="networks.html#aplicación-en-r"><i class="fa fa-check"></i><b>14.6</b> Aplicación en R</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="indexes.html"><a href="indexes.html"><i class="fa fa-check"></i><b>15</b> Análisis de componentes principales</a>
<ul>
<li class="chapter" data-level="" data-path="indexes.html"><a href="indexes.html#lecturas-sugeridas-10"><i class="fa fa-check"></i>Lecturas sugeridas</a></li>
<li class="chapter" data-level="" data-path="indexes.html"><a href="indexes.html#los-paquetes-que-necesitas-instalar-12"><i class="fa fa-check"></i>Los paquetes que necesitas instalar</a></li>
<li class="chapter" data-level="15.1" data-path="indexes.html"><a href="indexes.html#introducción-9"><i class="fa fa-check"></i><b>15.1</b> Introducción</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="indexes.html"><a href="indexes.html#conceptos-medidas-y-validez"><i class="fa fa-check"></i><b>15.1.1</b> Conceptos, medidas y validez</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="indexes.html"><a href="indexes.html#cómo-funciona-el-análisis-de-componentes-principales"><i class="fa fa-check"></i><b>15.2</b> Cómo funciona el Análisis de Componentes Principales</a></li>
<li class="chapter" data-level="15.3" data-path="indexes.html"><a href="indexes.html#nociones-básicas-en-r"><i class="fa fa-check"></i><b>15.3</b> Nociones básicas en R</a></li>
<li class="chapter" data-level="15.4" data-path="indexes.html"><a href="indexes.html#dimensionalidad-del-concepto"><i class="fa fa-check"></i><b>15.4</b> Dimensionalidad del concepto</a></li>
<li class="chapter" data-level="15.5" data-path="indexes.html"><a href="indexes.html#variación-del-concepto"><i class="fa fa-check"></i><b>15.5</b> Variación del concepto</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="maps.html"><a href="maps.html"><i class="fa fa-check"></i><b>16</b> Mapas y datos espaciales</a>
<ul>
<li class="chapter" data-level="" data-path="maps.html"><a href="maps.html#lecturas-sugeridas-11"><i class="fa fa-check"></i>Lecturas sugeridas</a></li>
<li class="chapter" data-level="" data-path="maps.html"><a href="maps.html#los-paquetes-que-necesitas-instalar-13"><i class="fa fa-check"></i>Los paquetes que necesitas instalar</a></li>
<li class="chapter" data-level="16.1" data-path="maps.html"><a href="maps.html#introducción-10"><i class="fa fa-check"></i><b>16.1</b> Introducción</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="maps.html"><a href="maps.html#datos-espaciales-qué-son"><i class="fa fa-check"></i><b>16.1.1</b> Datos espaciales: ¿qué son?</a></li>
<li class="chapter" data-level="16.1.2" data-path="maps.html"><a href="maps.html#estructura-de-datos-espaciales"><i class="fa fa-check"></i><b>16.1.2</b> Estructura de datos espaciales</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="maps.html"><a href="maps.html#datos-espaciales-en-r"><i class="fa fa-check"></i><b>16.2</b> Datos espaciales en R</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="maps.html"><a href="maps.html#características-simples-en-r"><i class="fa fa-check"></i><b>16.2.1</b> Características simples en R</a></li>
<li class="chapter" data-level="16.2.2" data-path="maps.html"><a href="maps.html#estructura"><i class="fa fa-check"></i><b>16.2.2</b> Estructura</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="maps.html"><a href="maps.html#gestión-de-datos-espaciales"><i class="fa fa-check"></i><b>16.3</b> Gestión de Datos Espaciales</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="maps.html"><a href="maps.html#modificaciones"><i class="fa fa-check"></i><b>16.3.1</b> Modificaciones</a></li>
<li class="chapter" data-level="16.3.2" data-path="maps.html"><a href="maps.html#añade-datos-de-otras-bases-de-datos-con-left_join"><i class="fa fa-check"></i><b>16.3.2</b> Añade datos de otras bases de datos con <code>left_join()</code></a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="maps.html"><a href="maps.html#mapeo"><i class="fa fa-check"></i><b>16.4</b> Mapeo</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="maps.html"><a href="maps.html#generando-centroides"><i class="fa fa-check"></i><b>16.4.1</b> Generando centroides</a></li>
<li class="chapter" data-level="16.4.2" data-path="maps.html"><a href="maps.html#mapeando-variables"><i class="fa fa-check"></i><b>16.4.2</b> Mapeando variables</a></li>
<li class="chapter" data-level="16.4.3" data-path="maps.html"><a href="maps.html#mapeando-puntos"><i class="fa fa-check"></i><b>16.4.3</b> Mapeando puntos</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="maps.html"><a href="maps.html#inferencia-a-partir-de-datos-espaciales"><i class="fa fa-check"></i><b>16.5</b> Inferencia a partir de datos espaciales</a>
<ul>
<li class="chapter" data-level="16.5.1" data-path="maps.html"><a href="maps.html#indicador-local-de-asociación-espacial-lisa-por-sus-siglas-en-inglés"><i class="fa fa-check"></i><b>16.5.1</b> Indicador local de asociación espacial (LISA, por sus siglas en inglés)</a></li>
<li class="chapter" data-level="16.5.2" data-path="maps.html"><a href="maps.html#matriz-de-pesos-espaciales"><i class="fa fa-check"></i><b>16.5.2</b> Matriz de pesos espaciales</a></li>
<li class="chapter" data-level="16.5.3" data-path="maps.html"><a href="maps.html#i-de-moran"><i class="fa fa-check"></i><b>16.5.3</b> I de Moran</a></li>
<li class="chapter" data-level="" data-path="maps.html"><a href="maps.html#comentarios-finales-referencias-para-un-mejor-análisis-de-datos-espaciales"><i class="fa fa-check"></i>Comentarios finales: Referencias para un mejor análisis de datos espaciales</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Respuestas ejercicios</b></span></li>
<li class="chapter" data-level="" data-path="respuestas-ejercicios.html"><a href="respuestas-ejercicios.html"><i class="fa fa-check"></i>Respuestas ejercicios</a></li>
<li class="part"><span><b>V Referencias</b></span></li>
<li class="chapter" data-level="17" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i><b>17</b> Referencias</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">AnalizaR Datos Políticos</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="adv-data" class="section level1" number="11">
<h1><span class="header-section-number">Capítulo 11</span> Manejo avanzado de datos políticos</h1>
<p>Andrés Cruz<a href="#fn46" class="footnote-ref" id="fnref46"><sup>46</sup></a> y Francisco Urdinez<a href="#fn47" class="footnote-ref" id="fnref47"><sup>47</sup></a></p>
<div id="lecturas-sugeridas-7" class="section level3 unnumbered">
<h3>Lecturas sugeridas</h3>
<ul>
<li><p>Graham, B. A., &amp; Tucker, J. R. (2019). The international political economy data resource. <em>The Review of International Organizations, 14</em>(1), 149-161.</p></li>
<li><p>Lall, R. (2016). How multiple imputation makes a difference. <em>Political Analysis, 24</em>(4), 414-433.</p></li>
</ul>
</div>
<div id="los-paquetes-que-necesitas-instalar-9" class="section level3 unnumbered">
<h3>Los paquetes que necesitas instalar</h3>
<ul>
<li><code>tidyverse</code> <span class="citation">(<a href="referencias.html#ref-R-tidyverse" role="doc-biblioref">Wickham 2019b</a>)</span>, <code>paqueteadp</code> <span class="citation">(<a href="referencias.html#ref-R-paqueteadp" role="doc-biblioref">Urdinez and Cruz 2020</a>)</span>, <code>skimr</code> <span class="citation">(<a href="referencias.html#ref-R-skimr" role="doc-biblioref">Waring et al. 2020</a>)</span>, <code>countrycode</code> <span class="citation">(<a href="referencias.html#ref-R-countrycode" role="doc-biblioref">Arel-Bundock 2020</a>)</span>, <code>stringdist</code> <span class="citation">(<a href="referencias.html#ref-R-stringdist" role="doc-biblioref">van der Loo 2019</a>)</span>, <code>naniar</code> <span class="citation">(<a href="referencias.html#ref-R-naniar" role="doc-biblioref">Tierney et al. 2020</a>)</span>, <code>mice</code> <span class="citation">(<a href="referencias.html#ref-R-mice" role="doc-biblioref">van Buuren and Groothuis-Oudshoorn 2020</a>)</span>, <code>remotes</code> <span class="citation">(<a href="referencias.html#ref-R-remotes" role="doc-biblioref">Hester et al. 2020</a>)</span>, <code>inexact</code> <span class="citation">(<a href="referencias.html#ref-R-inexact" role="doc-biblioref">Cruz 2020</a>)</span>.</li>
</ul>
</div>
<div id="introducción-6" class="section level2" number="11.1">
<h2><span class="header-section-number">11.1</span> Introducción</h2>
<p>En el presente capítulo abordaremos dos problemas comunes que surgen cuando se utilizan datos de fuentes diferentes. El primero de ellos consiste en unir bases de datos, proceso que a menudo se aborda utilizando una o varias variables de identificación (por ejemplo, el nombre de un país, el código oficial de una unidad subnacional, un código creado por uno mismo). En algunos casos, cuando las variables de identificación están bien normalizadas, el proceso se vuelve sencillo. Por ejemplo, en las bases de datos oficiales del gobierno, los países tienen un código único. En todos ellos el Brasil será “BRA,” y Chile será “CHI,” lo que facilita el trabajo en R.</p>
<p>Sin embargo, en el mundo real, las diferentes fuentes de datos no están hechas para trabajar juntas. Después de mirar una herramienta para estandarizar los códigos de país, <code>countrycode</code>, mostraremos una solución general, la unión <em>fuzzy</em> o inexacta de datos. Considere el siguiente escenario: su principal base de datos tiene una variable llamada <code>country</code>, donde Brasil está codificado en mayúsculas como “BRAZIL.” Entonces, quieres unir tus datos con los del Banco Mundial, donde la información de Brasil está etiquetada como “Brazil.” Hay casos extremos, como la diferencia entre “Venezuela” y su nombre oficial, “República Bolivariana de Venezuela.” Es probable que se enfrente a este tipo de diferencias en los países de su base de datos. ¿Cómo podemos resolver este rompecabezas de una manera rápida y efectiva?</p>
<p>El segundo problema es que, en la mayoría de los casos, nuestras bases de datos contienen valores perdidos. Esto ocurre por múltiples razones: error de codificación, gobiernos que no registran la información, etcétera. En la subsección, aprenderá cómo R registra y trabaja con los valores perdidos, además de algunas herramientas que permiten explorarlos en sus bases de datos. Un tema específico que abordaremos es el de las imputaciones. Cuando en una regresión hay valores perdidos, R simplemente elimina la observación que tiene el valor perdido, ya sea en su variable dependiente, variable independiente o controles (esta eliminación se llama <em>listwise deletion</em>). Imaginemos que queremos comparar diez países de América Latina en la evolución de sus tasas de desempleo entre 2008 y 2018, y sin embargo uno de ellos no tiene datos para el trienio 2011-2013. ¿Podemos, tal vez, llenar esos valores “adivinando” los valores no observados? Este proceso recibe el nombre de imputación.</p>
<p>La decisión de imputar o no es una decisión del investigador. La imputación será adecuada dependiendo de si los datos faltan de forma <strong>aleatoria</strong> o no. Este dilema está presente cuando los datos se usan para hacer gráficos de tendencia temporal y no queremos que estén incompletos. Además, en algunos modelos avanzados, como los espaciales, el hecho de tener valores perdidos puede inhibirnos de usar comandos. Para estos casos, podemos considerar la imputación de datos. Hacer esto tiene un costo ya que, como toda solución, no es perfecta.</p>
<p>A lo largo de este capítulo utilizaremos la base de datos de tratados internacionales creada por <a href="https://www.carstenschulz.eu/">Carsten Schulz</a> basada en el <a href="https://tratados.un.org/">repositorio de tratados internacionales existentes de las Naciones Unidas</a>. Este repositorio alberga todos los tratados internacionales celebrados entre Estados, con sus textos e información sobre los firmantes. La base de datos del ejemplo se simplifica, ya que sólo tiene cuatro tratados internacionales en lugar de los cientos que utiliza Schulz para estudiar las razones que motivan la decisión de un país de adherirse a un acuerdo internacional.</p>
<p>Comencemos cargando la base de datos de nuestro paquete, <code>paqueteadp</code>:</p>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb377-1"><a href="adv-data.html#cb377-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="adv-data.html#cb378-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(paqueteadp)</span></code></pre></div>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb379-1"><a href="adv-data.html#cb379-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;tratados&quot;</span>)</span></code></pre></div>
<p>Ahora, la base de datos ha sido cargado en nuestra sesión de R.</p>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb380-1"><a href="adv-data.html#cb380-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span>()</span>
<span id="cb380-2"><a href="adv-data.html#cb380-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;tratados&quot;</span></span></code></pre></div>
<p>La unidad de análisis de la base de datos es el país del tratado. Cada observación contiene información sobre el proceso de incorporación del tratado a nivel nacional, es decir, de su firma y ratificación. Estas acciones se clasifican en la variable <code>accion_tipo</code>, que va acompañada de la variable <code>accion_anio</code>. Esta última registra el año en que se llevó a cabo cada acción. Echemos un vistazo a la base de datos con <code>glimpse()</code>:</p>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="adv-data.html#cb381-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(tratados)</span>
<span id="cb381-2"><a href="adv-data.html#cb381-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Rows: 248</span></span>
<span id="cb381-3"><a href="adv-data.html#cb381-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Columns: 5</span></span>
<span id="cb381-4"><a href="adv-data.html#cb381-4" aria-hidden="true" tabindex="-1"></a><span class="do">## $ nombre_tratado &lt;chr&gt; &quot;Tratado de Prohibición Completa de los Ensayos ~</span></span>
<span id="cb381-5"><a href="adv-data.html#cb381-5" aria-hidden="true" tabindex="-1"></a><span class="do">## $ anio_adopcion  &lt;dbl&gt; 1996, 1996, 1996, 1996, 1996, 1996, 1996, 1996, ~</span></span>
<span id="cb381-6"><a href="adv-data.html#cb381-6" aria-hidden="true" tabindex="-1"></a><span class="do">## $ pais_nombre    &lt;chr&gt; &quot;Antigua y Barbuda&quot;, &quot;Antigua y Barbuda&quot;, &quot;Argen~</span></span>
<span id="cb381-7"><a href="adv-data.html#cb381-7" aria-hidden="true" tabindex="-1"></a><span class="do">## $ accion_tipo    &lt;chr&gt; &quot;Ratificación&quot;, &quot;Firma&quot;, &quot;Ratificación&quot;, &quot;Firma&quot;~</span></span>
<span id="cb381-8"><a href="adv-data.html#cb381-8" aria-hidden="true" tabindex="-1"></a><span class="do">## $ accion_anio    &lt;dbl&gt; 2006, 1997, 1998, 1996, 2007, 2005, 2008, 2008, ~</span></span></code></pre></div>
<p>Nuestra base de datos sólo contiene información de 31 países americanos y sus respuestas (firma, ratificación) a cuatro tratados pertinentes de los años 90.</p>
<ul>
<li><p>El Tratado de Prohibición Completa de los Ensayos Nucleares (1996).</p></li>
<li><p>El Protocolo de Kyoto de la Convención Marco de las Naciones Unidas sobre el Cambio Climático (1997).</p></li>
<li><p>El Convenio de Rotterdam sobre el procedimiento de consentimiento fundamentado previo aplicable a ciertos plaguicidas y productos químicos peligrosos objeto de comercio internacional (1998)</p></li>
<li><p>El Estatuto de Roma, acto constitutivo de la Corte Penal Internacional (1998).</p></li>
</ul>
<p>Así, para cada tratado tenemos 62 observaciones (31 países, 2 respuestas posibles para cada uno):</p>
<div class="sourceCode" id="cb382"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb382-1"><a href="adv-data.html#cb382-1" aria-hidden="true" tabindex="-1"></a>tratados <span class="sc">%&gt;%</span> </span>
<span id="cb382-2"><a href="adv-data.html#cb382-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(nombre_tratado)</span>
<span id="cb382-3"><a href="adv-data.html#cb382-3" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 4 x 2</span></span>
<span id="cb382-4"><a href="adv-data.html#cb382-4" aria-hidden="true" tabindex="-1"></a><span class="do">##   nombre_tratado                                                        n</span></span>
<span id="cb382-5"><a href="adv-data.html#cb382-5" aria-hidden="true" tabindex="-1"></a><span class="do">##   &lt;chr&gt;                                                             &lt;int&gt;</span></span>
<span id="cb382-6"><a href="adv-data.html#cb382-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 &quot;Convenio de Rotterdam sobre el Procedimiento de Consentimiento ~    62</span></span>
<span id="cb382-7"><a href="adv-data.html#cb382-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 2 &quot;Estatuto de Roma de la Corte Penal Internacional&quot;                   62</span></span>
<span id="cb382-8"><a href="adv-data.html#cb382-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 3 &quot;Protocolo de Kioto de la Convención Marco de las Naciones Unida~    62</span></span>
<span id="cb382-9"><a href="adv-data.html#cb382-9" aria-hidden="true" tabindex="-1"></a><span class="do">## # ... with 1 more row</span></span></code></pre></div>
</div>
<div id="uniendo-bases-de-datos" class="section level2" number="11.2">
<h2><span class="header-section-number">11.2</span> Uniendo bases de datos</h2>
<p>Un ejercicio común en los estudios de observación es unir bases de datos de diferentes fuentes. Supongamos que, por ejemplo, tenemos el siguiente resumen sobre cuántos tratados de la muestra han sido firmados o ratificados por cada país:</p>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="adv-data.html#cb383-1" aria-hidden="true" tabindex="-1"></a>resumen_tratados <span class="ot">&lt;-</span> tratados <span class="sc">%&gt;%</span> </span>
<span id="cb383-2"><a href="adv-data.html#cb383-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(pais_nombre) <span class="sc">%&gt;%</span> </span>
<span id="cb383-3"><a href="adv-data.html#cb383-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb383-4"><a href="adv-data.html#cb383-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Encontraremos los que no faltan con !is.na()</span></span>
<span id="cb383-5"><a href="adv-data.html#cb383-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">sum_signed =</span> <span class="fu">sum</span>(accion_tipo <span class="sc">==</span> <span class="st">&quot;Firma&quot;</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(accion_anio)),</span>
<span id="cb383-6"><a href="adv-data.html#cb383-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">sum_ratif  =</span> <span class="fu">sum</span>(accion_tipo <span class="sc">==</span> <span class="st">&quot;Ratificación&quot;</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(accion_anio))</span>
<span id="cb383-7"><a href="adv-data.html#cb383-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb383-8"><a href="adv-data.html#cb383-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb383-9"><a href="adv-data.html#cb383-9" aria-hidden="true" tabindex="-1"></a>resumen_tratados</span>
<span id="cb383-10"><a href="adv-data.html#cb383-10" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 31 x 3</span></span>
<span id="cb383-11"><a href="adv-data.html#cb383-11" aria-hidden="true" tabindex="-1"></a><span class="do">##   pais_nombre       sum_signed sum_ratif</span></span>
<span id="cb383-12"><a href="adv-data.html#cb383-12" aria-hidden="true" tabindex="-1"></a><span class="do">##   &lt;chr&gt;                  &lt;int&gt;     &lt;int&gt;</span></span>
<span id="cb383-13"><a href="adv-data.html#cb383-13" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 Antigua y Barbuda          3         3</span></span>
<span id="cb383-14"><a href="adv-data.html#cb383-14" aria-hidden="true" tabindex="-1"></a><span class="do">## 2 Argentina                  4         4</span></span>
<span id="cb383-15"><a href="adv-data.html#cb383-15" aria-hidden="true" tabindex="-1"></a><span class="do">## 3 Bahamas                    2         1</span></span>
<span id="cb383-16"><a href="adv-data.html#cb383-16" aria-hidden="true" tabindex="-1"></a><span class="do">## # ... with 28 more rows</span></span></code></pre></div>
<p>Al explorar la base de datos, un caso interesante es el de los Estados Unidos, que firmó los cuatro tratados pero no los ratificó:</p>
<div class="sourceCode" id="cb384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb384-1"><a href="adv-data.html#cb384-1" aria-hidden="true" tabindex="-1"></a>resumen_tratados <span class="sc">%&gt;%</span> </span>
<span id="cb384-2"><a href="adv-data.html#cb384-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(pais_nombre <span class="sc">==</span> <span class="st">&quot;Estados Unidos&quot;</span>)</span>
<span id="cb384-3"><a href="adv-data.html#cb384-3" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 0 x 3</span></span>
<span id="cb384-4"><a href="adv-data.html#cb384-4" aria-hidden="true" tabindex="-1"></a><span class="do">## # ... with 3 variables</span></span></code></pre></div>
<p>Sería interesante explorar la relación entre las respuestas de los países a los tratados y algunas otras variables sobre ellos. A modo de ejemplo, cargaremos datos en panel con información sobre el PIB per cápita con paridad de cambio, según el Banco Mundial.</p>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="adv-data.html#cb385-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;pib_pc_america&quot;</span>)</span></code></pre></div>
<p>Tenemos información de los 31 países de interés entre 1996 y 1998:</p>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="adv-data.html#cb386-1" aria-hidden="true" tabindex="-1"></a>pib_pc_america <span class="sc">%&gt;%</span> </span>
<span id="cb386-2"><a href="adv-data.html#cb386-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(pais_nombre)</span>
<span id="cb386-3"><a href="adv-data.html#cb386-3" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 31 x 2</span></span>
<span id="cb386-4"><a href="adv-data.html#cb386-4" aria-hidden="true" tabindex="-1"></a><span class="do">##   pais_nombre             n</span></span>
<span id="cb386-5"><a href="adv-data.html#cb386-5" aria-hidden="true" tabindex="-1"></a><span class="do">##   &lt;chr&gt;               &lt;int&gt;</span></span>
<span id="cb386-6"><a href="adv-data.html#cb386-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 Antigua and Barbuda     3</span></span>
<span id="cb386-7"><a href="adv-data.html#cb386-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 2 Argentina               3</span></span>
<span id="cb386-8"><a href="adv-data.html#cb386-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 3 Bahamas (the)           3</span></span>
<span id="cb386-9"><a href="adv-data.html#cb386-9" aria-hidden="true" tabindex="-1"></a><span class="do">## # ... with 28 more rows</span></span>
<span id="cb386-10"><a href="adv-data.html#cb386-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb386-11"><a href="adv-data.html#cb386-11" aria-hidden="true" tabindex="-1"></a>pib_pc_america <span class="sc">%&gt;%</span> </span>
<span id="cb386-12"><a href="adv-data.html#cb386-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(anio)</span>
<span id="cb386-13"><a href="adv-data.html#cb386-13" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 3 x 2</span></span>
<span id="cb386-14"><a href="adv-data.html#cb386-14" aria-hidden="true" tabindex="-1"></a><span class="do">##    anio     n</span></span>
<span id="cb386-15"><a href="adv-data.html#cb386-15" aria-hidden="true" tabindex="-1"></a><span class="do">##   &lt;int&gt; &lt;int&gt;</span></span>
<span id="cb386-16"><a href="adv-data.html#cb386-16" aria-hidden="true" tabindex="-1"></a><span class="do">## 1  1996    31</span></span>
<span id="cb386-17"><a href="adv-data.html#cb386-17" aria-hidden="true" tabindex="-1"></a><span class="do">## 2  1997    31</span></span>
<span id="cb386-18"><a href="adv-data.html#cb386-18" aria-hidden="true" tabindex="-1"></a><span class="do">## 3  1998    31</span></span></code></pre></div>
<p>Con esta base de datos, obtenemos el cambio medio del PIB per cápita con paridad de poder adquisitivo para el período 1996-1998:</p>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb387-1"><a href="adv-data.html#cb387-1" aria-hidden="true" tabindex="-1"></a>resumen_pib <span class="ot">&lt;-</span> pib_pc_america <span class="sc">%&gt;%</span> </span>
<span id="cb387-2"><a href="adv-data.html#cb387-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(pais_nombre) <span class="sc">%&gt;%</span> </span>
<span id="cb387-3"><a href="adv-data.html#cb387-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_pib_pc =</span> <span class="fu">mean</span>(pib_pc))</span></code></pre></div>
<p>Ahora tenemos dos bases de datos de resumen, <code>resumen_tratados</code> y <code>resumen_pib</code>, ambos a nivel de país. ¿Cómo podemos unir su información? En este caso particular, ambos tienen 31 filas (observaciones). Una opción que hay que evitar es simplemente pegar una base de datos junto a la otra (por ejemplo, con la función <code>bind_cols()</code>). En algunos casos, esta opción puede ser una buena idea, pero suele ser una elección arriesgada: es difícil saber si ambas bases de datos están ordenadas exactamente de la misma manera necesaria para unirlas correctamente, especialmente cuando el número de observaciones es grande. Por lo tanto, normalmente queremos guiar la unión por una o más variables de identificación presentes en ambas bases de datos. En este caso, la columna <code>pais_nombre</code> puede guiar la unión: queremos añadir información sobre el PIB a nuestra base de datos si y sólo si hay un <em>match</em> exacto entre sus nombres de países.</p>
<p>En el código, podemos añadir nuevas variables a nuestra base de datos de otro con <code>left_join()</code><a href="#fn48" class="footnote-ref" id="fnref48"><sup>48</sup></a>:</p>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="adv-data.html#cb388-1" aria-hidden="true" tabindex="-1"></a>resumen_completo <span class="ot">&lt;-</span> <span class="fu">left_join</span>(<span class="at">x =</span> resumen_tratados, <span class="at">y =</span> resumen_pib,</span>
<span id="cb388-2"><a href="adv-data.html#cb388-2" aria-hidden="true" tabindex="-1"></a>                              <span class="co"># Podemos proporcionar explícitamente la identificación </span></span>
<span id="cb388-3"><a href="adv-data.html#cb388-3" aria-hidden="true" tabindex="-1"></a>                              <span class="co">#nombre variable:                             </span></span>
<span id="cb388-4"><a href="adv-data.html#cb388-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">by =</span> <span class="st">&quot;pais_nombre&quot;</span>)</span></code></pre></div>
<p>Este código dará los mismos resultados usando pipes:</p>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb389-1"><a href="adv-data.html#cb389-1" aria-hidden="true" tabindex="-1"></a>resumen_completo <span class="ot">&lt;-</span> resumen_tratados <span class="sc">%&gt;%</span> </span>
<span id="cb389-2"><a href="adv-data.html#cb389-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(resumen_pib, <span class="at">by =</span> <span class="st">&quot;pais_nombre&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="adv-data.html#cb390-1" aria-hidden="true" tabindex="-1"></a>resumen_completo</span>
<span id="cb390-2"><a href="adv-data.html#cb390-2" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 31 x 4</span></span>
<span id="cb390-3"><a href="adv-data.html#cb390-3" aria-hidden="true" tabindex="-1"></a><span class="do">##   pais_nombre       sum_signed sum_ratif mean_pib_pc</span></span>
<span id="cb390-4"><a href="adv-data.html#cb390-4" aria-hidden="true" tabindex="-1"></a><span class="do">##   &lt;chr&gt;                  &lt;int&gt;     &lt;int&gt;       &lt;dbl&gt;</span></span>
<span id="cb390-5"><a href="adv-data.html#cb390-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 Antigua y Barbuda          3         3         NA </span></span>
<span id="cb390-6"><a href="adv-data.html#cb390-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 2 Argentina                  4         4      15362.</span></span>
<span id="cb390-7"><a href="adv-data.html#cb390-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 3 Bahamas                    2         1         NA </span></span>
<span id="cb390-8"><a href="adv-data.html#cb390-8" aria-hidden="true" tabindex="-1"></a><span class="do">## # ... with 28 more rows</span></span></code></pre></div>
<p>También es posible unir bases de datos utilizando más de una variable de identificación. Por ejemplo, podríamos unir nuestras bases de datos originales, <code>tratados</code> y <code>pib_pc_america</code>, ambos con la unidad de observación del año del país. Sin embargo, hay una particularidad. En ambos casos, la variable país se llama <code>pais_nombre</code>, pero el nombre de la variable año no es el mismo: en el primero, el nombre es <code>anio_adopcion</code> (para la fecha original del tratado), y en el segundo es <code>anio</code>. Podemos proporcionar fácilmente esta información a <code>left_join()</code> con el argumento <code>by =</code>:</p>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="adv-data.html#cb391-1" aria-hidden="true" tabindex="-1"></a>tratados_con_pib <span class="ot">&lt;-</span> tratados <span class="sc">%&gt;%</span> </span>
<span id="cb391-2"><a href="adv-data.html#cb391-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(pib_pc_america, </span>
<span id="cb391-3"><a href="adv-data.html#cb391-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;pais_nombre&quot;</span>, <span class="st">&quot;anio_adopcion&quot;</span> <span class="ot">=</span> <span class="st">&quot;anio&quot;</span>))</span></code></pre></div>
<p>Así pues, a la base de datos original de los “tratados,” que tenía 248 observaciones y 5 columnas, añadimos la columna adicional con información sobre el PIB per cápita con paridad de tipos de cambio para cada año de participación en el tratado:</p>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="adv-data.html#cb392-1" aria-hidden="true" tabindex="-1"></a>tratados_con_pib</span>
<span id="cb392-2"><a href="adv-data.html#cb392-2" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 248 x 6</span></span>
<span id="cb392-3"><a href="adv-data.html#cb392-3" aria-hidden="true" tabindex="-1"></a><span class="do">##   nombre_tratado anio_adopcion pais_nombre accion_tipo accion_anio pib_pc</span></span>
<span id="cb392-4"><a href="adv-data.html#cb392-4" aria-hidden="true" tabindex="-1"></a><span class="do">##   &lt;chr&gt;                  &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;             &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span id="cb392-5"><a href="adv-data.html#cb392-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 Tratado de Pr~          1996 Antigua y ~ Ratificaci~        2006    NA </span></span>
<span id="cb392-6"><a href="adv-data.html#cb392-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 2 Tratado de Pr~          1996 Antigua y ~ Firma              1997    NA </span></span>
<span id="cb392-7"><a href="adv-data.html#cb392-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 3 Tratado de Pr~          1996 Argentina   Ratificaci~        1998 14557.</span></span>
<span id="cb392-8"><a href="adv-data.html#cb392-8" aria-hidden="true" tabindex="-1"></a><span class="do">## # ... with 245 more rows</span></span></code></pre></div>
<blockquote>
<p><strong>Ejercicio 11A.</strong> Descargue el <a href="https://ncgg.princeton.edu/wep/dataverse.html">World Economics and Politics (WEP) Dataverse</a> y elija diez variables de país-año, incluyendo tanto las características institucionales como económicas de los estados como nuevas variables que se añadirán a <code>tratados_con_pib</code> y unirlas. ¿Fue fácil encontrar los identificadores únicos (códigos, nombres)?</p>
</blockquote>
</div>
<div id="estandarizando-los-códigos-de-país" class="section level2" number="11.3">
<h2><span class="header-section-number">11.3</span> Estandarizando los códigos de país</h2>
<p>Puedes notar que los nombres de los países en las bases de datos con los que estamos trabajando son muy particulares. Por ejemplo, Bolivia es “Bolivia (Estado Plurinacional de)” y la República Dominicana es “República Dominicana (la).” Estos son sus nombres oficiales para la comunidad internacional. Probablemente queramos unirlos con datos de otras fuentes que no tienen los mismos nombres: podemos tener “Bolivia,” “Estado Plurinacional de Bolivia,” “Plurinational State of Bolivia,” etcétera. Para estos casos, que son muy comunes para los que estudian política comparada y relaciones internacionales, la mejor opción es tener <em>códigos estandarizados</em>, algo que también podemos encontrar para las divisiones subnacionales y otros tipos de unidades de análisis.</p>
<p>La mayor parte de la codificación reduce sustancialmente los nombres de los países a un puñado de caracteres y/o números. En general, éstos provienen de organizaciones internacionales o de grandes proyectos académicos que los apoyan. El paquete de <code>countrycode</code> nos permite transformar diferentes codificaciones y estándares con facilidad, lo que nos ayuda en las operaciones posteriores con las bases de datos.</p>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="adv-data.html#cb393-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(countrycode)</span></code></pre></div>
<p>Después de cargar el paquete, podemos comprobar en el archivo de ayuda <code>?codelist</code> las diferentes codificaciones permitidas. Después de esto, usando nuestra variable inicial y la función <code>countrycode()</code>, crearemos una variable con códigos estandarizados. <code>iso2c</code> y <code>iso3c</code> son algunas de las codificaciones más comunes, que reducen los países a 2 o 3 caracteres, según la ISO (Organización Internacional de Normalización). Mientras tanto, <code>cown</code> y <code>imf</code> utilizan codificaciones numéricas relativamente comunes en las ciencias sociales, que provienen del proyecto Correlates of War y del Fondo Monetario Internacional, respectivamente[^<code>countrycode</code> permite muchas otras codificaciones utilizadas en nuestra disciplina, algunas más completas que otras. Dos de ellas, que prevalecen en las ciencias políticas, son las de Polity IV y el proyecto Varieties of Democracy (V-Dem). Le recomendamos que revise el archivo de ayuda <code>?codelist</code> para más información.]</p>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="adv-data.html#cb394-1" aria-hidden="true" tabindex="-1"></a>resumen_completo_con_codigos <span class="ot">&lt;-</span> resumen_completo <span class="sc">%&gt;%</span> </span>
<span id="cb394-2"><a href="adv-data.html#cb394-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb394-3"><a href="adv-data.html#cb394-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">pais_iso2c =</span> <span class="fu">countrycode</span>(pais_nombre, </span>
<span id="cb394-4"><a href="adv-data.html#cb394-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">origin =</span> <span class="st">&quot;un.name.es&quot;</span>, <span class="at">destination =</span> <span class="st">&quot;iso2c&quot;</span>, </span>
<span id="cb394-5"><a href="adv-data.html#cb394-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">custom_dict =</span> codelist),</span>
<span id="cb394-6"><a href="adv-data.html#cb394-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">pais_iso3c =</span> <span class="fu">countrycode</span>(pais_nombre, </span>
<span id="cb394-7"><a href="adv-data.html#cb394-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">origin =</span> <span class="st">&quot;un.name.es&quot;</span>, <span class="at">destination =</span> <span class="st">&quot;iso3c&quot;</span>, </span>
<span id="cb394-8"><a href="adv-data.html#cb394-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">custom_dict =</span> codelist),</span>
<span id="cb394-9"><a href="adv-data.html#cb394-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">pais_iso3c =</span> <span class="fu">countrycode</span>(pais_nombre, </span>
<span id="cb394-10"><a href="adv-data.html#cb394-10" aria-hidden="true" tabindex="-1"></a>                             <span class="at">origin =</span> <span class="st">&quot;un.name.es&quot;</span>, <span class="at">destination =</span> <span class="st">&quot;cown&quot;</span>, </span>
<span id="cb394-11"><a href="adv-data.html#cb394-11" aria-hidden="true" tabindex="-1"></a>                             <span class="at">custom_dict =</span> codelist),</span>
<span id="cb394-12"><a href="adv-data.html#cb394-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">pais_iso3c =</span> <span class="fu">countrycode</span>(pais_nombre, </span>
<span id="cb394-13"><a href="adv-data.html#cb394-13" aria-hidden="true" tabindex="-1"></a>                             <span class="at">origin =</span> <span class="st">&quot;un.name.es&quot;</span>, <span class="at">destination =</span> <span class="st">&quot;imf&quot;</span>, </span>
<span id="cb394-14"><a href="adv-data.html#cb394-14" aria-hidden="true" tabindex="-1"></a>                             <span class="at">custom_dict =</span> codelist),</span>
<span id="cb394-15"><a href="adv-data.html#cb394-15" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="adv-data.html#cb395-1" aria-hidden="true" tabindex="-1"></a>resumen_completo_con_codigos <span class="sc">%&gt;%</span> </span>
<span id="cb395-2"><a href="adv-data.html#cb395-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">&quot;pais_&quot;</span>))</span>
<span id="cb395-3"><a href="adv-data.html#cb395-3" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 31 x 3</span></span>
<span id="cb395-4"><a href="adv-data.html#cb395-4" aria-hidden="true" tabindex="-1"></a><span class="do">##   pais_nombre       pais_iso2c pais_iso3c</span></span>
<span id="cb395-5"><a href="adv-data.html#cb395-5" aria-hidden="true" tabindex="-1"></a><span class="do">##   &lt;chr&gt;             &lt;chr&gt;           &lt;dbl&gt;</span></span>
<span id="cb395-6"><a href="adv-data.html#cb395-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 Antigua y Barbuda AG                311</span></span>
<span id="cb395-7"><a href="adv-data.html#cb395-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 2 Argentina         AR                213</span></span>
<span id="cb395-8"><a href="adv-data.html#cb395-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 3 Bahamas           BS                313</span></span>
<span id="cb395-9"><a href="adv-data.html#cb395-9" aria-hidden="true" tabindex="-1"></a><span class="do">## # ... with 28 more rows</span></span></code></pre></div>
<p>Tener una base de datos con al menos un código de normalización es particularmente útil, ya que a menudo reduce la fricción de unir nuestros datos con otros. El <code>countrycode</code>, entonces, es una buena herramienta para pre-procesar las bases de datos con la información del país antes de unirlos.</p>
</div>
<div id="la-unión-borrosa-o-inexacta-de-los-datos" class="section level2" number="11.4">
<h2><span class="header-section-number">11.4</span> La unión borrosa o inexacta de los datos</h2>
<p>Aunque el <code>country code</code> ayuda enormemente en algunos casos, no siempre es lo suficientemente flexible. A veces, en lugar de necesitar traducir entre codificaciones, no tenemos un estándar para guiar la unión, es todo un desastre. Piensa en los nombres de las personas: en una base datos de ex-presidentes de Brasil, la misma persona puede ser codificada como <code>Lula</code>, <code>Luiz Inácio Lula da Silva</code>, <code>Lula da Silva</code>. ¿Y si la persona se cambió el nombre o se le conoce por un apodo? El legislador chileno José Manuel Ismael Edwards Silva es conocido como Rojo Edwards. Estos problemas del mundo real pueden causar grandes dolores de cabeza a los que trabajan con datos políticos. La unión difusa es la solución para estas situaciones.</p>
<p>Carguemos una base de datos igual a nuestro anterior <code>resumen_pib</code>, pero con nombres desordenados en los países:</p>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="adv-data.html#cb396-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;resumen_desordenado&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="adv-data.html#cb397-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(resumen_desordenado<span class="sc">$</span>pais_nombre)</span>
<span id="cb397-2"><a href="adv-data.html#cb397-2" aria-hidden="true" tabindex="-1"></a><span class="do">##  [1] &quot;Antigua &amp; Barbuda&quot; &quot;Argentina&quot;         &quot;Bahamas&quot;          </span></span>
<span id="cb397-3"><a href="adv-data.html#cb397-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  [4] &quot;Barbados&quot;          &quot;Belice&quot;            &quot;Bolivia&quot;          </span></span>
<span id="cb397-4"><a href="adv-data.html#cb397-4" aria-hidden="true" tabindex="-1"></a><span class="do">##  [7] &quot;Brasil&quot;            &quot;Canadá&quot;            &quot;Chile&quot;            </span></span>
<span id="cb397-5"><a href="adv-data.html#cb397-5" aria-hidden="true" tabindex="-1"></a><span class="do">## [10] &quot;Colombia&quot;          &quot;Costa Rica&quot;        &quot;Dominica&quot;         </span></span>
<span id="cb397-6"><a href="adv-data.html#cb397-6" aria-hidden="true" tabindex="-1"></a><span class="do">## [13] &quot;Rep. Dominicana&quot;   &quot;Ecuador&quot;           &quot;El Salvador&quot;      </span></span>
<span id="cb397-7"><a href="adv-data.html#cb397-7" aria-hidden="true" tabindex="-1"></a><span class="do">## [16] &quot;Granada&quot;           &quot;Guatemala&quot;         &quot;Guyana&quot;           </span></span>
<span id="cb397-8"><a href="adv-data.html#cb397-8" aria-hidden="true" tabindex="-1"></a><span class="do">## [19] &quot;Haití&quot;             &quot;Honduras&quot;         </span></span>
<span id="cb397-9"><a href="adv-data.html#cb397-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  [ reached getOption(&quot;max.print&quot;) -- omitted 11 entries ]</span></span></code></pre></div>
<p>Los nombres de esta base de datos no corresponden a ninguna normalización, sino que son el resultado de una codificación manual. Un ejemplo claro es la abreviatura de “Rep. Dominicana.” ¿Qué pasaría si unimos nuestra base de datos <code>resumen_tratados</code> con una base de datos confuso como este?</p>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="adv-data.html#cb398-1" aria-hidden="true" tabindex="-1"></a>resumen_tratados <span class="sc">%&gt;%</span> </span>
<span id="cb398-2"><a href="adv-data.html#cb398-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(resumen_desordenado, <span class="at">by =</span> <span class="st">&quot;pais_nombre&quot;</span>)</span>
<span id="cb398-3"><a href="adv-data.html#cb398-3" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 31 x 4</span></span>
<span id="cb398-4"><a href="adv-data.html#cb398-4" aria-hidden="true" tabindex="-1"></a><span class="do">##   pais_nombre       sum_signed sum_ratif pib_pc_prom</span></span>
<span id="cb398-5"><a href="adv-data.html#cb398-5" aria-hidden="true" tabindex="-1"></a><span class="do">##   &lt;chr&gt;                  &lt;int&gt;     &lt;int&gt;       &lt;dbl&gt;</span></span>
<span id="cb398-6"><a href="adv-data.html#cb398-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 Antigua y Barbuda          3         3         NA </span></span>
<span id="cb398-7"><a href="adv-data.html#cb398-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 2 Argentina                  4         4      15362.</span></span>
<span id="cb398-8"><a href="adv-data.html#cb398-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 3 Bahamas                    2         1      29530.</span></span>
<span id="cb398-9"><a href="adv-data.html#cb398-9" aria-hidden="true" tabindex="-1"></a><span class="do">## # ... with 28 more rows</span></span></code></pre></div>
<p>Como pueden observar, la unión falla para las observaciones múltiples porque no se encuentra una coincidencia exacta para la variable de identificación. Ese es el caso de “Antigua y Barbuda” en la base de datos original, y “Antigua &amp; Barbuda” en el adicional. R considera que son unidades diferentes. Intuitivamente, estos valores son similares, pero R no puede adivinar o asumir sin nuestras instrucciones precisas.</p>
<p>Afortunadamente, tenemos una solución para este tipo de casos, así como con situaciones similares para nombres de políticos, partidos políticos, empresas o regiones. La intuición inicial es la siguiente: Las cadenas de texto <code>Antigua y Barbuda</code> y <code>Antigua &amp; Barbuda</code> son similares. Comparten letras, tienen longitudes similares, etcétera. Ambas tienen más en común que, por ejemplo, el par “Antigua y Barbuda” y “Argentina.” Los científicos de la computación, reconociendo este hecho, han desarrollado múltiples algoritmos para asignar un puntaje de diferencia entre dos cadenas de texto, cualquiera que sea. La mayoría de estos algoritmos asignan un valor de 0 cuando las cadenas son iguales, y luego aumenta de acuerdo a su disimilitud.</p>
<p>Basándonos en lo anterior, podríamos calcular las distancias entre todos los posibles pares de cadenas en nuestras dos variables de identificación. Luego, podríamos recuperar los valores más bajos para hacer los pares, y finalmente, podríamos realizar un <em><code>fuzzy join</code></em>. Como ejemplo, usaremos el paquete <code>stringdist</code> para generar una matriz con todas estas distancias para nuestros dos bases de datos:</p>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="adv-data.html#cb399-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringdist)</span>
<span id="cb399-2"><a href="adv-data.html#cb399-2" aria-hidden="true" tabindex="-1"></a><span class="fu">stringdistmatrix</span>(resumen_tratados<span class="sc">$</span>pais_nombre,</span>
<span id="cb399-3"><a href="adv-data.html#cb399-3" aria-hidden="true" tabindex="-1"></a>                 resumen_desordenado<span class="sc">$</span>pais_nombre, </span>
<span id="cb399-4"><a href="adv-data.html#cb399-4" aria-hidden="true" tabindex="-1"></a>                 <span class="co"># Usaremos el algoritmo por defecto, llamado &quot;osa&quot; o</span></span>
<span id="cb399-5"><a href="adv-data.html#cb399-5" aria-hidden="true" tabindex="-1"></a>                 <span class="co"># &quot;Alineación óptima de las cuerdas&quot;</span></span>
<span id="cb399-6"><a href="adv-data.html#cb399-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">&quot;osa&quot;</span>, </span>
<span id="cb399-7"><a href="adv-data.html#cb399-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">useNames =</span> T)</span></code></pre></div>
<pre><code>##                   Antigua &amp; Barbuda Argentina Bahamas Barbados
## Antigua y Barbuda                 1        14      15       13
## Argentina                        14         0       9        9
## Bahamas                          15         9       0        4
## Barbados                         13         9       4        0</code></pre>
<p>Mirando la primera fila, podemos ver que la cadena “Antigua y Barbuda” obtiene una puntuación de 1 en comparación con “Antigua &amp; Barbuda,” mientras que recibe una puntuación de 14 en comparación con “Argentina.”</p>
<p>Aunque los algoritmos disponibles en <code>stringdist</code> son robustos, no son infalibles, y la supervisión humana es a menudo necesaria.</p>
<p>Para realizar un <em>fuzzy join</em> utilizaremos un paquete de trabajo en curso desarrollado por Andrés Cruz, <code>inexact</code>, que combina los algoritmos de <code>stringdist</code> con la supervisión humana. Permite hacer una unión borrosa supervisada por un humano.</p>
<p>Después de instalar <code>inexact</code>, podemos usarlo en la pestaña <code>Addins</code> de RStudio, o ejecutando el siguiente comando:</p>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="adv-data.html#cb401-1" aria-hidden="true" tabindex="-1"></a>inexact<span class="sc">::</span><span class="fu">inexact_addin</span>()</span></code></pre></div>
<p>Aparecerá una ventana como la de la figura <a href="adv-data.html#fig:adv-data-inexact-1">11.1</a>, en la que tendremos que proporcionar las características de la unión que estamos tratando de realizar.</p>

<div class="figure" style="text-align: center"><span id="fig:adv-data-inexact-1"></span>
<img src="00-images/adv-data/inexact_1.png" alt="Primer panel de inexact, donde hay que seleccionar las opciones de unión." width="80%" />
<p class="caption">
Figura 11.1: Primer panel de <code>inexact</code>, donde hay que seleccionar las opciones de unión.
</p>
</div>
<p>Después de hacer clic en <code>Next</code>, aparecerá una ventana de supervisión de <code>inexact</code>, como podemos observar en la Figura <a href="adv-data.html#fig:adv-data-inexact-2">11.2</a>. En esta ventana sólo aparecerán los pares que tengan una distancia superior a 0 (es decir, los imperfectos). Por defecto, estos estarán ordenados desde el más conflictivo al menos conflictivo, en términos de las distancias calculadas. Puede comprobar cada par y modificarlos manualmente según sus conocimientos. En este caso, uno de los seis pares por defecto del algoritmo está equivocado: se emparejó “Bolivia (Estado Plurinacional de)” con “Estados Unidos.” Podemos corregir esto fácilmente seleccionando “Bolivia” en la lista de opciones.</p>

<div class="figure" style="text-align: center"><span id="fig:adv-data-inexact-2"></span>
<img src="00-images/adv-data/inexact_2.png" alt="Segundo panel de inexact, donde supervisamos los pares por defecto." width="80%" />
<p class="caption">
Figura 11.2: Segundo panel de <code>inexact</code>, donde supervisamos los pares por defecto.
</p>
</div>
<p>Por último, después de hacer clic en <code>Next</code>, llegaremos a una ventana final, donde se presenta un código que nos permite hacer la unión <em>fuzzy</em>, tal como muestra la Figura <a href="adv-data.html#fig:adv-data-inexact-3">11.3</a>.</p>
(ref:cap-inexact-3) Tercer panel de <code>inexact</code>, con el código final.
<div class="figure" style="text-align: center"><span id="fig:adv-data-inexact-3"></span>
<img src="00-images/adv-data/inexact_3.png" alt="(ref:cap-inexact-3)" width="80%" />
<p class="caption">
Figura 11.3: (ref:cap-inexact-3)
</p>
</div>
<p>El código y sus resultados se presentan a continuación. Fíjate en cómo el argumento <code>custom_match =</code> es el que permite a <code>inexact::inexact_join()</code> modificar los pares por defecto del algoritmo. Ahora podemos unir ambas bases de datos perfectamente, ¡aunque no tengan variables completamente estandarizadas en común!</p>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb402-1"><a href="adv-data.html#cb402-1" aria-hidden="true" tabindex="-1"></a><span class="co"># You added custom matches:</span></span>
<span id="cb402-2"><a href="adv-data.html#cb402-2" aria-hidden="true" tabindex="-1"></a>inexact<span class="sc">::</span><span class="fu">inexact_join</span>(</span>
<span id="cb402-3"><a href="adv-data.html#cb402-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x  =</span> resumen_tratados,</span>
<span id="cb402-4"><a href="adv-data.html#cb402-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y  =</span> resumen_desordenado,</span>
<span id="cb402-5"><a href="adv-data.html#cb402-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> <span class="st">&#39;pais_nombre&#39;</span>,</span>
<span id="cb402-6"><a href="adv-data.html#cb402-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">&#39;osa&#39;</span>,</span>
<span id="cb402-7"><a href="adv-data.html#cb402-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">&#39;left&#39;</span>,</span>
<span id="cb402-8"><a href="adv-data.html#cb402-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">custom_match =</span> <span class="fu">c</span>(</span>
<span id="cb402-9"><a href="adv-data.html#cb402-9" aria-hidden="true" tabindex="-1"></a>   <span class="st">&#39;Bolivia (Estado Plurinacional de)&#39;</span> <span class="ot">=</span> <span class="st">&#39;Bolivia&#39;</span></span>
<span id="cb402-10"><a href="adv-data.html#cb402-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb402-11"><a href="adv-data.html#cb402-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb402-12"><a href="adv-data.html#cb402-12" aria-hidden="true" tabindex="-1"></a><span class="do">##                              pais_nombre sum_signed sum_ratif</span></span>
<span id="cb402-13"><a href="adv-data.html#cb402-13" aria-hidden="true" tabindex="-1"></a><span class="do">##  1:                    Antigua y Barbuda          3         3</span></span>
<span id="cb402-14"><a href="adv-data.html#cb402-14" aria-hidden="true" tabindex="-1"></a><span class="do">##  2:                            Argentina          4         4</span></span>
<span id="cb402-15"><a href="adv-data.html#cb402-15" aria-hidden="true" tabindex="-1"></a><span class="do">##  3:                              Bahamas          2         1</span></span>
<span id="cb402-16"><a href="adv-data.html#cb402-16" aria-hidden="true" tabindex="-1"></a><span class="do">##  4:                             Barbados          3         2</span></span>
<span id="cb402-17"><a href="adv-data.html#cb402-17" aria-hidden="true" tabindex="-1"></a><span class="do">##  5:                               Belice          2         2</span></span>
<span id="cb402-18"><a href="adv-data.html#cb402-18" aria-hidden="true" tabindex="-1"></a><span class="do">##     pib_pc_prom</span></span>
<span id="cb402-19"><a href="adv-data.html#cb402-19" aria-hidden="true" tabindex="-1"></a><span class="do">##  1:       18965</span></span>
<span id="cb402-20"><a href="adv-data.html#cb402-20" aria-hidden="true" tabindex="-1"></a><span class="do">##  2:       15362</span></span>
<span id="cb402-21"><a href="adv-data.html#cb402-21" aria-hidden="true" tabindex="-1"></a><span class="do">##  3:       29530</span></span>
<span id="cb402-22"><a href="adv-data.html#cb402-22" aria-hidden="true" tabindex="-1"></a><span class="do">##  4:       14863</span></span>
<span id="cb402-23"><a href="adv-data.html#cb402-23" aria-hidden="true" tabindex="-1"></a><span class="do">##  5:        5980</span></span>
<span id="cb402-24"><a href="adv-data.html#cb402-24" aria-hidden="true" tabindex="-1"></a><span class="do">##  [ reached getOption(&quot;max.print&quot;) -- omitted 27 rows ]</span></span></code></pre></div>
<blockquote>
<p><strong>Ejercicio 11B.</strong> La siguiente <a href="https://datos.hcdn.gob.ar/dataset/a80e0fa7-d73a-4ed1-9dec-80465e368951/resource/169de2eb-465f-4007-a4c2-39a5ba4c0df3/download/diputados1.8.csv">base de datos tiene los nombres e información de los diputados argentinos en 2019</a>. Descárguelo y combínelo con el <a href="https://datos.hcdn.gob.ar/dataset/b238e6ab-691a-4e64-91d9-1445c4506ef4/resource/237f85b1-0b99-42e4-9b64-31a3935870a2/download/bloques_integracion2.5.csv">siguiente base de datos</a> que contiene la información de las comisiones de las que cada diputado forma parte. Utilice códigos y nombres únicos para unir ambas variables y comparar los resultados.</p>
</blockquote>
</div>
<div id="gestión-de-valores-perdidos" class="section level2" number="11.5">
<h2><span class="header-section-number">11.5</span> Gestión de valores perdidos</h2>
<p>Ya nos hemos encontrado con valores perdidos (NAs) en algunas ocasiones, incluyendo la sección introductoria. En el contexto de R, se trata de valores especiales que pueden asumir vectores que designan que hay información faltante. Sin embargo, los valores perdidos no son sólo una rareza de la programación. Tomarlos de forma suelta puede implicar serios sesgos en nuestra investigación. Por lo tanto, abordaremos el tema con mayor detalle. Discutiremos las imputaciones, una posible técnica para modificar los sesgos producidos por los valores perdidos.</p>
<div id="tipos-de-valores-perdidos" class="section level3" number="11.5.1">
<h3><span class="header-section-number">11.5.1</span> Tipos de valores perdidos</h3>
<p>Aunque R simplemente registra <code>NA</code> en la célula perdida, es importante entender teóricamente el tipo de valor perdido con el que estamos tratando. En resumen, la literatura de imputación identifica cuatro tipos diferentes. Los valores faltantes pueden ser <strong>estructurales</strong>, <em>faltantes completamente al azar</em> (<strong>MCAR</strong>, en inglés), <em>faltantes al azar</em> (<strong>MAR</strong>, en inglés) y <em>faltantes no al azar</em> (<strong>MNAR</strong>, en inglés).</p>
<p>Primero, examinaremos el caso de los datos <em>estructurales</em> faltantes. Veamos el siguiente ejemplo de la base de datos de nuestros tratados:</p>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="adv-data.html#cb403-1" aria-hidden="true" tabindex="-1"></a>tratados <span class="sc">%&gt;%</span> </span>
<span id="cb403-2"><a href="adv-data.html#cb403-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(pais_nombre <span class="sc">==</span> <span class="st">&quot;Estados Unidos de América&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb403-3"><a href="adv-data.html#cb403-3" aria-hidden="true" tabindex="-1"></a>           nombre_tratado <span class="sc">==</span> <span class="st">&quot;Tratado de Prohibición Completa de los Ensayos Nucleares&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb403-4"><a href="adv-data.html#cb403-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(pais_nombre, accion_tipo, accion_anio)</span>
<span id="cb403-5"><a href="adv-data.html#cb403-5" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 2 x 3</span></span>
<span id="cb403-6"><a href="adv-data.html#cb403-6" aria-hidden="true" tabindex="-1"></a><span class="do">##   pais_nombre               accion_tipo  accion_anio</span></span>
<span id="cb403-7"><a href="adv-data.html#cb403-7" aria-hidden="true" tabindex="-1"></a><span class="do">##   &lt;chr&gt;                     &lt;chr&gt;              &lt;dbl&gt;</span></span>
<span id="cb403-8"><a href="adv-data.html#cb403-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 Estados Unidos de América Ratificación          NA</span></span>
<span id="cb403-9"><a href="adv-data.html#cb403-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 2 Estados Unidos de América Firma               1996</span></span></code></pre></div>
<p>La variable <code>accion_anio</code> codifica el año en que, en este caso los Estados Unidos, tomó medidas sobre el Tratado de Prohibición Completa de los Ensayos Nucleares (1996). Estados Unidos firmó el tratado en 1996, pero nunca lo ratificó, como observamos anteriormente. En otras palabras, el año de la ratificación simplemente no existe para los Estados Unidos, como podría ser el caso de otros países. Por lo tanto, los datos que faltan son estructurales cuando faltan datos porque no existen.</p>
<p>En segundo lugar, tenemos datos que faltan completamente al azar (<strong>MCAR</strong>) si hubo algún proceso de aleatorización en el trabajo cuando se generaron los datos. Por ejemplo, si hemos hecho ocho preguntas a cada persona al azar en una encuesta de diez preguntas. Las dos preguntas que faltan para cada persona no se explican por variables relacionadas con el encuestado (su ideología, edad, género, religión, etc.), porque por diseño elegimos no hacerlas al azar. Otros casos de datos que faltan completamente al azar pueden ocurrir sin la interferencia del diseño, pero debido a eventos no planeados que afectan nuestro proceso de recolección de datos.</p>
<p>Por otro lado, nuestros datos podrían faltar al azar (<strong>MAR</strong>), además del resto de las variables que nos permitirán modelar la distribución de las celdas perdidas. Por ejemplo, pensemos en el Índice Compuesto de Capacidad Nacional (CINC, en inglés) del proyecto Correlatos de Guerra (COW, en inglés). Este índice es un <em>proxy</em> del poder nacional tal y como lo entiende la escuela de realismo. Combina seis indicadores de poder duro: consumo de energía primaria, población total, población urbana, producción de acero y hierro, gasto militar y número de tropas militares. El índice varía de 0 a 1, ya que representa la participación de cada país en el poder mundial total en un año determinado. Supongamos que tenemos veinte valores faltantes para algunos países-años. Probablemente tenemos otras variables para describir estos países-años que teóricamente se correlacionan con el índice. Podríamos hacer un modelo para tratar de “adivinar” nuestros valores perdidos a través de la información que observamos. Esto es lo que llamamos una “imputación.”</p>
<p>Finalmente, nuestros datos podrían faltar no al azar (<strong>MNAR</strong>). Este es posiblemente el escenario más frecuente en el que los datos se imputan incorrectamente en la ciencia política, cuando en realidad no deberían. Los valores faltantes no aleatorios son aquellos cuya condición faltante está correlacionada con otra variable de tal manera que hay un <em>patrón</em> en los datos faltantes. Cuando nos enfrentamos a un escenario en el que hay datos perdidos, debemos considerar cuidadosamente qué variables pueden estar explicando estos datos perdidos, y si existe un sesgo de selección. Por ejemplo, si utilizamos datos del Banco Mundial sobre el crecimiento del PIB, es posible que los países pobres no presenten ningún dato. Esto se debe a que la calidad de las mediciones en estos países no es óptima. También es posible que no se hayan hecho mediciones si el país está pasando por un momento difícil en su economía, lo que podría tener efectos negativos en sus estadísticas nacionales. Por ejemplo, desde 2016 el Banco Mundial no reporta las tasas de inflación de Venezuela. Idealmente, es necesario corregir este sesgo a través de una co-variable en el modelo utilizando modelos de selección (desafortunadamente, no los abordamos en el libro).</p>
<p>Después de explicar el caso de ejemplo y presentar las estadísticas descriptivas de los valores faltantes, haremos dos escenarios para las imputaciones. El primero es una imputación con fines descriptivos (creación de gráficos). El segundo, quizás más útil, será para corregir posibles sesgos en el modelo de regresión.</p>
</div>
<div id="descripción-de-los-valores-que-faltan-en-la-base-de-datos" class="section level3" number="11.5.2">
<h3><span class="header-section-number">11.5.2</span> Descripción de los valores que faltan en la base de datos</h3>
<p>Comencemos cargando algunos datos sobre la capacidad del estado recogidos del proyecto Correlatos de Guerra, que hemos mencionado anteriormente. Nuestra muestra tiene sólo dos países, Estados Unidos y China, con datos anuales desde 1860 hasta 2012. Por lo tanto, la unidad de observación de la base de datos es el país-año.</p>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="adv-data.html#cb404-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(paqueteadp)</span>
<span id="cb404-2"><a href="adv-data.html#cb404-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;indice_cinc&quot;</span>)</span></code></pre></div>
<p>Tenemos dos variables con códigos estandarizados de países, <code>pais_iso3c</code> (categórico) y <code>pais_cown</code> (numérico), además de <code>anio</code>, que denota el año. A continuación, <code>gasto_militar</code> es el gasto militar del país, <code>cuerpo_militar</code> es el tamaño del ejército en hombres activos, <code>hierro_acero</code> denota la producción de acero y hierro, <code>cons_energia</code> corresponde al consumo de energía, <code>poblacion</code> es la población total, y <code>poblacion_urb</code> es la población urbana. Por último, <code>indice_capacidades</code> es el índice compuesto por las capacidades materiales que nos interesan. Esto refleja la parte de poder global que cada país posee. Si observamos el valor de los dos países más poderosos del mundo, notaremos que China superó a los Estados Unidos hace un par de años:</p>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb405-1"><a href="adv-data.html#cb405-1" aria-hidden="true" tabindex="-1"></a>indice_cinc <span class="sc">%&gt;%</span> </span>
<span id="cb405-2"><a href="adv-data.html#cb405-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(anio <span class="sc">==</span> <span class="dv">2012</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb405-3"><a href="adv-data.html#cb405-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(pais_iso3c, indice_capacidades)</span>
<span id="cb405-4"><a href="adv-data.html#cb405-4" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 2 x 2</span></span>
<span id="cb405-5"><a href="adv-data.html#cb405-5" aria-hidden="true" tabindex="-1"></a><span class="do">##   pais_iso3c indice_capacidades</span></span>
<span id="cb405-6"><a href="adv-data.html#cb405-6" aria-hidden="true" tabindex="-1"></a><span class="do">##   &lt;chr&gt;                   &lt;dbl&gt;</span></span>
<span id="cb405-7"><a href="adv-data.html#cb405-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 USA                      13.9</span></span>
<span id="cb405-8"><a href="adv-data.html#cb405-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 2 CHN                      21.8</span></span></code></pre></div>
<p>En la literatura de Relaciones Internacionales existe un debate sobre el alcance de este índice en relación con la participación real en el poder mundial total de los países, que se puede observar en <span class="citation"><a href="referencias.html#ref-chanTherePowerTransition2005" role="doc-biblioref">Chan</a> (<a href="referencias.html#ref-chanTherePowerTransition2005" role="doc-biblioref">2005</a>)</span> y <span class="citation"><a href="referencias.html#ref-xuetongRiseChinaIts2006" role="doc-biblioref">Xuetong</a> (<a href="referencias.html#ref-xuetongRiseChinaIts2006" role="doc-biblioref">2006</a>)</span>.</p>
<p>Empecemos describiendo los valores que faltan de la base de datos. Usando el resumen rápido de <code>skimr::skim()</code>, observamos en la Figura <a href="adv-data.html#fig:skim-adv-data">11.4</a> que <code>gasto_militar</code> y <code>poblacion_urb</code> son las dos variables en las que están presentes, teniendo 49 y 68 valores perdidos, respectivamente.</p>
<div class="figure" style="text-align: center"><span id="fig:skim-adv-data"></span>
<img src="00-images/adv-data/skim_adv-data.png" alt="Skim de nuestra base de datos" width="100%" />
<p class="caption">
Figura 11.4: Skim de nuestra base de datos
</p>
</div>
<p>El paquete <code>naniar</code> contiene herramientas visuales para ayudarnos a entender mejor los posibles patrones de nuestros valores perdidos. Una forma de explorar visualmente estos últimos viene con la función <code>gg_miss_var()</code>:</p>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="adv-data.html#cb406-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(naniar)</span></code></pre></div>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="adv-data.html#cb407-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_miss_var</span>(indice_cinc)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-31"></span>
<img src="11-adv-data_es_files/figure-html/unnamed-chunk-31-1.png" alt=" Los valores perdidos por variable en nuestra base de datos" width="672" />
<p class="caption">
Figura 5.9:  Los valores perdidos por variable en nuestra base de datos
</p>
</div>
<p>De manera similar, sólo podemos presentar los porcentajes con el argumento <code>show_pct = T</code>:</p>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="adv-data.html#cb408-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_miss_var</span>(indice_cinc, <span class="at">show_pct =</span> T)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-32"></span>
<img src="11-adv-data_es_files/figure-html/unnamed-chunk-32-1.png" alt=" Valores perdidos por variable en nuestra base de datos, expresados como porcentaje de las observaciones" width="672" />
<p class="caption">
Figura 3.28:  Valores perdidos por variable en nuestra base de datos, expresados como porcentaje de las observaciones
</p>
</div>
<p>¿Dónde están nuestros valores perdidos? Una inspección visual de la base de datos, por ejemplo, con <code>View()</code>, nos permite tener una idea en bases de datos de tamaño pequeño y mediano. En cualquier caso, la función <code>gg_mis_fct()</code> de <code>naniar</code> es a menudo útil, que nos permite separar las NA según una variable categórica de nuestra base de datos. Hagámoslo por país:</p>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="adv-data.html#cb409-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_miss_fct</span>(<span class="at">x =</span> indice_cinc, <span class="at">fct =</span> pais_iso3c)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-33"></span>
<img src="11-adv-data_es_files/figure-html/unnamed-chunk-33-1.png" alt=" Gráfica alternativa. Valores perdidos por variable en nuestra base de datos, expresados como un porcentaje de las observaciones" width="576" />
<p class="caption">
Figura 3.30:  Gráfica alternativa. Valores perdidos por variable en nuestra base de datos, expresados como un porcentaje de las observaciones
</p>
</div>
<p>Rápidamente observamos que todos los valores que nos faltan corresponden a China. En contraste, sólo hay observaciones completas para los Estados Unidos.</p>
<p>También puede ser interesante explorar la relación entre los valores perdidos de una variable y una columna numérica de la base de datos, en lugar de una categórica. Para esta operación ligeramente más compleja, <code>naniar</code> proporciona la función <code>bind_shadow()</code>, que genera variables <code>shadow</code> a partir de las de nuestra base de datos. Estas variables contienen sólo la información binaria de los valores que faltan o no faltan para cada observación.</p>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="adv-data.html#cb410-1" aria-hidden="true" tabindex="-1"></a>indice_cinc_perdidos <span class="ot">&lt;-</span> indice_cinc <span class="sc">%&gt;%</span></span>
<span id="cb410-2"><a href="adv-data.html#cb410-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_shadow</span>(<span class="at">only_miss =</span> T) </span></code></pre></div>
<p>Con esta nueva base de datos podemos generar gráficos con <code>ggplot2</code> que pueden ayudarnos a explorar la distribución de los valores perdidos (según nuestras nuevas variables de las <code>shadows</code>) en relación con el año (variables del <code>anio</code>).</p>

<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="adv-data.html#cb411-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(indice_cinc_perdidos,</span>
<span id="cb411-2"><a href="adv-data.html#cb411-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> anio, <span class="at">fill =</span> poblacion_urb_NA)) <span class="sc">+</span> </span>
<span id="cb411-3"><a href="adv-data.html#cb411-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb411-4"><a href="adv-data.html#cb411-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># el resto es para hacer la gráfica más legible:</span></span>
<span id="cb411-5"><a href="adv-data.html#cb411-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1860</span>, <span class="dv">2020</span>, <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb411-6"><a href="adv-data.html#cb411-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb411-7"><a href="adv-data.html#cb411-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-35"></span>
<img src="11-adv-data_es_files/figure-html/unnamed-chunk-35-1.png" alt="Diagnosticar para responder a la pregunta: "¿En qué años hay NAs para la población urbana?" width="480" />
<p class="caption">
Figura 5.10: Diagnosticar para responder a la pregunta: "¿En qué años hay NAs para la población urbana?
</p>
</div>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb412-1"><a href="adv-data.html#cb412-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(indice_cinc_perdidos,</span>
<span id="cb412-2"><a href="adv-data.html#cb412-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> anio, <span class="at">fill =</span> gasto_militar_NA)) <span class="sc">+</span> </span>
<span id="cb412-3"><a href="adv-data.html#cb412-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb412-4"><a href="adv-data.html#cb412-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># el resto es para hacer la gráfica más legible:</span></span>
<span id="cb412-5"><a href="adv-data.html#cb412-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1860</span>, <span class="dv">2020</span>, <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb412-6"><a href="adv-data.html#cb412-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb412-7"><a href="adv-data.html#cb412-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-36"></span>
<img src="11-adv-data_es_files/figure-html/unnamed-chunk-36-1.png" alt="Diagnosticar para responder a la pregunta: "¿En qué años hay NAs para la población urbana?" width="480" />
<p class="caption">
Figura 5.11: Diagnosticar para responder a la pregunta: "¿En qué años hay NAs para la población urbana?
</p>
</div>
<p>En el caso de <code>poblacion_urb</code>, la población urbana del país, los valores que faltan se recogen claramente en los primeros años de la base de datos. Lo mismo se aplica para el <code>gasto_militar</code>, aunque ocasionalmente hay datos completos para unos pocos años más que en el <code>poblacion_urb</code>.</p>
</div>
</div>
<div id="imputación-de-valores-perdidos" class="section level2" number="11.6">
<h2><span class="header-section-number">11.6</span> Imputación de valores perdidos</h2>
<p>Observemos en un diagrama de dispersión la evolución del Índice Compuesto de Capacidad Nacional de China y Estados Unidos:</p>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="adv-data.html#cb413-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(indice_cinc) <span class="sc">+</span> </span>
<span id="cb413-2"><a href="adv-data.html#cb413-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> anio, <span class="at">y =</span> indice_capacidades, <span class="at">group =</span> pais_iso3c, <span class="at">color =</span> </span>
<span id="cb413-3"><a href="adv-data.html#cb413-3" aria-hidden="true" tabindex="-1"></a>                   pais_iso3c)) <span class="sc">+</span></span>
<span id="cb413-4"><a href="adv-data.html#cb413-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1860</span>, <span class="dv">2020</span>, <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb413-5"><a href="adv-data.html#cb413-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-37"></span>
<img src="11-adv-data_es_files/figure-html/unnamed-chunk-37-1.png" alt=" En lugar de mirar el índice de capacidades materiales como una línea, vemos cada año como un punto para observar mejor los valores que faltan" width="480" />
<p class="caption">
Figura 11.5:  En lugar de mirar el índice de capacidades materiales como una línea, vemos cada año como un punto para observar mejor los valores que faltan
</p>
</div>
<p>¿Cómo se vería el gráfico si los Estados Unidos no tuviera datos entre 1950 y 1970?</p>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb414-1"><a href="adv-data.html#cb414-1" aria-hidden="true" tabindex="-1"></a>indice_cinc2 <span class="ot">&lt;-</span> indice_cinc <span class="sc">%&gt;%</span></span>
<span id="cb414-2"><a href="adv-data.html#cb414-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">indice_capacidades =</span> <span class="fu">if_else</span>(pais_iso3c <span class="sc">==</span> <span class="st">&quot;USA&quot;</span> <span class="sc">&amp;</span> anio <span class="sc">%in%</span> <span class="dv">1950</span><span class="sc">:</span><span class="dv">1970</span>, </span>
<span id="cb414-3"><a href="adv-data.html#cb414-3" aria-hidden="true" tabindex="-1"></a>                                      <span class="cn">NA_real_</span>, indice_capacidades))</span></code></pre></div>
<p>Entonces, observamos el gráfico:</p>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="adv-data.html#cb415-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(indice_cinc2) <span class="sc">+</span> </span>
<span id="cb415-2"><a href="adv-data.html#cb415-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> anio, <span class="at">y =</span> indice_capacidades, <span class="at">group =</span> pais_iso3c, </span>
<span id="cb415-3"><a href="adv-data.html#cb415-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> pais_iso3c)) <span class="sc">+</span></span>
<span id="cb415-4"><a href="adv-data.html#cb415-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1860</span>, <span class="dv">2020</span>, <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb415-5"><a href="adv-data.html#cb415-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb415-6"><a href="adv-data.html#cb415-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Warning: Removed 21 rows containing missing values (geom_point).</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-39"></span>
<img src="11-adv-data_es_files/figure-html/unnamed-chunk-39-1.png" alt=" A la figura le faltan datos de los Estados Unidos entre 1950 y 1970" width="480" />
<p class="caption">
Figura 5.13:  A la figura le faltan datos de los Estados Unidos entre 1950 y 1970
</p>
</div>
<p>Ahora, es importante pensar en el tipo de valores perdidos que tenemos. Supongamos que no hay motivos declarados para asumir los valores perdidos en la base de datos, por lo tanto, se pierden al azar.</p>
<p>Para hacer la imputación usaremos
<code>mice</code> (abreviatura en inglés para Multivariate Imputation via Chained Equations). Esta es una de las muchas opciones que existen para el ecosistema de los paquetes de R, que también incluye el popular paquete <a href="https://gking.harvard.edu/amelia"><code>Amelia</code></a>, creado por los cientistas políticos Gary King, James Honaker y Matthew Blackwell. Elegimos ejemplificar con <code>mice</code>, considerando que es uno de los paquetes que se ha mantenido más actualizado. Por cierto, recuerda que estos paquetes asumen que los datos perdidos son MAR.</p>
<p>El paquete está diseñado para que podamos indicar cuántas imputaciones queremos hacer por cada valor que falta (con la opción <code>m=</code>, que por defecto hace 5 imputaciones), y nos permite trabajar tanto con datos transversales (como encuestas) como con datos de panel, como es nuestro caso con el índice CINC, que contiene datos de muchos años para cada país.</p>
<p>Después de comprender la estructura de los valores que faltan en la base de datos y exponer las hipótesis sobre su aleatoriedad, el segundo paso para la imputación es seleccionar las variables que se utilizarán. Sólo se necesita el id de cada observación (<code>pais_iso3c</code> o <code>code_cowc</code>), la variable temporal (<code>anio</code>) y las variables que se utilizarán para modelar los valores. Nuestra base de datos no tiene variables adicionales que nos gustaría eliminar, pero es una gran idea si quieres aplicar estos pasos en tus propios ejemplos.</p>
<p>Llamaremos a la imputación <code>imputacion_inicial</code>. Para ejecutarla, necesitamos indicar a <code>mice</code> una serie de parámetros. Como nuestros datos son de panel, necesitamos declarar cuál es la variable de las unidades de análisis y cuál es la variable temporal. Haremos esto por medio de la función <code>predictor()</code>: <code>pais_cown</code> es nuestra ID de países (numérica) y <code>anio</code> nuestra variable de tiempo.</p>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="adv-data.html#cb416-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mice)</span></code></pre></div>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb417-1"><a href="adv-data.html#cb417-1" aria-hidden="true" tabindex="-1"></a>imputacion_inicial <span class="ot">&lt;-</span> <span class="fu">mice</span>(indice_cinc2, <span class="at">maxit =</span> <span class="dv">0</span>)</span>
<span id="cb417-2"><a href="adv-data.html#cb417-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Warning: Number of logged events: 1</span></span>
<span id="cb417-3"><a href="adv-data.html#cb417-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb417-4"><a href="adv-data.html#cb417-4" aria-hidden="true" tabindex="-1"></a>predictor <span class="ot">&lt;-</span> imputacion_inicial<span class="sc">$</span>predictorMatrix</span>
<span id="cb417-5"><a href="adv-data.html#cb417-5" aria-hidden="true" tabindex="-1"></a><span class="co"># fijar pais_cown como la variable de ID</span></span>
<span id="cb417-6"><a href="adv-data.html#cb417-6" aria-hidden="true" tabindex="-1"></a>predictor[, <span class="st">&quot;pais_cown&quot;</span>] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span> </span>
<span id="cb417-7"><a href="adv-data.html#cb417-7" aria-hidden="true" tabindex="-1"></a><span class="co"># fijar el año como variable temporal (efectos aleatorios)</span></span>
<span id="cb417-8"><a href="adv-data.html#cb417-8" aria-hidden="true" tabindex="-1"></a>predictor[, <span class="st">&quot;anio&quot;</span>] <span class="ot">&lt;-</span> <span class="dv">2</span> </span></code></pre></div>
<p>También necesitamos especificar el método por el cual se realizará la imputación, usando el argumento <code>method =</code>. “pmm” (Predictive Mean Matching) funciona para variables numéricas, “logreg” (Logistic Regression) funciona para variables binaria y “polyreg” (Bayesian polytomous regression) es lo recomendado para variables de factores. En este caso, como el índice CINC es una variable continua, usaremos “pmm.” También definiremos un modelo normal en dos niveles con “2l.lmer” (tendría sentido usar “2l.bin,” un modelo logístico de dos niveles, si estuviéramos imputando variables categóricas).</p>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="adv-data.html#cb418-1" aria-hidden="true" tabindex="-1"></a>metodo_1 <span class="ot">&lt;-</span> imputacion_inicial<span class="sc">$</span>method</span>
<span id="cb418-2"><a href="adv-data.html#cb418-2" aria-hidden="true" tabindex="-1"></a>metodo_1[<span class="fu">which</span>(metodo_1 <span class="sc">==</span> <span class="st">&quot;pmm&quot;</span>)] <span class="ot">&lt;-</span> <span class="st">&quot;2l.lmer&quot;</span></span></code></pre></div>
<p>Una vez que la imputación está creada, la guardaremos como <code>imputacion_mice</code>. La imputación está más o menos escondidas en la lista de objetos que creamos, por lo que le asignaremos un nombre directamente.</p>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb419-1"><a href="adv-data.html#cb419-1" aria-hidden="true" tabindex="-1"></a>imputacion_mice <span class="ot">&lt;-</span> <span class="fu">mice</span>(indice_cinc2, <span class="at">m =</span> <span class="dv">5</span>, <span class="at">seed =</span> <span class="dv">1</span>, </span>
<span id="cb419-2"><a href="adv-data.html#cb419-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">method =</span> metodo_1, <span class="at">predictorMatrix =</span> predictor)</span>
<span id="cb419-3"><a href="adv-data.html#cb419-3" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb419-4"><a href="adv-data.html#cb419-4" aria-hidden="true" tabindex="-1"></a><span class="do">##  iter imp variable</span></span>
<span id="cb419-5"><a href="adv-data.html#cb419-5" aria-hidden="true" tabindex="-1"></a><span class="do">##   1   1  gasto_militar  poblacion_urb  indice_capacidades</span></span>
<span id="cb419-6"><a href="adv-data.html#cb419-6" aria-hidden="true" tabindex="-1"></a><span class="do">##   1   2  gasto_militar  poblacion_urb  indice_capacidades</span></span>
<span id="cb419-7"><a href="adv-data.html#cb419-7" aria-hidden="true" tabindex="-1"></a><span class="do">##   1   3  gasto_militar  poblacion_urb  indice_capacidades</span></span>
<span id="cb419-8"><a href="adv-data.html#cb419-8" aria-hidden="true" tabindex="-1"></a><span class="do">##   1   4  gasto_militar  poblacion_urb  indice_capacidades</span></span>
<span id="cb419-9"><a href="adv-data.html#cb419-9" aria-hidden="true" tabindex="-1"></a><span class="do">##   1   5  gasto_militar  poblacion_urb  indice_capacidades</span></span>
<span id="cb419-10"><a href="adv-data.html#cb419-10" aria-hidden="true" tabindex="-1"></a><span class="do">##   2   1  gasto_militar  poblacion_urb  indice_capacidades</span></span>
<span id="cb419-11"><a href="adv-data.html#cb419-11" aria-hidden="true" tabindex="-1"></a><span class="do">##   2   2  gasto_militar  poblacion_urb  indice_capacidades</span></span>
<span id="cb419-12"><a href="adv-data.html#cb419-12" aria-hidden="true" tabindex="-1"></a><span class="do">##   2   3  gasto_militar  poblacion_urb  indice_capacidades</span></span>
<span id="cb419-13"><a href="adv-data.html#cb419-13" aria-hidden="true" tabindex="-1"></a><span class="do">##   2   4  gasto_militar  poblacion_urb  indice_capacidades</span></span>
<span id="cb419-14"><a href="adv-data.html#cb419-14" aria-hidden="true" tabindex="-1"></a><span class="do">##   2   5  gasto_militar  poblacion_urb  indice_capacidades</span></span>
<span id="cb419-15"><a href="adv-data.html#cb419-15" aria-hidden="true" tabindex="-1"></a><span class="do">##   3   1  gasto_militar  poblacion_urb  indice_capacidades</span></span>
<span id="cb419-16"><a href="adv-data.html#cb419-16" aria-hidden="true" tabindex="-1"></a><span class="do">##   3   2  gasto_militar  poblacion_urb  indice_capacidades</span></span>
<span id="cb419-17"><a href="adv-data.html#cb419-17" aria-hidden="true" tabindex="-1"></a><span class="do">##   3   3  gasto_militar  poblacion_urb  indice_capacidades</span></span>
<span id="cb419-18"><a href="adv-data.html#cb419-18" aria-hidden="true" tabindex="-1"></a><span class="do">##   3   4  gasto_militar  poblacion_urb  indice_capacidades</span></span>
<span id="cb419-19"><a href="adv-data.html#cb419-19" aria-hidden="true" tabindex="-1"></a><span class="do">##   3   5  gasto_militar  poblacion_urb  indice_capacidades</span></span>
<span id="cb419-20"><a href="adv-data.html#cb419-20" aria-hidden="true" tabindex="-1"></a><span class="do">##   4   1  gasto_militar  poblacion_urb  indice_capacidades</span></span>
<span id="cb419-21"><a href="adv-data.html#cb419-21" aria-hidden="true" tabindex="-1"></a><span class="do">##   4   2  gasto_militar  poblacion_urb  indice_capacidades</span></span>
<span id="cb419-22"><a href="adv-data.html#cb419-22" aria-hidden="true" tabindex="-1"></a><span class="do">##   4   3  gasto_militar  poblacion_urb  indice_capacidades</span></span>
<span id="cb419-23"><a href="adv-data.html#cb419-23" aria-hidden="true" tabindex="-1"></a><span class="do">##   4   4  gasto_militar  poblacion_urb  indice_capacidades</span></span>
<span id="cb419-24"><a href="adv-data.html#cb419-24" aria-hidden="true" tabindex="-1"></a><span class="do">##   4   5  gasto_militar  poblacion_urb  indice_capacidades</span></span>
<span id="cb419-25"><a href="adv-data.html#cb419-25" aria-hidden="true" tabindex="-1"></a><span class="do">##   5   1  gasto_militar  poblacion_urb  indice_capacidades</span></span>
<span id="cb419-26"><a href="adv-data.html#cb419-26" aria-hidden="true" tabindex="-1"></a><span class="do">##   5   2  gasto_militar  poblacion_urb  indice_capacidades</span></span>
<span id="cb419-27"><a href="adv-data.html#cb419-27" aria-hidden="true" tabindex="-1"></a><span class="do">##   5   3  gasto_militar  poblacion_urb  indice_capacidades</span></span>
<span id="cb419-28"><a href="adv-data.html#cb419-28" aria-hidden="true" tabindex="-1"></a><span class="do">##   5   4  gasto_militar  poblacion_urb  indice_capacidades</span></span>
<span id="cb419-29"><a href="adv-data.html#cb419-29" aria-hidden="true" tabindex="-1"></a><span class="do">##   5   5  gasto_militar  poblacion_urb  indice_capacidades</span></span></code></pre></div>
<p>Podemos mirar los datos imputados, guardados dentro de <code>imp</code>:</p>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="adv-data.html#cb420-1" aria-hidden="true" tabindex="-1"></a>imputacion_mice<span class="sc">$</span>imp<span class="sc">$</span>indice_capacidades</span>
<span id="cb420-2"><a href="adv-data.html#cb420-2" aria-hidden="true" tabindex="-1"></a><span class="do">##     1  2  3  4  5</span></span>
<span id="cb420-3"><a href="adv-data.html#cb420-3" aria-hidden="true" tabindex="-1"></a><span class="do">## 91 20 22 19 26 25</span></span>
<span id="cb420-4"><a href="adv-data.html#cb420-4" aria-hidden="true" tabindex="-1"></a><span class="do">## 92 23 27 24 22 19</span></span>
<span id="cb420-5"><a href="adv-data.html#cb420-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 93 16 33 18 26 22</span></span>
<span id="cb420-6"><a href="adv-data.html#cb420-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 94 14 28 25 26 25</span></span>
<span id="cb420-7"><a href="adv-data.html#cb420-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  [ reached &#39;max&#39; / getOption(&quot;max.print&quot;) -- omitted 17 rows ]</span></span></code></pre></div>
<p>Observemos visualmente los valores imputados en la distribución de la variable “indice_capacidades”:</p>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb421-1"><a href="adv-data.html#cb421-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stripplot</span>(imputacion_mice, indice_capacidades, <span class="at">pch =</span> <span class="dv">20</span>)</span></code></pre></div>
<p><img src="11-adv-data_es_files/figure-html/unnamed-chunk-45-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Para trabajar con las imputaciones, debemos extraerlas del objeto <code>imputacion_mice</code>. Recuerda que generamos cinco imputaciones (<code>m = 5</code>). Usando la función <code>mice::complete()</code> extraeremos cada una, juntándolas al mismo tiempo con <code>bind_rows()</code>:</p>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="adv-data.html#cb422-1" aria-hidden="true" tabindex="-1"></a>datos_completos <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb422-2"><a href="adv-data.html#cb422-2" aria-hidden="true" tabindex="-1"></a>  mice<span class="sc">::</span><span class="fu">complete</span>(imputacion_mice, <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">num_imp =</span> <span class="dv">1</span>),</span>
<span id="cb422-3"><a href="adv-data.html#cb422-3" aria-hidden="true" tabindex="-1"></a>  mice<span class="sc">::</span><span class="fu">complete</span>(imputacion_mice, <span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">num_imp =</span> <span class="dv">2</span>),</span>
<span id="cb422-4"><a href="adv-data.html#cb422-4" aria-hidden="true" tabindex="-1"></a>  mice<span class="sc">::</span><span class="fu">complete</span>(imputacion_mice, <span class="dv">3</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">num_imp =</span> <span class="dv">3</span>),</span>
<span id="cb422-5"><a href="adv-data.html#cb422-5" aria-hidden="true" tabindex="-1"></a>  mice<span class="sc">::</span><span class="fu">complete</span>(imputacion_mice, <span class="dv">4</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">num_imp =</span> <span class="dv">4</span>),</span>
<span id="cb422-6"><a href="adv-data.html#cb422-6" aria-hidden="true" tabindex="-1"></a>  mice<span class="sc">::</span><span class="fu">complete</span>(imputacion_mice, <span class="dv">5</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">num_imp =</span> <span class="dv">5</span>),</span>
<span id="cb422-7"><a href="adv-data.html#cb422-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb422-8"><a href="adv-data.html#cb422-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(num_imp, <span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb422-9"><a href="adv-data.html#cb422-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fuente =</span> <span class="st">&quot;Imputación específica&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb422-10"><a href="adv-data.html#cb422-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(pais_iso3c <span class="sc">==</span> <span class="st">&quot;USA&quot;</span> <span class="sc">&amp;</span> anio <span class="sc">%in%</span> <span class="dv">1950</span><span class="sc">:</span><span class="dv">1970</span>)</span></code></pre></div>
<p>Calcularemos la media de las imputaciones, para analizar los resultados en un gráfico bivariado.</p>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="adv-data.html#cb423-1" aria-hidden="true" tabindex="-1"></a>media_imp <span class="ot">&lt;-</span> datos_completos <span class="sc">%&gt;%</span> </span>
<span id="cb423-2"><a href="adv-data.html#cb423-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(pais_iso3c, pais_cown, anio) <span class="sc">%&gt;%</span> </span>
<span id="cb423-3"><a href="adv-data.html#cb423-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">indice_capacidades =</span> <span class="fu">mean</span>(indice_capacidades)) <span class="sc">%&gt;%</span> </span>
<span id="cb423-4"><a href="adv-data.html#cb423-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb423-5"><a href="adv-data.html#cb423-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fuente =</span> <span class="st">&quot;Average Imp.&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb423-6"><a href="adv-data.html#cb423-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(pais_iso3c <span class="sc">==</span> <span class="st">&quot;USA&quot;</span> <span class="sc">&amp;</span> anio <span class="sc">%in%</span> <span class="dv">1950</span><span class="sc">:</span><span class="dv">1970</span>)</span></code></pre></div>
<p>La siguiente figura muestra las imputaciones individuales en un color claro y la media de estas en un tono más oscuro:</p>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb424-1"><a href="adv-data.html#cb424-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> anio, <span class="at">y =</span> indice_capacidades, </span>
<span id="cb424-2"><a href="adv-data.html#cb424-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">group =</span> pais_iso3c, <span class="at">color =</span> pais_iso3c)) <span class="sc">+</span> </span>
<span id="cb424-3"><a href="adv-data.html#cb424-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> indice_cinc2) <span class="sc">+</span></span>
<span id="cb424-4"><a href="adv-data.html#cb424-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add imputed data and its average values:</span></span>
<span id="cb424-5"><a href="adv-data.html#cb424-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> datos_completos, <span class="at">color =</span> <span class="st">&quot;darkgray&quot;</span>) <span class="sc">+</span></span>
<span id="cb424-6"><a href="adv-data.html#cb424-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> media_imp, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb424-7"><a href="adv-data.html#cb424-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add vertical lines for emphasis:</span></span>
<span id="cb424-8"><a href="adv-data.html#cb424-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="dv">1950</span>, <span class="dv">1970</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb424-9"><a href="adv-data.html#cb424-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1860</span>, <span class="dv">2020</span>, <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb424-10"><a href="adv-data.html#cb424-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;lightgray&quot;</span>, <span class="st">&quot;black&quot;</span>)) <span class="sc">+</span></span>
<span id="cb424-11"><a href="adv-data.html#cb424-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb424-12"><a href="adv-data.html#cb424-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Warning: Removed 21 rows containing missing values (geom_point).</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-48"></span>
<img src="11-adv-data_es_files/figure-html/unnamed-chunk-48-1.png" alt="Cuatro imputaciones (tono claro) más su media (tono oscuro)." width="480" />
<p class="caption">
Figura 11.6: Cuatro imputaciones (tono claro) más su media (tono oscuro).
</p>
</div>
<p>Es importante remarcar que usar imputaciones para estudios descriptivos es distinto a hacerlo para regresiones, como veremos a continuación.</p>
<div class="figure" style="text-align: center"><span id="fig:imp"></span>
<img src="00-images/adv-data/imputa_1.png" alt="El proceso de las imputaciones para un análisis visual se realiza luego de tomar el promedio de las imputaciones individuales de mice." width="57%" />
<p class="caption">
Figura 11.7: El proceso de las imputaciones para un análisis visual se realiza luego de tomar el promedio de las imputaciones individuales de mice.
</p>
</div>
<div id="regresiones-luego-de-imputar-datos" class="section level3" number="11.6.1">
<h3><span class="header-section-number">11.6.1</span> Regresiones luego de imputar datos</h3>
<p>A diferencia de cuando visualizamos datos, al hacer regresiones con datos imputados lo recomendado no es tomar el promedio de las imputaciones, sino que obtener el promedio de los coeficientes obtenidos para regresiones hechas por separado con las distintas imputaciones. El proceso es el siguiente:</p>
<div class="figure" style="text-align: center"><span id="fig:imputa3"></span>
<img src="00-images/adv-data/imputa_2.png" alt="El proceso de imputación para regresiones consiste en obtener el promedio de los coeficientes entre múltiples regresiones, no usar los datos promediados en una sola regresión." width="60%" />
<p class="caption">
Figura 11.8: El proceso de imputación para regresiones consiste en obtener el promedio de los coeficientes entre múltiples regresiones, no usar los datos promediados en una sola regresión.
</p>
</div>
<p>Primero veamos cómo se vería usando una regresión usando datos incompletos. Usando un modelo muy sencillo, estimaremos el índice de capacidades de cada país de acuerdo a las variables <code>cons_energia</code> y <code>poblacion_urb</code>.</p>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="adv-data.html#cb425-1" aria-hidden="true" tabindex="-1"></a>modelo_incompleto <span class="ot">&lt;-</span> <span class="fu">lm</span>(indice_capacidades <span class="sc">~</span> cons_energia <span class="sc">+</span> poblacion_urb, </span>
<span id="cb425-2"><a href="adv-data.html#cb425-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">data =</span> indice_cinc2)</span>
<span id="cb425-3"><a href="adv-data.html#cb425-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb425-4"><a href="adv-data.html#cb425-4" aria-hidden="true" tabindex="-1"></a>texreg<span class="sc">::</span><span class="fu">screenreg</span>(modelo_incompleto)</span>
<span id="cb425-5"><a href="adv-data.html#cb425-5" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb425-6"><a href="adv-data.html#cb425-6" aria-hidden="true" tabindex="-1"></a><span class="do">## =========================</span></span>
<span id="cb425-7"><a href="adv-data.html#cb425-7" aria-hidden="true" tabindex="-1"></a><span class="do">##                Model 1   </span></span>
<span id="cb425-8"><a href="adv-data.html#cb425-8" aria-hidden="true" tabindex="-1"></a><span class="do">## -------------------------</span></span>
<span id="cb425-9"><a href="adv-data.html#cb425-9" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept)     15.32 ***</span></span>
<span id="cb425-10"><a href="adv-data.html#cb425-10" aria-hidden="true" tabindex="-1"></a><span class="do">##                 (0.54)   </span></span>
<span id="cb425-11"><a href="adv-data.html#cb425-11" aria-hidden="true" tabindex="-1"></a><span class="do">## cons_energia     0.00 ** </span></span>
<span id="cb425-12"><a href="adv-data.html#cb425-12" aria-hidden="true" tabindex="-1"></a><span class="do">##                 (0.00)   </span></span>
<span id="cb425-13"><a href="adv-data.html#cb425-13" aria-hidden="true" tabindex="-1"></a><span class="do">## poblacion_urb   -0.01 *  </span></span>
<span id="cb425-14"><a href="adv-data.html#cb425-14" aria-hidden="true" tabindex="-1"></a><span class="do">##                 (0.00)   </span></span>
<span id="cb425-15"><a href="adv-data.html#cb425-15" aria-hidden="true" tabindex="-1"></a><span class="do">## -------------------------</span></span>
<span id="cb425-16"><a href="adv-data.html#cb425-16" aria-hidden="true" tabindex="-1"></a><span class="do">## R^2              0.04    </span></span>
<span id="cb425-17"><a href="adv-data.html#cb425-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Adj. R^2         0.03    </span></span>
<span id="cb425-18"><a href="adv-data.html#cb425-18" aria-hidden="true" tabindex="-1"></a><span class="do">## Num. obs.      217       </span></span>
<span id="cb425-19"><a href="adv-data.html#cb425-19" aria-hidden="true" tabindex="-1"></a><span class="do">## =========================</span></span>
<span id="cb425-20"><a href="adv-data.html#cb425-20" aria-hidden="true" tabindex="-1"></a><span class="do">## *** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</span></span></code></pre></div>
<p>A continuación generaremos cinco regresiones, una por cada base imputada que generamos antes:</p>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="adv-data.html#cb426-1" aria-hidden="true" tabindex="-1"></a>modelo_imp1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(indice_capacidades <span class="sc">~</span> cons_energia <span class="sc">+</span> poblacion_urb, </span>
<span id="cb426-2"><a href="adv-data.html#cb426-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> mice<span class="sc">::</span><span class="fu">complete</span>(imputacion_mice, <span class="dv">1</span>))</span>
<span id="cb426-3"><a href="adv-data.html#cb426-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb426-4"><a href="adv-data.html#cb426-4" aria-hidden="true" tabindex="-1"></a>modelo_imp2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(indice_capacidades <span class="sc">~</span> cons_energia <span class="sc">+</span> poblacion_urb, </span>
<span id="cb426-5"><a href="adv-data.html#cb426-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> mice<span class="sc">::</span><span class="fu">complete</span>(imputacion_mice, <span class="dv">2</span>))</span>
<span id="cb426-6"><a href="adv-data.html#cb426-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb426-7"><a href="adv-data.html#cb426-7" aria-hidden="true" tabindex="-1"></a>modelo_imp3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(indice_capacidades <span class="sc">~</span> cons_energia <span class="sc">+</span> poblacion_urb,</span>
<span id="cb426-8"><a href="adv-data.html#cb426-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> mice<span class="sc">::</span><span class="fu">complete</span>(imputacion_mice, <span class="dv">3</span>))</span>
<span id="cb426-9"><a href="adv-data.html#cb426-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb426-10"><a href="adv-data.html#cb426-10" aria-hidden="true" tabindex="-1"></a>modelo_imp4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(indice_capacidades <span class="sc">~</span> cons_energia <span class="sc">+</span> poblacion_urb, </span>
<span id="cb426-11"><a href="adv-data.html#cb426-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> mice<span class="sc">::</span><span class="fu">complete</span>(imputacion_mice, <span class="dv">4</span>))</span>
<span id="cb426-12"><a href="adv-data.html#cb426-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb426-13"><a href="adv-data.html#cb426-13" aria-hidden="true" tabindex="-1"></a>modelo_imp5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(indice_capacidades <span class="sc">~</span> cons_energia <span class="sc">+</span> poblacion_urb, </span>
<span id="cb426-14"><a href="adv-data.html#cb426-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> mice<span class="sc">::</span><span class="fu">complete</span>(imputacion_mice, <span class="dv">5</span>))</span>
<span id="cb426-15"><a href="adv-data.html#cb426-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb426-16"><a href="adv-data.html#cb426-16" aria-hidden="true" tabindex="-1"></a>lista_modelos <span class="ot">&lt;-</span> <span class="fu">list</span>(modelo_incompleto, modelo_imp1, modelo_imp2, modelo_imp3, modelo_imp4, modelo_imp5)</span>
<span id="cb426-17"><a href="adv-data.html#cb426-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb426-18"><a href="adv-data.html#cb426-18" aria-hidden="true" tabindex="-1"></a>texreg<span class="sc">::</span><span class="fu">screenreg</span>(</span>
<span id="cb426-19"><a href="adv-data.html#cb426-19" aria-hidden="true" tabindex="-1"></a>  lista_modelos, </span>
<span id="cb426-20"><a href="adv-data.html#cb426-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">custom.model.names =</span> <span class="fu">c</span>(<span class="st">&quot;M incomp&quot;</span>, <span class="st">&quot;M imp 1&quot;</span>, <span class="st">&quot;M imp 2&quot;</span>, <span class="st">&quot;M imp 3&quot;</span>, <span class="st">&quot;M imp 4&quot;</span>, <span class="st">&quot;M imp 5&quot;</span>)</span>
<span id="cb426-21"><a href="adv-data.html#cb426-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb426-22"><a href="adv-data.html#cb426-22" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb426-23"><a href="adv-data.html#cb426-23" aria-hidden="true" tabindex="-1"></a><span class="do">## =====================================================================================</span></span>
<span id="cb426-24"><a href="adv-data.html#cb426-24" aria-hidden="true" tabindex="-1"></a><span class="do">##                M incomp    M imp 1     M imp 2     M imp 3     M imp 4     M imp 5   </span></span>
<span id="cb426-25"><a href="adv-data.html#cb426-25" aria-hidden="true" tabindex="-1"></a><span class="do">## -------------------------------------------------------------------------------------</span></span>
<span id="cb426-26"><a href="adv-data.html#cb426-26" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept)     15.32 ***   15.05 ***   15.87 ***   15.26 ***   15.81 ***   15.29 ***</span></span>
<span id="cb426-27"><a href="adv-data.html#cb426-27" aria-hidden="true" tabindex="-1"></a><span class="do">##                 (0.54)      (0.37)      (0.46)      (0.39)      (0.44)      (0.39)   </span></span>
<span id="cb426-28"><a href="adv-data.html#cb426-28" aria-hidden="true" tabindex="-1"></a><span class="do">## cons_energia     0.00 **     0.00 ***    0.00 ***    0.00 ***    0.00 ***    0.00 ***</span></span>
<span id="cb426-29"><a href="adv-data.html#cb426-29" aria-hidden="true" tabindex="-1"></a><span class="do">##                 (0.00)      (0.00)      (0.00)      (0.00)      (0.00)      (0.00)   </span></span>
<span id="cb426-30"><a href="adv-data.html#cb426-30" aria-hidden="true" tabindex="-1"></a><span class="do">## poblacion_urb   -0.01 *     -0.01 **    -0.01 **    -0.01 **    -0.01 ***   -0.01 *  </span></span>
<span id="cb426-31"><a href="adv-data.html#cb426-31" aria-hidden="true" tabindex="-1"></a><span class="do">##                 (0.00)      (0.00)      (0.00)      (0.00)      (0.00)      (0.00)   </span></span>
<span id="cb426-32"><a href="adv-data.html#cb426-32" aria-hidden="true" tabindex="-1"></a><span class="do">## -------------------------------------------------------------------------------------</span></span>
<span id="cb426-33"><a href="adv-data.html#cb426-33" aria-hidden="true" tabindex="-1"></a><span class="do">## R^2              0.04        0.06        0.07        0.07        0.08        0.05    </span></span>
<span id="cb426-34"><a href="adv-data.html#cb426-34" aria-hidden="true" tabindex="-1"></a><span class="do">## Adj. R^2         0.03        0.06        0.07        0.06        0.08        0.05    </span></span>
<span id="cb426-35"><a href="adv-data.html#cb426-35" aria-hidden="true" tabindex="-1"></a><span class="do">## Num. obs.      217         306         306         306         306         306       </span></span>
<span id="cb426-36"><a href="adv-data.html#cb426-36" aria-hidden="true" tabindex="-1"></a><span class="do">## =====================================================================================</span></span>
<span id="cb426-37"><a href="adv-data.html#cb426-37" aria-hidden="true" tabindex="-1"></a><span class="do">## *** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</span></span></code></pre></div>
<p><code>mice</code> nuevamente hace bastante simple el proceso de combinar los valores de las cinco regresiones:</p>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="adv-data.html#cb427-1" aria-hidden="true" tabindex="-1"></a>modelo_combinado_form <span class="ot">&lt;-</span> <span class="fu">with</span>(</span>
<span id="cb427-2"><a href="adv-data.html#cb427-2" aria-hidden="true" tabindex="-1"></a>  imputacion_mice, </span>
<span id="cb427-3"><a href="adv-data.html#cb427-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(indice_capacidades <span class="sc">~</span> cons_energia <span class="sc">+</span> poblacion_urb)</span>
<span id="cb427-4"><a href="adv-data.html#cb427-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb427-5"><a href="adv-data.html#cb427-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb427-6"><a href="adv-data.html#cb427-6" aria-hidden="true" tabindex="-1"></a>modelo_combinado <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">pool</span>(modelo_combinado_form))</span></code></pre></div>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="adv-data.html#cb428-1" aria-hidden="true" tabindex="-1"></a>modelo_combinado</span>
<span id="cb428-2"><a href="adv-data.html#cb428-2" aria-hidden="true" tabindex="-1"></a><span class="do">##            term estimate std.error statistic  df p.value</span></span>
<span id="cb428-3"><a href="adv-data.html#cb428-3" aria-hidden="true" tabindex="-1"></a><span class="do">## 1   (Intercept)  15.4553   0.57258      27.0  15 2.0e-14</span></span>
<span id="cb428-4"><a href="adv-data.html#cb428-4" aria-hidden="true" tabindex="-1"></a><span class="do">## 2  cons_energia   0.0014   0.00035       4.0  59 1.9e-04</span></span>
<span id="cb428-5"><a href="adv-data.html#cb428-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 3 poblacion_urb  -0.0099   0.00358      -2.8 162 6.1e-03</span></span></code></pre></div>
<p>Mostrar los resultados con <code>texreg</code> será un poco más complicado, pues no hay una implementación por defecto. Crearemos una personalizada usando <code>texreg::createTexreg()</code>, especificando manualmente los coeficientes, errores estándar, <span class="math inline">\(R^2\)</span>, etc.</p>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="adv-data.html#cb429-1" aria-hidden="true" tabindex="-1"></a>tr_modelo_combinado <span class="ot">&lt;-</span> texreg<span class="sc">::</span><span class="fu">createTexreg</span>(</span>
<span id="cb429-2"><a href="adv-data.html#cb429-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># nombres de los coeficientes:</span></span>
<span id="cb429-3"><a href="adv-data.html#cb429-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">coef.names =</span> <span class="fu">as.character</span>(modelo_combinado<span class="sc">$</span>term), </span>
<span id="cb429-4"><a href="adv-data.html#cb429-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># coeficientes, errores estándar y valores-p:</span></span>
<span id="cb429-5"><a href="adv-data.html#cb429-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">coef =</span> modelo_combinado<span class="sc">$</span>estimate, </span>
<span id="cb429-6"><a href="adv-data.html#cb429-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">se =</span> modelo_combinado<span class="sc">$</span>std.error, </span>
<span id="cb429-7"><a href="adv-data.html#cb429-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">pvalues =</span> modelo_combinado<span class="sc">$</span>p.value,</span>
<span id="cb429-8"><a href="adv-data.html#cb429-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># R^2 y número de observaciones:</span></span>
<span id="cb429-9"><a href="adv-data.html#cb429-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">gof.names =</span> <span class="fu">c</span>(<span class="st">&quot;R^2&quot;</span>, <span class="st">&quot;Num. obs.&quot;</span>),</span>
<span id="cb429-10"><a href="adv-data.html#cb429-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">gof =</span> <span class="fu">c</span>(<span class="fu">pool.r.squared</span>(modelo_combinado_form)[<span class="dv">1</span>, <span class="dv">1</span>], <span class="fu">nrow</span>(imputacion_mice<span class="sc">$</span>data)),</span>
<span id="cb429-11"><a href="adv-data.html#cb429-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">gof.decimal =</span> <span class="fu">c</span>(T, F)</span>
<span id="cb429-12"><a href="adv-data.html#cb429-12" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Así podemos usar el <code>texreg::screenreg()</code> tradicional con nuestro nuevo objeto:</p>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="adv-data.html#cb430-1" aria-hidden="true" tabindex="-1"></a>texreg<span class="sc">::</span><span class="fu">screenreg</span>(tr_modelo_combinado)</span>
<span id="cb430-2"><a href="adv-data.html#cb430-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb430-3"><a href="adv-data.html#cb430-3" aria-hidden="true" tabindex="-1"></a><span class="do">## =========================</span></span>
<span id="cb430-4"><a href="adv-data.html#cb430-4" aria-hidden="true" tabindex="-1"></a><span class="do">##                Model 1   </span></span>
<span id="cb430-5"><a href="adv-data.html#cb430-5" aria-hidden="true" tabindex="-1"></a><span class="do">## -------------------------</span></span>
<span id="cb430-6"><a href="adv-data.html#cb430-6" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept)     15.46 ***</span></span>
<span id="cb430-7"><a href="adv-data.html#cb430-7" aria-hidden="true" tabindex="-1"></a><span class="do">##                 (0.57)   </span></span>
<span id="cb430-8"><a href="adv-data.html#cb430-8" aria-hidden="true" tabindex="-1"></a><span class="do">## cons_energia     0.00 ***</span></span>
<span id="cb430-9"><a href="adv-data.html#cb430-9" aria-hidden="true" tabindex="-1"></a><span class="do">##                 (0.00)   </span></span>
<span id="cb430-10"><a href="adv-data.html#cb430-10" aria-hidden="true" tabindex="-1"></a><span class="do">## poblacion_urb   -0.01 ** </span></span>
<span id="cb430-11"><a href="adv-data.html#cb430-11" aria-hidden="true" tabindex="-1"></a><span class="do">##                 (0.00)   </span></span>
<span id="cb430-12"><a href="adv-data.html#cb430-12" aria-hidden="true" tabindex="-1"></a><span class="do">## -------------------------</span></span>
<span id="cb430-13"><a href="adv-data.html#cb430-13" aria-hidden="true" tabindex="-1"></a><span class="do">## R^2              0.07    </span></span>
<span id="cb430-14"><a href="adv-data.html#cb430-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Num. obs.      306       </span></span>
<span id="cb430-15"><a href="adv-data.html#cb430-15" aria-hidden="true" tabindex="-1"></a><span class="do">## =========================</span></span>
<span id="cb430-16"><a href="adv-data.html#cb430-16" aria-hidden="true" tabindex="-1"></a><span class="do">## *** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</span></span></code></pre></div>
<p>Finalmente conseguimos lo que buscábamos. Una regresión que tiene más observaciones, gracias al proceso de imputación. En este caso, la diferencia entre las observaciones es pequeña, cambiando de 12.165 a 12.187, casi sin diferencias en los coeficientes. Notarás que las imputaciones generan diferencias más importantes cuando el porcentaje de valores perdidos es mayor.</p>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="adv-data.html#cb431-1" aria-hidden="true" tabindex="-1"></a>texreg<span class="sc">::</span><span class="fu">screenreg</span>(<span class="fu">list</span>(modelo_incompleto, tr_modelo_combinado),</span>
<span id="cb431-2"><a href="adv-data.html#cb431-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">custom.model.names =</span> <span class="fu">c</span>(<span class="st">&quot;M incomp&quot;</span>, <span class="st">&quot;M combinado&quot;</span>))</span>
<span id="cb431-3"><a href="adv-data.html#cb431-3" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb431-4"><a href="adv-data.html#cb431-4" aria-hidden="true" tabindex="-1"></a><span class="do">## ======================================</span></span>
<span id="cb431-5"><a href="adv-data.html#cb431-5" aria-hidden="true" tabindex="-1"></a><span class="do">##                M incomp    M combinado</span></span>
<span id="cb431-6"><a href="adv-data.html#cb431-6" aria-hidden="true" tabindex="-1"></a><span class="do">## --------------------------------------</span></span>
<span id="cb431-7"><a href="adv-data.html#cb431-7" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept)     15.32 ***   15.46 *** </span></span>
<span id="cb431-8"><a href="adv-data.html#cb431-8" aria-hidden="true" tabindex="-1"></a><span class="do">##                 (0.54)      (0.57)    </span></span>
<span id="cb431-9"><a href="adv-data.html#cb431-9" aria-hidden="true" tabindex="-1"></a><span class="do">## cons_energia     0.00 **     0.00 *** </span></span>
<span id="cb431-10"><a href="adv-data.html#cb431-10" aria-hidden="true" tabindex="-1"></a><span class="do">##                 (0.00)      (0.00)    </span></span>
<span id="cb431-11"><a href="adv-data.html#cb431-11" aria-hidden="true" tabindex="-1"></a><span class="do">## poblacion_urb   -0.01 *     -0.01 **  </span></span>
<span id="cb431-12"><a href="adv-data.html#cb431-12" aria-hidden="true" tabindex="-1"></a><span class="do">##                 (0.00)      (0.00)    </span></span>
<span id="cb431-13"><a href="adv-data.html#cb431-13" aria-hidden="true" tabindex="-1"></a><span class="do">## --------------------------------------</span></span>
<span id="cb431-14"><a href="adv-data.html#cb431-14" aria-hidden="true" tabindex="-1"></a><span class="do">## R^2              0.04        0.07     </span></span>
<span id="cb431-15"><a href="adv-data.html#cb431-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Adj. R^2         0.03                 </span></span>
<span id="cb431-16"><a href="adv-data.html#cb431-16" aria-hidden="true" tabindex="-1"></a><span class="do">## Num. obs.      217         306        </span></span>
<span id="cb431-17"><a href="adv-data.html#cb431-17" aria-hidden="true" tabindex="-1"></a><span class="do">## ======================================</span></span>
<span id="cb431-18"><a href="adv-data.html#cb431-18" aria-hidden="true" tabindex="-1"></a><span class="do">## *** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</span></span></code></pre></div>
<p>¡Esperamos que hayas encontrado esta sección útil! Si es que te interesa aprender más sobre el trabajo con valores perdidos, recomendamos el trabajo de James Honaker y Gary King <span class="citation">(<a href="referencias.html#ref-honakerWhatMissingValues2010" role="doc-biblioref">Honaker and King 2010</a>)</span>.</p>
<blockquote>
<p><strong>Ejercicio 11C.</strong> En vez de cinco imputaciones, repite el ejercicio de regresión usando diez imputaciones.</p>
</blockquote>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="46">
<li id="fn46"><p>E-mail: arcruz@uc.cl<a href="adv-data.html#fnref46" class="footnote-back">↩︎</a></p></li>
<li id="fn47"><p>E-mail: furdinez@uc.cl<a href="adv-data.html#fnref47" class="footnote-back">↩︎</a></p></li>
<li id="fn48"><p>Esta forma de unir bases de datos, conocida como <code>left join</code>, es particularmente común. En algunos casos específicos, podríamos necesitar otros tipos de uniones, más avanzadas. Te recomendamos que revises este prolífico <a href="https://stat545.com/join-cheatsheet.html">resumen escrito por Jenny Bryan</a><a href="adv-data.html#fnref48" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="causal-inf.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="web-mining.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "night",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/arcruz0/libroadp/edit/master/11-adv-data_es.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
